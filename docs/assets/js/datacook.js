/*! For license information please see index.js.LICENSE.txt */
(()=>{var t={4064:t=>{t.exports=function(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r},t.exports.__esModule=!0,t.exports.default=t.exports},7394:t=>{t.exports=function(t){if(Array.isArray(t))return t},t.exports.__esModule=!0,t.exports.default=t.exports},3951:(t,e,n)=>{var r=n(4064);t.exports=function(t){if(Array.isArray(t))return r(t)},t.exports.__esModule=!0,t.exports.default=t.exports},4477:t=>{t.exports=function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t},t.exports.__esModule=!0,t.exports.default=t.exports},8813:t=>{t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},t.exports.__esModule=!0,t.exports.default=t.exports},7946:(t,e,n)=>{var r=n(689),i=n(1774);function a(e,n,s){return i()?(t.exports=a=Reflect.construct,t.exports.__esModule=!0,t.exports.default=t.exports):(t.exports=a=function(t,e,n){var i=[null];i.push.apply(i,e);var a=new(Function.bind.apply(t,i));return n&&r(a,n.prototype),a},t.exports.__esModule=!0,t.exports.default=t.exports),a.apply(null,arguments)}t.exports=a,t.exports.__esModule=!0,t.exports.default=t.exports},1398:t=>{function e(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}t.exports=function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t},t.exports.__esModule=!0,t.exports.default=t.exports},5590:t=>{t.exports=function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t},t.exports.__esModule=!0,t.exports.default=t.exports},986:t=>{function e(){return t.exports=e=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},t.exports.__esModule=!0,t.exports.default=t.exports,e.apply(this,arguments)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports},9033:t=>{function e(n){return t.exports=e=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},t.exports.__esModule=!0,t.exports.default=t.exports,e(n)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports},5317:(t,e,n)=>{var r=n(689);t.exports=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(t,"prototype",{value:Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),writable:!1}),e&&r(t,e)},t.exports.__esModule=!0,t.exports.default=t.exports},3852:t=>{t.exports=function(t){return t&&t.__esModule?t:{default:t}},t.exports.__esModule=!0,t.exports.default=t.exports},8797:(t,e,n)=>{var r=n(1736).default;function i(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,n=new WeakMap;return(i=function(t){return t?n:e})(t)}t.exports=function(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==r(t)&&"function"!=typeof t)return{default:t};var n=i(e);if(n&&n.has(t))return n.get(t);var a={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if("default"!==o&&Object.prototype.hasOwnProperty.call(t,o)){var l=s?Object.getOwnPropertyDescriptor(t,o):null;l&&(l.get||l.set)?Object.defineProperty(a,o,l):a[o]=t[o]}return a.default=t,n&&n.set(t,a),a},t.exports.__esModule=!0,t.exports.default=t.exports},1774:t=>{t.exports=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}},t.exports.__esModule=!0,t.exports.default=t.exports},2207:t=>{t.exports=function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)},t.exports.__esModule=!0,t.exports.default=t.exports},4592:t=>{t.exports=function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,a=[],s=!0,o=!1;try{for(n=n.call(t);!(s=(r=n.next()).done)&&(a.push(r.value),!e||a.length!==e);s=!0);}catch(t){o=!0,i=t}finally{try{s||null==n.return||n.return()}finally{if(o)throw i}}return a}},t.exports.__esModule=!0,t.exports.default=t.exports},1424:t=>{t.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},t.exports.__esModule=!0,t.exports.default=t.exports},6573:t=>{t.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},t.exports.__esModule=!0,t.exports.default=t.exports},1358:(t,e,n)=>{var r=n(1736).default,i=n(4477);t.exports=function(t,e){if(e&&("object"===r(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return i(t)},t.exports.__esModule=!0,t.exports.default=t.exports},689:t=>{function e(n,r){return t.exports=e=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},t.exports.__esModule=!0,t.exports.default=t.exports,e(n,r)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports},4185:(t,e,n)=>{var r=n(7394),i=n(4592),a=n(6413),s=n(1424);t.exports=function(t,e){return r(t)||i(t,e)||a(t,e)||s()},t.exports.__esModule=!0,t.exports.default=t.exports},7907:(t,e,n)=>{var r=n(3951),i=n(2207),a=n(6413),s=n(6573);t.exports=function(t){return r(t)||i(t)||a(t)||s()},t.exports.__esModule=!0,t.exports.default=t.exports},1736:t=>{function e(n){return t.exports=e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t.exports.__esModule=!0,t.exports.default=t.exports,e(n)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports},6413:(t,e,n)=>{var r=n(4064);t.exports=function(t,e){if(t){if("string"==typeof t)return r(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(t,e):void 0}},t.exports.__esModule=!0,t.exports.default=t.exports},3164:(t,e,n)=>{t.exports=n(405)},9390:(t,e,n)=>{"use strict";var r=n(3852);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=r(n(5590)),a=r(n(7695)),s=n(1065),o="image/bmp",l="image/x-ms-bmp",u=function(t){return e=a.default.decode(t),(0,s.scan)({bitmap:e},0,0,e.width,e.height,(function(t,n,r){var i=this.bitmap.data[r+0],a=this.bitmap.data[r+1],s=this.bitmap.data[r+2],o=this.bitmap.data[r+3];this.bitmap.data[r+0]=o,this.bitmap.data[r+1]=s,this.bitmap.data[r+2]=a,this.bitmap.data[r+3]=e.is_with_alpha?i:255})).bitmap;var e},h=function(t){return a.default.encode(function(t){return(0,s.scan)(t,0,0,t.bitmap.width,t.bitmap.height,(function(t,e,n){var r=this.bitmap.data[n+0],i=this.bitmap.data[n+1],a=this.bitmap.data[n+2],s=this.bitmap.data[n+3];this.bitmap.data[n+0]=s,this.bitmap.data[n+1]=a,this.bitmap.data[n+2]=i,this.bitmap.data[n+3]=r})).bitmap}(t)).data};e.default=function(){var t,e;return{mime:(0,i.default)({},o,["bmp"]),constants:{MIME_BMP:o,MIME_X_MS_BMP:l},decoders:(t={},(0,i.default)(t,o,u),(0,i.default)(t,l,u),t),encoders:(e={},(0,i.default)(e,o,h),(0,i.default)(e,l,h),e)}}},7453:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.srcOver=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;t.a*=n;var r=e.a+t.a-e.a*t.a,i=(t.r*t.a+e.r*e.a*(1-t.a))/r,a=(t.g*t.a+e.g*e.a*(1-t.a))/r,s=(t.b*t.a+e.b*e.a*(1-t.a))/r;return{r:i,g:a,b:s,a:r}},e.dstOver=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;t.a*=n;var r=e.a+t.a-e.a*t.a,i=(e.r*e.a+t.r*t.a*(1-e.a))/r,a=(e.g*e.a+t.g*t.a*(1-e.a))/r,s=(e.b*e.a+t.b*t.a*(1-e.a))/r;return{r:i,g:a,b:s,a:r}},e.multiply=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;t.a*=n;var r=e.a+t.a-e.a*t.a,i=t.r*t.a,a=t.g*t.a,s=t.b*t.a,o=e.r*e.a,l=e.g*e.a,u=e.b*e.a,h=(i*o+i*(1-e.a)+o*(1-t.a))/r,c=(a*l+a*(1-e.a)+l*(1-t.a))/r,d=(s*u+s*(1-e.a)+u*(1-t.a))/r;return{r:h,g:c,b:d,a:r}},e.add=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;t.a*=n;var r=e.a+t.a-e.a*t.a,i=t.r*t.a,a=t.g*t.a,s=t.b*t.a,o=e.r*e.a,l=e.g*e.a,u=e.b*e.a,h=(i+o)/r,c=(a+l)/r,d=(s+u)/r;return{r:h,g:c,b:d,a:r}},e.screen=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;t.a*=n;var r=e.a+t.a-e.a*t.a,i=t.r*t.a,a=t.g*t.a,s=t.b*t.a,o=e.r*e.a,l=e.g*e.a,u=e.b*e.a,h=(i*e.a+o*t.a-i*o+i*(1-e.a)+o*(1-t.a))/r,c=(a*e.a+l*t.a-a*l+a*(1-e.a)+l*(1-t.a))/r,d=(s*e.a+u*t.a-s*u+s*(1-e.a)+u*(1-t.a))/r;return{r:h,g:c,b:d,a:r}},e.overlay=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;t.a*=n;var r=e.a+t.a-e.a*t.a,i=t.r*t.a,a=t.g*t.a,s=t.b*t.a,o=e.r*e.a,l=e.g*e.a,u=e.b*e.a,h=(2*o<=e.a?2*i*o+i*(1-e.a)+o*(1-t.a):i*(1+e.a)+o*(1+t.a)-2*o*i-e.a*t.a)/r,c=(2*l<=e.a?2*a*l+a*(1-e.a)+l*(1-t.a):a*(1+e.a)+l*(1+t.a)-2*l*a-e.a*t.a)/r,d=(2*u<=e.a?2*s*u+s*(1-e.a)+u*(1-t.a):s*(1+e.a)+u*(1+t.a)-2*u*s-e.a*t.a)/r;return{r:h,g:c,b:d,a:r}},e.darken=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;t.a*=n;var r=e.a+t.a-e.a*t.a,i=t.r*t.a,a=t.g*t.a,s=t.b*t.a,o=e.r*e.a,l=e.g*e.a,u=e.b*e.a,h=(Math.min(i*e.a,o*t.a)+i*(1-e.a)+o*(1-t.a))/r,c=(Math.min(a*e.a,l*t.a)+a*(1-e.a)+l*(1-t.a))/r,d=(Math.min(s*e.a,u*t.a)+s*(1-e.a)+u*(1-t.a))/r;return{r:h,g:c,b:d,a:r}},e.lighten=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;t.a*=n;var r=e.a+t.a-e.a*t.a,i=t.r*t.a,a=t.g*t.a,s=t.b*t.a,o=e.r*e.a,l=e.g*e.a,u=e.b*e.a,h=(Math.max(i*e.a,o*t.a)+i*(1-e.a)+o*(1-t.a))/r,c=(Math.max(a*e.a,l*t.a)+a*(1-e.a)+l*(1-t.a))/r,d=(Math.max(s*e.a,u*t.a)+s*(1-e.a)+u*(1-t.a))/r;return{r:h,g:c,b:d,a:r}},e.hardLight=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;t.a*=n;var r=e.a+t.a-e.a*t.a,i=t.r*t.a,a=t.g*t.a,s=t.b*t.a,o=e.r*e.a,l=e.g*e.a,u=e.b*e.a,h=(2*i<=t.a?2*i*o+i*(1-e.a)+o*(1-t.a):i*(1+e.a)+o*(1+t.a)-2*o*i-e.a*t.a)/r,c=(2*a<=t.a?2*a*l+a*(1-e.a)+l*(1-t.a):a*(1+e.a)+l*(1+t.a)-2*l*a-e.a*t.a)/r,d=(2*s<=t.a?2*s*u+s*(1-e.a)+u*(1-t.a):s*(1+e.a)+u*(1+t.a)-2*u*s-e.a*t.a)/r;return{r:h,g:c,b:d,a:r}},e.difference=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;t.a*=n;var r=e.a+t.a-e.a*t.a,i=t.r*t.a,a=t.g*t.a,s=t.b*t.a,o=e.r*e.a,l=e.g*e.a,u=e.b*e.a,h=(i+o-2*Math.min(i*e.a,o*t.a))/r,c=(a+l-2*Math.min(a*e.a,l*t.a))/r,d=(s+u-2*Math.min(s*e.a,u*t.a))/r;return{r:h,g:c,b:d,a:r}},e.exclusion=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;t.a*=n;var r=e.a+t.a-e.a*t.a,i=t.r*t.a,a=t.g*t.a,s=t.b*t.a,o=e.r*e.a,l=e.g*e.a,u=e.b*e.a,h=(i*e.a+o*t.a-2*i*o+i*(1-e.a)+o*(1-t.a))/r,c=(a*e.a+l*t.a-2*a*l+a*(1-e.a)+l*(1-t.a))/r,d=(s*e.a+u*t.a-2*s*u+s*(1-e.a)+u*(1-t.a))/r;return{r:h,g:c,b:d,a:r}}},1140:(t,e,n)=>{"use strict";var r=n(8797);Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=arguments.length>4?arguments[4]:void 0;if("function"==typeof r&&(o=r,r={}),!(t instanceof this.constructor))return i.throwError.call(this,"The source must be a Jimp image",o);if("number"!=typeof e||"number"!=typeof n)return i.throwError.call(this,"x and y must be numbers",o);var l=r,u=l.mode,h=l.opacitySource,c=l.opacityDest;u||(u=a.BLEND_SOURCE_OVER),("number"!=typeof h||h<0||h>1)&&(h=1),("number"!=typeof c||c<0||c>1)&&(c=1);var d=s[u];e=Math.round(e),n=Math.round(n);var f=this;return 1!==c&&f.opacity(c),t.scanQuiet(0,0,t.bitmap.width,t.bitmap.height,(function(t,r,i){var s=f.getPixelIndex(e+t,n+r,a.EDGE_CROP),o=d({r:this.bitmap.data[i+0]/255,g:this.bitmap.data[i+1]/255,b:this.bitmap.data[i+2]/255,a:this.bitmap.data[i+3]/255},{r:f.bitmap.data[s+0]/255,g:f.bitmap.data[s+1]/255,b:f.bitmap.data[s+2]/255,a:f.bitmap.data[s+3]/255},h);f.bitmap.data[s+0]=this.constructor.limit255(255*o.r),f.bitmap.data[s+1]=this.constructor.limit255(255*o.g),f.bitmap.data[s+2]=this.constructor.limit255(255*o.b),f.bitmap.data[s+3]=this.constructor.limit255(255*o.a)})),(0,i.isNodePattern)(o)&&o.call(this,null,this),this};var i=n(1065),a=r(n(2434)),s=r(n(7453))},2434:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EDGE_CROP=e.EDGE_WRAP=e.EDGE_EXTEND=e.BLEND_EXCLUSION=e.BLEND_DIFFERENCE=e.BLEND_HARDLIGHT=e.BLEND_LIGHTEN=e.BLEND_DARKEN=e.BLEND_OVERLAY=e.BLEND_SCREEN=e.BLEND_ADD=e.BLEND_MULTIPLY=e.BLEND_DESTINATION_OVER=e.BLEND_SOURCE_OVER=e.VERTICAL_ALIGN_BOTTOM=e.VERTICAL_ALIGN_MIDDLE=e.VERTICAL_ALIGN_TOP=e.HORIZONTAL_ALIGN_RIGHT=e.HORIZONTAL_ALIGN_CENTER=e.HORIZONTAL_ALIGN_LEFT=e.AUTO=void 0,e.AUTO=-1,e.HORIZONTAL_ALIGN_LEFT=1,e.HORIZONTAL_ALIGN_CENTER=2,e.HORIZONTAL_ALIGN_RIGHT=4,e.VERTICAL_ALIGN_TOP=8,e.VERTICAL_ALIGN_MIDDLE=16,e.VERTICAL_ALIGN_BOTTOM=32,e.BLEND_SOURCE_OVER="srcOver",e.BLEND_DESTINATION_OVER="dstOver",e.BLEND_MULTIPLY="multiply",e.BLEND_ADD="add",e.BLEND_SCREEN="screen",e.BLEND_OVERLAY="overlay",e.BLEND_DARKEN="darken",e.BLEND_LIGHTEN="lighten",e.BLEND_HARDLIGHT="hardLight",e.BLEND_DIFFERENCE="difference",e.BLEND_EXCLUSION="exclusion",e.EDGE_EXTEND=1,e.EDGE_WRAP=2,e.EDGE_CROP=3},8675:(t,e,n)=>{"use strict";var r=n(9208).Buffer,i=n(7671),a=n(8797),s=n(3852);Object.defineProperty(e,"__esModule",{value:!0}),e.addConstants=V,e.addJimpMethods=q,e.jimpEvMethod=K,e.jimpEvChange=Z,Object.defineProperty(e,"addType",{enumerable:!0,get:function(){return T.addType}}),e.default=void 0;for(var o=s(n(7946)),l=s(n(4185)),u=s(n(8813)),h=s(n(1398)),c=s(n(1358)),d=s(n(9033)),f=s(n(4477)),p=s(n(5317)),m=s(n(5590)),g=s(n(1736)),b=s(n(5174)),y=s(n(6072)),v=s(n(6204)),w=n(1065),_=s(n(8083)),k=s(n(6932)),x=s(n(3545)),S=s(n(9231)),E=s(n(5507)),I=s(n(5198)),A=s(n(1140)),M=s(n(233)),T=a(n(7609)),N=n(3240),C=a(n(2434)),R="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ$_",O=[NaN,NaN],D=2;D<65;D++){var z=(0,_.default)(_.default.BIN,R.slice(0,D))(new Array(65).join("1"));O.push(z.length)}function B(){}function F(t){return Object.prototype.toString.call(t).toLowerCase().indexOf("arraybuffer")>-1}function P(t){for(var e=r.alloc(t.byteLength),n=new Uint8Array(t),i=0;i<e.length;++i)e[i]=n[i];return e}function L(t,e){(0,I.default)(t,(function(n,i,a){if(n)return e(n);if("headers"in i&&"location"in i.headers)return t.url=i.headers.location,L(t,e);if("object"===(0,g.default)(a)&&r.isBuffer(a))return e(null,a);var s="Could not load Buffer from <"+t.url+"> (HTTP: "+i.statusCode+")";return new Error(s)}))}function $(t,e){b.default&&"function"==typeof b.default.readFile&&!t.match(/^(http|ftp)s?:\/\/./)?b.default.readFile(t,e):L({url:t},e)}function U(t){return t&&"object"===(0,g.default)(t)&&"number"==typeof t.width&&"number"==typeof t.height&&(r.isBuffer(t.data)||t.data instanceof Uint8Array||"function"==typeof Uint8ClampedArray&&t.data instanceof Uint8ClampedArray)&&(t.data.length===t.width*t.height*4||t.data.length===t.width*t.height*3)}function j(t){if(t.length%3!=0)throw new Error("Buffer length is incorrect");for(var e=r.allocUnsafe(t.length/3*4),n=0,i=0;i<t.length;i++)e[n]=t[i],(i+1)%3==0&&(e[++n]=255),n++;return e}var W,G={data:null,width:null,height:null},H=function(t){function e(){for(var t,n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];(0,u.default)(this,e),t=(0,c.default)(this,(0,d.default)(e).call(this)),(0,m.default)((0,f.default)(t),"bitmap",G),(0,m.default)((0,f.default)(t),"_background",0),(0,m.default)((0,f.default)(t),"_originalMime",e.MIME_PNG),(0,m.default)((0,f.default)(t),"_exif",null),(0,m.default)((0,f.default)(t),"_rgba",!0),(0,m.default)((0,f.default)(t),"writeAsync",(function(e){return(0,M.default)(t.write,(0,f.default)(t),e)})),(0,m.default)((0,f.default)(t),"getBase64Async",(function(e){return(0,M.default)(t.getBase64,(0,f.default)(t),e)})),(0,m.default)((0,f.default)(t),"getBuffer",N.getBuffer),(0,m.default)((0,f.default)(t),"getBufferAsync",N.getBufferAsync),(0,m.default)((0,f.default)(t),"getPixelColour",t.getPixelColor),(0,m.default)((0,f.default)(t),"setPixelColour",t.setPixelColor);var s=(0,f.default)(t),o=B;function l(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=e[0],i=r||{};i.methodName="constructor",setTimeout((function(){var t;r&&o===B?s.emitError("constructor",r):r||s.emitMulti("constructor","initialized"),(t=o).call.apply(t,[s].concat(e))}),1)}if(F(i[0])&&(i[0]=P(i[0])),"number"==typeof i[0]&&"number"==typeof i[1]||parseInt(i[0],10)&&parseInt(i[1],10)){var h=parseInt(i[0],10),p=parseInt(i[1],10);if(o=i[2],"number"==typeof i[2]&&(t._background=i[2],o=i[3]),"string"==typeof i[2]&&(t._background=e.cssColorToHex(i[2]),o=i[3]),void 0===o&&(o=B),"function"!=typeof o)return(0,c.default)(t,w.throwError.call((0,f.default)(t),"cb must be a function",l));t.bitmap={data:r.alloc(h*p*4),width:h,height:p};for(var b=0;b<t.bitmap.data.length;b+=4)t.bitmap.data.writeUInt32BE(t._background,b);l(null,(0,f.default)(t))}else if("object"===(0,g.default)(i[0])&&i[0].url){if("function"!=typeof(o=i[1]||B))return(0,c.default)(t,w.throwError.call((0,f.default)(t),"cb must be a function",l));L(i[0],(function(e,n){if(e)return w.throwError.call((0,f.default)(t),e,l);t.parseBitmap(n,i[0].url,l)}))}else if(i[0]instanceof e){var y=i[0];if(void 0===(o=i[1])&&(o=B),"function"!=typeof o)return(0,c.default)(t,w.throwError.call((0,f.default)(t),"cb must be a function",l));t.bitmap={data:r.from(y.bitmap.data),width:y.bitmap.width,height:y.bitmap.height},t._quality=y._quality,t._deflateLevel=y._deflateLevel,t._deflateStrategy=y._deflateStrategy,t._filterType=y._filterType,t._rgba=y._rgba,t._background=y._background,t._originalMime=y._originalMime,l(null,(0,f.default)(t))}else if(U(i[0])){var v=i[0];o=i[1]||B;var _=v.width*v.height*4===v.data.length,k=_?r.from(v.data):j(v.data);t.bitmap={data:k,width:v.width,height:v.height},l(null,(0,f.default)(t))}else if("string"==typeof i[0]){var x=i[0];if(void 0===(o=i[1])&&(o=B),"function"!=typeof o)return(0,c.default)(t,w.throwError.call((0,f.default)(t),"cb must be a function",l));$(x,(function(e,n){if(e)return w.throwError.call((0,f.default)(t),e,l);t.parseBitmap(n,x,l)}))}else if("object"===(0,g.default)(i[0])&&r.isBuffer(i[0])){var S=i[0];if("function"!=typeof(o=i[1]))return(0,c.default)(t,w.throwError.call((0,f.default)(t),"cb must be a function",l));t.parseBitmap(S,null,l)}else{"function"!=typeof(o=i[i.length-1])&&"function"!=typeof(o=i[i.length-2])&&(o=B);var E=e.__extraConstructors.find((function(t){return t.test.apply(t,i)}));if(!E)return(0,c.default)(t,w.throwError.call((0,f.default)(t),"No matching constructor overloading was found. Please see the docs for how to call the Jimp constructor.",l));new Promise((function(e,n){var r;return(r=E.run).call.apply(r,[(0,f.default)(t),e,n].concat(i))})).then((function(){return l(null,(0,f.default)(t))})).catch(l)}return t}return(0,p.default)(e,t),(0,h.default)(e,[{key:"parseBitmap",value:function(t,e,n){N.parseBitmap.call(this,t,null,n)}},{key:"rgba",value:function(t,e){return"boolean"!=typeof t?w.throwError.call(this,"bool must be a boolean, true for RGBA or false for RGB",e):(this._rgba=t,(0,w.isNodePattern)(e)&&e.call(this,null,this),this)}},{key:"emitMulti",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};n=Object.assign(n,{methodName:t,eventName:e}),this.emit("any",n),t&&this.emit(t,n),this.emit(e,n)}},{key:"emitError",value:function(t,e){this.emitMulti(t,"error",e)}},{key:"getHeight",value:function(){return this.bitmap.height}},{key:"getWidth",value:function(){return this.bitmap.width}},{key:"inspect",value:function(){return"<Jimp "+(this.bitmap===G?"pending...":this.bitmap.width+"x"+this.bitmap.height)+">"}},{key:"toString",value:function(){return"[object Jimp]"}},{key:"getMIME",value:function(){return this._originalMime||e.MIME_PNG}},{key:"getExtension",value:function(){var t=this.getMIME();return T.getExtension(t)}},{key:"write",value:function(t,e){var n=this;if(!b.default||!b.default.createWriteStream)throw new Error("Cant access the filesystem. You can use the getBase64 method.");if("string"!=typeof t)return w.throwError.call(this,"path must be a string",e);if(void 0===e&&(e=B),"function"!=typeof e)return w.throwError.call(this,"cb must be a function",e);var r=T.getType(t)||this.getMIME(),i=y.default.parse(t);return i.dir&&k.default.sync(i.dir),this.getBuffer(r,(function(r,i){if(r)return w.throwError.call(n,r,e);var a=b.default.createWriteStream(t);a.on("open",(function(){a.write(i),a.end()})).on("error",(function(t){return w.throwError.call(n,t,e)})),a.on("finish",(function(){e.call(n,null,n)}))})),this}},{key:"getBase64",value:function(t,n){return t===e.AUTO&&(t=this.getMIME()),"string"!=typeof t?w.throwError.call(this,"mime must be a string",n):"function"!=typeof n?w.throwError.call(this,"cb must be a function",n):(this.getBuffer(t,(function(e,r){if(e)return w.throwError.call(this,e,n);var i="data:"+t+";base64,"+r.toString("base64");n.call(this,null,i)})),this)}},{key:"hash",value:function(t,e){if("function"==typeof(t=t||64)&&(e=t,t=64),"number"!=typeof t)return w.throwError.call(this,"base must be a number",e);if(t<2||t>64)return w.throwError.call(this,"base must be a number between 2 and 64",e);var n=this.pHash();for(n=(0,_.default)(_.default.BIN,R.slice(0,t))(n);n.length<O[t];)n="0"+n;return(0,w.isNodePattern)(e)&&e.call(this,null,n),n}},{key:"pHash",value:function(){return(new E.default).getHash(this)}},{key:"distanceFromHash",value:function(t){var e=new E.default,n=e.getHash(this);return e.distance(n,t)}},{key:"getPixelIndex",value:function(t,n,r,i){var a,s;if("function"==typeof r&&void 0===i&&(i=r,r=null),r||(r=e.EDGE_EXTEND),"number"!=typeof t||"number"!=typeof n)return w.throwError.call(this,"x and y must be numbers",i);a=t=Math.round(t),s=n=Math.round(n),r===e.EDGE_EXTEND&&(t<0&&(a=0),t>=this.bitmap.width&&(a=this.bitmap.width-1),n<0&&(s=0),n>=this.bitmap.height&&(s=this.bitmap.height-1)),r===e.EDGE_WRAP&&(t<0&&(a=this.bitmap.width+t),t>=this.bitmap.width&&(a=t%this.bitmap.width),n<0&&(a=this.bitmap.height+n),n>=this.bitmap.height&&(s=n%this.bitmap.height));var o=this.bitmap.width*s+a<<2;return(a<0||a>=this.bitmap.width)&&(o=-1),(s<0||s>=this.bitmap.height)&&(o=-1),(0,w.isNodePattern)(i)&&i.call(this,null,o),o}},{key:"getPixelColor",value:function(t,e,n){if("number"!=typeof t||"number"!=typeof e)return w.throwError.call(this,"x and y must be numbers",n);t=Math.round(t),e=Math.round(e);var r=this.getPixelIndex(t,e),i=this.bitmap.data.readUInt32BE(r);return(0,w.isNodePattern)(n)&&n.call(this,null,i),i}},{key:"setPixelColor",value:function(t,e,n,r){if("number"!=typeof t||"number"!=typeof e||"number"!=typeof n)return w.throwError.call(this,"hex, x and y must be numbers",r);e=Math.round(e),n=Math.round(n);var i=this.getPixelIndex(e,n);return this.bitmap.data.writeUInt32BE(t,i),(0,w.isNodePattern)(r)&&r.call(this,null,this),this}},{key:"hasAlpha",value:function(){for(var t=0;t<this.bitmap.height;t++)for(var e=0;e<this.bitmap.width;e++){var n=this.bitmap.width*t+e<<2;if(255!==this.bitmap.data[n+3])return!0}return!1}},{key:"scanIterator",value:function(t,e,n,r){return"number"!=typeof t||"number"!=typeof e?w.throwError.call(this,"x and y must be numbers"):"number"!=typeof n||"number"!=typeof r?w.throwError.call(this,"w and h must be numbers"):(0,w.scanIterator)(this,t,e,n,r)}}]),e}(v.default);function V(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:H;Object.entries(t).forEach((function(t){var n=(0,l.default)(t,2),r=n[0],i=n[1];e[r]=i}))}function q(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:H;Object.entries(t).forEach((function(t){var n=(0,l.default)(t,2),r=n[0],i=n[1];e.prototype[r]=i}))}function K(t,e,n){var r="before-"+e,i=e.replace(/e$/,"")+"ed";H.prototype[t]=function(){for(var e,a=arguments.length,s=new Array(a),o=0;o<a;o++)s[o]=arguments[o];var l,u=s[n.length-1],h=this;"function"==typeof u?(e=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];var a=n[0],s=n[1];a?h.emitError(t,a):h.emitMulti(t,i,(0,m.default)({},t,s)),u.apply(this,n)},s[s.length-1]=e):e=!1,this.emitMulti(t,r);try{l=n.apply(this,s),e||this.emitMulti(t,i,(0,m.default)({},t,l))}catch(e){e.methodName=t,this.emitError(t,e)}return l},H.prototype[t+"Quiet"]=n}function Z(t,e){K(t,"change",e)}V(C),q({composite:A.default}),H.__extraConstructors=[],H.appendConstructorOption=function(t,e,n){H.__extraConstructors.push({name:t,test:e,run:n})},H.read=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return new Promise((function(t,n){(0,o.default)(H,e.concat([function(e,r){e?n(e):t(r)}]))}))},H.create=H.read,H.rgbaToInt=function(t,e,n,r,i){if("number"!=typeof t||"number"!=typeof e||"number"!=typeof n||"number"!=typeof r)return w.throwError.call(this,"r, g, b and a must be numbers",i);if(t<0||t>255)return w.throwError.call(this,"r must be between 0 and 255",i);if((e<0||e>255)&&w.throwError.call(this,"g must be between 0 and 255",i),n<0||n>255)return w.throwError.call(this,"b must be between 0 and 255",i);if(r<0||r>255)return w.throwError.call(this,"a must be between 0 and 255",i);t=Math.round(t),n=Math.round(n),e=Math.round(e),r=Math.round(r);var a=t*Math.pow(256,3)+e*Math.pow(256,2)+n*Math.pow(256,1)+r*Math.pow(256,0);return(0,w.isNodePattern)(i)&&i.call(this,null,a),a},H.intToRGBA=function(t,e){if("number"!=typeof t)return w.throwError.call(this,"i must be a number",e);var n={};return n.r=Math.floor(t/Math.pow(256,3)),n.g=Math.floor((t-n.r*Math.pow(256,3))/Math.pow(256,2)),n.b=Math.floor((t-n.r*Math.pow(256,3)-n.g*Math.pow(256,2))/Math.pow(256,1)),n.a=Math.floor((t-n.r*Math.pow(256,3)-n.g*Math.pow(256,2)-n.b*Math.pow(256,1))/Math.pow(256,0)),(0,w.isNodePattern)(e)&&e.call(this,null,n),n},H.cssColorToHex=function(t){return"number"==typeof(t=t||0)?Number(t):parseInt((0,S.default)(t).toHex8(),16)},H.limit255=function(t){return t=Math.max(t,0),Math.min(t,255)},H.diff=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.1;if(!(t instanceof H&&e instanceof H))return w.throwError.call(this,"img1 and img2 must be an Jimp images");var r=t.bitmap,i=e.bitmap;if(r.width===i.width&&r.height===i.height||(r.width*r.height>i.width*i.height?t=t.cloneQuiet().resize(i.width,i.height):e=e.cloneQuiet().resize(r.width,r.height)),"number"!=typeof n||n<0||n>1)return w.throwError.call(this,"threshold must be a number between 0 and 1");var a=new H(r.width,r.height,4294967295),s=(0,x.default)(r.data,i.data,a.bitmap.data,a.bitmap.width,a.bitmap.height,{threshold:n});return{percent:s/(a.bitmap.width*a.bitmap.height),image:a}},H.distance=function(t,e){var n=new E.default,r=n.getHash(t),i=n.getHash(e);return n.distance(r,i)},H.compareHashes=function(t,e){return(new E.default).distance(t,e)},H.colorDiff=function(t,e){var n=function(t){return Math.pow(t,2)},r=Math.max;return 0===t.a||t.a||(t.a=255),0===e.a||e.a||(e.a=255),(r(n(t.r-e.r),n(t.r-e.r-t.a+e.a))+r(n(t.g-e.g),n(t.g-e.g-t.a+e.a))+r(n(t.b-e.b),n(t.b-e.b-t.a+e.a)))/195075},K("clone","clone",(function(t){var e=new H(this);return(0,w.isNodePattern)(t)&&t.call(e,null,e),e})),Z("background",(function(t,e){return"number"!=typeof t?w.throwError.call(this,"hex must be a hexadecimal rgba value",e):(this._background=t,(0,w.isNodePattern)(e)&&e.call(this,null,this),this)})),Z("scan",(function(t,e,n,r,i,a){if("number"!=typeof t||"number"!=typeof e)return w.throwError.call(this,"x and y must be numbers",a);if("number"!=typeof n||"number"!=typeof r)return w.throwError.call(this,"w and h must be numbers",a);if("function"!=typeof i)return w.throwError.call(this,"f must be a function",a);var s=(0,w.scan)(this,t,e,n,r,i);return(0,w.isNodePattern)(a)&&a.call(this,null,s),s})),"BROWSER"===i.env.ENVIRONMENT&&("undefined"!=typeof window&&"object"===("undefined"==typeof window?"undefined":(0,g.default)(window))&&(W=window),"undefined"!=typeof self&&"object"===("undefined"==typeof self?"undefined":(0,g.default)(self))&&(W=self),W.Jimp=H,W.Buffer=r);var X=H;e.default=X},5507:t=>{"use strict";function e(t,e){this.size=this.size||t,this.smallerSize=this.smallerSize||e,function(t){for(var e=1;e<t;e++)r[e]=1;r[0]=1/Math.sqrt(2)}(this.size)}function n(t){var e={};return e.r=Math.floor(t/Math.pow(256,3)),e.g=Math.floor((t-e.r*Math.pow(256,3))/Math.pow(256,2)),e.b=Math.floor((t-e.r*Math.pow(256,3)-e.g*Math.pow(256,2))/Math.pow(256,1)),e.a=Math.floor((t-e.r*Math.pow(256,3)-e.g*Math.pow(256,2)-e.b*Math.pow(256,1))/Math.pow(256,0)),e}e.prototype.size=32,e.prototype.smallerSize=8,e.prototype.distance=function(t,e){for(var n=0,r=0;r<t.length;r++)t[r]!==e[r]&&n++;return n/t.length},e.prototype.getHash=function(t){(t=t.clone().resize(this.size,this.size)).grayscale();for(var e=[],i=0;i<t.bitmap.width;i++){e[i]=[];for(var a=0;a<t.bitmap.height;a++)e[i][a]=n(t.getPixelColor(i,a)).b}for(var s=function(t,e){for(var n=e,i=[],a=0;a<n;a++){i[a]=[];for(var s=0;s<n;s++){for(var o=0,l=0;l<n;l++)for(var u=0;u<n;u++)o+=Math.cos((2*l+1)/(2*n)*a*Math.PI)*Math.cos((2*u+1)/(2*n)*s*Math.PI)*t[l][u];o*=r[a]*r[s]/4,i[a][s]=o}}return i}(e,this.size),o=0,l=0;l<this.smallerSize;l++)for(var u=0;u<this.smallerSize;u++)o+=s[l][u];for(var h=o/(this.smallerSize*this.smallerSize),c="",d=0;d<this.smallerSize;d++)for(var f=0;f<this.smallerSize;f++)c+=s[d][f]>h?"1":"0";return c};var r=[];t.exports=e},5198:(t,e,n)=>{"use strict";var r=n(7671),i=n(9208).Buffer,a=n(3852),s=a(n(5590)),o=a(n(986));function l(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}r.browser||"BROWSER"===r.env.ENVIRONMENT||void 0!==r.versions.electron&&"renderer"===r.type&&"function"==typeof XMLHttpRequest?t.exports=function(t,e){var n=new XMLHttpRequest;n.open("GET",t.url,!0),n.responseType="arraybuffer",n.addEventListener("load",(function(){if(n.status<400)try{var r=i.from(this.response);e(null,n,r)}catch(n){return e(new Error("Response is not a buffer for url "+t.url+". Error: "+n.message))}else e(new Error("HTTP Status "+n.status+" for url "+t.url))})),n.addEventListener("error",(function(t){e(t)})),n.send()}:t.exports=function(t,e){var r=(0,o.default)({},t);n(4939)(function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?l(n,!0).forEach((function(e){(0,s.default)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):l(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({compression:!0},r),(function(t,n){null===t?e(null,n,n.body):e(t)}))}},3240:(t,e,n)=>{"use strict";var r=n(9208).Buffer,i=n(8797),a=n(3852);Object.defineProperty(e,"__esModule",{value:!0}),e.parseBitmap=function(t,e,n){var i=function(t,e){var n=(0,o.default)(t);return n?n.mime:e?c.getType(e):null}(t,e);if("string"!=typeof i)return n(new Error("Could not find MIME for Buffer <"+e+">"));this._originalMime=i.toLowerCase();try{var a=this.getMIME();if(!this.constructor.decoders[a])return u.throwError.call(this,"Unsupported MIME type: "+a,n);this.bitmap=this.constructor.decoders[a](t)}catch(t){return n.call(this,t,this)}try{this._exif=l.default.create(t).parse(),function(t){if(!(f(t)<2)){var e=function(t){var e=t.getWidth(),n=t.getHeight();switch(f(t)){case 1:default:return null;case 2:return function(t,n){return[e-t-1,n]};case 3:return function(t,r){return[e-t-1,n-r-1]};case 4:return function(t,e){return[t,n-e-1]};case 5:return function(t,e){return[e,t]};case 6:return function(t,e){return[e,n-t-1]};case 7:return function(t,r){return[e-r-1,n-t-1]};case 8:return function(t,n){return[e-n-1,t]}}}(t),n=f(t)>4;!function(t,e,n,i){for(var a=t.bitmap.data,o=t.bitmap.width,l=r.alloc(a.length),u=0;u<e;u++)for(var h=0;h<n;h++){var c=i(u,h),d=(0,s.default)(c,2),f=d[0],p=e*h+u<<2,m=o*d[1]+f<<2,g=a.readUInt32BE(m);l.writeUInt32BE(g,p)}t.bitmap.data=l,t.bitmap.width=e,t.bitmap.height=n}(t,n?t.bitmap.height:t.bitmap.width,n?t.bitmap.width:t.bitmap.height,e)}}(this)}catch(t){}return n.call(this,null,this),this},e.getBuffer=p,e.getBufferAsync=function(t){return(0,d.default)(p,this,t)};var s=a(n(4185)),o=a(n(9544)),l=a(n(9771)),u=n(1065),h=i(n(2434)),c=i(n(7609)),d=a(n(233));function f(t){return t._exif&&t._exif.tags&&t._exif.tags.Orientation||1}function p(t,e){if(t===h.AUTO&&(t=this.getMIME()),"string"!=typeof t)return u.throwError.call(this,"mime must be a string",e);if("function"!=typeof e)return u.throwError.call(this,"cb must be a function",e);var n,i;if(t=t.toLowerCase(),this._rgba&&this.constructor.hasAlpha[t]?this.bitmap.data=r.from(this.bitmap.data):this.bitmap.data=(n=this.constructor,i=this,new n(i.bitmap.width,i.bitmap.height,i._background).composite(i,0,0).bitmap).data,this.constructor.encoders[t]){var a=this.constructor.encoders[t](this);e.call(this,null,a)}else e.call(this,"Unsupported MIME type: "+t);return this}},7609:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getExtension=e.getType=e.addType=void 0;var n={};e.addType=function(t,e){n[t]=e},e.getType=function(t){var e,r=t.split("/").slice(-1);return(e=r[r.length-1].split(".").pop(),Object.entries(n).find((function(t){return t[1].includes(e)}))||[])[0]},e.getExtension=function(t){return(n[t.toLowerCase()]||[])[0]}},233:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;e.default=function(t,e){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return new Promise((function(n,i){r.push((function(t,e){t&&i(t),n(e)})),t.bind(e).apply(void 0,r)}))}},5683:(t,e,n)=>{"use strict";var r=n(8797),i=n(3852);Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:l.default,n={hasAlpha:{},encoders:{},decoders:{},class:{},constants:{}};function r(t){Object.entries(t).forEach((function(t){var e=(0,o.default)(t,2),r=e[0],i=e[1];n[r]=h({},n[r],{},i)}))}function i(t){var e=t();Array.isArray(e.mime)?l.addType.apply(void 0,(0,a.default)(e.mime)):Object.entries(e.mime).forEach((function(t){return l.addType.apply(void 0,(0,a.default)(t))})),delete e.mime,r(e)}function s(t){var e=t(l.jimpEvChange)||{};e.class||e.constants?r(e):r({class:e})}return t.types&&(t.types.forEach(i),e.decoders=h({},e.decoders,{},n.decoders),e.encoders=h({},e.encoders,{},n.encoders),e.hasAlpha=h({},e.hasAlpha,{},n.hasAlpha)),t.plugins&&t.plugins.forEach(s),(0,l.addJimpMethods)(n.class,e),(0,l.addConstants)(n.constants,e),l.default};var a=i(n(7907)),s=i(n(5590)),o=i(n(4185)),l=r(n(8675));function u(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function h(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?u(n,!0).forEach((function(e){(0,s.default)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):u(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}},2457:(t,e,n)=>{"use strict";var r=n(9208).Buffer,i=n(3852);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=i(n(5590)),s=i(n(8233)),o=n(1150),l="image/gif";e.default=function(){return{mime:(0,a.default)({},l,["gif"]),constants:{MIME_GIF:l},decoders:(0,a.default)({},l,(function(t){var e=new s.default.GifReader(t),n=r.alloc(e.width*e.height*4);return e.decodeAndBlitFrameRGBA(0,n),{data:n,width:e.width,height:e.height}})),encoders:(0,a.default)({},l,(function(t){var e=new o.BitmapImage(t.bitmap);o.GifUtil.quantizeDekker(e,256);var n=new o.GifFrame(e);return(new o.GifCodec).encodeGif([n],{}).then((function(t){return t.buffer}))}))}}},4141:(t,e,n)=>{"use strict";var r=n(3852);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=r(n(5590)),a=r(n(6786)),s=n(1065),o="image/jpeg";e.default=function(){return{mime:(0,i.default)({},o,["jpeg","jpg","jpe"]),constants:{MIME_JPEG:o},decoders:(0,i.default)({},o,a.default.decode),encoders:(0,i.default)({},o,(function(t){return a.default.encode(t.bitmap,t._quality).data})),class:{_quality:100,quality:function(t,e){return"number"!=typeof t?s.throwError.call(this,"n must be a number",e):t<0||t>100?s.throwError.call(this,"n must be a number 0 - 100",e):(this._quality=Math.round(t),(0,s.isNodePattern)(e)&&e.call(this,null,this),this)}}}}},1601:(t,e,n)=>{"use strict";var r=n(3852);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=r(n(1736)),a=n(1065);e.default=function(){return{blit:function(t,e,n,r,s,o,l,u){if(!(t instanceof this.constructor))return a.throwError.call(this,"The source must be a Jimp image",u);if("number"!=typeof e||"number"!=typeof n)return a.throwError.call(this,"x and y must be numbers",u);if("function"==typeof r)u=r,r=0,s=0,o=t.bitmap.width,l=t.bitmap.height;else{if((0,i.default)(r)!==(0,i.default)(s)||(0,i.default)(s)!==(0,i.default)(o)||(0,i.default)(o)!==(0,i.default)(l))return a.throwError.call(this,"srcx, srcy, srcw, srch must be numbers",u);r=r||0,s=s||0,o=o||t.bitmap.width,l=l||t.bitmap.height}e=Math.round(e),n=Math.round(n),r=Math.round(r),s=Math.round(s),o=Math.round(o),l=Math.round(l);var h=this.bitmap.width,c=this.bitmap.height,d=this;return t.scanQuiet(r,s,o,l,(function(t,i,a){var o=e+t-r,l=n+i-s;if(o>=0&&l>=0&&h-o>0&&c-l>0){var u=d.getPixelIndex(o,l),f={r:this.bitmap.data[a],g:this.bitmap.data[a+1],b:this.bitmap.data[a+2],a:this.bitmap.data[a+3]},p={r:d.bitmap.data[u],g:d.bitmap.data[u+1],b:d.bitmap.data[u+2],a:d.bitmap.data[u+3]};d.bitmap.data[u]=(f.a*(f.r-p.r)-p.r+255>>8)+p.r,d.bitmap.data[u+1]=(f.a*(f.g-p.g)-p.g+255>>8)+p.g,d.bitmap.data[u+2]=(f.a*(f.b-p.b)-p.b+255>>8)+p.b,d.bitmap.data[u+3]=this.constructor.limit255(p.a+f.a)}})),(0,a.isNodePattern)(u)&&u.call(this,null,this),this}}}},6037:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.shgTable=e.mulTable=void 0,e.mulTable=[1,57,41,21,203,34,97,73,227,91,149,62,105,45,39,137,241,107,3,173,39,71,65,238,219,101,187,87,81,151,141,133,249,117,221,209,197,187,177,169,5,153,73,139,133,127,243,233,223,107,103,99,191,23,177,171,165,159,77,149,9,139,135,131,253,245,119,231,224,109,211,103,25,195,189,23,45,175,171,83,81,79,155,151,147,9,141,137,67,131,129,251,123,30,235,115,113,221,217,53,13,51,50,49,193,189,185,91,179,175,43,169,83,163,5,79,155,19,75,147,145,143,35,69,17,67,33,65,255,251,247,243,239,59,29,229,113,111,219,27,213,105,207,51,201,199,49,193,191,47,93,183,181,179,11,87,43,85,167,165,163,161,159,157,155,77,19,75,37,73,145,143,141,35,138,137,135,67,33,131,129,255,63,250,247,61,121,239,237,117,29,229,227,225,111,55,109,216,213,211,209,207,205,203,201,199,197,195,193,48,190,47,93,185,183,181,179,178,176,175,173,171,85,21,167,165,41,163,161,5,79,157,78,154,153,19,75,149,74,147,73,144,143,71,141,140,139,137,17,135,134,133,66,131,65,129,1],e.shgTable=[0,9,10,10,14,12,14,14,16,15,16,15,16,15,15,17,18,17,12,18,16,17,17,19,19,18,19,18,18,19,19,19,20,19,20,20,20,20,20,20,15,20,19,20,20,20,21,21,21,20,20,20,21,18,21,21,21,21,20,21,17,21,21,21,22,22,21,22,22,21,22,21,19,22,22,19,20,22,22,21,21,21,22,22,22,18,22,22,21,22,22,23,22,20,23,22,22,23,23,21,19,21,21,21,23,23,23,22,23,23,21,23,22,23,18,22,23,20,22,23,23,23,21,22,20,22,21,22,24,24,24,24,24,22,21,24,23,23,24,21,24,23,24,22,24,24,22,24,24,22,23,24,24,24,20,23,22,23,24,24,24,24,24,24,24,23,21,23,22,23,24,24,24,22,24,24,24,23,22,24,24,25,23,25,25,23,24,25,25,24,22,25,25,25,24,23,24,25,25,25,25,25,25,25,25,25,25,25,25,23,25,23,24,25,25,25,25,25,25,25,25,25,24,22,25,25,23,25,25,20,24,25,24,25,25,22,24,25,24,25,24,25,25,24,25,25,25,25,22,25,25,25,24,25,24,25,18]},4783:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=n(1065),i=n(6037);e.default=function(){return{blur:function(t,e){if("number"!=typeof t)return r.throwError.call(this,"r must be a number",e);if(t<1)return r.throwError.call(this,"r must be greater than 0",e);for(var n,a,s,o,l,u,h,c,d,f,p,m,g,b,y=this.bitmap.width-1,v=this.bitmap.height-1,w=t+1,_=i.mulTable[t],k=i.shgTable[t],x=[],S=[],E=[],I=[],A=[],M=[],T=2;T-- >0;){for(m=0,g=0,u=0;u<this.bitmap.height;u++){for(n=this.bitmap.data[g]*w,a=this.bitmap.data[g+1]*w,s=this.bitmap.data[g+2]*w,o=this.bitmap.data[g+3]*w,h=1;h<=t;h++)c=g+((h>y?y:h)<<2),n+=this.bitmap.data[c++],a+=this.bitmap.data[c++],s+=this.bitmap.data[c++],o+=this.bitmap.data[c];for(l=0;l<this.bitmap.width;l++)x[m]=n,S[m]=a,E[m]=s,I[m]=o,0===u&&(A[l]=((c=l+w)<y?c:y)<<2,M[l]=(c=l-t)>0?c<<2:0),d=g+A[l],f=g+M[l],n+=this.bitmap.data[d++]-this.bitmap.data[f++],a+=this.bitmap.data[d++]-this.bitmap.data[f++],s+=this.bitmap.data[d++]-this.bitmap.data[f++],o+=this.bitmap.data[d]-this.bitmap.data[f],m++;g+=this.bitmap.width<<2}for(l=0;l<this.bitmap.width;l++){for(n=x[p=l]*w,a=S[p]*w,s=E[p]*w,o=I[p]*w,h=1;h<=t;h++)n+=x[p+=h>v?0:this.bitmap.width],a+=S[p],s+=E[p],o+=I[p];for(m=l<<2,u=0;u<this.bitmap.height;u++)b=o*_>>>k,this.bitmap.data[m+3]=b,b>255&&(this.bitmap.data[m+3]=255),b>0?(b=255/b,this.bitmap.data[m]=(n*_>>>k)*b,this.bitmap.data[m+1]=(a*_>>>k)*b,this.bitmap.data[m+2]=(s*_>>>k)*b):(this.bitmap.data[m+2]=0,this.bitmap.data[m+1]=0,this.bitmap.data[m]=0),0===l&&(A[u]=((c=u+w)<v?c:v)*this.bitmap.width,M[u]=(c=u-t)>0?c*this.bitmap.width:0),d=l+A[u],f=l+M[u],n+=x[d]-x[f],a+=S[d]-S[f],s+=E[d]-E[f],o+=I[d]-I[f],m+=this.bitmap.width<<2}}return(0,r.isNodePattern)(e)&&e.call(this,null,this),this}}}},5553:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=n(1065);e.default=function(){return{circle:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0;"function"==typeof t&&(e=t,t={});var n=t.radius||(this.bitmap.width>this.bitmap.height?this.bitmap.height:this.bitmap.width)/2,i={x:"number"==typeof t.x?t.x:this.bitmap.width/2,y:"number"==typeof t.y?t.y:this.bitmap.height/2};return this.scanQuiet(0,0,this.bitmap.width,this.bitmap.height,(function(t,e,r){var a=Math.sqrt(Math.pow(t-i.x,2)+Math.pow(e-i.y,2));n-a<=0?this.bitmap.data[r+3]=0:n-a<1&&(this.bitmap.data[r+3]=255*(n-a))})),(0,r.isNodePattern)(e)&&e.call(this,null,this),this}}}},5162:(t,e,n)=>{"use strict";var r=n(9208).Buffer,i=n(3852);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=i(n(7907)),s=i(n(9231)),o=n(1065);function l(t,e,n,r){for(var i=[0,0,0],a=(e.length-1)/2,s=0;s<e.length;s+=1)for(var o=0;o<e[s].length;o+=1){var l=t.getPixelIndex(n+s-a,r+o-a);i[0]+=t.bitmap.data[l]*e[s][o],i[1]+=t.bitmap.data[l+1]*e[s][o],i[2]+=t.bitmap.data[l+2]*e[s][o]}return i}var u=function(t){return null!=t};function h(t){return this.scanQuiet(0,0,this.bitmap.width,this.bitmap.height,(function(t,e,n){var r=parseInt(.2126*this.bitmap.data[n]+.7152*this.bitmap.data[n+1]+.0722*this.bitmap.data[n+2],10);this.bitmap.data[n]=r,this.bitmap.data[n+1]=r,this.bitmap.data[n+2]=r})),(0,o.isNodePattern)(t)&&t.call(this,null,this),this}function c(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50;return{r:(e.r-t.r)*(n/100)+t.r,g:(e.g-t.g)*(n/100)+t.g,b:(e.b-t.b)*(n/100)+t.b}}function d(t,e){var n=this;return t&&Array.isArray(t)?(t=t.map((function(t){return"xor"!==t.apply&&"mix"!==t.apply||(t.params[0]=(0,s.default)(t.params[0]).toRgb()),t})),this.scanQuiet(0,0,this.bitmap.width,this.bitmap.height,(function(r,i,l){var u={r:n.bitmap.data[l],g:n.bitmap.data[l+1],b:n.bitmap.data[l+2]},h=function(t,e){return n.constructor.limit255(u[t]+e)};t.forEach((function(t){if("mix"===t.apply)u=c(u,t.params[0],t.params[1]);else if("tint"===t.apply)u=c(u,{r:255,g:255,b:255},t.params[0]);else if("shade"===t.apply)u=c(u,{r:0,g:0,b:0},t.params[0]);else if("xor"===t.apply)u={r:u.r^t.params[0].r,g:u.g^t.params[0].g,b:u.b^t.params[0].b};else if("red"===t.apply)u.r=h("r",t.params[0]);else if("green"===t.apply)u.g=h("g",t.params[0]);else if("blue"===t.apply)u.b=h("b",t.params[0]);else{var r;if("hue"===t.apply&&(t.apply="spin"),!(u=(0,s.default)(u))[t.apply])return o.throwError.call(n,"action "+t.apply+" not supported",e);u=(r=u)[t.apply].apply(r,(0,a.default)(t.params)).toRgb()}})),n.bitmap.data[l]=u.r,n.bitmap.data[l+1]=u.g,n.bitmap.data[l+2]=u.b})),(0,o.isNodePattern)(e)&&e.call(this,null,this),this):o.throwError.call(this,"actions must be an array",e)}e.default=function(){return{brightness:function(t,e){return"number"!=typeof t?o.throwError.call(this,"val must be numbers",e):t<-1||t>1?o.throwError.call(this,"val must be a number between -1 and +1",e):(this.scanQuiet(0,0,this.bitmap.width,this.bitmap.height,(function(e,n,r){t<0?(this.bitmap.data[r]=this.bitmap.data[r]*(1+t),this.bitmap.data[r+1]=this.bitmap.data[r+1]*(1+t),this.bitmap.data[r+2]=this.bitmap.data[r+2]*(1+t)):(this.bitmap.data[r]=this.bitmap.data[r]+(255-this.bitmap.data[r])*t,this.bitmap.data[r+1]=this.bitmap.data[r+1]+(255-this.bitmap.data[r+1])*t,this.bitmap.data[r+2]=this.bitmap.data[r+2]+(255-this.bitmap.data[r+2])*t)})),(0,o.isNodePattern)(e)&&e.call(this,null,this),this)},contrast:function(t,e){if("number"!=typeof t)return o.throwError.call(this,"val must be numbers",e);if(t<-1||t>1)return o.throwError.call(this,"val must be a number between -1 and +1",e);var n=(t+1)/(1-t);function r(t){return(t=Math.floor(n*(t-127)+127))<0?0:t>255?255:t}return this.scanQuiet(0,0,this.bitmap.width,this.bitmap.height,(function(t,e,n){this.bitmap.data[n]=r(this.bitmap.data[n]),this.bitmap.data[n+1]=r(this.bitmap.data[n+1]),this.bitmap.data[n+2]=r(this.bitmap.data[n+2])})),(0,o.isNodePattern)(e)&&e.call(this,null,this),this},posterize:function(t,e){return"number"!=typeof t?o.throwError.call(this,"n must be numbers",e):(t<2&&(t=2),this.scanQuiet(0,0,this.bitmap.width,this.bitmap.height,(function(e,n,r){this.bitmap.data[r]=Math.floor(this.bitmap.data[r]/255*(t-1))/(t-1)*255,this.bitmap.data[r+1]=Math.floor(this.bitmap.data[r+1]/255*(t-1))/(t-1)*255,this.bitmap.data[r+2]=Math.floor(this.bitmap.data[r+2]/255*(t-1))/(t-1)*255})),(0,o.isNodePattern)(e)&&e.call(this,null,this),this)},greyscale:h,grayscale:h,opacity:function(t,e){return"number"!=typeof t?o.throwError.call(this,"f must be a number",e):t<0||t>1?o.throwError.call(this,"f must be a number from 0 to 1",e):(this.scanQuiet(0,0,this.bitmap.width,this.bitmap.height,(function(e,n,r){var i=this.bitmap.data[r+3]*t;this.bitmap.data[r+3]=i})),(0,o.isNodePattern)(e)&&e.call(this,null,this),this)},sepia:function(t){return this.scanQuiet(0,0,this.bitmap.width,this.bitmap.height,(function(t,e,n){var r=this.bitmap.data[n],i=this.bitmap.data[n+1],a=this.bitmap.data[n+2];a=.272*(r=.393*r+.769*i+.189*a)+.534*(i=.349*r+.686*i+.168*a)+.131*a,this.bitmap.data[n]=r<255?r:255,this.bitmap.data[n+1]=i<255?i:255,this.bitmap.data[n+2]=a<255?a:255})),(0,o.isNodePattern)(t)&&t.call(this,null,this),this},fade:function(t,e){return"number"!=typeof t?o.throwError.call(this,"f must be a number",e):t<0||t>1?o.throwError.call(this,"f must be a number from 0 to 1",e):(this.opacity(1-t),(0,o.isNodePattern)(e)&&e.call(this,null,this),this)},convolution:function(t,e,n){"function"==typeof e&&void 0===n&&(n=e,e=null),e||(e=this.constructor.EDGE_EXTEND);var i,a,s,l,u,h,c,d,f,p,m=r.from(this.bitmap.data),g=t.length,b=t[0].length,y=Math.floor(g/2),v=Math.floor(b/2),w=-y,_=-v;return this.scanQuiet(0,0,this.bitmap.width,this.bitmap.height,(function(n,r,o){l=0,s=0,a=0;for(var g=w;g<=y;g++)for(var b=_;b<=v;b++)d=n+b,f=r+g,i=t[g+y][b+v],-1===(p=this.getPixelIndex(d,f,e))?(c=0,h=0,u=0):(u=this.bitmap.data[p+0],h=this.bitmap.data[p+1],c=this.bitmap.data[p+2]),a+=i*u,s+=i*h,l+=i*c;a<0&&(a=0),s<0&&(s=0),l<0&&(l=0),a>255&&(a=255),s>255&&(s=255),l>255&&(l=255),m[o+0]=a,m[o+1]=s,m[o+2]=l})),this.bitmap.data=m,(0,o.isNodePattern)(n)&&n.call(this,null,this),this},opaque:function(t){return this.scanQuiet(0,0,this.bitmap.width,this.bitmap.height,(function(t,e,n){this.bitmap.data[n+3]=255})),(0,o.isNodePattern)(t)&&t.call(this,null,this),this},pixelate:function(t,e,n,r,i,a){if("function"==typeof e)a=e,i=null,r=null,n=null,e=null;else{if("number"!=typeof t)return o.throwError.call(this,"size must be a number",a);if(u(e)&&"number"!=typeof e)return o.throwError.call(this,"x must be a number",a);if(u(n)&&"number"!=typeof n)return o.throwError.call(this,"y must be a number",a);if(u(r)&&"number"!=typeof r)return o.throwError.call(this,"w must be a number",a);if(u(i)&&"number"!=typeof i)return o.throwError.call(this,"h must be a number",a)}var s=[[1/16,2/16,1/16],[2/16,.25,2/16],[1/16,2/16,1/16]];e=e||0,n=n||0,r=u(r)?r:this.bitmap.width-e,i=u(i)?i:this.bitmap.height-n;var h=this.cloneQuiet();return this.scanQuiet(e,n,r,i,(function(e,n,r){e=t*Math.floor(e/t),n=t*Math.floor(n/t);var i=l(h,s,e,n);this.bitmap.data[r]=i[0],this.bitmap.data[r+1]=i[1],this.bitmap.data[r+2]=i[2]})),(0,o.isNodePattern)(a)&&a.call(this,null,this),this},convolute:function(t,e,n,r,i,a){if(!Array.isArray(t))return o.throwError.call(this,"the kernel must be an array",a);if("function"==typeof e)a=e,e=null,n=null,r=null,i=null;else{if(u(e)&&"number"!=typeof e)return o.throwError.call(this,"x must be a number",a);if(u(n)&&"number"!=typeof n)return o.throwError.call(this,"y must be a number",a);if(u(r)&&"number"!=typeof r)return o.throwError.call(this,"w must be a number",a);if(u(i)&&"number"!=typeof i)return o.throwError.call(this,"h must be a number",a)}var s=(t.length-1)/2;e=u(e)?e:s,n=u(n)?n:s,r=u(r)?r:this.bitmap.width-e,i=u(i)?i:this.bitmap.height-n;var h=this.cloneQuiet();return this.scanQuiet(e,n,r,i,(function(e,n,r){var i=l(h,t,e,n);this.bitmap.data[r]=this.constructor.limit255(i[0]),this.bitmap.data[r+1]=this.constructor.limit255(i[1]),this.bitmap.data[r+2]=this.constructor.limit255(i[2])})),(0,o.isNodePattern)(a)&&a.call(this,null,this),this},color:d,colour:d}}},4106:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=n(1065);e.default=function(){return{contain:function(t,e,n,i,a){if("number"!=typeof t||"number"!=typeof e)return r.throwError.call(this,"w and h must be numbers",a);"string"==typeof n&&("function"==typeof i&&void 0===a&&(a=i),i=n,n=null),"function"==typeof n&&(void 0===a&&(a=n),i=null,n=null),"function"==typeof i&&void 0===a&&(a=i,i=null);var s=7&(n=n||this.constructor.HORIZONTAL_ALIGN_CENTER|this.constructor.VERTICAL_ALIGN_MIDDLE),o=n>>3;if((0===s||s&s-1)&&(0===o||o&o-1))return r.throwError.call(this,"only use one flag per alignment direction",a);var l=s>>1,u=o>>1,h=t/e>this.bitmap.width/this.bitmap.height?e/this.bitmap.height:t/this.bitmap.width,c=this.cloneQuiet().scale(h,i);return this.resize(t,e,i),this.scanQuiet(0,0,this.bitmap.width,this.bitmap.height,(function(t,e,n){this.bitmap.data.writeUInt32BE(this._background,n)})),this.blit(c,(this.bitmap.width-c.bitmap.width)/2*l,(this.bitmap.height-c.bitmap.height)/2*u),(0,r.isNodePattern)(a)&&a.call(this,null,this),this}}}},2731:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=n(1065);e.default=function(){return{cover:function(t,e,n,i,a){if("number"!=typeof t||"number"!=typeof e)return r.throwError.call(this,"w and h must be numbers",a);n&&"function"==typeof n&&void 0===a?(a=n,n=null,i=null):"function"==typeof i&&void 0===a&&(a=i,i=null);var s=7&(n=n||this.constructor.HORIZONTAL_ALIGN_CENTER|this.constructor.VERTICAL_ALIGN_MIDDLE),o=n>>3;if((0===s||s&s-1)&&(0===o||o&o-1))return r.throwError.call(this,"only use one flag per alignment direction",a);var l=s>>1,u=o>>1,h=t/e>this.bitmap.width/this.bitmap.height?t/this.bitmap.width:e/this.bitmap.height;return this.scale(h,i),this.crop((this.bitmap.width-t)/2*l,(this.bitmap.height-e)/2*u,t,e),(0,r.isNodePattern)(a)&&a.call(this,null,this),this}}}},1215:(t,e,n)=>{"use strict";var r=n(9208).Buffer,i=n(3852);Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){return t("crop",(function(t,e,n,i,a){if("number"!=typeof t||"number"!=typeof e)return s.throwError.call(this,"x and y must be numbers",a);if("number"!=typeof n||"number"!=typeof i)return s.throwError.call(this,"w and h must be numbers",a);if(t=Math.round(t),e=Math.round(e),n=Math.round(n),i=Math.round(i),0===t&&n===this.bitmap.width){var o=n*e+t<<2,l=o+i*n<<2;this.bitmap.data=this.bitmap.data.slice(o,l)}else{var u=r.allocUnsafe(n*i*4),h=0;this.scanQuiet(t,e,n,i,(function(t,e,n){var r=this.bitmap.data.readUInt32BE(n,!0);u.writeUInt32BE(r,h,!0),h+=4})),this.bitmap.data=u}return this.bitmap.width=n,this.bitmap.height=i,(0,s.isNodePattern)(a)&&a.call(this,null,this),this})),{class:{autocrop:function(){for(var t,e=this.bitmap.width,n=this.bitmap.height,r=1,i=0,o=2e-4,l=!0,u=!1,h={north:!1,south:!1,east:!1,west:!1},c=arguments.length,d=new Array(c),f=0;f<c;f++)d[f]=arguments[f];for(var p=0,m=d.length;p<m;p++)if("number"==typeof d[p]&&(o=d[p]),"boolean"==typeof d[p]&&(l=d[p]),"function"==typeof d[p]&&(t=d[p]),"object"===(0,a.default)(d[p])){var g=d[p];void 0!==g.tolerance&&(o=g.tolerance),void 0!==g.cropOnlyFrames&&(l=g.cropOnlyFrames),void 0!==g.cropSymmetric&&(u=g.cropSymmetric),void 0!==g.leaveBorder&&(i=g.leaveBorder),void 0!==g.ignoreSides&&(h=g.ignoreSides)}var b=this.getPixelColor(0,0),y=this.constructor.intToRGBA(b),v=0,w=0,_=0,k=0;if(b=this.getPixelColor(0,0),!h.north)t:for(var x=0;x<n-r;x++){for(var S=0;S<e;S++){var E=this.getPixelColor(S,x),I=this.constructor.intToRGBA(E);if(this.constructor.colorDiff(y,I)>o)break t}v++}if(b=this.getPixelColor(e,0),!h.east)t:for(var A=0;A<e-r;A++){for(var M=0+v;M<n;M++){var T=this.getPixelColor(A,M),N=this.constructor.intToRGBA(T);if(this.constructor.colorDiff(y,N)>o)break t}w++}if(b=this.getPixelColor(0,n),!h.south)t:for(var C=n-1;C>=v+r;C--){for(var R=e-w-1;R>=0;R--){var O=this.getPixelColor(R,C),D=this.constructor.intToRGBA(O);if(this.constructor.colorDiff(y,D)>o)break t}_++}if(b=this.getPixelColor(e,n),!h.west)t:for(var z=e-1;z>=0+w+r;z--){for(var B=n-1;B>=0+v;B--){var F=this.getPixelColor(z,B),P=this.constructor.intToRGBA(F);if(this.constructor.colorDiff(y,P)>o)break t}k++}if(k-=i,w-=i,v-=i,_-=i,u){var L=Math.min(w,k),$=Math.min(v,_);k=L,w=L,v=$,_=$}var U=e-((k=k>=0?k:0)+(w=w>=0?w:0)),j=n-((_=_>=0?_:0)+(v=v>=0?v:0));return(l?0!==w&&0!==v&&0!==k&&0!==_:0!==w||0!==v||0!==k||0!==_)&&this.crop(w,v,U,j),(0,s.isNodePattern)(t)&&t.call(this,null,this),this}}}};var a=i(n(1736)),s=n(1065)},8987:(t,e,n)=>{"use strict";var r=n(3852);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=r(n(1736)),a=n(1065);e.default=function(){return{displace:function(t,e,n){if("object"!==(0,i.default)(t)||t.constructor!==this.constructor)return a.throwError.call(this,"The source must be a Jimp image",n);if("number"!=typeof e)return a.throwError.call(this,"factor must be a number",n);var r=this.cloneQuiet();return this.scanQuiet(0,0,this.bitmap.width,this.bitmap.height,(function(n,i,a){var s=t.bitmap.data[a]/256*e;s=Math.round(s);var o=this.getPixelIndex(n+s,i);this.bitmap.data[o]=r.bitmap.data[a],this.bitmap.data[o+1]=r.bitmap.data[a+1],this.bitmap.data[o+2]=r.bitmap.data[a+2]})),(0,a.isNodePattern)(n)&&n.call(this,null,this),this}}}},4672:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=n(1065);function i(t){var e=[1,9,3,11,13,5,15,7,4,12,2,10,16,8,14,6];return this.scanQuiet(0,0,this.bitmap.width,this.bitmap.height,(function(t,n,r){var i=e[((3&n)<<2)+t%4];this.bitmap.data[r]=Math.min(this.bitmap.data[r]+i,255),this.bitmap.data[r+1]=Math.min(this.bitmap.data[r+1]+i,255),this.bitmap.data[r+2]=Math.min(this.bitmap.data[r+2]+i,255)})),(0,r.isNodePattern)(t)&&t.call(this,null,this),this}e.default=function(){return{dither565:i,dither16:i}}},346:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=n(1065);e.default=function(){return{fisheye:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{r:2.5},n=arguments.length>1?arguments[1]:void 0;"function"==typeof e&&(n=e,e={r:2.5});var i=this.cloneQuiet(),a=i.bitmap,s=a.width,o=a.height;return i.scanQuiet(0,0,s,o,(function(n,r){var a=n/s,l=r/o,u=Math.sqrt(Math.pow(a-.5,2)+Math.pow(l-.5,2)),h=2*Math.pow(u,e.r),c=(a-.5)/u,d=(l-.5)/u,f=Math.round((h*c+.5)*s),p=Math.round((h*d+.5)*o),m=i.getPixelColor(f,p);t.setPixelColor(m,n,r)})),this.setPixelColor(i.getPixelColor(s/2,o/2),s/2,o/2),(0,r.isNodePattern)(n)&&n.call(this,null,this),this}}}},6339:(t,e,n)=>{"use strict";var r=n(9208).Buffer;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=n(1065);function a(t,e,n){if("boolean"!=typeof t||"boolean"!=typeof e)return i.throwError.call(this,"horizontal and vertical must be Booleans",n);var a=r.alloc(this.bitmap.data.length);return this.scanQuiet(0,0,this.bitmap.width,this.bitmap.height,(function(n,r,i){var s=t?this.bitmap.width-1-n:n,o=e?this.bitmap.height-1-r:r,l=this.bitmap.width*o+s<<2,u=this.bitmap.data.readUInt32BE(i);a.writeUInt32BE(u,l)})),this.bitmap.data=r.from(a),(0,i.isNodePattern)(n)&&n.call(this,null,this),this}e.default=function(){return{flip:a,mirror:a}}},4622:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=n(1065);e.default=function(){return{gaussian:function(t,e){if("number"!=typeof t)return r.throwError.call(this,"r must be a number",e);if(t<1)return r.throwError.call(this,"r must be greater than 0",e);for(var n=Math.ceil(2.57*t),i=2*n+1,a=t*t*2,s=a*Math.PI,o=[],l=0;l<i;l++){o[l]=[];for(var u=0;u<i;u++){var h=Math.pow(u-n,2)+Math.pow(l-n,2);o[l][u]=Math.exp(-h/a)/s}}for(var c=0;c<this.bitmap.height;c++)for(var d=0;d<this.bitmap.width;d++)for(var f=0,p=0,m=0,g=0,b=0,y=0;y<i;y++){for(var v=0;v<i;v++){var w=Math.min(this.bitmap.width-1,Math.max(0,v+d-n)),_=Math.min(this.bitmap.height-1,Math.max(0,y+c-n)),k=o[y][v],x=_*this.bitmap.width+w<<2;f+=this.bitmap.data[x]*k,p+=this.bitmap.data[x+1]*k,m+=this.bitmap.data[x+2]*k,g+=this.bitmap.data[x+3]*k,b+=k}var S=c*this.bitmap.width+d<<2;this.bitmap.data[S]=Math.round(f/b),this.bitmap.data[S+1]=Math.round(p/b),this.bitmap.data[S+2]=Math.round(m/b),this.bitmap.data[S+3]=Math.round(g/b)}return(0,r.isNodePattern)(e)&&e.call(this,null,this),this}}}},2981:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=n(1065);e.default=function(){return{invert:function(t){return this.scanQuiet(0,0,this.bitmap.width,this.bitmap.height,(function(t,e,n){this.bitmap.data[n]=255-this.bitmap.data[n],this.bitmap.data[n+1]=255-this.bitmap.data[n+1],this.bitmap.data[n+2]=255-this.bitmap.data[n+2]})),(0,r.isNodePattern)(t)&&t.call(this,null,this),this}}}},9495:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=n(1065);e.default=function(){return{mask:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3?arguments[3]:void 0;if(!(t instanceof this.constructor))return r.throwError.call(this,"The source must be a Jimp image",i);if("number"!=typeof e||"number"!=typeof n)return r.throwError.call(this,"x and y must be numbers",i);e=Math.round(e),n=Math.round(n);var a=this.bitmap.width,s=this.bitmap.height,o=this;return t.scanQuiet(0,0,t.bitmap.width,t.bitmap.height,(function(t,r,i){var l=e+t,u=n+r;if(l>=0&&u>=0&&l<a&&u<s){var h=o.getPixelIndex(l,u),c=this.bitmap.data,d=(c[i+0]+c[i+1]+c[i+2])/3;o.bitmap.data[h+3]*=d/255}})),(0,r.isNodePattern)(i)&&i.call(this,null,this),this}}}},8687:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=n(1065);function i(){var t={r:new Array(256).fill(0),g:new Array(256).fill(0),b:new Array(256).fill(0)};return this.scanQuiet(0,0,this.bitmap.width,this.bitmap.height,(function(e,n,r){t.r[this.bitmap.data[r+0]]++,t.g[this.bitmap.data[r+1]]++,t.b[this.bitmap.data[r+2]]++})),t}var a=function(t,e,n){return 255*(t-e)/(n-e)},s=function(t){return[t.findIndex((function(t){return t>0})),255-t.slice().reverse().findIndex((function(t){return t>0}))]};e.default=function(){return{normalize:function(t){var e=i.call(this),n={r:s(e.r),g:s(e.g),b:s(e.b)};return this.scanQuiet(0,0,this.bitmap.width,this.bitmap.height,(function(t,e,r){var i=this.bitmap.data[r+0],s=this.bitmap.data[r+1],o=this.bitmap.data[r+2];this.bitmap.data[r+0]=a(i,n.r[0],n.r[1]),this.bitmap.data[r+1]=a(s,n.g[0],n.g[1]),this.bitmap.data[r+2]=a(o,n.b[0],n.b[1])})),(0,r.isNodePattern)(t)&&t.call(this,null,this),this}}}},8152:(t,e,n)=>{"use strict";var r=n(7671),i=n(3852);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=i(n(1736)),s=i(n(7907)),o=i(n(6072)),l=i(n(3327)),u=n(1065),h=n(6366);function c(t,e,n,r,i){if(i.width>0&&i.height>0){var a=e.pages[i.page];t.blit(a,n+i.xoffset,r+i.yoffset,i.x,i.y,i.width,i.height)}return t}function d(t,e,n,r,i){for(var a=0;a<r.length;a++){var s;s=t.chars[r[a]]?r[a]:/\s/.test(r[a])?"":"?";var o=t.chars[s]||{},l=t.kernings[s];c(this,t,e,n,o||{}),e+=(l&&l[r[a+1]]?l[r[a+1]]:0)+(o.xadvance||i)}}var f=r.env.DIRNAME||"".concat("/","/../");e.default=function(){return{constants:{measureText:h.measureText,measureTextHeight:h.measureTextHeight,FONT_SANS_8_BLACK:o.default.join(f,"fonts/open-sans/open-sans-8-black/open-sans-8-black.fnt"),FONT_SANS_10_BLACK:o.default.join(f,"fonts/open-sans/open-sans-10-black/open-sans-10-black.fnt"),FONT_SANS_12_BLACK:o.default.join(f,"fonts/open-sans/open-sans-12-black/open-sans-12-black.fnt"),FONT_SANS_14_BLACK:o.default.join(f,"fonts/open-sans/open-sans-14-black/open-sans-14-black.fnt"),FONT_SANS_16_BLACK:o.default.join(f,"fonts/open-sans/open-sans-16-black/open-sans-16-black.fnt"),FONT_SANS_32_BLACK:o.default.join(f,"fonts/open-sans/open-sans-32-black/open-sans-32-black.fnt"),FONT_SANS_64_BLACK:o.default.join(f,"fonts/open-sans/open-sans-64-black/open-sans-64-black.fnt"),FONT_SANS_128_BLACK:o.default.join(f,"fonts/open-sans/open-sans-128-black/open-sans-128-black.fnt"),FONT_SANS_8_WHITE:o.default.join(f,"fonts/open-sans/open-sans-8-white/open-sans-8-white.fnt"),FONT_SANS_16_WHITE:o.default.join(f,"fonts/open-sans/open-sans-16-white/open-sans-16-white.fnt"),FONT_SANS_32_WHITE:o.default.join(f,"fonts/open-sans/open-sans-32-white/open-sans-32-white.fnt"),FONT_SANS_64_WHITE:o.default.join(f,"fonts/open-sans/open-sans-64-white/open-sans-64-white.fnt"),FONT_SANS_128_WHITE:o.default.join(f,"fonts/open-sans/open-sans-128-white/open-sans-128-white.fnt"),loadFont:function(t,e){var n=this;return"string"!=typeof t?u.throwError.call(this,"file must be a string",e):new Promise((function(r,i){e=e||function(t,e){t?i(t):r(e)},(0,l.default)(t,(function(r,i){var a={},s={};if(r)return u.throwError.call(n,r,e);for(var l=0;l<i.chars.length;l++)a[String.fromCharCode(i.chars[l].id)]=i.chars[l];for(var h=0;h<i.kernings.length;h++){var c=String.fromCharCode(i.kernings[h].first);s[c]=s[c]||{},s[c][String.fromCharCode(i.kernings[h].second)]=i.kernings[h].amount}(function(t,e,n){var r=n.map((function(n){return t.read(e+"/"+n)}));return Promise.all(r)})(n,o.default.dirname(t),i.pages).then((function(t){e(null,{chars:a,kernings:s,pages:t,common:i.common,info:i.info})}))}))}))}},class:{print:function(t,e,n,r,i,o,l){var c,f,p=this;if("function"==typeof i&&void 0===l&&(l=i,i=1/0),void 0===i&&(i=1/0),"function"==typeof o&&void 0===l&&(l=o,o=1/0),void 0===o&&(o=1/0),"object"!==(0,a.default)(t))return u.throwError.call(this,"font must be a Jimp loadFont",l);if("number"!=typeof e||"number"!=typeof n||"number"!=typeof i)return u.throwError.call(this,"x, y and maxWidth must be numbers",l);if("number"!=typeof i)return u.throwError.call(this,"maxWidth must be a number",l);if("number"!=typeof o)return u.throwError.call(this,"maxHeight must be a number",l);"object"===(0,a.default)(r)&&null!==r.text&&void 0!==r.text?(c=r.alignmentX||this.constructor.HORIZONTAL_ALIGN_LEFT,f=r.alignmentY||this.constructor.VERTICAL_ALIGN_TOP,r=r.text):(c=this.constructor.HORIZONTAL_ALIGN_LEFT,f=this.constructor.VERTICAL_ALIGN_TOP,r=r.toString()),o!==1/0&&f===this.constructor.VERTICAL_ALIGN_BOTTOM?n+=o-(0,h.measureTextHeight)(t,r,i):o!==1/0&&f===this.constructor.VERTICAL_ALIGN_MIDDLE&&(n+=o/2-(0,h.measureTextHeight)(t,r,i)/2);var m=Object.entries(t.chars)[0][1].xadvance,g=function(t,e,n){var r=e.split(" "),i=[],a=[],o=0;return r.forEach((function(e){var r=[].concat((0,s.default)(a),[e]).join(" "),l=(0,h.measureText)(t,r);l<=n?(l>o&&(o=l),a.push(e)):(i.push(a),a=[e])})),i.push(a),{lines:i,longestLine:o}}(t,r,i),b=g.lines,y=g.longestLine;return b.forEach((function(r){var a=r.join(" "),s=function(t,e,n,r,i){return i===t.HORIZONTAL_ALIGN_LEFT?0:i===t.HORIZONTAL_ALIGN_CENTER?(r-(0,h.measureText)(e,n))/2:r-(0,h.measureText)(e,n)}(p.constructor,t,a,i,c);d.call(p,t,e+s,n,a,m),n+=t.common.lineHeight})),(0,u.isNodePattern)(l)&&l.call(this,null,this,{x:e+y,y:n}),this}}}}},6366:(t,e)=>{"use strict";function n(t,e){for(var n=0,r=0;r<e.length;r++)if(t.chars[e[r]]){var i=t.kernings[e[r]]&&t.kernings[e[r]][e[r+1]]?t.kernings[e[r]][e[r+1]]:0;n+=(t.chars[e[r]].xadvance||0)+i}return n}Object.defineProperty(e,"__esModule",{value:!0}),e.measureText=n,e.measureTextHeight=function(t,e,r){for(var i=e.split(" "),a="",s=t.common.lineHeight,o=0;o<i.length;o++){var l=a+i[o]+" ";n(t,l)>r&&o>0?(s+=t.common.lineHeight,a=i[o]+" "):a=l}return s}},1083:(t,e,n)=>{"use strict";var r=n(9208).Buffer,i=n(3852);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=n(1065),s=i(n(8502)),o=i(n(7691));e.default=function(){return{constants:{RESIZE_NEAREST_NEIGHBOR:"nearestNeighbor",RESIZE_BILINEAR:"bilinearInterpolation",RESIZE_BICUBIC:"bicubicInterpolation",RESIZE_HERMITE:"hermiteInterpolation",RESIZE_BEZIER:"bezierInterpolation"},class:{resize:function(t,e,n,i){if("number"!=typeof t||"number"!=typeof e)return a.throwError.call(this,"w and h must be numbers",i);if("function"==typeof n&&void 0===i&&(i=n,n=null),t===this.constructor.AUTO&&e===this.constructor.AUTO)return a.throwError.call(this,"w and h cannot both be set to auto",i);if(t===this.constructor.AUTO&&(t=this.bitmap.width*(e/this.bitmap.height)),e===this.constructor.AUTO&&(e=this.bitmap.height*(t/this.bitmap.width)),t<0||e<0)return a.throwError.call(this,"w and h must be positive numbers",i);if(t=Math.round(t),e=Math.round(e),"function"==typeof o.default[n]){var l={data:r.alloc(t*e*4),width:t,height:e};o.default[n](this.bitmap,l),this.bitmap=l}else{var u=this;new s.default(this.bitmap.width,this.bitmap.height,t,e,!0,!0,(function(n){u.bitmap.data=r.from(n),u.bitmap.width=t,u.bitmap.height=e})).resize(this.bitmap.data)}return(0,a.isNodePattern)(i)&&i.call(this,null,this),this}}}}},8502:t=>{"use strict";function e(t,e,n,r,i,a,s){this.widthOriginal=Math.abs(Math.floor(t)||0),this.heightOriginal=Math.abs(Math.floor(e)||0),this.targetWidth=Math.abs(Math.floor(n)||0),this.targetHeight=Math.abs(Math.floor(r)||0),this.colorChannels=i?4:3,this.interpolationPass=Boolean(a),this.resizeCallback="function"==typeof s?s:function(){},this.targetWidthMultipliedByChannels=this.targetWidth*this.colorChannels,this.originalWidthMultipliedByChannels=this.widthOriginal*this.colorChannels,this.originalHeightMultipliedByChannels=this.heightOriginal*this.colorChannels,this.widthPassResultSize=this.targetWidthMultipliedByChannels*this.heightOriginal,this.finalResultSize=this.targetWidthMultipliedByChannels*this.targetHeight,this.initialize()}e.prototype.initialize=function(){if(!(this.widthOriginal>0&&this.heightOriginal>0&&this.targetWidth>0&&this.targetHeight>0))throw new Error("Invalid settings specified for the resizer.");this.configurePasses()},e.prototype.configurePasses=function(){this.widthOriginal===this.targetWidth?this.resizeWidth=this.bypassResizer:(this.ratioWeightWidthPass=this.widthOriginal/this.targetWidth,this.ratioWeightWidthPass<1&&this.interpolationPass?(this.initializeFirstPassBuffers(!0),this.resizeWidth=4===this.colorChannels?this.resizeWidthInterpolatedRGBA:this.resizeWidthInterpolatedRGB):(this.initializeFirstPassBuffers(!1),this.resizeWidth=4===this.colorChannels?this.resizeWidthRGBA:this.resizeWidthRGB)),this.heightOriginal===this.targetHeight?this.resizeHeight=this.bypassResizer:(this.ratioWeightHeightPass=this.heightOriginal/this.targetHeight,this.ratioWeightHeightPass<1&&this.interpolationPass?(this.initializeSecondPassBuffers(!0),this.resizeHeight=this.resizeHeightInterpolated):(this.initializeSecondPassBuffers(!1),this.resizeHeight=4===this.colorChannels?this.resizeHeightRGBA:this.resizeHeightRGB))},e.prototype._resizeWidthInterpolatedRGBChannels=function(t,e){var n,r,i=e?4:3,a=this.ratioWeightWidthPass,s=this.widthBuffer,o=0,l=0,u=0,h=0,c=0;for(n=0;o<1/3;n+=i,o+=a)for(l=n,u=0;l<this.widthPassResultSize;u+=this.originalWidthMultipliedByChannels,l+=this.targetWidthMultipliedByChannels)s[l]=t[u],s[l+1]=t[u+1],s[l+2]=t[u+2],e&&(s[l+3]=t[u+3]);for(o-=1/3,r=this.widthOriginal-1;o<r;n+=i,o+=a)for(h=1-(c=o%1),l=n,u=Math.floor(o)*i;l<this.widthPassResultSize;u+=this.originalWidthMultipliedByChannels,l+=this.targetWidthMultipliedByChannels)s[l+0]=t[u+0]*h+t[u+i+0]*c,s[l+1]=t[u+1]*h+t[u+i+1]*c,s[l+2]=t[u+2]*h+t[u+i+2]*c,e&&(s[l+3]=t[u+3]*h+t[u+i+3]*c);for(r=this.originalWidthMultipliedByChannels-i;n<this.targetWidthMultipliedByChannels;n+=i)for(l=n,u=r;l<this.widthPassResultSize;u+=this.originalWidthMultipliedByChannels,l+=this.targetWidthMultipliedByChannels)s[l]=t[u],s[l+1]=t[u+1],s[l+2]=t[u+2],e&&(s[l+3]=t[u+3]);return s},e.prototype._resizeWidthRGBChannels=function(t,e){var n=e?4:3,r=this.ratioWeightWidthPass,i=1/r,a=this.originalWidthMultipliedByChannels-n+1,s=this.targetWidthMultipliedByChannels-n+1,o=this.outputWidthWorkBench,l=this.widthBuffer,u=this.outputWidthWorkBenchOpaquePixelsCount,h=0,c=0,d=0,f=0,p=0,m=0,g=0,b=1,y=0,v=0,w=0,_=0;do{for(p=0;p<this.originalHeightMultipliedByChannels;)o[p++]=0,o[p++]=0,o[p++]=0,e&&(o[p++]=0,u[p/n-1]=0);h=r;do{for(c=1+d-f,b=Math.min(h,c),p=0,m=d;p<this.originalHeightMultipliedByChannels;m+=a)y=t[m],v=t[++m],w=t[++m],_=e?t[++m]:255,o[p++]+=(_?y:0)*b,o[p++]+=(_?v:0)*b,o[p++]+=(_?w:0)*b,e&&(o[p++]+=_*b,u[p/n-1]+=_?b:0);if(!(h>=c)){f+=h;break}f=d+=n,h-=c}while(h>0&&d<this.originalWidthMultipliedByChannels);for(p=0,m=g;p<this.originalHeightMultipliedByChannels;m+=s)h=e?u[p/n]:1,b=e?h?1/h:0:i,l[m]=o[p++]*b,l[++m]=o[p++]*b,l[++m]=o[p++]*b,e&&(l[++m]=o[p++]*i);g+=n}while(g<this.targetWidthMultipliedByChannels);return l},e.prototype._resizeHeightRGBChannels=function(t,e){var n=this.ratioWeightHeightPass,r=1/n,i=this.outputHeightWorkBench,a=this.heightBuffer,s=this.outputHeightWorkBenchOpaquePixelsCount,o=0,l=0,u=0,h=0,c=0,d=0,f=0,p=1,m=0,g=0,b=0,y=0;do{for(c=0;c<this.targetWidthMultipliedByChannels;)i[c++]=0,i[c++]=0,i[c++]=0,e&&(i[c++]=0,s[c/4-1]=0);o=n;do{for(l=1+u-h,p=Math.min(o,l),f=u,c=0;c<this.targetWidthMultipliedByChannels;)m=t[f++],g=t[f++],b=t[f++],y=e?t[f++]:255,i[c++]+=(y?m:0)*p,i[c++]+=(y?g:0)*p,i[c++]+=(y?b:0)*p,e&&(i[c++]+=y*p,s[c/4-1]+=y?p:0);if(!(o>=l)){h+=o;break}h=u=f,o-=l}while(o>0&&u<this.widthPassResultSize);for(c=0;c<this.targetWidthMultipliedByChannels;)o=e?s[c/4]:1,p=e?o?1/o:0:r,a[d++]=Math.round(i[c++]*p),a[d++]=Math.round(i[c++]*p),a[d++]=Math.round(i[c++]*p),e&&(a[d++]=Math.round(i[c++]*r))}while(d<this.finalResultSize);return a},e.prototype.resizeWidthInterpolatedRGB=function(t){return this._resizeWidthInterpolatedRGBChannels(t,!1)},e.prototype.resizeWidthInterpolatedRGBA=function(t){return this._resizeWidthInterpolatedRGBChannels(t,!0)},e.prototype.resizeWidthRGB=function(t){return this._resizeWidthRGBChannels(t,!1)},e.prototype.resizeWidthRGBA=function(t){return this._resizeWidthRGBChannels(t,!0)},e.prototype.resizeHeightInterpolated=function(t){for(var e,n=this.ratioWeightHeightPass,r=this.heightBuffer,i=0,a=0,s=0,o=0,l=0,u=0,h=0;i<1/3;i+=n)for(s=0;s<this.targetWidthMultipliedByChannels;)r[a++]=Math.round(t[s++]);for(i-=1/3,e=this.heightOriginal-1;i<e;i+=n)for(u=1-(h=i%1),l=(o=Math.floor(i)*this.targetWidthMultipliedByChannels)+this.targetWidthMultipliedByChannels,s=0;s<this.targetWidthMultipliedByChannels;++s)r[a++]=Math.round(t[o++]*u+t[l++]*h);for(;a<this.finalResultSize;)for(s=0,o=e*this.targetWidthMultipliedByChannels;s<this.targetWidthMultipliedByChannels;++s)r[a++]=Math.round(t[o++]);return r},e.prototype.resizeHeightRGB=function(t){return this._resizeHeightRGBChannels(t,!1)},e.prototype.resizeHeightRGBA=function(t){return this._resizeHeightRGBChannels(t,!0)},e.prototype.resize=function(t){this.resizeCallback(this.resizeHeight(this.resizeWidth(t)))},e.prototype.bypassResizer=function(t){return t},e.prototype.initializeFirstPassBuffers=function(t){this.widthBuffer=this.generateFloatBuffer(this.widthPassResultSize),t||(this.outputWidthWorkBench=this.generateFloatBuffer(this.originalHeightMultipliedByChannels),this.colorChannels>3&&(this.outputWidthWorkBenchOpaquePixelsCount=this.generateFloat64Buffer(this.heightOriginal)))},e.prototype.initializeSecondPassBuffers=function(t){this.heightBuffer=this.generateUint8Buffer(this.finalResultSize),t||(this.outputHeightWorkBench=this.generateFloatBuffer(this.targetWidthMultipliedByChannels),this.colorChannels>3&&(this.outputHeightWorkBenchOpaquePixelsCount=this.generateFloat64Buffer(this.targetWidth)))},e.prototype.generateFloatBuffer=function(t){try{return new Float32Array(t)}catch(t){return[]}},e.prototype.generateFloat64Buffer=function(t){try{return new Float64Array(t)}catch(t){return[]}},e.prototype.generateUint8Buffer=function(t){try{return new Uint8Array(t)}catch(t){return[]}},t.exports=e},7691:(t,e,n)=>{"use strict";var r=n(9208).Buffer;t.exports={nearestNeighbor:function(t,e){for(var n=t.width,r=t.height,i=e.width,a=e.height,s=t.data,o=e.data,l=0;l<a;l++)for(var u=0;u<i;u++){var h=4*(l*i+u),c=4*(Math.floor(l*r/a)*n+Math.floor(u*n/i));o[h++]=s[c++],o[h++]=s[c++],o[h++]=s[c++],o[h++]=s[c++]}},bilinearInterpolation:function(t,e){for(var n=t.width,r=t.height,i=e.width,a=e.height,s=t.data,o=e.data,l=function(t,e,n,r,i){return e===r?n:Math.round((t-e)*i+(r-t)*n)},u=function(t,e,r,i,a,u,h,c){var d=4*(h*n+i)+e,f=4*(h*n+a)+e,p=l(r,i,s[d],a,s[f]);if(c===h)o[t+e]=p;else{f=4*(c*n+a)+e;var m=l(r,i,s[d=4*(c*n+i)+e],a,s[f]);o[t+e]=l(u,h,p,c,m)}},h=0;h<a;h++)for(var c=0;c<i;c++){var d=4*(h*i+c),f=c*n/i,p=Math.floor(f),m=Math.min(Math.ceil(f),n-1),g=h*r/a,b=Math.floor(g),y=Math.min(Math.ceil(g),r-1);u(d,0,f,p,m,g,b,y),u(d,1,f,p,m,g,b,y),u(d,2,f,p,m,g,b,y),u(d,3,f,p,m,g,b,y)}},_interpolate2D:function(t,e,n,i){for(var a=t.data,s=e.data,o=t.width,l=t.height,u=e.width,h=e.height,c=Math.max(1,Math.floor(o/u)),d=u*c,f=Math.max(1,Math.floor(l/h)),p=h*f,m=r.alloc(d*l*4),g=0;g<l;g++)for(var b=0;b<d;b++)for(var y=b*(o-1)/d,v=Math.floor(y),w=y-v,_=4*(g*o+v),k=4*(g*d+b),x=0;x<4;x++){var S=_+x,E=v>0?a[S-4]:2*a[S]-a[S+4],I=a[S],A=a[S+4],M=v<o-2?a[S+8]:2*a[S+4]-a[S];m[k+x]=i(E,I,A,M,w)}for(var T=r.alloc(d*p*4),N=0;N<p;N++)for(var C=0;C<d;C++)for(var R=N*(l-1)/p,O=Math.floor(R),D=R-O,z=4*(O*d+C),B=4*(N*d+C),F=0;F<4;F++){var P=z+F,L=O>0?m[P-4*d]:2*m[P]-m[P+4*d],$=m[P],U=m[P+4*d],j=O<l-2?m[P+8*d]:2*m[P+4*d]-m[P];T[B+F]=i(L,$,U,j,D)}var W=c*f;if(W>1)for(var G=0;G<h;G++)for(var H=0;H<u;H++){for(var V=0,q=0,K=0,Z=0,X=0,J=0;J<f;J++)for(var Y=G*f+J,Q=0;Q<c;Q++){var tt=4*(Y*d+(H*c+Q)),et=T[tt+3];et&&(V+=T[tt],q+=T[tt+1],K+=T[tt+2],X++),Z+=et}var nt=4*(G*u+H);s[nt]=X?Math.round(V/X):0,s[nt+1]=X?Math.round(q/X):0,s[nt+2]=X?Math.round(K/X):0,s[nt+3]=Math.round(Z/W)}else e.data=T},bicubicInterpolation:function(t,e,n){return this._interpolate2D(t,e,n,(function(t,e,n,r,i){var a=r-n-t+e,s=t-e-a,o=n-t,l=e;return Math.max(0,Math.min(255,a*(i*i*i)+s*(i*i)+o*i+l))}))},hermiteInterpolation:function(t,e,n){return this._interpolate2D(t,e,n,(function(t,e,n,r,i){var a=e,s=.5*(n-t),o=t-2.5*e+2*n-.5*r,l=.5*(r-t)+1.5*(e-n);return Math.max(0,Math.min(255,Math.round(((l*i+o)*i+s)*i+a)))}))},bezierInterpolation:function(t,e,n){return this._interpolate2D(t,e,n,(function(t,e,n,r,i){var a=1-i,s=e*a*a*a,o=3*(e+(n-t)/4)*a*a*i,l=3*(n-(r-e)/4)*a*i*i,u=n*i*i*i;return Math.max(0,Math.min(255,Math.round(s+o+l+u)))}))}}},8672:(t,e,n)=>{"use strict";var r=n(9208).Buffer;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=n(1065);function a(t,e){var n=(t%=360)*Math.PI/180,i=Math.cos(n),a=Math.sin(n),s=this.bitmap.width,o=this.bitmap.height;if(!0===e||"string"==typeof e){(s=Math.ceil(Math.abs(this.bitmap.width*i)+Math.abs(this.bitmap.height*a))+1)%2!=0&&s++,(o=Math.ceil(Math.abs(this.bitmap.width*a)+Math.abs(this.bitmap.height*i))+1)%2!=0&&o++;var l=this.cloneQuiet();this.scanQuiet(0,0,this.bitmap.width,this.bitmap.height,(function(t,e,n){this.bitmap.data.writeUInt32BE(this._background,n)}));var u=Math.max(s,o,this.bitmap.width,this.bitmap.height);this.resize(u,u,e),this.blit(l,this.bitmap.width/2-l.bitmap.width/2,this.bitmap.height/2-l.bitmap.height/2)}var h=this.bitmap.width,c=this.bitmap.height,d=r.alloc(this.bitmap.data.length);function f(t,e){return function(n,r){return{x:n+t,y:r+e}}}for(var p=f(-h/2,-c/2),m=f(h/2+.5,c/2+.5),g=1;g<=c;g++)for(var b=1;b<=h;b++){var y=p(b,g),v=m(i*y.x-a*y.y,i*y.y+a*y.x),w=h*(g-1)+b-1<<2;if(v.x>=0&&v.x<h&&v.y>=0&&v.y<c){var _=(h*(0|v.y)+v.x|0)<<2,k=this.bitmap.data.readUInt32BE(_);d.writeUInt32BE(k,w)}else d.writeUInt32BE(this._background,w)}if(this.bitmap.data=d,!0===e||"string"==typeof e){var x=h/2-s/2,S=c/2-o/2;this.crop(x,S,s,o)}}e.default=function(){return{rotate:function(t,e,n){return null==e&&(e=!0),"function"==typeof e&&void 0===n&&(n=e,e=!0),"number"!=typeof t?i.throwError.call(this,"deg must be a number",n):"boolean"!=typeof e&&"string"!=typeof e?i.throwError.call(this,"mode must be a boolean or a string",n):(a.call(this,t,e,n),(0,i.isNodePattern)(n)&&n.call(this,null,this),this)}}}},4227:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=n(1065);e.default=function(){return{scale:function(t,e,n){if("number"!=typeof t)return r.throwError.call(this,"f must be a number",n);if(t<0)return r.throwError.call(this,"f must be a positive number",n);"function"==typeof e&&void 0===n&&(n=e,e=null);var i=this.bitmap.width*t,a=this.bitmap.height*t;return this.resize(i,a,e),(0,r.isNodePattern)(n)&&n.call(this,null,this),this},scaleToFit:function(t,e,n,i){if("number"!=typeof t||"number"!=typeof e)return r.throwError.call(this,"w and h must be numbers",i);"function"==typeof n&&void 0===i&&(i=n,n=null);var a=t/e>this.bitmap.width/this.bitmap.height?e/this.bitmap.height:t/this.bitmap.width;return this.scale(a,n),(0,r.isNodePattern)(i)&&i.call(this,null,this),this}}}},4667:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=n(1065);e.default=function(){return{shadow:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;"function"==typeof e&&(n=e,e={});var i=e,a=i.opacity,s=void 0===a?.7:a,o=i.size,l=void 0===o?1.1:o,u=i.x,h=void 0===u?-25:u,c=i.y,d=void 0===c?25:c,f=i.blur,p=void 0===f?5:f,m=this.clone(),g=this.clone();return g.scan(0,0,g.bitmap.width,g.bitmap.height,(function(e,n,r){g.bitmap.data[r]=0,g.bitmap.data[r+1]=0,g.bitmap.data[r+2]=0,g.bitmap.data[r+3]=g.constructor.limit255(g.bitmap.data[r+3]*s),t.bitmap.data[r]=0,t.bitmap.data[r+1]=0,t.bitmap.data[r+2]=0,t.bitmap.data[r+3]=0})),g.resize(g.bitmap.width*l,g.bitmap.height*l).blur(p),this.composite(g,h,d),this.composite(m,0,0),(0,r.isNodePattern)(n)&&n.call(this,null,this),this}}}},4120:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=n(1065);e.default=function(){return{threshold:function(t,e){var n=this,i=t.max,a=t.replace,s=void 0===a?255:a,o=t.autoGreyscale,l=void 0===o||o;return"number"!=typeof i?r.throwError.call(this,"max must be a number",e):"number"!=typeof s?r.throwError.call(this,"replace must be a number",e):"boolean"!=typeof l?r.throwError.call(this,"autoGreyscale must be a boolean",e):(i=this.constructor.limit255(i),s=this.constructor.limit255(s),l&&this.greyscale(),this.scanQuiet(0,0,this.bitmap.width,this.bitmap.height,(function(t,e,r){var a=n.bitmap.data[r]<i?n.bitmap.data[r]:s;n.bitmap.data[r]=a,n.bitmap.data[r+1]=a,n.bitmap.data[r+2]=a})),(0,r.isNodePattern)(e)&&e.call(this,null,this),this)}}}},1414:(t,e,n)=>{"use strict";var r=n(3852);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=r(n(7907)),a=n(5595),s=r(n(1601)),o=r(n(4783)),l=r(n(5553)),u=r(n(5162)),h=r(n(4106)),c=r(n(2731)),d=r(n(1215)),f=r(n(8987)),p=r(n(4672)),m=r(n(346)),g=r(n(6339)),b=r(n(4622)),y=r(n(2981)),v=r(n(9495)),w=r(n(8687)),_=r(n(8152)),k=r(n(1083)),x=r(n(8672)),S=r(n(4227)),E=r(n(4667)),I=r(n(4120)),A=[s.default,o.default,l.default,u.default,h.default,c.default,d.default,f.default,p.default,m.default,g.default,b.default,y.default,v.default,w.default,_.default,k.default,x.default,S.default,E.default,I.default];e.default=function(t){var e=A.map((function(e){var n=e(t)||{};return n.class||n.constants||(n={class:n}),n}));return a.mergeDeep.apply(void 0,(0,i.default)(e))}},9826:(t,e,n)=>{"use strict";var r=n(3852);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=r(n(5590)),a=n(6941),s=n(1065),o="image/png";e.default=function(){return{mime:(0,i.default)({},o,["png"]),constants:{MIME_PNG:o,PNG_FILTER_AUTO:-1,PNG_FILTER_NONE:0,PNG_FILTER_SUB:1,PNG_FILTER_UP:2,PNG_FILTER_AVERAGE:3,PNG_FILTER_PATH:4},hasAlpha:(0,i.default)({},o,!0),decoders:(0,i.default)({},o,a.PNG.sync.read),encoders:(0,i.default)({},o,(function(t){var e=new a.PNG({width:t.bitmap.width,height:t.bitmap.height});return e.data=t.bitmap.data,a.PNG.sync.write(e,{width:t.bitmap.width,height:t.bitmap.height,deflateLevel:t._deflateLevel,deflateStrategy:t._deflateStrategy,filterType:t._filterType,colorType:"number"==typeof t._colorType?t._colorType:t._rgba?6:2,inputHasAlpha:t._rgba})})),class:{_deflateLevel:9,_deflateStrategy:3,_filterType:-1,_colorType:null,deflateLevel:function(t,e){return"number"!=typeof t?s.throwError.call(this,"l must be a number",e):t<0||t>9?s.throwError.call(this,"l must be a number 0 - 9",e):(this._deflateLevel=Math.round(t),(0,s.isNodePattern)(e)&&e.call(this,null,this),this)},deflateStrategy:function(t,e){return"number"!=typeof t?s.throwError.call(this,"s must be a number",e):t<0||t>3?s.throwError.call(this,"s must be a number 0 - 3",e):(this._deflateStrategy=Math.round(t),(0,s.isNodePattern)(e)&&e.call(this,null,this),this)},filterType:function(t,e){return"number"!=typeof t?s.throwError.call(this,"n must be a number",e):t<-1||t>4?s.throwError.call(this,"n must be -1 (auto) or a number 0 - 4",e):(this._filterType=Math.round(t),(0,s.isNodePattern)(e)&&e.call(this,null,this),this)},colorType:function(t,e){return"number"!=typeof t?s.throwError.call(this,"s must be a number",e):0!==t&&2!==t&&4!==t&&6!==t?s.throwError.call(this,"s must be a number 0, 2, 4, 6.",e):(this._colorType=Math.round(t),(0,s.isNodePattern)(e)&&e.call(this,null,this),this)}}}}},9314:(t,e,n)=>{"use strict";var r=n(9208).Buffer,i=n(3852);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=i(n(5590)),s=i(n(2574)),o="image/tiff";e.default=function(){return{mime:(0,a.default)({},o,["tiff","tif"]),constants:{MIME_TIFF:o},decoders:(0,a.default)({},o,(function(t){var e=s.default.decode(t),n=e[0];s.default.decodeImages(t,e);var i=s.default.toRGBA8(n);return{data:r.from(i),width:n.t256[0],height:n.t257[0]}})),encoders:(0,a.default)({},o,(function(t){var e=s.default.encodeImage(t.bitmap.data,t.bitmap.width,t.bitmap.height);return r.from(e)}))}}},6291:(t,e,n)=>{"use strict";var r=n(3852);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=n(5595),a=r(n(4141)),s=r(n(9826)),o=r(n(9390)),l=r(n(9314)),u=r(n(2457));e.default=function(){return(0,i.mergeDeep)((0,a.default)(),(0,s.default)(),(0,o.default)(),(0,l.default)(),(0,u.default)())}},1065:(t,e,n)=>{"use strict";var r=n(3852);Object.defineProperty(e,"__esModule",{value:!0}),e.isNodePattern=function(t){if(void 0===t)return!1;if("function"!=typeof t)throw new TypeError("Callback must be a function");return!0},e.throwError=function(t,e){if("string"==typeof t&&(t=new Error(t)),"function"==typeof e)return e.call(this,t);throw t},e.scan=function(t,e,n,r,i,a){e=Math.round(e),n=Math.round(n),r=Math.round(r),i=Math.round(i);for(var s=n;s<n+i;s++)for(var o=e;o<e+r;o++){var l=t.bitmap.width*s+o<<2;a.call(t,o,s,l)}return t},e.scanIterator=s;var i=r(n(3164)),a=i.default.mark(s);function s(t,e,n,r,s){var o,l,u;return i.default.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:e=Math.round(e),n=Math.round(n),r=Math.round(r),s=Math.round(s),o=n;case 5:if(!(o<n+s)){i.next=17;break}l=e;case 7:if(!(l<e+r)){i.next=14;break}return u=t.bitmap.width*o+l<<2,i.next=11,{x:l,y:o,idx:u,image:t};case 11:l++,i.next=7;break;case 14:o++,i.next=5;break;case 17:case"end":return i.stop()}}),a)}},7441:(t,e,n)=>{"use strict";n.r(e),n.d(e,{MathBackendCPU:()=>o,shared:()=>r,version_cpu:()=>de});var r={};n.r(r),n.d(r,{addImpl:()=>k,bincountImpl:()=>I,bincountReduceImpl:()=>A,ceilImpl:()=>C,concatImpl:()=>D,equalImpl:()=>z,expImpl:()=>P,expm1Impl:()=>U,floorImpl:()=>G,gatherNdImpl:()=>q,gatherV2Impl:()=>K,greaterEqualImpl:()=>Y,greaterImpl:()=>Z,lessEqualImpl:()=>it,lessImpl:()=>et,linSpaceImpl:()=>ot,logImpl:()=>lt,maxImpl:()=>ct,maximumImpl:()=>dt,minimumImpl:()=>mt,multiplyImpl:()=>yt,negImpl:()=>kt,notEqualImpl:()=>St,prodImpl:()=>Nt,rangeImpl:()=>Rt,rsqrtImpl:()=>Ot,sigmoidImpl:()=>Bt,simpleAbsImpl:()=>l,sliceImpl:()=>Lt,sparseFillEmptyRowsImpl:()=>jt,sparseReshapeImpl:()=>Wt,sparseSegmentReductionImpl:()=>Gt,sqrtImpl:()=>Ht,squaredDifferenceImpl:()=>Kt,stridedSliceImpl:()=>Jt,stringNGramsImpl:()=>Qt,stringSplitImpl:()=>ee,stringToHashBucketFastImpl:()=>ne,subImpl:()=>re,tileImpl:()=>oe,topKImpl:()=>he,transposeImpl:()=>At,uniqueImpl:()=>ce});var i=n(1420);function a(t,e){Array.isArray(t)||(t=[t]),t.forEach((t=>{null!=t&&i.util.assert("complex64"!==t.dtype,(()=>`${e} does not support complex64 tensors in the CPU backend.`))}))}const s=i.kernel_impls.whereImpl;class o extends i.KernelBackend{constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new i.DataStorage(this,(0,i.engine)())}nextDataId(){return o.nextDataId++}write(t,e,n){this.firstUse&&(this.firstUse=!1,(0,i.env)().get("IS_NODE")&&i.backend_util.warn("\n============================\nHi there 👋. Looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, which binds to TensorFlow C++, by running npm i @tensorflow/tfjs-node, or npm i @tensorflow/tfjs-node-gpu if you have CUDA. Then call require('@tensorflow/tfjs-node'); (-gpu suffix for CUDA) at the start of your program. Visit https://github.com/tensorflow/tfjs-node for more details.\n============================"));const r={id:this.nextDataId()};return this.data.set(r,{values:t,dtype:n,refCount:1}),r}makeTensorInfo(t,e,n){let r;if("string"===e&&null!=n&&n.length>0&&i.util.isString(n[0])){const a=n.map((t=>i.util.encodeString(t)));r=this.write(a,t,e)}else r=this.write(n,t,e);return{dataId:r,shape:t,dtype:e}}refCount(t){return this.data.has(t)?this.data.get(t).refCount:0}incRef(t){this.data.get(t).refCount++}decRef(t){this.data.has(t)&&this.data.get(t).refCount--}move(t,e,n,r,i){this.data.set(t,{values:e,dtype:r,refCount:i})}numDataIds(){return this.data.numDataIds()}async read(t){return this.readSync(t)}readSync(t){const{dtype:e,complexTensorInfos:n}=this.data.get(t);if("complex64"===e){const t=this.readSync(n.real.dataId),e=this.readSync(n.imag.dataId);return i.backend_util.mergeRealAndImagArrays(t,e)}return this.data.get(t).values}bufferSync(t){const e=this.readSync(t.dataId);let n=e;if("string"===t.dtype)try{n=e.map((t=>i.util.decodeString(t)))}catch(t){throw new Error("Failed to decode encoded string bytes into utf-8")}return(0,i.buffer)(t.shape,t.dtype,n)}makeOutput(t,e,n){const r=this.write(t,e,n);return(0,i.engine)().makeTensorFromDataId(r,e,n,this)}disposeData(t,e=!1){if(this.data.has(t)){if(this.data.get(t).refCount--,!e&&this.data.get(t).refCount>0)return!1;const{complexTensorInfos:n}=this.data.get(t);null!=n&&(this.disposeData(n.real.dataId,!0),this.disposeData(n.imag.dataId,!0)),this.data.delete(t)}return!0}disposeIntermediateTensorInfo(t){this.disposeData(t.dataId)}async time(t){const e=i.util.now();return t(),{kernelMs:i.util.now()-e}}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(t){a([t],"where");const e=this.readSync(t.dataId);return s(t.shape,e)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}}function l(t){const e=new Float32Array(t.length);for(let n=0;n<t.length;++n)e[n]=Math.abs(t[n]);return e}o.nextDataId=0;const u={kernelName:i.Abs,backendName:"cpu",kernelFunc:t=>{const{x:e}=t.inputs,n=t.backend;a(e,"abs");let r=new Float32Array(i.util.sizeFromShape(e.shape));return r=l(n.data.get(e.dataId).values),n.makeOutput(r,e.shape,e.dtype)}};function h(t){return(e,n,r,a,s)=>{const o=i.backend_util.assertAndGetBroadcastShape(e,n),l=o.length,u=i.util.computeStrides(o),h=i.util.sizeFromShape(o),c=i.util.getTypedArrayFromDType(s,h),d=e.length,f=n.length,p=i.util.computeStrides(e),m=i.util.computeStrides(n),g=i.backend_util.getBroadcastDims(e,o),b=i.backend_util.getBroadcastDims(n,o);if(g.length+b.length===0)for(let e=0;e<c.length;++e)c[e]=t(r[e%r.length],a[e%a.length]);else for(let e=0;e<c.length;++e){const n=i.util.indexToLoc(e,l,u),s=n.slice(-d);g.forEach((t=>s[t]=0));const o=i.util.locToIndex(s,d,p),h=n.slice(-f);b.forEach((t=>h[t]=0));const y=i.util.locToIndex(h,f,m);c[e]=t(r[o],a[y])}return[c,o]}}function c(t){const{inputs:e,backend:n}=t,{real:r,imag:i}=e,a=n.data.get(r.dataId).values,s=n.data.get(i.dataId).values,o=n.makeTensorInfo(r.shape,"complex64");return n.data.get(o.dataId).complexTensorInfos={real:n.makeTensorInfo(r.shape,"float32",a),imag:n.makeTensorInfo(i.shape,"float32",s)},o}const d={kernelName:i.Complex,backendName:"cpu",kernelFunc:c};function f(t,e,n="float32"){if("complex64"===n)return c({inputs:{real:f(t,e,"float32"),imag:f(t,e,"float32")},backend:t});const r=i.util.makeZerosTypedArray(i.util.sizeFromShape(e),n);return t.makeTensorInfo(e,n,r)}function p(t){const{inputs:e,backend:n}=t,{x:r}=e;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}const m={kernelName:i.Identity,backendName:"cpu",kernelFunc:p};function g(t){const{inputs:e,backend:n}=t,{input:r}=e,i=n.data.get(r.dataId).complexTensorInfos.real,a=n.data.get(i.dataId).values;return n.makeTensorInfo(i.shape,i.dtype,a)}const b={kernelName:i.Real,backendName:"cpu",kernelFunc:g};function y(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{dtype:s}=r;if("complex64"===s){if("complex64"===a.dtype)return p({inputs:{x:a},backend:n});const t=f(n,a.shape,a.dtype),e=y({inputs:{x:a},backend:n,attrs:{dtype:"float32"}}),r=c({inputs:{real:e,imag:t},backend:n});return n.disposeIntermediateTensorInfo(t),n.disposeIntermediateTensorInfo(e),r}if("complex64"===a.dtype){const t=g({inputs:{input:a},backend:n}),e=y({inputs:{x:t},backend:n,attrs:{dtype:s}});return n.disposeIntermediateTensorInfo(t),e}if(!i.util.hasEncodingLoss(a.dtype,s)){const t=p({inputs:{x:a},backend:n});return{dataId:t.dataId,shape:t.shape,dtype:s}}if("int32"===s){const t=n.data.get(a.dataId).values,e=Int32Array.from(t);return n.makeTensorInfo(a.shape,"int32",e)}if("bool"===s){const t=n.data.get(a.dataId).values,e=i.util.toTypedArray([0],a.dtype),[r,s]=h(((t,e)=>t!==e?1:0))(a.shape,[],t,e,"bool");return n.makeTensorInfo(s,"bool",r)}throw new Error(`Error in Cast: failed to cast ${a.dtype} to ${s}`)}const v={kernelName:i.Cast,backendName:"cpu",kernelFunc:y};function w(t,e,n,r){return null==n?({inputs:n,backend:s})=>{const{a:o,b:l}=n,u=s;a([o,l],t);const h=u.data.get(o.dataId).values,c=u.data.get(l.dataId).values,d="string"===o.dtype?i.backend_util.fromUint8ToStringArray(h):h,f="string"===o.dtype?i.backend_util.fromUint8ToStringArray(c):c,p=r||o.dtype,[m,g]=e(o.shape,l.shape,d,f,p);return u.makeTensorInfo(g,p,m)}:({inputs:t,backend:i})=>{const{a,b:s}=t,o=i;if("complex64"===a.dtype||"complex64"===s.dtype){const t=y({inputs:{x:a},backend:o,attrs:{dtype:"complex64"}}),e=o.data.get(t.dataId),r=e.complexTensorInfos.real,i=e.complexTensorInfos.imag,l=o.data.get(r.dataId).values,u=o.data.get(i.dataId).values,h=y({inputs:{x:s},backend:o,attrs:{dtype:"complex64"}}),d=o.data.get(h.dataId),f=d.complexTensorInfos.real,p=d.complexTensorInfos.imag,m=o.data.get(f.dataId).values,g=o.data.get(p.dataId).values,[b,v,w]=n(a.shape,s.shape,l,u,m,g),_=o.makeTensorInfo(w,"float32",b),k=o.makeTensorInfo(w,"float32",v),x=c({inputs:{real:_,imag:k},backend:o});return o.disposeIntermediateTensorInfo(t),o.disposeIntermediateTensorInfo(h),o.disposeIntermediateTensorInfo(_),o.disposeIntermediateTensorInfo(k),x}{const t=o.data.get(a.dataId).values,n=o.data.get(s.dataId).values,i=r||a.dtype,[l,u]=e(a.shape,s.shape,t,n,i);return o.makeTensorInfo(u,i,l)}}}function _(t){return(e,n,r,a,s,o)=>{const l=i.backend_util.assertAndGetBroadcastShape(e,n),u=i.util.sizeFromShape(l),h=l.length,c=i.util.computeStrides(l),d=i.util.getTypedArrayFromDType("float32",u),f=i.util.getTypedArrayFromDType("float32",u),p=i.backend_util.getBroadcastDims(e,l),m=i.backend_util.getBroadcastDims(n,l),g=i.backend_util.mergeRealAndImagArrays(r,a),b=i.backend_util.mergeRealAndImagArrays(s,o),y=e.length,v=i.util.computeStrides(e),w=n.length,_=i.util.computeStrides(n);if(p.length+m.length===0)for(let e=0;e<d.length;e++){const n=e%g.length,r=e%b.length,i=t(g[2*n],g[2*n+1],b[2*r],b[2*r+1]);d[e]=i.real,f[e]=i.imag}else for(let e=0;e<d.length;e++){const n=i.util.indexToLoc(e,h,c),r=n.slice(-y);p.forEach((t=>r[t]=0));const a=i.util.locToIndex(r,y,v),s=n.slice(-w);m.forEach((t=>s[t]=0));const o=i.util.locToIndex(s,w,_),l=t(g[2*a],g[2*a+1],b[2*o],b[2*o+1]);d[e]=l.real,f[e]=l.imag}return[d,f,l]}}const k=h(((t,e)=>t+e)),x=_(((t,e,n,r)=>({real:t+n,imag:e+r}))),S=w(i.Add,k,x),E={kernelName:i.Add,backendName:"cpu",kernelFunc:S};function I(t,e,n,r,a){const s=i.util.sizeFromShape(r),o=i.util.makeZerosTypedArray(a,n);for(let n=0;n<t.length;n++){const r=t[n];if(r<0)throw new Error("Input x must be non-negative!");r>=a||(o[r]+=s>0?e[n]:1)}return o}function A(t,e,n,r=!1){const a=t.shape[0],s=t.shape[1],o=(0,i.buffer)([a,n],e.dtype);for(let i=0;i<a;i++)for(let a=0;a<s;a++){const s=t.get(i,a);if(s<0)throw new Error("Input x must be non-negative!");s>=n||(r?o.set(1,i,s):e.size>0?o.set(o.get(i,s)+e.get(i,a),i,s):o.set(o.get(i,s)+1,i,s))}return o}function M(t){return(e,n,r)=>{const a=i.util.getTypedArrayFromDType(n,e.length);for(let n=0;n<e.length;++n)a[n]=t(e[n],r);return a}}function T(t,e,n){return({inputs:r,attrs:s,backend:o})=>{const{x:l}=r;if(a(l,t),"string"===l.dtype||"string"===n)throw new Error("unaryKernelFunc does not support string input/output");const u=o,h=u.data.get(l.dataId).values,c=i.util.sizeFromShape(l.shape),d=n||l.dtype,f=i.util.getArrayFromDType(d,c);for(let t=0;t<c;++t)f[t]=e(h[t],s);return u.makeTensorInfo(l.shape,d,f)}}function N(t,e,n){return({inputs:r,attrs:i,backend:s})=>{const{x:o}=r;if(a(o,t),"string"===o.dtype||"string"===n)throw new Error("unaryKernelFunc does not support string input/output");const l=s,u=l.data.get(o.dataId).values,h=n||o.dtype,c=e(u,h,i);return l.makeTensorInfo(o.shape,h,c)}}const C=M((t=>Math.ceil(t))),R=N(i.Ceil,C),O={kernelName:i.Ceil,backendName:"cpu",kernelFunc:R};function D(t,e,n,r){const a=i.util.getArrayFromDType(n,i.util.sizeFromShape(e));if(r&&"string"!==n){let e=0;t.forEach((t=>{const n=i.util.sizeFromShape(t.shape);a.set(t.vals,e),e+=n}))}else{let r=0;t.forEach((t=>{const s="string"===n?i.backend_util.fromUint8ToStringArray(t.vals):t.vals;let o=0;for(let n=0;n<t.shape[0];++n){const i=n*e[1]+r;for(let e=0;e<t.shape[1];++e)a[i+e]=s[o++]}r+=t.shape[1]}))}return a}const z=h(((t,e)=>t===e?1:0)),B=w(i.Equal,z,null,"bool"),F={kernelName:i.Equal,backendName:"cpu",kernelFunc:B},P=M((t=>Math.exp(t))),L=N(i.Exp,P,"float32"),$={kernelName:i.Exp,backendName:"cpu",kernelFunc:L},U=M((t=>Math.expm1(t))),j=N(i.Expm1,U),W={kernelName:i.Expm1,backendName:"cpu",kernelFunc:j},G=M((t=>Math.floor(t))),H=N(i.Floor,G),V={kernelName:i.Floor,backendName:"cpu",kernelFunc:H};function q(t,e,n,r,a,s,o,l,u){const h=(0,i.buffer)([r,s],n);for(let n=0;n<r;n++){const r=[];let i=0;for(let e=0;e<a;e++){const s=t[n*a+e];i+=s*o[e],r.push(s)}if(i<0||i>=u/s)throw new Error(`Invalid indices: ${r} does not index into ${l}`);for(let t=0;t<s;t++)h.values[n*s+t]=e.get(...e.indexToLoc(i*s+t))}return h}function K(t,e,n){const r=(0,i.buffer)(n,t.dtype);for(let n=0;n<r.size;++n){const i=r.indexToLoc(n).slice(),a=i[0],s=i[2],o=e.locToIndex([a,s]);i[2]=e.values[o];const l=t.locToIndex(i);r.values[n]=t.values[l]}return r}const Z=h(((t,e)=>t>e?1:0)),X=w(i.Greater,Z,null,"bool"),J={kernelName:i.Greater,backendName:"cpu",kernelFunc:X},Y=h(((t,e)=>t>=e?1:0)),Q=w(i.GreaterEqual,Y,null,"bool"),tt={kernelName:i.GreaterEqual,backendName:"cpu",kernelFunc:Q},et=h(((t,e)=>t<e?1:0)),nt=w(i.Less,et,null,"bool"),rt={kernelName:i.Less,backendName:"cpu",kernelFunc:nt},it=h(((t,e)=>t<=e?1:0)),at=w(i.LessEqual,it,null,"bool"),st={kernelName:i.LessEqual,backendName:"cpu",kernelFunc:at};function ot(t,e,n){const r=(e-t)/(n-1),a=i.util.makeZerosTypedArray(n,"float32");a[0]=t;for(let t=1;t<a.length;t++)a[t]=a[t-1]+r;return a}const lt=M((t=>Math.log(t))),ut=N(i.Log,lt),ht={kernelName:i.Log,backendName:"cpu",kernelFunc:ut};function ct(t,e,n,r){const a=i.util.getTypedArrayFromDType(r,i.util.sizeFromShape(n));for(let n=0;n<a.length;++n){const r=n*e;let i=t[r];for(let n=0;n<e;++n){const e=t[r+n];(Number.isNaN(e)||e>i)&&(i=e)}a[n]=i}return a}const dt=h(((t,e)=>Math.max(t,e))),ft=w(i.Maximum,dt),pt={kernelName:i.Maximum,backendName:"cpu",kernelFunc:ft},mt=h(((t,e)=>Math.min(t,e))),gt=w(i.Minimum,mt),bt={kernelName:i.Minimum,backendName:"cpu",kernelFunc:gt},yt=h(((t,e)=>t*e)),vt=_(((t,e,n,r)=>({real:t*n-e*r,imag:t*r+e*n}))),wt=w(i.Multiply,yt,vt),_t={kernelName:i.Multiply,backendName:"cpu",kernelFunc:wt};function kt(t,e,n){const r=i.util.createScalarValue(-1,n);return yt([],e,r,t,n)}const xt={kernelName:i.Neg,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n}=t,{x:r}=e;a(r,"neg");const i=n.data.get(r.dataId).values,[s,o]=kt(i,r.shape,r.dtype);return n.makeTensorInfo(o,r.dtype,s)}},St=h(((t,e)=>t!==e?1:0)),Et=w(i.NotEqual,St,null,"bool"),It={kernelName:i.NotEqual,backendName:"cpu",kernelFunc:Et};function At(t,e,n,r,a){const s=e.length,o=i.util.sizeFromShape(e),l=i.util.computeStrides(e),u=i.util.computeStrides(a),h=i.util.getTypedArrayFromDType(n,i.util.sizeFromShape(a));for(let e=0;e<o;++e){const n=i.util.indexToLoc(e,s,l),a=new Array(n.length);for(let t=0;t<a.length;t++)a[t]=n[r[t]];h[i.util.locToIndex(a,s,u)]=t[e]}return h}function Mt(t){const{inputs:e,attrs:n,backend:r}=t,{x:i}=e,{perm:s}=n;a(i,"transpose");const o=i.shape.length,l=new Array(o);for(let t=0;t<l.length;t++)l[t]=i.shape[s[t]];const u=At(r.data.get(i.dataId).values,i.shape,i.dtype,s,l);return{dataId:r.write(u,l,i.dtype),shape:l,dtype:i.dtype}}const Tt={kernelName:i.Transpose,backendName:"cpu",kernelFunc:Mt};function Nt(t,e,n,r){const[a,s]=i.backend_util.computeOutAndReduceShapes(t,r),o=(0,i.upcastType)(e,"int32"),l=i.util.makeZerosTypedArray(i.util.sizeFromShape(a),o),u=i.util.sizeFromShape(s);for(let t=0;t<l.length;++t){const e=t*u;let r=1;for(let t=0;t<u;++t)r*=n[e+t];l[t]=r}return{outVals:l,outShape:a,outDtype:o}}const Ct={kernelName:i.Prod,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:o,keepDims:l}=r;a(s,"prod");const u=s.shape.length,h=i.util.parseAxisParam(o,s.shape),c=i.backend_util.getAxesPermutation(h,u);let d=h,f=s;const p=[];null!=c&&(f=Mt({inputs:{x:s},backend:n,attrs:{perm:c}}),p.push(f),d=i.backend_util.getInnerMostAxes(d.length,u));const m=n.data.get(f.dataId).values,{outVals:g,outShape:b,outDtype:y}=Nt(f.shape,f.dtype,m,d);let v=b;return l&&(v=i.backend_util.expandShapeToKeepDim(b,h)),p.forEach((t=>n.disposeIntermediateTensorInfo(t))),n.makeTensorInfo(v,y,g)}};function Rt(t,e,n,r){if(t===e||t<e&&n<0||e<t&&n>1)return i.util.makeZerosTypedArray(0,r);const a=Math.abs(Math.ceil((e-t)/n)),s=i.util.makeZerosTypedArray(a,r);e<t&&1===n&&(n=-1),s[0]=t;for(let t=1;t<s.length;t++)s[t]=s[t-1]+n;return s}const Ot=M((t=>1/Math.sqrt(t))),Dt=N(i.Rsqrt,Ot),zt={kernelName:i.Rsqrt,backendName:"cpu",kernelFunc:Dt},Bt=M((t=>1/(1+Math.exp(-t)))),Ft=T(i.Sigmoid,(t=>1/(1+Math.exp(-t)))),Pt={kernelName:i.Sigmoid,backendName:"cpu",kernelFunc:Ft};function Lt(t,e,n,r,a){const s=i.slice_util.isSliceContinous(r,e,n),o=i.util.sizeFromShape(n),l=i.util.computeStrides(r);if(s){const n=i.slice_util.computeFlatOffset(e,l);return"string"===a?t.slice(n,n+o):t.subarray(n,n+o)}const u="string"===a?i.backend_util.fromUint8ToStringArray(t):t,h=(0,i.buffer)(r,a,u),c=(0,i.buffer)(n,a);for(let t=0;t<c.size;++t){const n=c.indexToLoc(t),r=n.map(((t,n)=>t+e[n]));c.set(h.get(...r),...n)}return"string"===a?i.backend_util.fromStringArrayToUint8(c.values):c.values}function $t(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{begin:o,size:l}=r;a(s,"slice");const[u,h]=i.slice_util.parseSliceParams(s,o,l);i.slice_util.assertParamsValid(s,u,h);const c=Lt(n.data.get(s.dataId).values,u,h,s.shape,s.dtype);return n.makeTensorInfo(h,s.dtype,c)}const Ut={kernelName:i.Slice,backendName:"cpu",kernelFunc:$t};function jt(t,e,n,r,a,s,o){const l=e[0],u=s[0],h=new Array(u),c=new Array(l),d=e[1];if(0===u){if(0!==l)throw new Error(i.backend_util.getSparseFillEmptyRowsIndicesDenseShapeMismatch(l));return[i.util.getArrayFromDType(n,0),[0,d],i.util.getArrayFromDType(a,0),h,c]}let f=!0,p=0;const m=new Array(u).fill(0);for(let e=0;e<l;++e){const n=t[e*d];if(n<0)throw new Error(i.backend_util.getSparseFillEmptyRowsNegativeIndexErrorMessage(e,n));if(n>=u)throw new Error(i.backend_util.getSparseFillEmptyRowsOutOfRangeIndexErrorMessage(e,n,u));++m[n],f=f&&n>=p,p=n}let g=!0;for(let t=0;t<u;++t){const e=0===m[t];h[t]=e,g=g&&!e,m[t]=Math.max(m[t],1),t>0&&(m[t]+=m[t-1])}if(g&&f){const e=t,n=r;for(let t=0;t<l;++t)c[t]=t;return[e,[l,d],n,h,c]}{const e=m[u-1],s=i.util.getArrayFromDType(n,e*d),f=i.util.getArrayFromDType(a,e),p=new Array(u).fill(0);for(let e=0;e<l;++e){const n=t[e*d],i=p[n],a=(0===n?0:m[n-1])+i;p[n]++;for(let n=0;n<d;++n)s[a*d+n]=t[e*d+n];f[a]=r[e],c[e]=a}for(let t=0;t<u;++t)if(0===p[t]){const e=0===t?0:m[t-1];s[e*d+0]=t;for(let t=1;t<d;++t)s[e*d+t]=0;f[e]=o}return[s,[e,d],f,h,c]}}function Wt(t,e,n,r,a){const s=i.util.sizeFromShape(r),o=e[0],l=a.length,u=[];let h=1,c=-1;for(let t=0;t<l;++t){const e=a[t];if(-1===e){if(-1!==c)throw new Error(i.backend_util.getSparseReshapeMultipleNegativeOneOutputDimErrorMessage(c,t));c=t,u.push(1)}else{if(e<0)throw new Error(i.backend_util.getSparseReshapeNegativeOutputDimErrorMessage(t,e));h*=e,u.push(e)}}if(-1!==c){if(h<=0)throw new Error(i.backend_util.getSparseReshapeEmptyTensorZeroOutputDimErrorMessage());const t=Math.trunc(s/h);if(h*t!==s)throw new Error(i.backend_util.getSparseReshapeInputOutputMultipleErrorMessage(r,u));u[c]=t}if(i.util.sizeFromShape(u)!==s)throw new Error(i.backend_util.getSparseReshapeInputOutputMismatchErrorMessage(r,u));const d=r.length,f=[];if(d>0){f[d-1]=1;for(let t=d-2;t>=0;--t)f[t]=f[t+1]*r[t+1]}const p=[];if(l>0){p[l-1]=1;for(let t=l-2;t>=0;--t)p[t]=p[t+1]*u[t+1]}const m=i.util.getArrayFromDType(n,o*l);for(let e=0;e<o;++e){let n=0;for(let r=0;r<d;++r)n+=t[e*d+r]*f[r];for(let t=0;t<l;++t)m[e*l+t]=Math.trunc(n/p[t]),n%=p[t]}return[m,[o,l],u]}function Gt(t,e,n,r,a,s=!1,o=0){const l=r.length,u=[e[0],t.length/e[0]],h=u[1],c=l>0?a[l-1]+1:0;if(c<0)throw new Error(i.backend_util.getSparseSegmentReductionNegativeSegmentIdsErrorMessage());const d=e.slice();d[0]=c;const f=d.reduce(((t,e)=>t*e),1),p=i.util.getArrayFromDType(n,f);if(0===l)return c>0&&p.fill(o),[p,d];if(c<=0)throw new Error(i.backend_util.getSparseSegmentReductionNegativeSegmentIdsErrorMessage());let m=0,g=1,b=0,y=a[m];for(;;){let e=0;if(g<l){if(e=a[g],y===e){++g;continue}if(y>=e)throw new Error(i.backend_util.getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage())}if(y<0||y>=c)throw new Error(i.backend_util.getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage(y,c));y>b&&p.fill(o,b*h,y*h);for(let e=m;e<g;++e){const n=r[e];if(n<0||n>=u[0])throw new Error(i.backend_util.getSparseSegmentReductionIndicesOutOfRangeErrorMessage(e,r[e],u[0]));for(let e=0;e<h;e++)p[y*h+e]+=t[n*h+e]}if(s)for(let t=0;t<h;t++)p[y*h+t]/=g-m;if(m=g,++g,b=y+1,y=e,g>l)break}return b<c&&p.fill(o,b*h,c*h),[p,d]}const Ht=M((t=>Math.sqrt(t))),Vt=T(i.Sqrt,(t=>Math.sqrt(t))),qt={kernelName:i.Sqrt,backendName:"cpu",kernelFunc:Vt},Kt=h(((t,e)=>{const n=t-e;return n*n})),Zt=w(i.SquaredDifference,Kt),Xt={kernelName:i.SquaredDifference,backendName:"cpu",kernelFunc:Zt};function Jt(t,e,n,r){const a=(0,i.buffer)(t,e.dtype);for(let t=0;t<a.size;t++){const i=a.indexToLoc(t),s=new Array(i.length);for(let t=0;t<s.length;t++)s[t]=i[t]*n[t]+r[t];a.set(e.get(...s),...i)}return a}class Yt{constructor(t,e,n,r,a,s){this.separator=i.util.encodeString(t),this.nGramWidths=e,this.leftPad=i.util.encodeString(n),this.rightPad=i.util.encodeString(r),this.padWidth=a,this.preserveShort=s}getPadWidth(t){return Math.min(this.padWidth<0?t-1:this.padWidth,t-1)}getNumNGrams(t,e){const n=this.getPadWidth(e);return Math.max(0,t+2*n-e+1)}createNGrams(t,e,n,r,i,a){for(let s=0;s<i;++s){const o=this.getPadWidth(a),l=Math.max(0,o-s),u=Math.max(0,o-(i-(s+1))),h=a-(l+u),c=e+(l>0?0:s-o);let d=0;d+=l*this.leftPad.length;for(let e=0;e<h;++e)d+=t[c+e].length;d+=u*this.rightPad.length,d+=(l+u+h-1)*this.separator.length,n[r+s]=new Uint8Array(d);const f=n[r+s];let p=0;const m=t=>t.forEach((t=>f[p++]=t));for(let t=0;t<l;++t)m(this.leftPad),m(this.separator);for(let e=0;e<h-1;++e)m(t[c+e]),m(this.separator);if(h>0){m(t[c+h-1]);for(let t=0;t<u;++t)m(this.separator),m(this.rightPad)}else{for(let t=0;t<u-1;++t)m(this.rightPad),m(this.separator);m(this.rightPad)}}}compute(t,e){const n=t.length,r=e.length;if(r>0){let t=e[0];if(0!==t)throw new Error(`First split value must be 0, got ${t}`);for(let i=1;i<r;++i){let r=e[i]>=t;if(r=r&&e[i]<=n,!r)throw new Error(`Invalid split value ${e[i]}, must be in [${t}, ${n}]`);t=e[i]}if(t!==n)throw new Error(`Last split value must be data size. Expected ${n}, got ${t}`)}const a=r-1,s=i.util.getArrayFromDType("int32",r);if(0===n||0===r){const t=new Array(n);for(let t=0;t<=a;++t)s[t]=0;return[t,s]}s[0]=0;for(let t=1;t<=a;++t){const n=e[t]-e[t-1];let r=0;this.nGramWidths.forEach((t=>{r+=this.getNumNGrams(n,t)})),this.preserveShort&&n>0&&0===r&&(r=1),s[t]=s[t-1]+r}const o=new Array(s[a]);for(let n=0;n<a;++n){const r=e[n];let i=s[n];if(this.nGramWidths.forEach((a=>{const s=e[n+1]-e[n],l=this.getNumNGrams(s,a);this.createNGrams(t,r,o,i,l,a),i+=l})),this.preserveShort&&i===s[n]){const a=e[n+1]-e[n];if(0===a)continue;const s=a+2*this.padWidth,l=1;this.createNGrams(t,r,o,i,l,s)}}return[o,s]}}function Qt(t,e,n,r,i,a,s,o){return new Yt(n,r,i,a,s,o).compute(t,e)}function te(t,e,n,r){if(!t.length)return;if(0===e.length){for(let e=0;e<t.length;++e)r.push(t.subarray(e,e+1));return}if(1===e.length){const i=e[0];let a=t.indexOf(i);for(;-1!==a;){const e=t.subarray(0,a);n&&0===e.length||r.push(e),a=(t=t.subarray(a+1)).indexOf(i)}return void(n&&0===t.length||r.push(t))}let i=0;for(let a=0;a<t.length+1;a++)if(a===t.length||-1!==e.indexOf(t[a])){const e=t.subarray(i,a);n&&0===e.length||r.push(e),i=a+1}}function ee(t,e,n){const r=t.length,a=[];let s=0,o=0;const l=new Array(r);for(let i=0;i<r;++i){const r=a.length;te(t[i],e,n,a);const u=a.length-r;l[i]=u,s+=u,o=Math.max(o,u)}const u=i.util.getArrayFromDType("int32",2*s),h=new Array(s),c=[r,o];let d=0;for(let t=0;t<r;++t)for(let e=0;e<l[t];++e)u[2*d]=t,u[2*d+1]=e,h[d]=a[d],++d;return[u,h,c]}function ne(t,e){const n=i.util.getArrayFromDType("int32",t.length);for(let r=0;r<t.length;++r)n[r]=i.util.fingerPrint64(t[r]).modulo(e).getLowBitsUnsigned();return n}const re=h(((t,e)=>t-e)),ie=_(((t,e,n,r)=>({real:t-n,imag:e-r}))),ae=w(i.Sub,re,ie),se={kernelName:i.Sub,backendName:"cpu",kernelFunc:ae};function oe(t,e){const n=new Array(t.rank);for(let r=0;r<n.length;r++)n[r]=t.shape[r]*e[r];const r=(0,i.buffer)(n,t.dtype);for(let e=0;e<r.values.length;++e){const n=r.indexToLoc(e),i=new Array(t.rank);for(let e=0;e<i.length;e++)i[e]=n[e]%t.shape[e];const a=t.locToIndex(i);r.values[e]=t.values[a]}return r}const le=(t,e)=>{const n=e.value-t.value;return 0===n?t.index-e.index:n};function ue(t,e,n=0,r=t.length-1){for(;r>n;){if(r-n>600){const i=r-n+1,a=e-n+1,s=Math.log(i),o=.5*Math.exp(2*s/3),l=.5*Math.sqrt(s*o*(i-o)/i)*Math.sign(a-i/2);ue(t,e,Math.max(n,Math.floor(e-a*o/i+l)),Math.min(r,Math.floor(e+(i-a)*o/i+l)))}const a=t[e];let s=n,o=r;for(i.util.swap(t,n,e),le(t[r],a)>0&&i.util.swap(t,n,r);s<o;){for(i.util.swap(t,s,o),s++,o--;le(t[s],a)<0;)s+=1;for(;le(t[o],a)>0;)o-=1}0===le(t[n],a)?i.util.swap(t,n,o):(o+=1,i.util.swap(t,o,r)),o<=e&&(n=o+1),e<=o&&(r=o-1)}}function he(t,e,n,r,a){const s=e[e.length-1],[o,l]=[t.length/s,s],u=i.util.getTypedArrayFromDType(n,o*r),h=i.util.getTypedArrayFromDType("int32",o*r);for(let e=0;e<o;e++){const n=e*l,i=t.subarray(n,n+l);let s=new Array(i.length);i.forEach(((t,e)=>s[e]={value:t,index:e})),r<s.length&&(ue(s,r),s=s.slice(0,r)),a&&s.sort(le);const o=e*r,c=u.subarray(o,o+r),d=h.subarray(o,o+r);for(let t=0;t<r;t++)c[t]=s[t].value,d[t]=s[t].index}const c=e.slice();return c[c.length-1]=r,[(0,i.buffer)(c,n,u),(0,i.buffer)(c,"int32",h)]}function ce(t,e,n,r){const a=i.util.parseAxisParam(e,n)[0],s=[1,n[0],1];for(let t=0;t<a;t++)s[0]*=n[t];s[1]=n[a];for(let t=a+1;t<n.length;t++)s[2]*=n[t];const o={},l=new Int32Array(n[a]),u=new i.TensorBuffer(s,r,t),h=[],c=1===s[0]&&1===s[2];for(let e=0;e<n[a];e++){let n;if(c)n=t[e].toString();else{const t=[];for(let n=0;n<s[0];n++)for(let r=0;r<s[2];r++)t.push(u.get(n,e,r));n=t.join(",")}if(void 0!==o[n])l[e]=o[n];else{const t=Object.keys(o).length;o[n]=t,l[e]=t,h.push(e)}}const d=s.slice();d[1]=Object.keys(o).length;const f=new i.TensorBuffer(d,r);h.forEach(((t,e)=>{for(let n=0;n<s[0];n++)for(let r=0;r<s[2];r++)f.set(u.get(n,t,r),n,e,r)}));const p=n.slice();return p[a]=d[1],{outputValues:f.values,outputShape:p,indices:l}}const de="3.12.0";(0,i.registerBackend)("cpu",(()=>new o),1);const fe=T(i.Elu,(t=>t>=0?t:Math.exp(t)-1)),pe={kernelName:i.Elu,backendName:"cpu",kernelFunc:fe};function me(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{alpha:o}=r;a([s],"leakyRelu");const l=i.util.sizeFromShape(s.shape),u=n.data.get(s.dataId).values,h=i.util.getTypedArrayFromDType("float32",l);for(let t=0;t<u.length;t++)h[t]=u[t]<0?o*u[t]:u[t];return n.makeTensorInfo(s.shape,"float32",h)}const ge={kernelName:i.LeakyRelu,backendName:"cpu",kernelFunc:me},be=h(((t,e)=>t<0?e*t:t));function ye(t){const{inputs:e,backend:n}=t,{x:r,alpha:i}=e;a([r,i],"prelu");const s=n.data.get(r.dataId).values,o=n.data.get(i.dataId).values,[l,u]=be(r.shape,i.shape,s,o,"float32");return n.makeTensorInfo(u,"float32",l)}const ve={kernelName:i.Prelu,backendName:"cpu",kernelFunc:ye},we=T(i.Relu,(t=>Math.max(0,t))),_e={kernelName:i.Relu,backendName:"cpu",kernelFunc:we},ke=T(i.Relu6,(t=>Math.min(Math.max(0,t),6))),xe={kernelName:i.Relu6,backendName:"cpu",kernelFunc:ke};function Se(t,e,n,r,i){if("linear"===n)return p({inputs:{x:e},backend:t});if("relu"===n)return we({inputs:{x:e},backend:t});if("elu"===n)return fe({inputs:{x:e},backend:t});if("relu6"===n)return ke({inputs:{x:e},backend:t});if("prelu"===n)return ye({inputs:{x:e,alpha:r},backend:t});if("leakyrelu"===n)return me({inputs:{x:e},backend:t,attrs:{alpha:i}});if("sigmoid"===n)return Ft({inputs:{x:e},backend:t});throw new Error(`Activation ${n} has not been implemented for the CPU backend.`)}function Ee(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{shape:s}=r,o=i.util.sizeFromShape(a.shape),l=i.util.inferFromImplicitShape(s,o),u=i.util.sizeFromShape(l);i.util.assert(o===u,(()=>`The new shape (${l}) has ${u} elements and the old shape (${a.shape}) has ${o} elements. The new shape and old shape must have the same number of elements.`)),n.incRef(a.dataId);const h=n.data.get(a.dataId);if(null!=h.complexTensorInfos){const t=h.complexTensorInfos.real,e=h.complexTensorInfos.imag;t.shape=l,e.shape=l}return{dataId:a.dataId,shape:l,dtype:a.dtype}}const Ie={kernelName:i.Reshape,backendName:"cpu",kernelFunc:Ee};function Ae(t){const{inputs:e,backend:n,attrs:r}=t,{a:s,b:o}=e,{transposeA:l,transposeB:u}=r;a([s,o],"matMul");const h=s.shape.length,c=o.shape.length,d=l?s.shape[h-2]:s.shape[h-1],f=u?o.shape[c-1]:o.shape[c-2],p=l?s.shape[h-1]:s.shape[h-2],m=u?o.shape[c-2]:o.shape[c-1],g=s.shape.slice(0,-2),b=o.shape.slice(0,-2),y=i.util.sizeFromShape(g),v=i.util.sizeFromShape(b),w=i.broadcast_util.assertAndGetBroadcastShape(s.shape.slice(0,-2),o.shape.slice(0,-2)).concat([p,m]);i.util.assert(d===f,(()=>`Error in matMul: inner shapes (${d}) and (${f}) of Tensors with shapes ${s.shape} and ${o.shape} and transposeA=${l} and transposeB=${u} must match.`));const _=u?[v,m,f]:[v,f,m],k=Ee({inputs:{x:s},backend:n,attrs:{shape:l?[y,d,p]:[y,p,d]}}),x=Ee({inputs:{x:o},backend:n,attrs:{shape:_}}),S=l?k.shape[1]:k.shape[2],E=l?k.shape[2]:k.shape[1],I=u?x.shape[1]:x.shape[2],A=Math.max(y,v),M=n.data.get(k.dataId).values,T=n.data.get(x.dataId).values,N=i.util.computeStrides(k.shape),C=i.util.computeStrides(x.shape),[R,O,D]=l?[N[0],1,N[1]]:[N[0],N[1],1],[z,B,F]=u?[1,C[1],C[0]]:[C[1],1,C[0]],P=E*I,L=(0,i.buffer)([A,E,I],k.dtype),$=L.values,U=n.blockSize;for(let t=0;t<A;t++)for(let e=0;e<E;e+=U)for(let n=0;n<I;n+=U)for(let r=0;r<S;r+=U){const i=Math.min(e+U,E),a=Math.min(n+U,I),s=Math.min(r+U,S);for(let o=e;o<i;o++)for(let e=n;e<a;e++){let n=0;for(let i=r;i<s;i++){const r=Math.min(t,y-1)*R,a=Math.min(t,v-1)*F;n+=M[r+o*O+i*D]*T[i*z+e*B+a]}$[t*P+(o*I+e)]+=n}}return n.disposeIntermediateTensorInfo(k),n.disposeIntermediateTensorInfo(x),n.makeTensorInfo(w,L.dtype,L.values)}const Me={kernelName:i.BatchMatMul,backendName:"cpu",kernelFunc:Ae},Te={kernelName:i._FusedMatMul,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{a:i,b:a,bias:s,preluActivationWeights:o}=e,{transposeA:l,transposeB:u,activation:h,leakyreluAlpha:c}=r;let d,f,p;const m=[];d=Ae({inputs:{a:i,b:a},attrs:{transposeA:l,transposeB:u},backend:n}),s&&(f=S({inputs:{a:d,b:s},backend:n}),m.push(d),d=f),h&&(p=Se(n,d,h,o,c),m.push(d),d=p);for(const t of m)n.disposeIntermediateTensorInfo(t);return d}},Ne=T(i.Acos,(t=>Math.acos(t))),Ce={kernelName:i.Acos,backendName:"cpu",kernelFunc:Ne},Re=T(i.Acosh,(t=>Math.acosh(t))),Oe={kernelName:i.Acosh,backendName:"cpu",kernelFunc:Re},De={kernelName:i.AddN,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n}=t,r=e;a(e,"addN");const s=r.map((t=>n.data.get(t.dataId).values)),o=(0,i.buffer)(r[0].shape,r[0].dtype),l=o.values;for(let t=0;t<r.length;t++){const e=s[t];for(let t=0;t<l.length;t++)l[t]+=e[t]}return n.makeTensorInfo(o.shape,o.dtype,o.values)}},ze={kernelName:i.All,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:o,keepDims:l}=r;a(s,"all");const u=i.util.parseAxisParam(o,s.shape);let h=u;const c=i.backend_util.getAxesPermutation(h,s.shape.length);let d=s;null!=c&&(d=Mt({inputs:{x:s},backend:n,attrs:{perm:c}}),h=i.backend_util.getInnerMostAxes(h.length,s.shape.length)),i.backend_util.assertAxesAreInnerMostDims("all",h,d.shape.length);const[f,p]=i.backend_util.computeOutAndReduceShapes(d.shape,h),m=i.util.sizeFromShape(p),g=i.util.makeZerosTypedArray(i.util.sizeFromShape(f),d.dtype),b=n.data.get(d.dataId).values;for(let t=0;t<g.length;++t){const e=t*m;let n=b[e];for(let t=0;t<m;++t){const r=b[e+t];n=n&&r}g[t]=n}null!=c&&n.disposeIntermediateTensorInfo(d);const y=n.makeTensorInfo(f,d.dtype,g);if(l){const t=Ee({inputs:{x:y},backend:n,attrs:{shape:i.backend_util.expandShapeToKeepDim(f,u)}});return n.disposeIntermediateTensorInfo(y),t}return y}},Be={kernelName:i.Any,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:o,keepDims:l}=r;a(s,"any");const u=i.util.parseAxisParam(o,s.shape);let h=u;const c=i.backend_util.getAxesPermutation(h,s.shape.length);let d=s;null!=c&&(d=Mt({inputs:{x:s},backend:n,attrs:{perm:c}}),h=i.backend_util.getInnerMostAxes(h.length,s.shape.length)),i.backend_util.assertAxesAreInnerMostDims("any",h,d.shape.length);const[f,p]=i.backend_util.computeOutAndReduceShapes(d.shape,h),m=i.util.sizeFromShape(p),g=i.util.makeZerosTypedArray(i.util.sizeFromShape(f),d.dtype),b=n.data.get(d.dataId).values;for(let t=0;t<g.length;++t){const e=t*m;let n=b[e];for(let t=0;t<m;++t){const r=b[e+t];n=n||r}g[t]=n}null!=c&&n.disposeIntermediateTensorInfo(d);const y=n.makeTensorInfo(f,d.dtype,g);if(l){const t=Ee({inputs:{x:y},backend:n,attrs:{shape:i.backend_util.expandShapeToKeepDim(f,u)}});return n.disposeIntermediateTensorInfo(y),t}return y}},Fe={kernelName:i.ArgMax,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:o}=r;a(s,"argMax");let l=i.util.parseAxisParam(o,s.shape);const u=i.backend_util.getAxesPermutation(l,s.shape.length);let h=s;const c=[];null!=u&&(h=Mt({inputs:{x:s},backend:n,attrs:{perm:u}}),c.push(h),l=i.backend_util.getInnerMostAxes(l.length,h.shape.length)),l=[l[0]],i.backend_util.assertAxesAreInnerMostDims("argMax",l,h.shape.length);const[d,f]=i.backend_util.computeOutAndReduceShapes(h.shape,l),p=i.util.sizeFromShape(d),m=i.util.makeZerosTypedArray(p,"int32"),g=i.util.sizeFromShape(f),b=n.data.get(h.dataId).values;for(let t=0;t<m.length;++t){const e=t*g;let n=b[e],r=0;for(let t=0;t<g;++t){const i=b[e+t];i>n&&(n=i,r=t)}m[t]=r}return c.forEach((t=>n.disposeIntermediateTensorInfo(t))),n.makeTensorInfo(d,"int32",m)}},Pe={kernelName:i.ArgMin,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:o}=r;a(s,"argMin");let l=i.util.parseAxisParam(o,s.shape);const u=i.backend_util.getAxesPermutation(l,s.shape.length);let h=s;const c=[];null!=u&&(h=Mt({inputs:{x:s},backend:n,attrs:{perm:u}}),c.push(h),l=i.backend_util.getInnerMostAxes(l.length,h.shape.length)),l=[l[0]],i.backend_util.assertAxesAreInnerMostDims("argMin",l,h.shape.length);const[d,f]=i.backend_util.computeOutAndReduceShapes(h.shape,l),p=i.util.sizeFromShape(d),m=i.util.makeZerosTypedArray(p,"int32"),g=i.util.sizeFromShape(f),b=n.data.get(h.dataId).values;for(let t=0;t<m.length;++t){const e=t*g;let n=b[e],r=0;for(let t=0;t<g;++t){const i=b[e+t];i<n&&(n=i,r=t)}m[t]=r}return c.forEach((t=>n.disposeIntermediateTensorInfo(t))),n.makeTensorInfo(d,"int32",m)}},Le=T(i.Asin,(t=>Math.asin(t))),$e={kernelName:i.Asin,backendName:"cpu",kernelFunc:Le},Ue=T(i.Asinh,(t=>Math.asinh(t))),je={kernelName:i.Asinh,backendName:"cpu",kernelFunc:Ue},We=T(i.Atan,(t=>Math.atan(t))),Ge={kernelName:i.Atan,backendName:"cpu",kernelFunc:We},He=h(((t,e)=>Math.atan2(t,e))),Ve=w(i.Atan2,He),qe={kernelName:i.Atan2,backendName:"cpu",kernelFunc:Ve},Ke=T(i.Atanh,(t=>Math.atanh(t))),Ze={kernelName:i.Atanh,backendName:"cpu",kernelFunc:Ke};function Xe(t,e,n,r,a,s){const o=a.strideHeight,l=a.strideWidth,u=a.dilationHeight,h=a.dilationWidth,c=a.effectiveFilterHeight,d=a.effectiveFilterWidth,f=a.padInfo.top,p=a.padInfo.left,m="max"===s?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,g=(0,i.buffer)(a.outShape,n),b=g.values,y=a.outShape[1]*a.outShape[2]*a.outShape[3],v=a.outShape[2]*a.outShape[3],w=a.outShape[3];for(let e=0;e<a.batchSize;++e){const n=e*y,i=e*r[0];for(let e=0;e<a.inChannels;++e)for(let g=0;g<a.outHeight;++g){const y=g*o-f,_=Math.max(0,y),k=Math.min(a.inHeight,c+y),x=n+g*v;for(let n=0;n<a.outWidth;++n){const o=n*l-p,c=Math.max(0,o),f=Math.min(a.inWidth,d+o);let g=m,y=0,v=0;for(let n=_;n<k;n+=u){const a=i+n*r[1];for(let n=c;n<f;n+=h){const i=t[a+n*r[2]+e];"max"===s&&i>g?g=i:"avg"===s&&(y+=i,v++)}if(isNaN(g))break}b[x+n*w+e]="avg"===s?y/v:g}}}return g}function Je(t,e,n,r,a=!1,s=!1){const o=(0,i.buffer)(r.outShape,"int32"),l=r.strideHeight,u=r.strideWidth,h=r.dilationHeight,c=r.dilationWidth,d=r.effectiveFilterHeight,f=r.effectiveFilterWidth,p=r.padInfo.top,m=r.padInfo.left,g=(0,i.buffer)(e,n,t);for(let t=0;t<r.batchSize;++t)for(let e=0;e<r.inChannels;++e)for(let n=0;n<r.outHeight;++n){const i=n*l-p;let b=i;for(;b<0;)b+=h;const y=Math.min(r.inHeight,d+i);for(let l=0;l<r.outWidth;++l){const d=l*u-m;let p=d;for(;p<0;)p+=c;const v=Math.min(r.inWidth,f+d);let w=Number.NEGATIVE_INFINITY,_=-1;for(let n=b;n<y;n+=h){const o=n-i;for(let i=p;i<v;i+=c){const l=i-d,u=g.get(t,n,i,e);u>w&&(w=u,_=a?s?((t*r.inHeight+n)*r.inWidth+i)*r.inChannels+e:(n*r.inWidth+i)*r.inChannels+e:o*f+l)}}o.set(_,t,n,l,e)}}return o}function Ye(t,e,n,r,a,s){const o=a.strideDepth,l=a.strideHeight,u=a.strideWidth,h=a.dilationDepth,c=a.dilationHeight,d=a.dilationWidth,f=a.effectiveFilterDepth,p=a.effectiveFilterHeight,m=a.effectiveFilterWidth,g=a.padInfo.front,b=a.padInfo.top,y=a.padInfo.left,v="max"===s?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,w=(0,i.buffer)(a.outShape,n),_=w.values,k=a.outShape[1]*a.outShape[2]*a.outShape[3]*a.outShape[4],x=a.outShape[2]*a.outShape[3]*a.outShape[4],S=a.outShape[3]*a.outShape[4],E=a.outShape[4];for(let e=0;e<a.batchSize;++e){const n=e*k,i=e*r[0];for(let e=0;e<a.inChannels;++e)for(let w=0;w<a.outDepth;++w){const k=w*o-g;let I=k;for(;I<0;)I+=h;const A=Math.min(a.inDepth,f+k),M=n+w*x;for(let n=0;n<a.outHeight;++n){const o=n*l-b;let f=o;for(;f<0;)f+=c;const g=Math.min(a.inHeight,p+o),w=M+n*S;for(let n=0;n<a.outWidth;++n){const o=n*u-y;let l=o;for(;l<0;)l+=d;const p=Math.min(a.inWidth,m+o),b=w+n*E;let k=v,x=0,S=0;for(let n=I;n<A;n+=h){const a=i+n*r[1];for(let n=f;n<g;n+=c){const i=a+n*r[2];for(let n=l;n<p;n+=d){const a=t[i+n*r[3]+e];if("max"===s&&a>k?k=a:"avg"===s&&(x+=a,S++),isNaN(k))break}if(isNaN(k))break}if(isNaN(k))break}_[b+e]="avg"===s?x/S:k}}}}return w}const Qe={kernelName:i.AvgPool,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e;a(s,"avgPool");const{filterSize:o,strides:l,pad:u,dimRoundingMode:h}=r;i.util.assert(i.backend_util.eitherStridesOrDilationsAreOne(l,1),(()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${l} and dilations '1'`));const c=i.backend_util.computePool2DInfo(s.shape,o,l,1,u,h);let d;if(1===c.filterWidth&&1===c.filterHeight&&i.util.arraysEqual(c.inShape,c.outShape))d=p({inputs:{x:s},backend:n});else{const t=n.data.get(s.dataId).values,e=i.util.computeStrides(s.shape),r=Xe(t,s.shape,s.dtype,e,c,"avg");d=n.makeTensorInfo(c.outShape,s.dtype,r.values)}return d}},tn={kernelName:i.AvgPool3D,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{filterSize:o,strides:l,pad:u,dimRoundingMode:h,dataFormat:c}=r;a(s,"avgPool3d");const d=i.backend_util.computePool3DInfo(s.shape,o,l,1,u,h,c),f=Ye(n.data.get(s.dataId).values,s.shape,s.dtype,i.util.computeStrides(s.shape),d,"avg");return n.makeTensorInfo(f.shape,"float32",f.values)}},en={kernelName:i.AvgPool3DGrad,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:o}=e,{filterSize:l,strides:u,pad:h,dimRoundingMode:c}=r;a([s,o],"avgPool3DGrad");const d=i.backend_util.computePool3DInfo(o.shape,l,u,1,h,c),f=d.strideDepth,p=d.strideHeight,m=d.strideWidth,g=d.filterDepth,b=d.filterHeight,y=d.filterWidth,v=d.dilationDepth,w=d.dilationHeight,_=d.dilationWidth,k=d.effectiveFilterDepth,x=d.effectiveFilterHeight,S=d.effectiveFilterWidth,E=k-1-d.padInfo.front,I=S-1-d.padInfo.left,A=x-1-d.padInfo.top,M=(0,i.buffer)(o.shape,"float32"),T=1/(g*b*y),N=n.bufferSync(s);for(let t=0;t<d.batchSize;++t)for(let e=0;e<d.inChannels;++e)for(let n=0;n<d.inDepth;++n)for(let r=0;r<d.inHeight;++r)for(let i=0;i<d.inWidth;++i){const a=n-E,s=r-A,o=i-I;let l=0;for(let n=0;n<k;n+=v){const r=(a+n)/f;if(!(r<0||r>=d.outDepth||Math.floor(r)!==r))for(let n=0;n<x;n+=w){const i=(s+n)/p;if(!(i<0||i>=d.outHeight||Math.floor(i)!==i))for(let n=0;n<S;n+=_){const a=(o+n)/m;a<0||a>=d.outWidth||Math.floor(a)!==a||(l+=N.get(t,r,i,a,e))}}}M.set(l*T,t,n,r,i,e)}return n.makeTensorInfo(M.shape,M.dtype,M.values)}},nn={kernelName:i.AvgPoolGrad,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:o}=e,l=o;a([s,o],"avgPoolGrad");const{filterSize:u,strides:h,pad:c}=r,d=i.backend_util.computePool2DInfo(l.shape,u,h,1,c),f=d.strideHeight,p=d.strideWidth,m=d.filterHeight,g=d.filterWidth,b=d.dilationHeight,y=d.dilationWidth,v=d.effectiveFilterHeight,w=d.effectiveFilterWidth,_=w-1-d.padInfo.left,k=v-1-d.padInfo.top,x=(0,i.buffer)(l.shape,"float32"),S=1/(m*g),E=n.data.get(s.dataId).values,I=(0,i.buffer)(s.shape,"float32",E);for(let t=0;t<d.batchSize;++t)for(let e=0;e<d.inChannels;++e)for(let n=0;n<d.inHeight;++n)for(let r=0;r<d.inWidth;++r){const i=n-k,a=r-_;let s=0;for(let n=0;n<v;n+=b){const r=(i+n)/f;if(!(r<0||r>=d.outHeight||Math.floor(r)!==r))for(let n=0;n<w;n+=y){const i=(a+n)/p;i<0||i>=d.outWidth||Math.floor(i)!==i||(s+=I.get(t,r,i,e))}}x.set(s*S,t,n,r,e)}return n.makeTensorInfo(x.shape,x.dtype,x.values)}},rn={kernelName:i.FusedBatchNorm,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,scale:o,offset:l,mean:u,variance:h}=e;i.util.assert(u.shape.length===h.shape.length,(()=>"Batch normalization gradient requires mean and variance to have equal ranks.")),i.util.assert(null==l||u.shape.length===l.shape.length,(()=>"Batch normalization gradient requires mean and offset to have equal ranks.")),i.util.assert(null==o||u.shape.length===o.shape.length,(()=>"Batch normalization gradient requires mean and scale to have equal ranks.")),a([s,u,h,o,l],"batchNorm");let{varianceEpsilon:c}=r;null==c&&(c=.001);const d=n.data.get(s.dataId).values,f=n.data.get(u.dataId).values,p=n.data.get(h.dataId).values,m=o?n.data.get(o.dataId).values:new Float32Array([1]),g=l?n.data.get(l.dataId).values:new Float32Array([0]),b=new Float32Array(d.length),y=g.length,v=m.length,w=p.length,_=f.length;let k=0,x=0,S=0,E=0;for(let t=0;t<d.length;++t)b[t]=g[k++]+(d[t]-f[x++])*m[S++]/Math.sqrt(p[E++]+c),k>=y&&(k=0),x>=_&&(x=0),S>=v&&(S=0),E>=w&&(E=0);return n.makeTensorInfo(s.shape,s.dtype,b)}},an={kernelName:i.BatchToSpaceND,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{blockShape:o,crops:l}=r;a([s],"batchToSpaceND");const u=o.reduce(((t,e)=>t*e)),h=i.backend_util.getReshaped(s.shape,o,u),c=i.backend_util.getPermuted(h.length,o.length),d=i.backend_util.getReshapedPermuted(s.shape,o,u),f=i.backend_util.getSliceBeginCoords(l,o.length),p=i.backend_util.getSliceSize(d,l,o.length),m=Ee({inputs:{x:s},backend:n,attrs:{shape:h}}),g=Mt({inputs:{x:m},backend:n,attrs:{perm:c}}),b=Ee({inputs:{x:g},backend:n,attrs:{shape:d}}),y=$t({inputs:{x:b},backend:n,attrs:{begin:f,size:p}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(b),y}},sn={kernelName:i.Bincount,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,weights:a}=e,{size:s}=r,o=I(n.data.get(i.dataId).values,n.data.get(a.dataId).values,a.dtype,a.shape,s);return n.makeTensorInfo([s],a.dtype,o)}},on={kernelName:i.BroadcastArgs,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n}=t,{s0:r,s1:a}=e,s=n.data.get(r.dataId).values,o=n.data.get(a.dataId).values,l=i.backend_util.assertAndGetBroadcastShape(Array.from(s),Array.from(o));return n.makeTensorInfo([l.length],"int32",Int32Array.from(l))}},ln=T(i.ClipByValue,((t,e)=>{const n=e;return t>n.clipValueMax?n.clipValueMax:t<n.clipValueMin?n.clipValueMin:t})),un={kernelName:i.ClipByValue,backendName:"cpu",kernelFunc:ln},hn={kernelName:i.ComplexAbs,backendName:"cpu",kernelFunc:t=>{const{x:e}=t.inputs,n=t.backend,r=new Float32Array(i.util.sizeFromShape(e.shape)),a=n.data.get(e.dataId),s=a.complexTensorInfos.real,o=a.complexTensorInfos.imag,l=n.data.get(s.dataId).values,u=n.data.get(o.dataId).values;for(let t=0;t<l.length;t++){const e=l[t],n=u[t];r[t]=Math.hypot(e,n)}return n.makeOutput(r,e.shape,"float32")}};function cn(t){const{inputs:e,backend:n}=t,{input:r}=e,i=n.data.get(r.dataId).complexTensorInfos.imag,a=n.data.get(i.dataId).values;return n.makeTensorInfo(i.shape,i.dtype,a)}const dn={kernelName:i.Imag,backendName:"cpu",kernelFunc:cn};function fn(t){const{inputs:e,backend:n,attrs:r}=t,{axis:a}=r,s=i.util.parseAxisParam(a,e[0].shape)[0];let o=i.backend_util.computeOutShape(e.map((t=>t.shape)),s);if(0===i.util.sizeFromShape(o))return n.makeTensorInfo(o,e[0].dtype,[]);const l=e.filter((t=>i.util.sizeFromShape(t.shape)>0));if(1===l.length)return p({inputs:{x:l[0]},backend:n});const u=l.map((t=>t.shape));if(i.backend_util.assertParamsConsistent(u,s),"complex64"===l[0].dtype){const t=l.map((t=>g({inputs:{input:t},backend:n}))),e=l.map((t=>cn({inputs:{input:t},backend:n}))),r=fn({inputs:t,backend:n,attrs:{axis:s}}),i=fn({inputs:e,backend:n,attrs:{axis:s}}),a=c({inputs:{real:r,imag:i},backend:n});return t.forEach((t=>n.disposeIntermediateTensorInfo(t))),e.forEach((t=>n.disposeIntermediateTensorInfo(t))),n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(i),a}const h=l.map((t=>{const e=i.util.sizeFromShape(t.shape.slice(s));return Ee({inputs:{x:t},backend:n,attrs:{shape:[-1,e]}})})),d=h.map((t=>({vals:n.data.get(t.dataId).values,shape:t.shape})));o=i.backend_util.computeOutShape(h.map((t=>t.shape)),1);const f=1===h[0].shape[0],m=D(d,o,e[0].dtype,f),b=i.backend_util.computeOutShape(l.map((t=>t.shape)),s),y=n.makeTensorInfo(b,e[0].dtype,m);return h.forEach((t=>n.disposeIntermediateTensorInfo(t))),y}const pn={kernelName:i.Concat,backendName:"cpu",kernelFunc:fn};function mn(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:o}=e,{strides:l,pad:u,dataFormat:h,dilations:c,dimRoundingMode:d}=r;a([s,o],"conv2d");const f=i.backend_util.convertConv2DDataFormat(h),p=i.backend_util.computeConv2DInfo(s.shape,o.shape,l,c,u,d,!1,f),m=p.filterHeight,g=p.filterWidth,b=p.dilationHeight,y=p.dilationWidth,v=p.padInfo.left,w=p.padInfo.top,_="channelsLast"===p.dataFormat,k=new i.TensorBuffer(p.outShape,s.dtype),x=i.util.computeStrides(s.shape),S=i.util.computeStrides(o.shape),E=x[0],I=_?x[1]:x[2],A=_?x[2]:1,M=_?1:x[1],T=k.strides[0],N=_?k.strides[1]:k.strides[2],C=_?k.strides[2]:1,R=_?1:k.strides[1],O=n.data.get(s.dataId).values,D=n.data.get(o.dataId).values,z=k.values;for(let t=0;t<p.batchSize;++t){const e=t*E,n=t*T;for(let t=0;t<p.outHeight;++t){const r=n+t*N,i=t*p.strideHeight-w;for(let t=0;t<m;++t){const n=i+t*b;if(n<0||n>=p.inHeight)continue;const a=t*S[0],s=e+n*I;for(let t=0;t<p.outWidth;++t){const e=r+t*C,n=t*p.strideWidth-v;for(let t=0;t<g;++t){const r=n+t*y;if(r<0||r>=p.inWidth)continue;const i=s+r*A;let o=a+t*S[1];for(let t=0;t<p.inChannels;++t){const n=O[i+t*M];for(let t=0;t<p.outChannels;++t)z[e+t*R]+=n*D[o+t];o+=p.outChannels}}}}}}return n.makeTensorInfo(k.shape,k.dtype,z)}const gn={kernelName:i.Conv2D,backendName:"cpu",kernelFunc:mn},bn={kernelName:i.Conv2DBackpropFilter,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,dy:o}=e,{strides:l,pad:u,dataFormat:h,dimRoundingMode:c,filterShape:d}=r;a([s,o],"conv2dBackpropFilter");const f=i.backend_util.convertConv2DDataFormat(h),p=i.backend_util.computeConv2DInfo(s.shape,d,l,1,u,c,!1,f),{strideHeight:m,strideWidth:g,filterHeight:b,filterWidth:y}=p,v="channelsLast"===p.dataFormat,w=new i.TensorBuffer(p.filterShape,"float32"),_=p.padInfo.left,k=p.padInfo.top,x=n.data.get(s.dataId).values,S=n.data.get(o.dataId).values,E=new i.TensorBuffer(s.shape,s.dtype,x),I=new i.TensorBuffer(o.shape,o.dtype,S);for(let t=0;t<b;++t){const e=Math.max(0,Math.ceil((k-t)/m)),n=Math.min(p.outHeight,(p.inHeight+k-t)/m);for(let r=0;r<y;++r){const i=Math.max(0,Math.ceil((_-r)/g)),a=Math.min(p.outWidth,(p.inWidth+_-r)/g);for(let s=0;s<p.inChannels;++s)for(let o=0;o<p.outChannels;++o){let l=0;for(let u=0;u<p.batchSize;++u)for(let h=e;h<n;++h){const e=t+h*m-k;for(let t=i;t<a;++t){const n=r+t*g-_;l+=v?E.get(u,e,n,s)*I.get(u,h,t,o):E.get(u,s,e,n)*I.get(u,o,h,t)}}w.set(l,t,r,s,o)}}}return n.makeTensorInfo(w.shape,w.dtype,w.values)}},yn={kernelName:i.Conv2DBackpropInput,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,filter:o}=e,{inputShape:l,strides:u,pad:h,dataFormat:c,dimRoundingMode:d}=r;a([s,o],"conv2dBackpropInput");const f=i.util.computeStrides(o.shape),p=i.util.computeStrides(s.shape);let m=i.backend_util.convertConv2DDataFormat(c);const g=i.backend_util.computeConv2DInfo(l,o.shape,u,1,h,d,!1,m),b=new i.TensorBuffer(g.inShape,"float32"),y=b.values,v=n.data.get(s.dataId).values,w=n.data.get(o.dataId).values,[_,k,x]=f,{batchSize:S,filterHeight:E,filterWidth:I,inChannels:A,inHeight:M,inWidth:T,outChannels:N,outHeight:C,outWidth:R,strideHeight:O,strideWidth:D}=g;m=g.dataFormat;const z=E-1-g.padInfo.top,B=I-1-g.padInfo.left,F="channelsLast"===m,P=b.strides[0],L=F?b.strides[1]:b.strides[2],$=F?b.strides[2]:1,U=F?1:b.strides[1],j=p[0],W=F?p[1]:p[2],G=F?p[2]:1,H=F?1:p[1];for(let t=0;t<S;++t)for(let e=0;e<A;++e)for(let n=0;n<M;++n){const r=n-z,i=Math.max(0,Math.ceil(r/O)),a=Math.min(C,(E+r)/O);for(let s=0;s<T;++s){const o=s-B,l=Math.max(0,Math.ceil(o/D)),u=Math.min(R,(I+o)/D);let h=0;for(let n=i;n<a;++n){const i=n*O-r;for(let r=l;r<u;++r){const a=j*t+W*n+G*r,s=_*(E-1-i)+k*(I-1-(r*D-o))+x*e;for(let t=0;t<N;++t)h+=v[a+H*t]*w[s+t]}}y[P*t+L*n+$*s+U*e]=h}}return n.makeTensorInfo(b.shape,b.dtype,b.values)}},vn={kernelName:i.Conv3D,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:o}=e,{strides:l,pad:u,dilations:h}=r;a([s,o],"conv3d");const c=i.backend_util.computeConv3DInfo(s.shape,o.shape,l,h,u),{filterDepth:d,filterHeight:f,filterWidth:p,dilationDepth:m,dilationHeight:g,dilationWidth:b,padInfo:y}=c,v=y.front,w=y.left,_=y.top,k=new i.TensorBuffer(c.outShape,s.dtype),x=n.data.get(s.dataId).values,S=n.data.get(o.dataId).values,E=k.values,I=i.util.computeStrides(s.shape),A=i.util.computeStrides(o.shape);for(let t=0;t<c.batchSize;++t){const e=t*I[0],n=t*k.strides[0];for(let t=0;t<c.outDepth;++t){const r=n+t*k.strides[1],i=t*c.strideDepth-v;for(let t=0;t<d;++t){const n=i+t*m;if(n<0||n>=c.inDepth)continue;const a=t*A[0],s=e+n*I[1];for(let t=0;t<c.outHeight;++t){const e=r+t*k.strides[2],n=t*c.strideHeight-_;for(let t=0;t<f;++t){const r=n+t*g;if(r<0||r>=c.inHeight)continue;const i=a+t*A[1],o=s+r*I[2];for(let t=0;t<c.outWidth;++t){const n=e+t*c.outChannels,r=t*c.strideWidth-w;for(let t=0;t<p;++t){const e=r+t*b;if(e<0||e>=c.inWidth)continue;const a=i+t*A[2],s=o+e*c.inChannels;let l=a;for(let t=0;t<c.inChannels;++t){const e=x[s+t];for(let t=0;t<c.outChannels;++t)E[n+t]+=e*S[l+t];l+=c.outChannels}}}}}}}}return n.makeTensorInfo(k.shape,k.dtype,k.values)}},wn={kernelName:i.Conv3DBackpropFilterV2,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,dy:o}=e,{strides:l,pad:u,filterShape:h}=r;a([s,o],"conv3dBackpropFilterV2");const c=i.util.computeStrides(s.shape),d=i.util.computeStrides(o.shape),f=i.backend_util.computeConv3DInfo(s.shape,h,l,1,u),p=f.strideDepth,m=f.strideHeight,g=f.strideWidth,b=f.filterDepth,y=f.filterHeight,v=f.filterWidth,w=new i.TensorBuffer(f.filterShape,"float32"),_=w.values,[k,x,S,E]=w.strides,I=n.data.get(o.dataId).values,[A,M,T,N]=d,C=n.data.get(s.dataId).values,[R,O,D,z]=c,B=f.padInfo.front,F=f.padInfo.left,P=f.padInfo.top;for(let t=0;t<b;++t){const e=Math.max(0,Math.ceil((B-t)/p)),n=Math.min(f.outDepth,(f.inDepth+B-t)/p),r=t*k;for(let i=0;i<y;++i){const a=Math.max(0,Math.ceil((P-i)/m)),s=Math.min(f.outHeight,(f.inHeight+P-i)/m),o=i*x+r;for(let r=0;r<v;++r){const l=Math.max(0,Math.ceil((F-r)/g)),u=Math.min(f.outWidth,(f.inWidth+F-r)/g),h=r*S+o;for(let o=0;o<f.inChannels;++o){const c=o*E+h;for(let h=0;h<f.outChannels;++h){let d=0;for(let c=0;c<f.batchSize;++c){const f=c*R,b=c*A;for(let c=e;c<n;++c){const e=(t+c*p-B)*O+f,n=c*M+b;for(let t=a;t<s;++t){const a=(i+t*m-P)*D+e,s=t*T+n;for(let t=l;t<u;++t){const e=t*N+s;d+=C[(r+t*g-F)*z+a+o]*I[e+h]}}}}_[c+h]=d}}}}}return n.makeTensorInfo(w.shape,w.dtype,w.values)}},_n={kernelName:i.Conv3DBackpropInputV2,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,filter:o}=e,{pad:l,strides:u,inputShape:h}=r;a([s],"conv3dBackpropInputV2");const c=i.util.computeStrides(s.shape),d=i.util.computeStrides(o.shape),f=i.backend_util.computeConv3DInfo(h,o.shape,u,1,l),p=new i.TensorBuffer(f.inShape,"float32"),m=p.values,[g,b,y,v]=p.strides,w=n.data.get(s.dataId).values,[_,k,x,S]=c,E=n.data.get(o.dataId).values,[I,A,M,T]=d,{batchSize:N,filterDepth:C,filterHeight:R,filterWidth:O,inChannels:D,inDepth:z,inHeight:B,inWidth:F,outChannels:P,outDepth:L,outHeight:$,outWidth:U,strideDepth:j,strideHeight:W,strideWidth:G}=f,H=C-1-f.padInfo.front,V=R-1-f.padInfo.top,q=O-1-f.padInfo.left;for(let t=0;t<N;++t)for(let e=0;e<D;++e)for(let n=0;n<z;++n){const r=n-H,i=Math.max(0,Math.ceil(r/j)),a=Math.min(L,(C+r)/j);for(let s=0;s<B;++s){const o=s-V,l=Math.max(0,Math.ceil(o/W)),u=Math.min($,(R+o)/W);for(let h=0;h<F;++h){const c=h-q,d=Math.max(0,Math.ceil(c/G)),f=Math.min(U,(O+c)/G);let p=0;for(let n=i;n<a;++n){const i=n*j-r;for(let r=l;r<u;++r){const a=r*W-o;for(let s=d;s<f;++s){const o=_*t+k*n+x*r+S*s,l=I*(C-1-i)+A*(R-1-a)+M*(O-1-(s*G-c))+T*e;for(let t=0;t<P;++t)p+=w[o+t]*E[l+t]}}}m[g*t+b*n+y*s+v*h+e]=p}}}return n.makeTensorInfo(p.shape,p.dtype,p.values)}},kn=T(i.Cos,(t=>Math.cos(t))),xn={kernelName:i.Cos,backendName:"cpu",kernelFunc:kn},Sn=T(i.Cosh,(t=>Math.cosh(t))),En={kernelName:i.Cosh,backendName:"cpu",kernelFunc:Sn},In={kernelName:i.CropAndResize,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{image:a,boxes:s,boxInd:o}=e,{cropSize:l,method:u,extrapolationValue:h}=r,[c,d,f,p]=a.shape,m=s.shape[0],[g,b]=l,y=(0,i.buffer)([m,g,b,p],"float32"),v=n.data.get(s.dataId).values,w=n.data.get(o.dataId).values,_=n.data.get(a.dataId).values,k=i.util.computeStrides(a.shape),x=i.util.computeStrides(y.shape);for(let t=0;t<m;t++){const e=4*t,n=v[e],r=v[e+1],i=v[e+2],a=v[e+3],s=w[t];if(s>=c)continue;const o=g>1?(i-n)*(d-1)/(g-1):0,l=b>1?(a-r)*(f-1)/(b-1):0;for(let e=0;e<g;e++){const c=g>1?n*(d-1)+e*o:.5*(n+i)*(d-1);if(c<0||c>d-1)for(let n=0;n<b;n++)for(let r=0;r<p;r++){const i=r+n*x[2]+e*x[1]+t*x[0];y.values[i]=h}else if("bilinear"===u){const n=Math.floor(c),i=Math.ceil(c),o=c-n;for(let u=0;u<b;u++){const c=b>1?r*(f-1)+u*l:.5*(r+a)*(f-1);if(c<0||c>f-1){for(let n=0;n<p;n++){const r=n+u*x[2]+e*x[1]+t*x[0];y.values[r]=h}continue}const d=Math.floor(c),m=Math.ceil(c),g=c-d;for(let r=0;r<p;r++){let a=r+d*k[2]+n*k[1]+s*k[0];const l=_[a];a=r+m*k[2]+n*k[1]+s*k[0];const h=_[a];a=r+d*k[2]+i*k[1]+s*k[0];const c=_[a];a=r+m*k[2]+i*k[1]+s*k[0];const f=l+(h-l)*g,p=c+(_[a]-c)*g;a=r+u*x[2]+e*x[1]+t*x[0],y.values[a]=f+(p-f)*o}}}else for(let n=0;n<b;++n){const i=b>1?r*(f-1)+n*l:.5*(r+a)*(f-1);if(i<0||i>f-1){for(let r=0;r<p;r++){const i=r+n*x[2]+e*x[1]+t*x[0];y.values[i]=h}continue}const o=Math.round(i),u=Math.round(c);for(let r=0;r<p;r++){const i=r+o*k[2]+u*k[1]+s*k[0],a=r+n*x[2]+e*x[1]+t*x[0];y.values[a]=_[i]}}}}return n.makeTensorInfo(y.shape,y.dtype,y.values)}},An={kernelName:i.Cumsum,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:o,exclusive:l,reverse:u}=r;a(s,"cumsum");const h=i.backend_util.getAxesPermutation([o],s.shape.length);let c=s;null!=h&&(c=Mt({inputs:{x:s},backend:n,attrs:{perm:h}}));const d=i.backend_util.getInnerMostAxes(1,s.shape.length)[0];if(d!==c.shape.length-1)throw new Error(`backend.cumsum in CPU expects an inner-most axis=${c.shape.length-1} but got axis=${d}`);const f=(0,i.upcastType)(c.dtype,"int32"),p=i.util.makeZerosTypedArray(i.util.sizeFromShape(c.shape),f),m=n.data.get(c.dataId).values,g=c.shape[c.shape.length-1],b=u?(t,e)=>t+g-e-1:(t,e)=>t+e;for(let t=0;t<m.length;t+=g)for(let e=0;e<g;e++){const n=b(t,e);if(0===e)p[n]=l?0:m[n];else{const r=b(t,e-1);p[n]=l?m[r]+p[r]:m[n]+p[r]}}const y=n.makeTensorInfo(c.shape,f,p);if(null!=h){const t=Mt({inputs:{x:y},backend:n,attrs:{perm:i.backend_util.getUndoAxesPermutation(h)}});return n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(c),t}return y}},Mn={kernelName:i.DenseBincount,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,weights:a}=e,{size:s,binaryOutput:o}=r;if(1===i.shape.length){const t=I(n.data.get(i.dataId).values,n.data.get(a.dataId).values,a.dtype,a.shape,s);return n.makeTensorInfo([s],a.dtype,t)}if(2===i.shape.length){const t=A(n.bufferSync(i),n.bufferSync(a),s,o);return n.makeTensorInfo(t.shape,a.dtype,t.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${i.shape.length}.`)}},Tn={kernelName:i.DepthToSpace,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{blockSize:s,dataFormat:o}=r;i.util.assert("NHWC"===o,(()=>`Only NHWC dataFormat supported on CPU for depthToSpace. Got ${o}`));const l=a.shape[0],u=a.shape[1],h=a.shape[2],c=a.shape[3],d=u*s,f=h*s,p=c/(s*s),m=n.data.get(a.dataId).values,g=new Float32Array(l*d*f*p);let b=0;for(let t=0;t<l;++t)for(let e=0;e<d;++e){const n=Math.floor(e/s),r=e%s;for(let e=0;e<f;++e){const i=Math.floor(e/s),a=(r*s+e%s)*p;for(let e=0;e<p;++e){const r=e+a+c*(i+h*(n+u*t));g[b++]=m[r]}}}return n.makeTensorInfo([l,d,f,p],a.dtype,g)}};function Nn(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:o}=e,{strides:l,pad:u,dilations:h,dimRoundingMode:c}=r;a([s,o],"depthwiseConv2DNative");const d=i.util.computeStrides(s.shape),f=i.util.computeStrides(o.shape);let p=h;null==p&&(p=[1,1]),i.util.assert(i.backend_util.eitherStridesOrDilationsAreOne(l,p),(()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${l} and dilations '${p}'`));const m=i.backend_util.computeConv2DInfo(s.shape,o.shape,l,p,u,c,!0),{filterHeight:g,filterWidth:b,dilationHeight:y,dilationWidth:v,padInfo:w}=m,_=w.left,k=w.top,x=m.outChannels/m.inChannels,S=new i.TensorBuffer(m.outShape,s.dtype),E=n.data.get(s.dataId).values,I=n.data.get(o.dataId).values,A=S.values;for(let t=0;t<m.batchSize;++t){const e=t*d[0],n=t*S.strides[0];for(let t=0;t<m.outHeight;++t){const r=n+t*S.strides[1],i=t*m.strideHeight-k;for(let t=0;t<g;++t){const n=i+t*y;if(n<0||n>=m.inHeight)continue;const a=t*f[0],s=e+n*d[1];for(let t=0;t<m.outWidth;++t){const e=r+t*S.strides[2],n=t*m.strideWidth-_;for(let t=0;t<b;++t){const r=n+t*v;if(r<0||r>=m.inWidth)continue;const i=a+t*f[1],o=s+r*m.inChannels;let l=e,u=i;for(let t=0;t<m.inChannels;++t){const e=E[o+t];for(let t=0;t<x;++t)A[l+t]+=e*I[u+t];l+=x,u+=x}}}}}}return n.makeTensorInfo(S.shape,S.dtype,S.values)}const Cn={kernelName:i.DepthwiseConv2dNative,backendName:"cpu",kernelFunc:Nn},Rn={kernelName:i.DepthwiseConv2dNativeBackpropFilter,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,dy:o}=e,{strides:l,dilations:u,pad:h,dimRoundingMode:c,filterShape:d}=r;a([s,o],"depthwiseConv2dNativeBackpropFilter");const f=i.backend_util.computeConv2DInfo(s.shape,d,l,u,h,c,!0),{strideHeight:p,strideWidth:m,filterHeight:g,filterWidth:b}=f,y=new i.TensorBuffer(f.filterShape,"float32"),v=f.padInfo.left,w=f.padInfo.top,_=f.outChannels/f.inChannels,k=n.data.get(s.dataId).values,x=new i.TensorBuffer(s.shape,s.dtype,k),S=n.data.get(o.dataId).values,E=new i.TensorBuffer(o.shape,o.dtype,S);for(let t=0;t<g;++t){const e=Math.max(0,Math.ceil((w-t)/p)),n=Math.min(f.outHeight,(f.inHeight+w-t)/p);for(let r=0;r<b;++r){const i=Math.max(0,Math.ceil((v-r)/m)),a=Math.min(f.outWidth,(f.inWidth+v-r)/m);for(let s=0;s<f.outChannels;++s){const o=Math.trunc(s/_),l=s%_;let u=0;for(let l=0;l<f.batchSize;++l)for(let h=e;h<n;++h){const e=t+h*p-w;for(let t=i;t<a;++t){const n=r+t*m-v;u+=x.get(l,e,n,o)*E.get(l,h,t,s)}}y.set(u,t,r,o,l)}}}return n.makeTensorInfo(y.shape,y.dtype,y.values)}},On={kernelName:i.DepthwiseConv2dNativeBackpropInput,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,filter:o}=e,{strides:l,dilations:u,pad:h,dimRoundingMode:c,inputShape:d}=r;a([s,o],"depthwiseConv2DNativeBackpropInput");const f=i.util.computeStrides(s.shape),p=i.util.computeStrides(o.shape),m=i.backend_util.computeConv2DInfo(d,o.shape,l,u,h,c,!0),g=new i.TensorBuffer(m.inShape,"float32"),b=g.values,[y,v,w]=g.strides,_=n.data.get(s.dataId).values,[k,x,S]=f,E=n.data.get(o.dataId).values,[I,A,M]=p,{batchSize:T,filterHeight:N,filterWidth:C,inChannels:R,inHeight:O,inWidth:D,outChannels:z,outHeight:B,outWidth:F,strideHeight:P,strideWidth:L}=m,$=N-1-m.padInfo.top,U=C-1-m.padInfo.left,j=z/R;for(let t=0;t<T;++t)for(let e=0;e<R;++e)for(let n=0;n<O;++n){const r=n-$,i=Math.max(0,Math.ceil(r/P)),a=Math.min(B,(N+r)/P);for(let s=0;s<D;++s){const o=s-U,l=Math.max(0,Math.ceil(o/L)),u=Math.min(F,(C+o)/L);let h=0;for(let n=i;n<a;++n){const i=n*P-r;for(let r=l;r<u;++r){const a=k*t+x*n+S*r,s=I*(N-1-i)+A*(C-1-(r*L-o))+M*e;for(let t=0;t<j;++t)h+=_[a+(e*j+t)]*E[s+t]}}b[y*t+v*n+w*s+e]=h}}return n.makeTensorInfo(g.shape,g.dtype,g.values)}},Dn={kernelName:i.Diag,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n}=t,{x:r}=e,a=i.util.sizeFromShape(r.shape),s=n.data.get(r.dataId).values,o=(0,i.buffer)([a,a],r.dtype),l=o.values;for(let t=0;t<s.length;t++)l[t*a+t]=s[t];const u=[...r.shape,...r.shape];return n.makeTensorInfo(u,o.dtype,o.values)}},zn={kernelName:i.Dilation2D,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:r,filter:a}=t,{strides:s,pad:o,dilations:l}=n,u=e,h=u.data.get(r.dataId).values,c=r.shape.length,d=u.data.get(a.dataId).values,f=a.shape.length,{batchSize:p,inHeight:m,inWidth:g,inChannels:b,outHeight:y,outWidth:v,padInfo:w,strideHeight:_,strideWidth:k,filterHeight:x,filterWidth:S,dilationHeight:E,dilationWidth:I,outShape:A}=i.backend_util.computeDilation2DInfo(r.shape,a.shape,s,o,"NHWC",l),M=i.util.sizeFromShape(A),T=A.length,N=i.util.getArrayFromDType(r.dtype,M);for(let t=0;t<p;++t)for(let e=0;e<y;++e){const n=e*_-w.top;for(let s=0;s<v;++s){const o=s*k-w.left;for(let l=0;l<b;++l){let u=Number.MIN_SAFE_INTEGER;for(let e=0;e<x;++e){const s=n+e*E;if(s>=0&&s<m)for(let n=0;n<S;++n){const p=o+n*I;if(p>=0&&p<g){const o=i.util.locToIndex([t,s,p,l],c,i.util.computeStrides(r.shape)),m=i.util.locToIndex([e,n,l],f,i.util.computeStrides(a.shape)),g=h[o]+d[m];g>u&&(u=g)}}}N[i.util.locToIndex([t,e,s,l],T,i.util.computeStrides(A))]=u}}}return{dataId:u.write(i.util.toTypedArray(N,r.dtype),A,r.dtype),shape:A,dtype:r.dtype}}},Bn={kernelName:i.Dilation2DBackpropFilter,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:r,filter:a,dy:s}=t,{strides:o,pad:l,dilations:u}=n,h=e,c=i.util.toNestedArray(r.shape,h.data.get(r.dataId).values),d=i.util.toNestedArray(a.shape,h.data.get(a.dataId).values),{batchSize:f,inHeight:p,inWidth:m,inChannels:g,outHeight:b,outWidth:y,padInfo:v,strideHeight:w,strideWidth:_,filterHeight:k,filterWidth:x,dilationHeight:S,dilationWidth:E,outShape:I}=i.backend_util.computeDilation2DInfo(r.shape,a.shape,o,l,"NHWC",u);i.util.assert(s.rank===I.length,(()=>`Error in ${i.Dilation2DBackpropFilter}, dy must have the same rank as output ${I.length}, but got ${s.rank}`));const A=i.util.toNestedArray(I,h.data.get(s.dataId).values),M=i.util.makeZerosNestedTypedArray(a.shape,a.dtype);for(let t=0;t<f;++t)for(let e=0;e<b;++e){const n=e*w-v.top;for(let r=0;r<y;++r){const i=r*_-v.left;for(let a=0;a<g;++a){let s=Number.MIN_SAFE_INTEGER,o=0,l=0;for(let e=0;e<k;++e){const r=n+e*S;if(r>=0&&r<p)for(let n=0;n<x;++n){const u=i+n*E;if(u>=0&&u<m){const i=c[t][r][u][a]+d[e][n][a];i>s&&(s=i,o=e,l=n)}}}M[o][l][a]+=A[t][e][r][a]}}}return{dataId:h.write(i.util.toTypedArray(M,r.dtype),a.shape,a.dtype),shape:a.shape,dtype:a.dtype}}},Fn={kernelName:i.Dilation2DBackpropInput,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:r,filter:a,dy:s}=t,{strides:o,pad:l,dilations:u}=n,h=e,c=i.util.toNestedArray(r.shape,h.data.get(r.dataId).values),d=i.util.toNestedArray(a.shape,h.data.get(a.dataId).values),{batchSize:f,inHeight:p,inWidth:m,inChannels:g,outHeight:b,outWidth:y,padInfo:v,strideHeight:w,strideWidth:_,filterHeight:k,filterWidth:x,dilationHeight:S,dilationWidth:E,outShape:I}=i.backend_util.computeDilation2DInfo(r.shape,a.shape,o,l,"NHWC",u);i.util.assert(s.rank===I.length,(()=>`Error in ${i.Dilation2DBackpropInput}, dy must have the same rank as output ${I.length}, but got ${s.rank}`));const A=i.util.toNestedArray(I,h.data.get(s.dataId).values),M=i.util.makeZerosNestedTypedArray(r.shape,r.dtype);for(let t=0;t<f;++t)for(let e=0;e<b;++e){const n=e*w-v.top;for(let r=0;r<y;++r){const i=r*_-v.left;for(let a=0;a<g;++a){let s=Number.MIN_SAFE_INTEGER,o=n<0?0:n,l=i<0?0:i;for(let e=0;e<k;++e){const r=n+e*S;if(r>=0&&r<p)for(let n=0;n<x;++n){const u=i+n*E;if(u>=0&&u<m){const i=c[t][r][u][a]+d[e][n][a];i>s&&(s=i,o=r,l=u)}}}M[t][o][l][a]+=A[t][e][r][a]}}}return{dataId:h.write(i.util.toTypedArray(M,r.dtype),r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};function Pn(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:o,keepDims:l}=r;let u;a(s,"sum"),u="bool"===s.dtype?y({inputs:{x:s},backend:n,attrs:{dtype:"int32"}}):p({inputs:{x:s},backend:n});const h=u.shape.length,c=i.util.parseAxisParam(o,u.shape),d=i.backend_util.getAxesPermutation(c,h);let m=c,g=u;null!=d&&(g=Mt({inputs:{x:u},backend:n,attrs:{perm:d}}),m=i.backend_util.getInnerMostAxes(m.length,h)),i.backend_util.assertAxesAreInnerMostDims("sum",m,g.shape.length);const[b,v]=i.backend_util.computeOutAndReduceShapes(g.shape,m);let w=f(n,b,i.backend_util.upcastType(g.dtype,"int32"));const _=i.util.sizeFromShape(v),k=n.data.get(w.dataId).values,x=n.data.get(g.dataId).values;for(let t=0;t<k.length;++t){const e=t*_;let n=0;for(let t=0;t<_;++t)n+=x[e+t];k[t]=n}if(l){const t=w;w=Ee({inputs:{x:w},backend:n,attrs:{shape:i.backend_util.expandShapeToKeepDim(w.shape,c)}}),n.disposeIntermediateTensorInfo(t)}return n.disposeIntermediateTensorInfo(u),null!=d&&n.disposeIntermediateTensorInfo(g),w}const Ln={kernelName:i.Sum,backendName:"cpu",kernelFunc:Pn},$n={kernelName:i.Einsum,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{equation:a}=r,s=e,{allDims:o,summedDims:l,idDims:u}=i.backend_util.decodeEinsumEquation(a,s.length);i.backend_util.checkEinsumDimSizes(o.length,u,s);const{path:h,steps:c}=i.backend_util.getEinsumComputePath(l,u),d=c.length;let f=null,p=o.length;const m=[];for(let t=0;t<d;++t){for(const e of c[t]){const{permutationIndices:t,expandDims:r}=i.backend_util.getEinsumPermutation(p,u[e]);let a;i.backend_util.isIdentityPermutation(t)?a=s[e]:(a=Mt({inputs:{x:s[e]},backend:n,attrs:{perm:t}}),m.push(a));const o=a.shape.slice();for(let t=0;t<r.length;++t)o.splice(r[t],0,1);i.util.arraysEqual(a.shape,o)||(a=Ee({inputs:{x:a},backend:n,attrs:{shape:o}}),m.push(a)),null===f?f=a:(f=wt({inputs:{a,b:f},backend:n}),m.push(f))}t<d-1&&(h[t]>=0&&(f=Pn({inputs:{x:f},backend:n,attrs:{axis:h[t]-(o.length-p),keepDims:!1}}),m.push(f)),p--)}for(const t of m)t!==f&&n.disposeIntermediateTensorInfo(t);return f}},Un={kernelName:i.EluGrad,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n}=t,{dy:r,y:s}=e;a([r,s],"eluGrad");const o=new Float32Array(i.util.sizeFromShape(s.shape)),l=n.data.get(s.dataId).values,u=n.data.get(r.dataId).values;for(let t=0;t<l.length;++t){const e=l[t];o[t]=e>=1?u[t]:u[t]*(e+1)}return n.makeTensorInfo(s.shape,"float32",o)}},jn=i.backend_util.ERF_P,Wn=i.backend_util.ERF_A1,Gn=i.backend_util.ERF_A2,Hn=i.backend_util.ERF_A3,Vn=i.backend_util.ERF_A4,qn=i.backend_util.ERF_A5,Kn=T(i.Erf,(t=>{const e=Math.sign(t),n=Math.abs(t),r=1/(1+jn*n);return e*(1-((((qn*r+Vn)*r+Hn)*r+Gn)*r+Wn)*r*Math.exp(-n*n))})),Zn={kernelName:i.Erf,backendName:"cpu",kernelFunc:Kn};function Xn(t){const{inputs:e,backend:n,attrs:r}=t,{input:a}=e,{dim:s}=r,o=a.shape.length,l=a.shape.slice();let u=s;return s<0&&(i.util.assert(-(o+1)<=s,(()=>`Axis must be in the interval [${-(o+1)}, ${o}]`)),u=o+s+1),l.splice(u,0,1),Ee({inputs:{x:a},backend:n,attrs:{shape:l}})}const Jn={kernelName:i.ExpandDims,backendName:"cpu",kernelFunc:Xn},Yn=h(((t,e)=>t/e)),Qn=w(i.RealDiv,Yn),tr={kernelName:i.RealDiv,backendName:"cpu",kernelFunc:Qn};function er(t,e,n){const r=t.shape,a=r[0],s=r[1],o=n.data.get(t.dataId),l=o.complexTensorInfos.real,u=o.complexTensorInfos.imag,h=[a,s],d=i.util.sizeFromShape(h),f=i.util.getTypedArrayFromDType("float32",d),p=i.util.getTypedArrayFromDType("float32",d);for(let t=0;t<a;t++){const r=$t({inputs:{x:l},backend:n,attrs:{begin:[t,0],size:[1,s]}}),a=$t({inputs:{x:u},backend:n,attrs:{begin:[t,0],size:[1,s]}}),o=c({inputs:{real:r,imag:a},backend:n}),{real:h,imag:d}=nr(o,e,n),m=i.backend_util.mergeRealAndImagArrays(h,d);for(let e=0;e<s;e++){const n=i.backend_util.getComplexWithIndex(m,e);f[t*s+e]=n.real,p[t*s+e]=n.imag}n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(o)}const m=n.makeTensorInfo(h,"float32",f),g=n.makeTensorInfo(h,"float32",p),b=c({inputs:{real:m,imag:g},backend:n});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),b}function nr(t,e,n){const r=i.util.sizeFromShape(t.shape),a=n.data.get(t.dataId),s=n.data.get(a.complexTensorInfos.real.dataId).values,o=n.data.get(a.complexTensorInfos.imag.dataId).values;if(0==((l=r)&l-1)){const a=rr(s,o,r,e,n),l=[t.shape[0],t.shape[1]];if(e){const t=n.makeTensorInfo(l,"float32",a.real),e=n.makeTensorInfo(l,"float32",a.imag),s=n.makeTensorInfo([],"float32",i.util.createScalarValue(r,"float32")),o=p({inputs:{x:s},backend:n}),u=tr.kernelFunc({inputs:{a:t,b:s},backend:n}),h=tr.kernelFunc({inputs:{a:e,b:o},backend:n}),c=n.data.get(u.dataId).values,d=n.data.get(h.dataId).values;return n.disposeIntermediateTensorInfo(t),n.disposeIntermediateTensorInfo(e),n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(h),{real:c,imag:d}}return a}{const t=function(t,e,n){const r=new Float32Array(2*e);for(let a=0;a<e;a++){let s=0,o=0;for(let r=0;r<e;r++){const l=i.backend_util.exponent(a*r,e,n),u=i.backend_util.getComplexWithIndex(t,r);s+=u.real*l.real-u.imag*l.imag,o+=u.real*l.imag+u.imag*l.real}n&&(s/=e,o/=e),i.backend_util.assignToTypedArray(r,s,o,a)}return r}(i.backend_util.mergeRealAndImagArrays(s,o),r,e);return i.backend_util.splitRealAndImagArrays(t)}var l}function rr(t,e,n,r,a){if(1===n)return{real:t,imag:e};const s=i.backend_util.mergeRealAndImagArrays(t,e),o=n/2,l=i.backend_util.complexWithEvenIndex(s),u=l.real,h=l.imag,d=[u.length],f=a.makeTensorInfo(d,"float32",u),p=a.makeTensorInfo(d,"float32",h),m=c({inputs:{real:f,imag:p},backend:a}),b=i.backend_util.complexWithOddIndex(s),y=b.real,v=b.imag,w=[y.length],_=a.makeTensorInfo(w,"float32",y),k=a.makeTensorInfo(w,"float32",v),x=c({inputs:{real:_,imag:k},backend:a}),E=rr(u,h,o,r,a),I=E.real,A=E.imag,M=[I.length],T=a.makeTensorInfo(M,"float32",I),N=a.makeTensorInfo(M,"float32",A),C=c({inputs:{real:T,imag:N},backend:a}),R=rr(y,v,o,r,a),O=R.real,D=R.imag,z=[O.length],B=a.makeTensorInfo(z,"float32",O),F=a.makeTensorInfo(z,"float32",D),P=c({inputs:{real:B,imag:F},backend:a}),L=i.backend_util.exponents(n,r),$=[L.real.length],U=a.makeTensorInfo($,"float32",L.real),j=a.makeTensorInfo($,"float32",L.imag),W=c({inputs:{real:U,imag:j},backend:a}),G=wt({inputs:{a:W,b:P},backend:a}),H=S({inputs:{a:C,b:G},backend:a}),V=ae({inputs:{a:C,b:G},backend:a}),q=g({inputs:{input:H},backend:a}),K=g({inputs:{input:V},backend:a}),Z=cn({inputs:{input:H},backend:a}),X=cn({inputs:{input:V},backend:a}),J=fn({inputs:[q,K],backend:a,attrs:{axis:0}}),Y=fn({inputs:[Z,X],backend:a,attrs:{axis:0}}),Q=a.data.get(J.dataId).values,tt=a.data.get(Y.dataId).values;return a.disposeIntermediateTensorInfo(f),a.disposeIntermediateTensorInfo(p),a.disposeIntermediateTensorInfo(m),a.disposeIntermediateTensorInfo(_),a.disposeIntermediateTensorInfo(k),a.disposeIntermediateTensorInfo(x),a.disposeIntermediateTensorInfo(T),a.disposeIntermediateTensorInfo(N),a.disposeIntermediateTensorInfo(C),a.disposeIntermediateTensorInfo(B),a.disposeIntermediateTensorInfo(F),a.disposeIntermediateTensorInfo(P),a.disposeIntermediateTensorInfo(U),a.disposeIntermediateTensorInfo(j),a.disposeIntermediateTensorInfo(W),a.disposeIntermediateTensorInfo(G),a.disposeIntermediateTensorInfo(H),a.disposeIntermediateTensorInfo(V),a.disposeIntermediateTensorInfo(q),a.disposeIntermediateTensorInfo(Z),a.disposeIntermediateTensorInfo(K),a.disposeIntermediateTensorInfo(X),a.disposeIntermediateTensorInfo(J),a.disposeIntermediateTensorInfo(Y),{real:Q,imag:tt}}const ir={kernelName:i.FFT,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n}=t,{input:r}=e,a=i.util.sizeFromShape(r.shape),s=r.shape[r.shape.length-1],o=Ee({inputs:{x:r},backend:n,attrs:{shape:[a/s,s]}}),l=er(o,!1,n),u=Ee({inputs:{x:l},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(l),u}};function ar(t){const{backend:e,attrs:n}=t,{shape:r,value:a,dtype:s}=n,o=s||i.util.inferDtype(a),l=i.util.getArrayFromDType(o,i.util.sizeFromShape(r));return function(t,e,n){t.fill(e)}(l,a),e.makeTensorInfo(r,o,l)}const sr={kernelName:i.Fill,backendName:"cpu",kernelFunc:ar},or={kernelName:i.FlipLeftRight,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:r}=t,a=n,s=i.util.getTypedArrayFromDType(r.dtype,i.util.sizeFromShape(r.shape)),[o,l,u,h]=r.shape,c=a.data.get(r.dataId).values;for(let t=0;t<o;t++){const e=t*u*l*h;for(let t=0;t<l;t++){const n=t*(u*h);for(let t=0;t<u;t++){const r=t*h;for(let i=0;i<h;i++){const a=Math.round(u-t-1),o=e+n+r+i;let l=c[o];a>=0&&a<u&&(l=c[e+n+a*h+i]),s[o]=l}}}}return{dataId:a.write(s,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},lr=h(((t,e)=>Math.floor(t/e))),ur=w(i.FloorDiv,lr,null,"int32"),hr={kernelName:i.FloorDiv,backendName:"cpu",kernelFunc:ur},cr={kernelName:i.FusedConv2D,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,filter:a,bias:s,preluActivationWeights:o}=e,{strides:l,pad:u,dataFormat:h,dilations:c,dimRoundingMode:d,activation:f,leakyreluAlpha:p}=r;let m=mn({inputs:{x:i,filter:a},backend:n,attrs:{strides:l,pad:u,dataFormat:h,dilations:c,dimRoundingMode:d}});if(s){const t=m;m=S({inputs:{a:m,b:s},backend:n}),n.disposeIntermediateTensorInfo(t)}if(f){const t=m;m=Se(n,m,f,o,p),n.disposeIntermediateTensorInfo(t)}return m}},dr={kernelName:i.FusedDepthwiseConv2D,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,filter:a,bias:s,preluActivationWeights:o}=e,{strides:l,pad:u,dataFormat:h,dilations:c,dimRoundingMode:d,activation:f,leakyreluAlpha:p}=r;let m=Nn({inputs:{x:i,filter:a},backend:n,attrs:{strides:l,pad:u,dataFormat:h,dilations:c,dimRoundingMode:d}});if(s){const t=m;m=S({inputs:{a:m,b:s},backend:n}),n.disposeIntermediateTensorInfo(t)}if(f){const t=m;m=Se(n,m,f,o,p),n.disposeIntermediateTensorInfo(t)}return m}},fr={kernelName:i.GatherNd,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n}=t,{params:r,indices:a}=e,s=i.util.sizeFromShape(r.shape),o=a.shape,l=o[o.length-1],[u,h,c,d]=i.backend_util.prepareAndValidate(r,a);if(0===h)return n.makeTensorInfo(u,r.dtype,[]);const f=q(n.data.get(a.dataId).values,n.bufferSync(r),r.dtype,h,l,c,d,r.shape,s);return n.makeTensorInfo(u,r.dtype,f.values)}},pr={kernelName:i.GatherV2,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,indices:o}=e,{axis:l,batchDims:u}=r;a([s,o],"gatherV2");const h=i.util.parseAxisParam(l,s.shape)[0],c=n.data.get(o.dataId).values,d=s.shape[h];for(let t=0;t<c.length;++t){const e=c[t];i.util.assert(e<=d-1&&e>=0,(()=>`GatherV2: the index value ${e} is not in [0, ${d-1}]`))}let f=u;null==u&&(f=0);const p=i.util.sizeFromShape(o.shape),m=i.backend_util.segment_util.collectGatherOpShapeInfo(s,o,h,f),g=Ee({inputs:{x:s},backend:n,attrs:{shape:[m.batchSize,m.outerSize,m.dimSize,m.sliceSize]}}),b=Ee({inputs:{x:o},backend:n,attrs:{shape:[m.batchSize,p/m.batchSize]}}),y=[m.batchSize,m.outerSize,p/m.batchSize,m.sliceSize],v=n.bufferSync(b),w=K(n.bufferSync(g),v,y);return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(b),n.makeTensorInfo(m.outputShape,w.dtype,w.values)}},mr={kernelName:i.IFFT,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n}=t,{input:r}=e,a=i.util.sizeFromShape(r.shape),s=r.shape[r.shape.length-1],o=Ee({inputs:{x:r},backend:n,attrs:{shape:[a/s,s]}}),l=er(o,!0,n),u=Ee({inputs:{x:l},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(l),u}},gr=T(i.IsFinite,(t=>Number.isFinite(t)?1:0),"bool"),br={kernelName:i.IsFinite,backendName:"cpu",kernelFunc:gr},yr=T(i.IsInf,(t=>Math.abs(t)===1/0?1:0),"bool"),vr={kernelName:i.IsInf,backendName:"cpu",kernelFunc:yr},wr=T(i.IsNan,(t=>Number.isNaN(t)?1:0),"bool"),_r={kernelName:i.IsNan,backendName:"cpu",kernelFunc:wr},kr={kernelName:i.LinSpace,backendName:"cpu",kernelFunc:function(t){const{backend:e,attrs:n}=t,{start:r,stop:i,num:a}=n,s=ot(r,i,a);return e.makeTensorInfo([s.length],"float32",s)}},xr=T(i.Log1p,(t=>Math.log1p(t))),Sr={kernelName:i.Log1p,backendName:"cpu",kernelFunc:xr},Er=h(((t,e)=>t&&e)),Ir=w(i.LogicalAnd,Er,null,"bool"),Ar={kernelName:i.LogicalAnd,backendName:"cpu",kernelFunc:Ir},Mr=T(i.LogicalNot,(t=>t?0:1),"bool"),Tr={kernelName:i.LogicalNot,backendName:"cpu",kernelFunc:Mr},Nr=h(((t,e)=>t||e)),Cr=w(i.LogicalOr,Nr,null,"bool"),Rr={kernelName:i.LogicalOr,backendName:"cpu",kernelFunc:Cr},Or={kernelName:i.LRN,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{depthRadius:o,bias:l,alpha:u,beta:h}=r;a(s,"LRN");const c=s.shape[3],d=c-1,f=n.data.get(s.dataId).values,p=i.util.sizeFromShape(s.shape),m=new Float32Array(p);function g(t){const e=t%c;let n=t-e+Math.max(0,e-o);const r=t-e+Math.min(e+o,d);let i=0;for(;n<=r;n++){const t=f[n];i+=t*t}return i}for(let t=0;t<p;t++){const e=g(t),n=f[t]*Math.pow(l+u*e,-h);m[t]=n}return n.makeTensorInfo(s.shape,s.dtype,m)}},Dr={kernelName:i.LRNGrad,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,y:o,dy:l}=e,{depthRadius:u,bias:h,alpha:c,beta:d}=r;a(l,"LRNGrad");const f=i.util.sizeFromShape(l.shape),p=l.shape[3],m=n.data.get(l.dataId).values,g=n.data.get(s.dataId).values,b=n.data.get(o.dataId).values,y=new Float32Array(f),v=f;for(let t=0;t<v;t++){const e=t%p,n=t-e+Math.max(0,e-u),r=t-e+Math.min(p,e+u+1);let i=0;for(let t=n;t<r;t++)i+=Math.pow(g[t],2);i=c*i+h;for(let e=n;e<r;e++){let n=-2*c*d*g[e]*b[t]/i;t===e&&(n+=Math.pow(i,-d)),n*=m[t],y[e]+=n}}return n.makeTensorInfo(l.shape,s.dtype,y)}};function zr(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{reductionIndices:o,keepDims:l}=r,u=n;let h=s.shape;const c=h.length,d=i.util.parseAxisParam(o,h);let f=d;const p=i.backend_util.getAxesPermutation(f,c);let m=u.data.get(s.dataId).values;if(null!=p){const t=new Array(c);for(let e=0;e<t.length;e++)t[e]=h[p[e]];m=At(m,h,s.dtype,p,t),f=i.backend_util.getInnerMostAxes(f.length,c),h=t}a(s,"max"),i.backend_util.assertAxesAreInnerMostDims("max",f,c);const[g,b]=i.backend_util.computeOutAndReduceShapes(h,f),y=ct(m,i.util.sizeFromShape(b),g,s.dtype),v=u.write(y,g,s.dtype);let w=g;return l&&(w=i.backend_util.expandShapeToKeepDim(g,d)),{dataId:v,shape:w,dtype:s.dtype}}const Br={kernelName:i.Max,backendName:"cpu",kernelFunc:zr},Fr={kernelName:i.MaxPool,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e;a(s,"maxPool");const{filterSize:o,strides:l,pad:u,dimRoundingMode:h}=r;i.util.assert(i.backend_util.eitherStridesOrDilationsAreOne(l,1),(()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${l} and dilations '1'`));const c=i.backend_util.computePool2DInfo(s.shape,o,l,1,u,h);let d;if(1===c.filterWidth&&1===c.filterHeight&&i.util.arraysEqual(c.inShape,c.outShape))d=p({inputs:{x:s},backend:n});else{const t=n.data.get(s.dataId).values,e=i.util.computeStrides(s.shape),r=Xe(t,s.shape,s.dtype,e,c,"max");d=n.makeTensorInfo(c.outShape,s.dtype,r.values)}return d}},Pr={kernelName:i.MaxPool3D,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{filterSize:o,strides:l,pad:u,dimRoundingMode:h,dataFormat:c}=r;a(s,"maxPool3d");const d=i.backend_util.computePool3DInfo(s.shape,o,l,1,u,h,c),f=Ye(n.data.get(s.dataId).values,s.shape,s.dtype,i.util.computeStrides(s.shape),d,"max");return n.makeTensorInfo(f.shape,"float32",f.values)}},Lr={kernelName:i.MaxPool3DGrad,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:o}=e,{filterSize:l,strides:u,pad:h,dimRoundingMode:c}=r;a([s,o],"maxPool3DGrad");const d=i.backend_util.computePool3DInfo(o.shape,l,u,1,h,c),f=function(t,e){const n=(0,i.buffer)(e.outShape,"int32"),r=e.strideDepth,a=e.strideHeight,s=e.strideWidth,o=e.dilationDepth,l=e.dilationHeight,u=e.dilationWidth,h=e.effectiveFilterDepth,c=e.effectiveFilterHeight,d=e.effectiveFilterWidth,f=e.padInfo.front,p=e.padInfo.top,m=e.padInfo.left;for(let i=0;i<e.batchSize;++i)for(let g=0;g<e.inChannels;++g)for(let b=0;b<e.outDepth;++b){const y=b*r-f;let v=y;for(;v<0;)v+=o;const w=Math.min(e.inDepth,h+y);for(let r=0;r<e.outHeight;++r){const h=r*a-p;let f=h;for(;f<0;)f+=l;const _=Math.min(e.inHeight,c+h);for(let a=0;a<e.outWidth;++a){const p=a*s-m;let k=p;for(;k<0;)k+=u;const x=Math.min(e.inWidth,d+p);let S=Number.NEGATIVE_INFINITY,E=-1;for(let e=v;e<w;e+=o){const n=e-y;for(let r=f;r<_;r+=l){const a=r-h;for(let s=k;s<x;s+=u){const o=s-p,l=t.get(i,e,r,s,g);l>=S&&(S=l,E=n*c*d+a*c+o)}}}n.set(E,i,b,r,a,g)}}}return n}(n.bufferSync(o),d),p=d.strideDepth,m=d.strideHeight,g=d.strideWidth,b=d.dilationDepth,y=d.dilationHeight,v=d.dilationWidth,w=d.effectiveFilterDepth,_=d.effectiveFilterHeight,k=d.effectiveFilterWidth,x=w-1-d.padInfo.front,S=k-1-d.padInfo.left,E=_-1-d.padInfo.top,I=(0,i.buffer)(o.shape,"float32"),A=n.bufferSync(s);for(let t=0;t<d.batchSize;++t)for(let e=0;e<d.inChannels;++e)for(let n=0;n<d.inDepth;++n)for(let r=0;r<d.inHeight;++r)for(let i=0;i<d.inWidth;++i){const a=n-x,s=r-E,o=i-S;let l=0;for(let n=0;n<w;n+=b){const r=(a+n)/p;if(!(r<0||r>=d.outDepth||Math.floor(r)!==r))for(let i=0;i<_;i+=y){const a=(s+i)/m;if(!(a<0||a>=d.outHeight||Math.floor(a)!==a))for(let s=0;s<k;s+=v){const u=(o+s)/g;if(u<0||u>=d.outWidth||Math.floor(u)!==u)continue;const h=w*_*k-1-f.get(t,r,a,u,e)===n*_*k+i*k+s?1:0;0!==h&&(l+=A.get(t,r,a,u,e)*h)}}}I.set(l,t,n,r,i,e)}return n.makeTensorInfo(I.shape,I.dtype,I.values)}},$r={kernelName:i.MaxPoolGrad,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:o,output:l}=e,u=o;a([o,l],"maxPoolGrad");const{filterSize:h,strides:c,pad:d,dimRoundingMode:f}=r,p=i.backend_util.computePool2DInfo(u.shape,h,c,1,d,f),m=n.data.get(u.dataId).values,g=(0,i.buffer)(p.outShape,u.dtype,Je(m,u.shape,u.dtype,p).values),b=p.strideHeight,y=p.strideWidth,v=p.dilationHeight,w=p.dilationWidth,_=p.effectiveFilterHeight,k=p.effectiveFilterWidth,x=k-1-p.padInfo.left,S=_-1-p.padInfo.top,E=(0,i.buffer)(u.shape,"float32"),I=n.data.get(s.dataId).values,A=(0,i.buffer)(s.shape,"float32",I);for(let t=0;t<p.batchSize;++t)for(let e=0;e<p.inChannels;++e)for(let n=0;n<p.inHeight;++n)for(let r=0;r<p.inWidth;++r){const i=n-S,a=r-x;let s=0;for(let n=0;n<_;n+=v){const r=(i+n)/b;if(!(r<0||r>=p.outHeight||Math.floor(r)!==r))for(let i=0;i<k;i+=w){const o=(a+i)/y;if(o<0||o>=p.outWidth||Math.floor(o)!==o)continue;const l=_*k-1-g.get(t,r,o,e)===n*k+i?1:0;0!==l&&(s+=A.get(t,r,o,e)*l)}}E.set(s,t,n,r,e)}return n.makeTensorInfo(E.shape,E.dtype,E.values)}},Ur={kernelName:i.MaxPoolWithArgmax,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:r}=t,{filterSize:s,strides:o,pad:l,includeBatchInIndex:u}=e,h=n;a(r,"MaxPoolWithArgmax");const c=h.data.get(r.dataId).values,d=i.backend_util.computePool2DInfo(r.shape,s,o,[1,1],l),[f,p]=function(t,e,n,r,a){const s=Xe(t,0,n,i.util.computeStrides(e),a,"max"),o=Je(t,e,n,a,!0,r);return[s.values,o.values]}(c,r.shape,r.dtype,u,d),m=h.write(f,d.outShape,r.dtype),g=h.write(p,d.outShape,r.dtype);return[{dataId:m,shape:d.outShape,dtype:r.dtype},{dataId:g,shape:d.outShape,dtype:"int32"}]}},jr={kernelName:i.Mean,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{axis:s,keepDims:o}=r,l=i.util.parseAxisParam(s,a.shape),u=i.backend_util.computeOutAndReduceShapes(a.shape,l)[1],h=i.util.sizeFromShape(u),c=[],d=n.makeTensorInfo([],"float32",new Float32Array([h]));c.push(d);const f=y({inputs:{x:a},backend:n,attrs:{dtype:"float32"}});c.push(f);const p=Qn({inputs:{a:f,b:d},backend:n});c.push(p);const m=Pn({inputs:{x:p},backend:n,attrs:{axis:s,keepDims:o}});return c.forEach((t=>n.disposeIntermediateTensorInfo(t))),m}},Wr={kernelName:i.Min,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:o,keepDims:l}=r;a(s,"min");const u=i.util.parseAxisParam(o,s.shape);let h=u;const c=i.backend_util.getAxesPermutation(h,s.shape.length);let d=s;null!=c&&(d=Mt({inputs:{x:s},backend:n,attrs:{perm:c}}),h=i.backend_util.getInnerMostAxes(h.length,s.shape.length)),i.backend_util.assertAxesAreInnerMostDims("min",h,d.shape.length);const[f,p]=i.backend_util.computeOutAndReduceShapes(d.shape,h),m=i.util.sizeFromShape(p),g=i.util.makeZerosTypedArray(i.util.sizeFromShape(f),d.dtype),b=n.data.get(d.dataId).values;for(let t=0;t<g.length;++t){const e=t*m;let n=b[e];for(let t=0;t<m;++t){const r=b[e+t];(Number.isNaN(r)||r<n)&&(n=r)}g[t]=n}null!=c&&n.disposeIntermediateTensorInfo(d);const y=n.makeTensorInfo(f,d.dtype,g);if(l){const t=Ee({inputs:{x:y},backend:n,attrs:{shape:i.backend_util.expandShapeToKeepDim(f,u)}});return n.disposeIntermediateTensorInfo(y),t}return y}},Gr={kernelName:i.MirrorPad,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{paddings:o,mode:l}=r;a(s,"mirrorPad");const u=o.map(((t,e)=>t[0]+s.shape[e]+t[1])),h=o.map((t=>t[0])),c=o.map(((t,e)=>t[0]+s.shape[e])),d="reflect"===l?0:1,f=n.data.get(s.dataId).values,p=s.shape.length,m=i.util.computeStrides(s.shape),g=i.util.sizeFromShape(u),b=u.length,y=i.util.computeStrides(u),v=i.util.getTypedArrayFromDType(s.dtype,g);for(let t=0;t<g;t++){let e=i.util.indexToLoc(t,b,y);for(let t=0;t<b;t++)e[t]<h[t]?e[t]=2*h[t]-e[t]-d:e[t]>=c[t]&&(e[t]=2*(c[t]-1)-e[t]+d);e=e.map(((t,e)=>t-h[e]));const n=i.util.locToIndex(e,p,m);v[t]=f[n]}return{dataId:n.write(v,u,s.dtype),shape:u,dtype:s.dtype}}},Hr=h(((t,e)=>{const n=t%e;return t<0&&e<0||t>=0&&e>=0?n:(n+e)%e})),Vr=w(i.Mod,Hr),qr={kernelName:i.Mod,backendName:"cpu",kernelFunc:Vr};var Kr=n(3883);function Zr(t){const{inputs:e,backend:n,attrs:r}=t,{logits:a}=e,{dim:s}=r,o=a.shape.length;let l=s;if(-1===l&&(l=o-1),l!==o-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${o} and dim was ${l}`);const u=i.util.parseAxisParam([l],a.shape),h=zr({inputs:{x:a},backend:n,attrs:{reductionIndices:u,keepDims:!1}}),c=i.backend_util.expandShapeToKeepDim(h.shape,u),d=Ee({inputs:{x:h},backend:n,attrs:{shape:c}}),f=ae({inputs:{a,b:d},backend:n}),p=L({inputs:{x:f},backend:n}),m=Pn({inputs:{x:p},backend:n,attrs:{axis:u,keepDims:!1}}),g=Ee({inputs:{x:m},backend:n,attrs:{shape:c}}),b=Qn({inputs:{a:p,b:g},backend:n});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),b}const Xr={kernelName:i.Softmax,backendName:"cpu",kernelFunc:Zr},Jr={kernelName:i.Multinomial,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{logits:s}=e,{numSamples:o,seed:l,normalized:u}=r;a(s,"multinomial");const h=u?s:Zr({inputs:{logits:s},backend:n,attrs:{dim:-1}}),c=h.shape[0],d=h.shape[1],f=n.data.get(h.dataId).values,p=[c,o],m=i.util.makeZerosTypedArray(i.util.sizeFromShape(p),"int32");for(let t=0;t<c;++t){const e=t*d,n=new Float32Array(d-1);n[0]=f[e];for(let t=1;t<n.length;++t)n[t]=n[t-1]+f[e+t];const r=Kr.alea(l.toString()),i=t*o;for(let t=0;t<o;++t){const e=r();m[i+t]=n.length;for(let r=0;r<n.length;r++)if(e<n[r]){m[i+t]=r;break}}}return u||n.disposeIntermediateTensorInfo(h),n.makeTensorInfo(p,"int32",m)}},Yr=i.kernel_impls.nonMaxSuppressionV3Impl,Qr={kernelName:i.NonMaxSuppressionV3,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{boxes:i,scores:s}=e,{maxOutputSize:o,iouThreshold:l,scoreThreshold:u}=r;a(i,"NonMaxSuppression");const h=n.data.get(i.dataId).values,c=n.data.get(s.dataId).values,{selectedIndices:d}=Yr(h,c,o,l,u);return n.makeTensorInfo([d.length],"int32",new Int32Array(d))}},ti=i.kernel_impls.nonMaxSuppressionV4Impl,ei={kernelName:i.NonMaxSuppressionV4,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{boxes:i,scores:s}=e,{maxOutputSize:o,iouThreshold:l,scoreThreshold:u,padToMaxOutputSize:h}=r;a(i,"NonMaxSuppressionPadded");const c=n.data.get(i.dataId).values,d=n.data.get(s.dataId).values,{selectedIndices:f,validOutputs:p}=ti(c,d,o,l,u,h);return[n.makeTensorInfo([f.length],"int32",new Int32Array(f)),n.makeTensorInfo([],"int32",new Int32Array([p]))]}},ni=i.kernel_impls.nonMaxSuppressionV5Impl,ri={kernelName:i.NonMaxSuppressionV5,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{boxes:i,scores:s}=e,{maxOutputSize:o,iouThreshold:l,scoreThreshold:u,softNmsSigma:h}=r;a(i,"NonMaxSuppressionWithScore");const c=n.data.get(i.dataId).values,d=n.data.get(s.dataId).values,f=o,p=l,m=u,g=h,{selectedIndices:b,selectedScores:y}=ni(c,d,f,p,m,g);return[n.makeTensorInfo([b.length],"int32",new Int32Array(b)),n.makeTensorInfo([y.length],"float32",new Float32Array(y))]}},ii={kernelName:i.OneHot,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{indices:s}=e,{depth:o,onValue:l,offValue:u}=r;a(s,"oneHot");const h=i.util.sizeFromShape(s.shape),c=new Float32Array(h*o);c.fill(u);const d=n.data.get(s.dataId).values;for(let t=0;t<h;++t)d[t]>=0&&d[t]<o&&(c[t*o+d[t]]=l);return n.makeTensorInfo([...s.shape,o],"int32",c)}};function ai(t){const{inputs:e,backend:n}=t,{x:r}=e;if("string"===r.dtype)throw new Error("zerosLike is not supported for string tensors");if("complex64"===r.dtype){const t=g({inputs:{input:r},backend:n}),e=ai({inputs:{x:t},backend:n}),i=cn({inputs:{input:r},backend:n}),a=ai({inputs:{x:i},backend:n}),s=c({inputs:{real:e,imag:a},backend:n});return n.disposeIntermediateTensorInfo(t),n.disposeIntermediateTensorInfo(e),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(a),s}return ar({backend:n,attrs:{shape:r.shape,value:0,dtype:r.dtype}})}const si={kernelName:i.ZerosLike,backendName:"cpu",kernelFunc:ai},oi={kernelName:i.OnesLike,backendName:"cpu",kernelFunc:function t(e){const{inputs:n,backend:r}=e,{x:i}=n;if("string"===i.dtype)throw new Error("onesLike is not supported for string tensors");if("complex64"===i.dtype){const e=g({inputs:{input:i},backend:r}),n=t({inputs:{x:e},backend:r}),a=cn({inputs:{input:i},backend:r}),s=ai({inputs:{x:a},backend:r}),o=c({inputs:{real:n,imag:s},backend:r});return r.disposeIntermediateTensorInfo(e),r.disposeIntermediateTensorInfo(n),r.disposeIntermediateTensorInfo(a),r.disposeIntermediateTensorInfo(s),o}return ar({backend:r,attrs:{shape:i.shape,value:1,dtype:i.dtype}})}};function li(t){const{inputs:e,backend:n,attrs:r}=t,{axis:a}=r;if(1===e.length)return Xn({inputs:{input:e[0]},backend:n,attrs:{dim:a}});const s=e[0].shape,o=e[0].dtype;e.forEach((t=>{i.util.assertShapesMatch(s,t.shape,"All tensors passed to stack must have matching shapes"),i.util.assert(o===t.dtype,(()=>"All tensors passed to stack must have matching dtypes"))}));const l=[],u=fn({inputs:e.map((t=>{const e=Xn({inputs:{input:t},backend:n,attrs:{dim:a}});return l.push(e),e})),backend:n,attrs:{axis:a}});return l.forEach((t=>n.disposeIntermediateTensorInfo(t))),u}const ui={kernelName:i.Pack,backendName:"cpu",kernelFunc:li},hi={kernelName:i.PadV2,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{paddings:o,constantValue:l}=r;a(s,"pad");const u=o.map(((t,e)=>t[0]+s.shape[e]+t[1])),h=o.map((t=>t[0])),c=n.data.get(s.dataId).values,d=i.util.sizeFromShape(s.shape),f=s.shape.length,p=i.util.computeStrides(s.shape),m=i.util.sizeFromShape(u),g=u.length,b=i.util.computeStrides(u),y=i.util.getTypedArrayFromDType(s.dtype,m);0!==l&&y.fill(l);for(let t=0;t<d;t++){const e=i.util.indexToLoc(t,f,p).map(((t,e)=>t+h[e]));y[i.util.locToIndex(e,g,b)]=c[t]}return{dataId:n.write(y,u,s.dtype),shape:u,dtype:s.dtype}}},ci=h(((t,e)=>Math.pow(t,e))),di=w(i.Pow,ci),fi={kernelName:i.Pow,backendName:"cpu",kernelFunc:di},pi={kernelName:i.Range,backendName:"cpu",kernelFunc:function(t){const{backend:e,attrs:n}=t,{start:r,stop:i,dtype:a,step:s}=n,o=Rt(r,i,s,a);return e.makeTensorInfo([o.length],a,o)}},mi=T(i.Reciprocal,(t=>1/t)),gi={kernelName:i.Reciprocal,backendName:"cpu",kernelFunc:mi},bi={kernelName:i.ResizeBilinear,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{images:s}=e,{alignCorners:o,halfPixelCenters:l,size:u}=r;a(s,"resizeBilinear");const h=i.util.computeStrides(s.shape),[c,d]=u,[f,p,m,g]=s.shape,b=n.data.get(s.dataId).values,y=new Float32Array(i.util.sizeFromShape([f,c,d,g])),v=[o&&c>1?p-1:p,o&&d>1?m-1:m],w=[o&&c>1?c-1:c,o&&d>1?d-1:d];let _=0;const k=v[0]/w[0],x=v[1]/w[1];for(let t=0;t<f;t++)for(let e=0;e<c;e++){let n;n=l?k*(e+.5)-.5:k*e;const r=Math.max(0,Math.floor(n)),i=n-r,a=Math.min(p-1,Math.ceil(n)),s=t*h[0]+r*h[1],o=t*h[0]+a*h[1];for(let t=0;t<d;t++){let e;e=l?x*(t+.5)-.5:x*t;const n=Math.max(0,Math.floor(e)),r=e-n,a=Math.min(m-1,Math.ceil(e)),u=s+n*h[2],c=o+n*h[2],d=s+a*h[2],f=o+a*h[2];for(let t=0;t<g;t++){const e=b[u+t],n=b[c+t],a=e+(b[d+t]-e)*r,s=a+(n+(b[f+t]-n)*r-a)*i;y[_++]=s}}}return n.makeTensorInfo([f,c,d,g],"float32",y)}},yi={kernelName:i.ResizeBilinearGrad,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{images:s,dy:o}=e,{alignCorners:l}=r;a([o,s],"resizeBilinearGrad");const u=i.util.computeStrides(s.shape),[h,c,d,f]=s.shape,[,p,m]=o.shape,g=new Float32Array(h*c*d*f),b=[l&&p>1?c-1:c,l&&m>1?d-1:d],y=[l&&p>1?p-1:p,l&&m>1?m-1:m],v=b[0]/y[0],w=b[1]/y[1],_=n.data.get(o.dataId).values;let k=0;for(let t=0;t<h;t++){const e=t*u[0];for(let t=0;t<p;t++){const n=t*v,r=Math.floor(n),i=Math.min(Math.ceil(n),c-1),a=e+r*u[1],s=e+i*u[1],o=n-r,l=1-o;for(let t=0;t<m;t++){const e=t*w,n=Math.floor(e),r=Math.min(Math.ceil(e),d-1),i=e-n,h=1-i,c=a+n*u[2],p=a+r*u[2],m=s+n*u[2],b=s+r*u[2],y=l*h,v=l*i,x=o*h,S=o*i;for(let t=0;t<f;t++){const e=_[k++];g[c+t]+=e*y,g[p+t]+=e*v,g[m+t]+=e*x,g[b+t]+=e*S}}}}return n.makeTensorInfo([h,d,c,f],"float32",g)}},vi={kernelName:i.ResizeNearestNeighbor,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{images:s}=e,{alignCorners:o,halfPixelCenters:l,size:u}=r;a(s,"resizeNearestNeighbor");const h=i.util.computeStrides(s.shape),[c,d]=u,[f,p,m,g]=s.shape,b=n.data.get(s.dataId).values,y=new Float32Array(f*c*d*g),v=[o&&c>1?p-1:p,o&&d>1?m-1:m],w=[o&&c>1?c-1:c,o&&d>1?d-1:d],_=v[0]/w[0],k=v[1]/w[1];let x=0;for(let t=0;t<f;t++){const e=t*h[0];for(let t=0;t<c;t++){const n=l?_*(t+.5):_*t;let r=Math.min(p-1,o?Math.round(n):Math.floor(n));l&&(r=Math.max(0,r));const i=e+r*h[1];for(let t=0;t<d;t++){const e=l?k*(t+.5):k*t;let n=Math.min(m-1,o?Math.round(e):Math.floor(e));l&&(n=Math.max(0,n));const r=i+n*h[2];for(let t=0;t<g;t++){const e=b[r+t];y[x++]=e}}}}return n.makeTensorInfo([f,c,d,g],s.dtype,y)}},wi={kernelName:i.ResizeNearestNeighborGrad,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{images:s,dy:o}=e,{alignCorners:l}=r;a([o,s],"resizeNearestNeighborGrad");const u=i.util.computeStrides(s.shape),h=i.util.computeStrides(o.shape),[c,d,f,p]=s.shape,[,m,g]=o.shape,b=new Float32Array(c*d*f*p),y=n.data.get(o.dataId).values,v=[l&&m>1?d-1:d,l&&g>1?f-1:f],w=[l&&m>1?m-1:m,l&&g>1?g-1:g],_=v[0]/w[0],k=v[1]/w[1],x=1/_,S=1/k,E=2*Math.ceil(x)+2,I=2*Math.ceil(S)+2;for(let t=0;t<c;t++){const e=t*u[0];for(let t=0;t<d;t++){const n=e+t*u[1],r=Math.floor(t*x),i=Math.floor(r-E/2);for(let r=0;r<f;r++){const a=n+r*u[2],s=Math.floor(r*S),o=Math.floor(s-I/2);for(let n=0;n<p;n++){let s=0;for(let a=0;a<E;a++){const u=a+i;if(u<0||u>=m)continue;const c=e+u*h[1],p=u*_;if(t===Math.min(d-1,l?Math.round(p):Math.floor(p)))for(let t=0;t<I;t++){const e=t+o;if(e<0||e>=g)continue;const i=c+e*h[2],a=e*k;r===Math.min(f-1,l?Math.round(a):Math.floor(a))&&(s+=y[i+n])}}b[a+n]=s}}}}return n.makeTensorInfo(s.shape,s.dtype,b)}},_i={kernelName:i.Reverse,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{dims:o}=r;a(s,"reverse");const l=s.shape.length,u=i.util.parseAxisParam(o,s.shape);if(0===l)return p({inputs:{x:s},backend:n});const h=new i.TensorBuffer(s.shape,s.dtype),c=n.bufferSync(s);for(let t=0;t<h.size;t++){const e=h.indexToLoc(t),n=e.slice();u.forEach((t=>n[t]=s.shape[t]-1-n[t])),h.set(c.get(...n),...e)}return n.makeTensorInfo(h.shape,h.dtype,h.values)}},ki={kernelName:i.RotateWithOffset,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:r}=t,{radians:a,fillValue:s,center:o}=e,l=n,u=i.util.getTypedArrayFromDType(r.dtype,i.util.sizeFromShape(r.shape)),[h,c,d,f]=r.shape,[p,m]=i.backend_util.getImageCenter(o,c,d),g=Math.sin(a),b=Math.cos(a),y=l.data.get(r.dataId).values;for(let t=0;t<h;t++){const e=t*d*c*f;for(let t=0;t<c;t++){const n=t*(d*f);for(let r=0;r<d;r++){const i=r*f;for(let a=0;a<f;a++){const o=[h,t,r,a],l=o[2],v=o[1];let w=(l-p)*b-(v-m)*g,_=(l-p)*g+(v-m)*b;w=Math.round(w+p),_=Math.round(_+m);let k=s;"number"!=typeof s&&(k=3===a?255:s[a]),w>=0&&w<d&&_>=0&&_<c&&(k=y[e+_*(d*f)+w*f+a]),u[e+n+i+a]=k}}}}return{dataId:l.write(u,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},xi=T(i.Round,(t=>{const e=Math.floor(t);return t-e<.5?Math.floor(t):t-e>.5?Math.ceil(t):e%2==0?e:e+1})),Si={kernelName:i.Round,backendName:"cpu",kernelFunc:xi};function Ei(t,e,n,r,a,s,o,l,u,h){const c=[r/a,a],d=t.values,f=e.values;if(0===r)return(0,i.buffer)(n,e.dtype);const p=(0,i.buffer)(c,e.dtype);p.values.fill(u);for(let t=0;t<s;t++){const i=[];let s=0;for(let e=0;e<o;e++){const n=d[t*o+e];i.push(n),s+=n*l[e]}if(s<0||s>=r/a)throw new Error(`Invalid indices: ${i} does not index into ${n}`);for(let n=0;n<a;n++)h?p.values[s*a+n]+=f[t*a+n]:p.values[s*a+n]=0===e.rank?f[0]:f[t*a+n]}return p}const Ii={kernelName:i.ScatterNd,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{indices:a,updates:s}=e,{shape:o}=r,{sliceRank:l,numUpdates:u,sliceSize:h,strides:c,outputSize:d}=i.backend_util.calculateShapes(s,a,o),f=Ei(n.bufferSync(a),n.bufferSync(s),o,d,h,u,l,c,0,!0);return n.makeTensorInfo(o,f.dtype,f.values)}},Ai={kernelName:i.Select,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n}=t,{condition:r,t:s,e:o}=e;a([r,s,o],"select");const l=r.shape.length,u=n.data.get(r.dataId).values,h=n.data.get(s.dataId).values,c=n.data.get(o.dataId).values,d=(0,i.upcastType)(s.dtype,o.dtype),f=i.util.makeZerosTypedArray(i.util.sizeFromShape(s.shape),d);let p=0;const m=0===l||l>1||1===s.shape.length?1:i.util.sizeFromShape(s.shape.slice(1));for(let t=0;t<u.length;t++)for(let e=0;e<m;e++)1===u[t]?f[p++]=h[t]:f[p++]=c[t];return n.makeTensorInfo(s.shape,d,f)}},Mi=i.backend_util.SELU_SCALEALPHA,Ti=i.backend_util.SELU_SCALE,Ni=T(i.Selu,(t=>t>=0?Ti*t:Mi*(Math.exp(t)-1))),Ci={kernelName:i.Selu,backendName:"cpu",kernelFunc:Ni},Ri=T(i.Sign,(t=>t<0?-1:t>0?1:0)),Oi={kernelName:i.Sign,backendName:"cpu",kernelFunc:Ri},Di=T(i.Sin,(t=>Math.sin(t))),zi={kernelName:i.Sin,backendName:"cpu",kernelFunc:Di},Bi=T(i.Sinh,(t=>Math.sinh(t))),Fi={kernelName:i.Sinh,backendName:"cpu",kernelFunc:Bi},Pi=Math.log(1.1920928955078125e-7)+2,Li=T(i.Softplus,(t=>{const e=t>-Pi,n=t<Pi,r=Math.exp(t);let i;return i=n?r:e?t:Math.log(1+r),i})),$i={kernelName:i.Softplus,backendName:"cpu",kernelFunc:Li},Ui={kernelName:i.SpaceToBatchND,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{blockShape:o,paddings:l}=r;a([s],"spaceToBatchND");const u=i.util.sizeFromShape(o),h=[[0,0]];h.push(...l);for(let t=1+o.length;t<s.shape.length;++t)h.push([0,0]);const c=hi.kernelFunc({inputs:{x:s},backend:n,attrs:{paddings:h,constantValue:0}}),d=i.backend_util.getReshaped(c.shape,o,u,!1),f=i.backend_util.getPermuted(d.length,o.length,!1),p=i.backend_util.getReshapedPermuted(c.shape,o,u,!1),m=Ee({inputs:{x:c},backend:n,attrs:{shape:d}}),g=Mt({inputs:{x:m},backend:n,attrs:{perm:f}}),b=Ee({inputs:{x:g},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),b}},ji={kernelName:i.SparseFillEmptyRows,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n}=t,{indices:r,values:i,denseShape:a,defaultValue:s}=e;if(1!==a.shape.length)throw new Error(`Dense shape must be a vector, saw:\n        ${a.shape}`);if(2!==r.shape.length)throw new Error(`Indices must be a matrix, saw:\n        ${r.shape}`);if(1!==i.shape.length)throw new Error(`Values must be a vector, saw:\n        ${i.shape}`);if(0!==s.shape.length)throw new Error(`Default value must be a scalar, saw:\n        ${s.shape}`);const o=n.data.get(r.dataId).values,l=n.data.get(i.dataId).values,u=n.data.get(a.dataId).values,h=n.data.get(s.dataId).values[0],[c,d,f,p,m]=jt(o,r.shape,r.dtype,l,i.dtype,u,h);return[n.makeTensorInfo(d,r.dtype,c),n.makeTensorInfo([d[0]],i.dtype,f),n.makeTensorInfo([p.length],"bool",new Uint8Array(p.map((t=>Number(t))))),n.makeTensorInfo([m.length],r.dtype,new Int32Array(m))]}},Wi={kernelName:i.SparseReshape,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n}=t,{inputIndices:r,inputShape:i,newShape:a}=e;if(2!==r.shape.length)throw new Error(`Input indices should be a matrix but received shape\n        ${r.shape}`);if(1!==i.shape.length)throw new Error(`Input shape should be a vector but received shape\n        ${i.shape}`);if(1!==a.shape.length)throw new Error(`Target shape should be a vector but received shape ${a.shape}`);const s=Array.from(n.data.get(i.dataId).values),o=n.data.get(r.dataId).values,l=Array.from(n.data.get(a.dataId).values),[u,h,c]=Wt(o,r.shape,r.dtype,s,l);return[n.makeTensorInfo(h,r.dtype,u),n.makeTensorInfo([c.length],a.dtype,new Int32Array(c))]}},Gi={kernelName:i.SparseSegmentMean,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n}=t,{data:r,indices:i,segmentIds:a}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==i.shape.length)throw new Error(`Indices should be a vector but received shape\n          ${i.shape}`);if(1!==a.shape.length)throw new Error(`Segment ids should be a vector but received shape\n          ${a.shape}`);if(i.shape[0]!==a.shape[0])throw new Error("segmentIds and indices should have same size.");const s=n.data.get(r.dataId).values,o=n.data.get(i.dataId).values,l=n.data.get(a.dataId).values,[u,h]=Gt(s,r.shape,r.dtype,o,l,!0);return n.makeTensorInfo(h,r.dtype,u)}},Hi={kernelName:i.SparseSegmentSum,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n}=t,{data:r,indices:i,segmentIds:a}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==i.shape.length)throw new Error(`Indices should be a vector but received shape\n         ${i.shape}`);if(1!==a.shape.length)throw new Error(`Segment ids should be a vector but received shape\n         ${a.shape}`);if(i.shape[0]!==a.shape[0])throw new Error("segmentIds and indices should have same size.");const s=n.data.get(r.dataId).values,o=n.data.get(i.dataId).values,l=n.data.get(a.dataId).values,[u,h]=Gt(s,r.shape,r.dtype,o,l);return n.makeTensorInfo(h,r.dtype,u)}},Vi={kernelName:i.SparseToDense,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{sparseIndices:a,sparseValues:s,defaultValue:o}=e,{outputShape:l}=r,{sliceRank:u,numUpdates:h,sliceSize:c,strides:d,outputSize:f}=i.backend_util.calculateShapes(s,a,l),p=Ei(n.bufferSync(a),n.bufferSync(s),l,f,c,h,u,d,n.data.get(o.dataId).values[0],!1);return n.makeTensorInfo(l,p.dtype,p.values)}},qi={kernelName:i.SplitV,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{numOrSizeSplits:s,axis:o}=r,l=i.util.parseAxisParam(o,a.shape)[0],u=i.backend_util.prepareSplitSize(a,s,l),h=new Array(a.shape.length).fill(0),c=a.shape.slice();return u.map((t=>{const e=[...c];e[l]=t;const r=$t({inputs:{x:a},backend:n,attrs:{begin:h,size:e}});return h[l]+=t,r}))}},Ki={kernelName:i.Square,backendName:"cpu",kernelFunc:({inputs:t,backend:e})=>{const{x:n}=t,r=e;a(n,"square");const i=r.data.get(n.dataId).values,s=new Float32Array(i.length);for(let t=0;t<i.length;++t){const e=i[t];s[t]=e*e}return{dataId:r.write(s,n.shape,n.dtype),shape:n.shape,dtype:n.dtype}}},Zi=T(i.Step,((t,e)=>{const n=e;return isNaN(t)?NaN:t>0?1:n.alpha})),Xi={kernelName:i.Step,backendName:"cpu",kernelFunc:Zi},Ji={kernelName:i.StridedSlice,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{begin:o,end:l,strides:u,beginMask:h,endMask:c,ellipsisMask:d,newAxisMask:f,shrinkAxisMask:p}=r;a(s,"stridedSlice");const{finalShapeSparse:m,finalShape:g,isIdentity:b,sliceDim0:y,isSimpleSlice:v,begin:w,end:_,strides:k}=i.slice_util.sliceInfo(s.shape,o,l,u,h,c,d,f,p);let x;if(b)x=Ee({inputs:{x:s},backend:n,attrs:{shape:g}});else if(y||v){i.util.assert(s.shape.length>=1,(()=>`Input must have rank at least 1, got: ${s.shape.length}`));const t=i.slice_util.computeOutShape(w,_,k),e=$t({inputs:{x:s},backend:n,attrs:{begin:w,size:t}});x=Ee({inputs:{x:e},backend:n,attrs:{shape:g}}),n.disposeIntermediateTensorInfo(e)}else{const t=Jt(m,n.bufferSync(s),k,w);x=n.makeTensorInfo(g,t.dtype,t.values)}return x}},Yi={kernelName:i.StringNGrams,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{separator:i,nGramWidths:a,leftPad:s,rightPad:o,padWidth:l,preserveShortSequences:u}=r,{data:h,dataSplits:c}=e,d=n.data.get(h.dataId).values,f=n.data.get(c.dataId).values,[p,m]=Qt(d,f,i,a,s,o,l,u);return[n.makeTensorInfo([p.length],"string",p),n.makeTensorInfo(c.shape,"int32",m)]}},Qi={kernelName:i.StringSplit,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{skipEmpty:i}=r,{input:a,delimiter:s}=e;if("string"!==a.dtype)throw new Error("Input must be of datatype string");if(1!==a.shape.length)throw new Error(`Input must be a vector, got shape: ${a.shape}`);if(0!==s.shape.length)throw new Error(`Delimiter must be a scalar, got shape: ${s.shape}`);const o=n.data.get(a.dataId).values,l=n.data.get(s.dataId).values[0],[u,h,c]=ee(o,l,i),d=h.length;return[n.makeTensorInfo([d,2],"int32",u),n.makeTensorInfo([d],"string",h),n.makeTensorInfo([2],"int32",new Int32Array(c))]}},ta={kernelName:i.StringToHashBucketFast,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{numBuckets:i}=r,{input:a}=e;if("string"!==a.dtype)throw new Error("Input must be of datatype string");if(i<=0)throw new Error("Number of buckets must be at least 1");const s=ne(n.data.get(a.dataId).values,i);return n.makeTensorInfo(a.shape,"int32",s)}},ea=T(i.Tan,(t=>Math.tan(t))),na={kernelName:i.Tan,backendName:"cpu",kernelFunc:ea},ra=T(i.Tanh,(t=>Math.tanh(t))),ia={kernelName:i.Tanh,backendName:"cpu",kernelFunc:ra},aa={kernelName:i.Tile,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{reps:s}=r;a(i,"tile");const o=oe(n.bufferSync(i),s);return n.makeTensorInfo(o.shape,o.dtype,o.values)}},sa={kernelName:i.TopK,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{k:s,sorted:o}=r;a(i,"topk");const l=n.data.get(i.dataId).values,[u,h]=he(l,i.shape,i.dtype,s,o);return[n.makeTensorInfo(u.shape,u.dtype,u.values),n.makeTensorInfo(h.shape,h.dtype,h.values)]}},oa={kernelName:i.Transform,backendName:"cpu",kernelFunc:function(t){const{inputs:e,attrs:n,backend:r}=t,{image:a,transforms:s}=e,{interpolation:o,fillMode:l,fillValue:u,outputShape:h}=n,[c,d,f,p]=a.shape,[m,g]=null!=h?h:[d,f],b=[c,m,g,p],y=i.util.computeStrides(a.shape),v=y[0],w=y[1],_=y[2],k=i.util.getTypedArrayFromDType(a.dtype,i.util.sizeFromShape(b));k.fill(u);const x=r.data.get(a.dataId).values,S=r.data.get(s.dataId).values;for(let t=0;t<c;++t){const e=1===s.shape[0]?S:S.subarray(8*t,8*t+8);for(let n=0;n<m;++n)for(let r=0;r<g;++r)for(let i=0;i<p;++i){let a;const s=e[6]*r+e[7]*n+1;if(0===s)continue;const h=(e[0]*r+e[1]*n+e[2])/s,c=(e[3]*r+e[4]*n+e[5])/s,p=la(h,f,l),m=la(c,d,l);switch(o){case"nearest":a=ha(x,d,f,v,w,_,t,m,p,i,u);break;case"bilinear":a=ca(x,d,f,v,w,_,t,m,p,i,u);break;default:throw new Error(`Error in Transform: Expect 'nearest' or 'bilinear', but got ${o}`)}k[t*v+n*w+r*_+i]=a}return r.makeTensorInfo(b,a.dtype,k)}return{dataId:r.write(k,b,a.dtype),shape:a.shape,dtype:a.dtype}}};function la(t,e,n){switch(n){case"reflect":return function(t,e){let n=t;if(n<0)if(e<=1)n=0;else{const t=2*e;n<t&&(n=t*Math.trunc(-n/t)+n),n=n<-e?n+t:-n-1}else if(n>e-1)if(e<=1)n=0;else{const t=2*e;n-=t*Math.trunc(n/t),n>=e&&(n=t-n-1)}return i.util.clamp(0,n,e-1)}(t,e);case"wrap":return function(t,e){let n=t;if(n<0)if(e<=1)n=0;else{const t=e-1;n+=e*(Math.trunc(-n/t)+1)}else if(n>e-1)if(e<=1)n=0;else{const t=e-1;n-=e*Math.trunc(n/t)}return i.util.clamp(0,n,e-1)}(t,e);case"nearest":return function(t,e){return i.util.clamp(0,t,e-1)}(t,e);default:return function(t,e){return t}(t)}}function ua(t,e,n,r,i,a,s,o,l,u,h){return 0<=o&&o<e&&0<=l&&l<n?t[s*r+o*i+l*a+u]:h}function ha(t,e,n,r,i,a,s,o,l,u,h){return ua(t,e,n,r,i,a,s,Math.round(o),Math.round(l),u,h)}function ca(t,e,n,r,i,a,s,o,l,u,h){const c=Math.floor(o),d=Math.floor(l),f=c+1,p=d+1;return(f-o)*((p-l)*ua(t,e,n,r,i,a,s,c,d,u,h)+(l-d)*ua(t,e,n,r,i,a,s,c,p,u,h))+(o-c)*((p-l)*ua(t,e,n,r,i,a,s,f,d,u,h)+(l-d)*ua(t,e,n,r,i,a,s,f,p,u,h))}const da={kernelName:i.Unique,backendName:"cpu",kernelFunc:function(t){const{inputs:e,attrs:n,backend:r}=t,{axis:i}=n,{x:s}=e;a(s,"unique");const o=r.data.get(s.dataId).values,{outputValues:l,outputShape:u,indices:h}=ce(o,i,s.shape,s.dtype);return[r.makeTensorInfo(u,s.dtype,l),r.makeTensorInfo([h.length],"int32",h)]}},fa={kernelName:i.Unpack,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{value:i}=e;let{axis:a}=r;a<0&&(a+=i.shape.length);const s=i.shape.length,o=i.shape[a],l=new Array(s-1);let u=0;for(let t=0;t<s;t++)t!==a&&(l[u++]=i.shape[t]);const h=new Array(s).fill(0),c=i.shape.slice();c[a]=1;const d=new Array(o);for(let t=0;t<d.length;t++){h[a]=t;const e=$t({inputs:{x:i},backend:n,attrs:{begin:h,size:c}});d[t]=Ee({inputs:{x:e},backend:n,attrs:{shape:l}}),n.disposeIntermediateTensorInfo(e)}return d}},pa={kernelName:i.UnsortedSegmentSum,backendName:"cpu",kernelFunc:function(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,segmentIds:o}=e,{numSegments:l}=r;a(s,"unsortedSegmentSum");const u=[],h=[],c=s.shape.length-o.shape.length;let d=o;for(let t=0;t<c;++t){const e=Xn({inputs:{input:d},backend:n,attrs:{dim:t+1}});d=e,h.push(e)}for(let t=0;t<l;++t){const e=i.util.createScalarValue(t,"int32"),r=n.makeTensorInfo([],"int32",e),a=B({inputs:{a:r,b:d},backend:n}),o=y({inputs:{x:a},backend:n,attrs:{dtype:"float32"}}),l=wt({inputs:{a:o,b:s},backend:n}),c=Pn({inputs:{x:l},backend:n,attrs:{axis:0,keepDims:!1}});u.push(c),h.push(r),h.push(a),h.push(o),h.push(l),h.push(c)}const f=li({inputs:u,backend:n,attrs:{axis:0}});return h.forEach((t=>n.disposeIntermediateTensorInfo(t))),f}},ma=[Te,u,Ce,Oe,E,De,ze,Be,Fe,Pe,$e,je,Ge,qe,Ze,Qe,tn,en,nn,Me,rn,an,sn,on,v,O,un,d,hn,pn,bn,yn,gn,wn,_n,vn,xn,En,In,An,Mn,Tn,Cn,Rn,On,Dn,zn,Fn,Bn,tr,$n,pe,Un,F,Zn,$,Jn,W,ir,sr,or,V,hr,cr,dr,fr,pr,J,tt,m,mr,dn,br,vr,_r,ge,rt,st,kr,ht,Sr,Ar,Tr,Rr,Or,Dr,pt,Fr,Pr,Lr,$r,Ur,Br,jr,Wr,bt,Gr,qr,Jr,_t,xt,Qr,ei,ri,It,ii,oi,ui,hi,fi,ve,Ct,pi,b,gi,_e,xe,Ie,bi,yi,vi,wi,_i,ki,Si,zt,Ii,Ai,Ci,Pt,Oi,zi,Fi,Ut,Xr,$i,Ui,ji,Wi,Gi,Hi,Vi,qi,qt,Ki,Xt,Xi,Ji,Yi,Qi,ta,se,Ln,na,ia,aa,sa,Tt,oa,da,fa,pa,si];for(const t of ma)(0,i.registerKernel)(t)},7607:(t,e,n)=>{"use strict";n.d(e,{JL:()=>r,Zu:()=>i});class r{constructor(t,e){this.backend=t,this.dataMover=e,this.data=new WeakMap,this.dataIdsCount=0}get(t){return this.data.has(t)||this.dataMover.moveData(this.backend,t),this.data.get(t)}set(t,e){this.dataIdsCount++,this.data.set(t,e)}has(t){return this.data.has(t)}delete(t){return this.dataIdsCount--,this.data.delete(t)}numDataIds(){return this.dataIdsCount}}class i{refCount(t){return a("refCount")}incRef(t){return a("incRef")}timerAvailable(){return!0}time(t){return a("time")}read(t){return a("read")}readSync(t){return a("readSync")}numDataIds(){return a("numDataIds")}disposeData(t,e){return a("disposeData")}write(t,e,n){return a("write")}move(t,e,n,r,i){return a("move")}memory(){return a("memory")}floatPrecision(){return a("floatPrecision")}epsilon(){return 32===this.floatPrecision()?1e-7:1e-4}dispose(){return a("dispose")}}function a(t){throw new Error(`'${t}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}},3733:(t,e,n)=>{"use strict";n.d(e,{BV:()=>w,wv:()=>v});var r=n(7607),i=n(7331),a=n(1208),s=n(3960),o=n(3796),l=n(1987),u=n(3591);class h{constructor(t,e){this.backendTimer=t,this.logger=e,null==e&&(this.logger=new d)}profileKernel(t,e,n){let r;const a=()=>{r=n()};let s;const o=l.now();if(this.backendTimer.timerAvailable())s=this.backendTimer.time(a);else{a();for(const t of r)t.dataSync();s=Promise.resolve({kernelMs:l.now()-o})}if((0,i.OB)().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let e=0;e<r.length;e++){const n=r[e];n.data().then((e=>{c(e,n.dtype,t)}))}return{kernelName:t,outputs:r,inputs:e,timeMs:s.then((t=>t.kernelMs)),extraInfo:s.then((t=>null!=t.getExtraProfileInfo?t.getExtraProfileInfo():""))}}logKernelProfile(t){const{kernelName:e,outputs:n,timeMs:r,inputs:i,extraInfo:a}=t;n.forEach((t=>{Promise.all([t.data(),r,a]).then((n=>{this.logger.logKernelProfile(e,t,n[0],n[1],i,n[2])}))}))}}function c(t,e,n){if("float32"!==e)return!1;for(let e=0;e<t.length;e++){const r=t[e];if(isNaN(r)||!isFinite(r))return console.warn(`Found ${r} in the result of '${n}'`),!0}return!1}class d{logKernelProfile(t,e,n,r,i,a){const s="number"==typeof r?u.oj(`${r}ms`,9):r.error,o=u.oj(t,25),l=e.rank,h=e.size,c=u.oj(e.shape.toString(),14);let d="";for(const t in i){const n=i[t];if(null!=n){const r=n.shape||e.shape,i=r.length;d+=`${t}: ${i}D ${i>0?r:""} `}}console.log(`%c${o}\t%c${s}\t%c${l}D ${c}\t%c${h}\t%c${d}\t%c${a}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}var f=n(4197),p=n(382),m=n(8496);function g(t){return null!=t.kernelName}class b{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map((t=>t.name))))}}}dispose(){for(const t in this.registeredVariables)this.registeredVariables[t].dispose()}}class y{constructor(t){this.ENV=t,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new b}async ready(){if(null!=this.pendingBackendInit)return this.pendingBackendInit.then((()=>{}));if(null!=this.backendInstance)return;const t=this.getSortedBackends();for(let e=0;e<t.length;e++){const n=t[e];if(await this.initializeBackend(n).success)return void await this.setBackend(n)}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(null!=this.pendingBackendInit)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(null==this.backendInstance){const{name:t,asyncInit:e}=this.initializeBackendsAndReturnBest();if(e)throw new Error(`The highest priority backend '${t}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(t)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(t){if(!(t in this.registry)){if(!(t in this.registryFactory))return null;{const{asyncInit:e}=this.initializeBackend(t);if(e)return null}}return this.registry[t]}findBackendFactory(t){return t in this.registryFactory?this.registryFactory[t].factory:null}registerBackend(t,e,n=1){return t in this.registryFactory?(m.Z(`${t} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[t]={factory:e,priority:n},!0)}async setBackend(t){if(null==this.registryFactory[t])throw new Error(`Backend name '${t}' not found in registry`);if(this.backendName=t,null==this.registry[t]){this.backendInstance=null;const{success:e,asyncInit:n}=this.initializeBackend(t);if(!(n?await e:e))return!1}return this.backendInstance=this.registry[t],this.setupRegisteredKernels(),this.profiler=new h(this.backendInstance),!0}setupRegisteredKernels(){(0,o.tr)(this.backendName).forEach((t=>{null!=t.setupFunc&&t.setupFunc(this.backendInstance)}))}disposeRegisteredKernels(t){(0,o.tr)(t).forEach((e=>{null!=e.disposeFunc&&e.disposeFunc(this.registry[t])}))}initializeBackend(t){const e=this.registryFactory[t];if(null==e)throw new Error(`Cannot initialize backend ${t}, no registration found.`);try{const n=e.factory();if(!n||n instanceof r.Zu||"function"!=typeof n.then)return this.registry[t]=n,{success:!0,asyncInit:!1};{const e=++this.pendingBackendInitId,r=n.then((n=>!(e<this.pendingBackendInitId||(this.registry[t]=n,this.pendingBackendInit=null,0)))).catch((n=>(e<this.pendingBackendInitId||(this.pendingBackendInit=null,m.Z(`Initialization of backend ${t} failed`),m.Z(n.stack||n.message)),!1)));return this.pendingBackendInit=r,{success:r,asyncInit:!0}}}catch(e){return m.Z(`Initialization of backend ${t} failed`),m.Z(e.stack||e.message),{success:!1,asyncInit:!1}}}removeBackend(t){if(!(t in this.registryFactory))throw new Error(`${t} backend not found in registry`);this.backendName===t&&null!=this.pendingBackendInit&&this.pendingBackendInitId++,t in this.registry&&(this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t]),delete this.registryFactory[t],this.backendName===t&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(0===Object.keys(this.registryFactory).length)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort(((t,e)=>this.registryFactory[e].priority-this.registryFactory[t].priority))}initializeBackendsAndReturnBest(){const t=this.getSortedBackends();for(let e=0;e<t.length;e++){const n=t[e],{success:r,asyncInit:i}=this.initializeBackend(n);if(i||r)return{name:n,asyncInit:i}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(t,e){const n=this.state.tensorInfo.get(e),r=n.backend,i=this.readSync(e),a=r.refCount(e);r.disposeData(e,!0),n.backend=t,t.move(e,i,n.shape,n.dtype,a),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(t,e){let n,r=null;if(null==e){if("function"!=typeof t)throw new Error("Please provide a function to tidy()");e=t}else{if("string"!=typeof t&&!(t instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if("function"!=typeof e)throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");r=t}return this.scopedRun((()=>this.startScope(r)),(()=>this.endScope(n)),(()=>(n=e(),n instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),n)))}scopedRun(t,e,n){t();try{const t=n();return e(),t}catch(t){throw e(),t}}nextTensorId(){return y.nextTensorId++}nextVariableId(){return y.nextVariableId++}clone(t){const e=w.runKernel(s.iJ,{x:t}),n={x:t};return this.addTapeNode(this.state.activeScope.name,n,[e],(t=>({x:()=>{const e={x:t};return w.runKernel(s.RF,e,{dtype:"float32"})}})),[],{}),e}runKernel(t,e,n){if(null==this.backendName&&this.backend,null==(0,o.pI)(t,this.backendName))throw new Error(`Kernel '${t}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:t,inputs:e,attrs:n})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(t,e,n){const r=this.backend.numDataIds();let i=0;n.forEach((t=>{i+="complex64"===t.dtype?3:1}));const a=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],s=r-e-i-a;if(s>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${s} data ids) after running '${t}'`)}runKernelFunc(t){let e,n=[];const r=this.isTapeOn(),i=this.state.numBytes,a=this.state.numTensors;let s,l;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0),null==this.backendName&&this.backend;const h=g(t)?t.kernelName:null!=this.state.activeScope?this.state.activeScope.name:"";if(g(t)){const{kernelName:e,inputs:i,attrs:a}=t;null==this.backendName&&this.backend;const h=(0,o.pI)(e,this.backendName);u.hu(null!=h,(()=>`Cannot find registered kernel '${e}' for backend '${this.backendName}'`)),s=()=>{const t=this.backend.numDataIds();l=h.kernelFunc({inputs:i,attrs:a,backend:this.backend});const s=Array.isArray(l)?l:[l];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(e,t,s);const o=s.map((t=>{if(null!=t.rank)return t;const{dataId:e,shape:n,dtype:r}=t;return this.makeTensorFromDataId(e,n,r)}));if(r){const t=this.getTensorsForGradient(e,i,o);n=this.saveTensorsForBackwardMode(t)}return o}}else{const{forwardFunc:e}=t,i=t=>{r&&(n=t.map((t=>this.keep(this.clone(t)))))};s=()=>{const t=this.backend.numDataIds();l=this.tidy((()=>e(this.backend,i)));const n=Array.isArray(l)?l:[l];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(h,t,n),n}}const{inputs:c,attrs:d}=t,f=g(t)?null:t.backwardsFunc;let p;return this.scopedRun((()=>this.state.kernelDepth++),(()=>this.state.kernelDepth--),(()=>{this.ENV.getBool("DEBUG")||this.state.profiling?(p=this.profiler.profileKernel(h,c,(()=>s())),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(p),e=p.outputs):e=s()})),r&&this.addTapeNode(h,c,e,f,n,d),this.state.profiling&&this.state.activeProfile.kernels.push({name:h,bytesAdded:this.state.numBytes-i,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-a,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(c).map((t=>null!=c[t]?c[t].shape:null)),outputShapes:e.map((t=>t.shape)),kernelTimeMs:p.timeMs,extraInfo:p.extraInfo}),Array.isArray(l)?e:e[0]}saveTensorsForBackwardMode(t){const e=t.map((t=>this.keep(this.clone(t))));return e}getTensorsForGradient(t,e,n){const r=(0,o.uk)(t);if(null!=r){const t=r.inputsToSave||[],i=r.outputsToSave||[];let a;r.saveAllInputs?(u.hu(Array.isArray(e),(()=>"saveAllInputs is true, expected inputs to be an array.")),a=Object.keys(e).map((t=>e[t]))):a=t.map((t=>e[t]));const s=n.filter(((t,e)=>i[e]));return a.concat(s)}return[]}makeTensor(t,e,n,r){if(null==t)throw new Error("Values passed to engine.makeTensor() are null");n=n||"float32",r=r||this.backend;let i=t;"string"===n&&u.HD(t[0])&&(i=t.map((t=>l.encodeString(t))));const a=r.write(i,e,n),s=new f.es(e,n,a,this.nextTensorId());if(this.trackTensor(s,r),"string"===n){const t=this.state.tensorInfo.get(a),e=(0,u.Ub)(i);this.state.numBytes+=e-t.bytes,t.bytes=e}return s}makeTensorFromDataId(t,e,n,r){n=n||"float32";const i=new f.es(e,n,t,this.nextTensorId());return this.trackTensor(i,r),i}makeVariable(t,e=!0,n,r){n=n||this.nextVariableId().toString(),null!=r&&r!==t.dtype&&(t=t.cast(r));const i=new f._w(t,e,n,this.nextTensorId());if(null!=this.state.registeredVariables[i.name])throw new Error(`Variable with name ${i.name} was already registered`);return this.state.registeredVariables[i.name]=i,this.incRef(i,this.backend),i}trackTensor(t,e){this.state.numTensors++,"string"===t.dtype&&this.state.numStringTensors++;let n=0;"complex64"!==t.dtype&&"string"!==t.dtype&&(n=t.size*u.bT(t.dtype)),this.state.numBytes+=n,this.state.tensorInfo.has(t.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(t.dataId,{backend:e||this.backend,dtype:t.dtype,shape:t.shape,bytes:n})),t instanceof f._w||this.track(t)}incRef(t,e){this.trackTensor(t,e),this.backend.incRef(t.dataId)}removeDataId(t,e){this.state.tensorInfo.has(t)&&this.state.tensorInfo.get(t).backend===e&&(this.state.tensorInfo.delete(t),this.state.numDataBuffers--)}disposeTensor(t){if(!this.state.tensorInfo.has(t.dataId))return;const e=this.state.tensorInfo.get(t.dataId);if(this.state.numTensors--,"string"===t.dtype&&(this.state.numStringTensors--,this.state.numBytes-=e.bytes),"complex64"!==t.dtype&&"string"!==t.dtype){const e=t.size*u.bT(t.dtype);this.state.numBytes-=e}e.backend.disposeData(t.dataId)&&this.removeDataId(t.dataId,e.backend)}disposeVariables(){for(const t in this.state.registeredVariables){const e=this.state.registeredVariables[t];this.disposeVariable(e)}}disposeVariable(t){this.disposeTensor(t),null!=this.state.registeredVariables[t.name]&&delete this.state.registeredVariables[t.name]}memory(){const t=this.backend.memory();return t.numTensors=this.state.numTensors,t.numDataBuffers=this.state.numDataBuffers,t.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(t.unreliable=!0,null==t.reasons&&(t.reasons=[]),t.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),t}async profile(t){this.state.profiling=!0;const e=this.state.numBytes,n=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await t(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map((t=>t.totalBytesSnapshot))),this.state.activeProfile.newBytes=this.state.numBytes-e,this.state.activeProfile.newTensors=this.state.numTensors-n;for(const t of this.state.activeProfile.kernels)t.kernelTimeMs=await t.kernelTimeMs,t.extraInfo=await t.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&0===this.state.kernelDepth}addTapeNode(t,e,n,r,i,a){const s={id:this.state.nextTapeNodeId++,kernelName:t,inputs:e,outputs:n,saved:i},l=(0,o.uk)(t);null!=l&&(r=l.gradFunc),null!=r&&(s.gradient=t=>(t=t.map(((t,e)=>{if(null==t){const t=n[e],r=u.wT(t.size,t.dtype);return this.makeTensor(r,t.shape,t.dtype)}return t})),r(t.length>1?t:t[0],i,a))),this.state.activeTape.push(s)}keep(t){return t.kept=!0,t}startTape(){0===this.state.gradientDepth&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(t){const e={track:[],name:"unnamed scope",id:this.state.nextScopeId++};t&&(e.name=t),this.state.scopeStack.push(e),this.state.activeScope=e}endScope(t){const e=(0,p.getTensorsInContainer)(t),n=new Set(e.map((t=>t.id)));for(let t=0;t<this.state.activeScope.track.length;t++){const e=this.state.activeScope.track[t];e.kept||n.has(e.id)||e.dispose()}const r=this.state.scopeStack.pop();this.state.activeScope=0===this.state.scopeStack.length?null:this.state.scopeStack[this.state.scopeStack.length-1],e.forEach((t=>{t.kept||t.scopeId!==r.id||this.track(t)}))}gradients(t,e,n,r=!1){if(u.hu(e.length>0,(()=>"gradients() received an empty list of xs.")),null!=n&&"float32"!==n.dtype)throw new Error(`dy must have 'float32' dtype, but has '${n.dtype}'`);const i=this.scopedRun((()=>this.startTape()),(()=>this.endTape()),(()=>this.tidy("forward",t)));u.hu(i instanceof f.es,(()=>"The result y returned by f() must be a tensor."));const a=function(t,e,n){const r={},i={};for(let t=0;t<e.length;t++)r[e[t].id]=!0;for(let n=0;n<t.length;n++){const a=t[n],s=a.inputs;for(const t in s){const n=s[t];let o=!1;for(let t=0;t<e.length;t++)if(r[n.id]){a.outputs.forEach((t=>r[t.id]=!0)),o=!0,i[a.id]=!0;break}if(o)break}}const a={};a[n.id]=!0;const s={};for(let e=t.length-1;e>=0;e--){const n=t[e],r=n.inputs;for(let t=0;t<n.outputs.length;t++)if(a[n.outputs[t].id]){for(const t in r)a[r[t].id]=!0,s[n.id]=!0;break}}const o=[];for(let e=0;e<t.length;e++){const n=t[e];if(i[n.id]&&s[n.id]){const t={};for(const e in n.inputs){const i=n.inputs[e];r[i.id]&&(t[e]=i)}const e=Object.assign({},n);e.inputs=t,e.outputs=n.outputs,o.push(e)}}return o}(this.state.activeTape,e,i);if(!r&&0===a.length&&e.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",(()=>{const t={};t[i.id]=null==n?function(t){const e=(0,u.p8)((0,u.NA)(t),"float32");return w.makeTensor(e,t,"float32")}(i.shape):n,function(t,e,n,r){for(let i=e.length-1;i>=0;i--){const a=e[i],s=[];if(a.outputs.forEach((e=>{const n=t[e.id];null!=n?s.push(n):s.push(null)})),null==a.gradient)throw new Error(`Cannot compute gradient: gradient function not found for ${a.kernelName}.`);const o=a.gradient(s);for(const e in a.inputs){if(!(e in o))throw new Error(`Cannot backprop through input ${e}. Available gradients found: ${Object.keys(o)}.`);const i=n((()=>o[e]()));if("float32"!==i.dtype)throw new Error(`Error in gradient for op ${a.kernelName}. The gradient of input ${e} must have 'float32' dtype, but has '${i.dtype}'`);const s=a.inputs[e];if(!u.cO(i.shape,s.shape))throw new Error(`Error in gradient for op ${a.kernelName}. The gradient of input '${e}' has shape '${i.shape}', which does not match the shape of the input '${s.shape}'`);if(null==t[s.id])t[s.id]=i;else{const e=t[s.id];t[s.id]=r(e,i),e.dispose()}}}}(t,a,(t=>this.tidy(t)),_);const r=e.map((e=>t[e.id]));return 0===this.state.gradientDepth&&(this.state.activeTape.forEach((t=>{for(const e of t.saved)e.dispose()})),this.state.activeTape=null),{value:i,grads:r}}))}customGrad(t){return u.hu(u.mf(t),(()=>"The f passed in customGrad(f) must be a function.")),(...e)=>{let n;u.hu(e.every((t=>t instanceof f.es)),(()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors"));const r={};return e.forEach(((t,e)=>{r[e]=t})),this.runKernelFunc({forwardFunc:(r,i)=>(n=t(...e,i),u.hu(n.value instanceof f.es,(()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor")),u.hu(u.mf(n.gradFunc),(()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function.")),n.value),backwardsFunc:(t,r)=>{const i=n.gradFunc(t,r),a=Array.isArray(i)?i:[i];u.hu(a.length===e.length,(()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...).")),u.hu(a.every((t=>t instanceof f.es)),(()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."));const s={};return a.forEach(((t,e)=>{s[e]=()=>t})),s},inputs:r})}}readSync(t){return this.state.tensorInfo.get(t).backend.readSync(t)}read(t){return this.state.tensorInfo.get(t).backend.read(t)}async time(t){const e=(0,l.now)(),n=await this.backend.time(t);return n.wallMs=(0,l.now)()-e,n}track(t){return null!=this.state.activeScope&&(t.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(t)),t}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new b;for(const t in this.registry)this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}function v(){const t=(0,a.D)();if(null==t._tfengine){const e=new i.qA(t);t._tfengine=new y(e)}return(0,i.iG)(t._tfengine.ENV),(0,f.Vi)((()=>t._tfengine)),t._tfengine}y.nextTensorId=0,y.nextVariableId=0;const w=v();function _(t,e){const n={a:t,b:e};return w.runKernel(s.mm,n)}},7331:(t,e,n)=>{"use strict";n.d(e,{qA:()=>i,OB:()=>s,Vi:()=>o,iG:()=>l});var r=n(3591);class i{constructor(t){this.global=t,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=a,this.populateURLFlags()}setPlatform(t,e){null!=this.platform&&(s().getBool("IS_TEST")||s().getBool("PROD")||console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${e}.`)),this.platformName=t,this.platform=e}registerFlag(t,e,n){if(this.flagRegistry[t]={evaluationFn:e,setHook:n},null!=this.urlFlags[t]){const e=this.urlFlags[t];s().getBool("IS_TEST")||s().getBool("PROD")||console.warn(`Setting feature override from URL ${t}: ${e}.`),this.set(t,e)}}async getAsync(t){return t in this.flags||(this.flags[t]=await this.evaluateFlag(t)),this.flags[t]}get(t){if(t in this.flags)return this.flags[t];const e=this.evaluateFlag(t);if((0,r.tI)(e))throw new Error(`Flag ${t} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[t]=e,this.flags[t]}getNumber(t){return this.get(t)}getBool(t){return this.get(t)}getFlags(){return this.flags}get features(){return this.flags}set(t,e){if(null==this.flagRegistry[t])throw new Error(`Cannot set flag ${t} as it has not been registered.`);this.flags[t]=e,null!=this.flagRegistry[t].setHook&&this.flagRegistry[t].setHook(e)}evaluateFlag(t){if(null==this.flagRegistry[t])throw new Error(`Cannot evaluate flag '${t}': no evaluation function found.`);return this.flagRegistry[t].evaluationFn()}setFlags(t){this.flags=Object.assign({},t)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(void 0===this.global||void 0===this.global.location||void 0===this.global.location.search)return;const t=this.getQueryParams(this.global.location.search);"tfjsflags"in t&&t.tfjsflags.split(",").forEach((t=>{const[e,n]=t.split(":");this.urlFlags[e]=function(t,e){if("true"===(e=e.toLowerCase())||"false"===e)return"true"===e;if(""+ +e===e)return+e;throw new Error(`Could not parse value flag value ${e} for flag ${t}.`)}(e,n)}))}}function a(t){const e={};return t.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,((t,...n)=>(function(t,e,n){t[decodeURIComponent(e)]=decodeURIComponent(n||"")}(e,n[0],n[1]),n.join("=")))),e}function s(){return o}let o=null;function l(t){o=t}},1208:(t,e,n)=>{"use strict";n.d(e,{D:()=>a,R:()=>s});var r=n(7671);let i;function a(){if(null==i){let t;if("undefined"!=typeof window)t=window;else if(void 0!==n.g)t=n.g;else if(void 0!==r)t=r;else{if("undefined"==typeof self)throw new Error("Could not find a global object");t=self}i=t}return i}function s(t,e){const n=function(){const t=a();return null==t._tfGlobals&&(t._tfGlobals=new Map),t._tfGlobals}();if(n.has(t))return n.get(t);{const r=e();return n.set(t,r),n.get(t)}}},1420:(t,e,n)=>{"use strict";n.r(e),n.d(e,{Abs:()=>Kt.SY,Acos:()=>Kt.VG,Acosh:()=>Kt.Sp,AdadeltaOptimizer:()=>dn,AdagradOptimizer:()=>pn,AdamOptimizer:()=>bn,AdamaxOptimizer:()=>wn,Add:()=>Kt.mm,AddN:()=>Kt.Xz,All:()=>Kt.oT,Any:()=>Kt.IK,ArgMax:()=>Kt.sJ,ArgMin:()=>Kt.aJ,Asin:()=>Kt.M2,Asinh:()=>Kt.qw,Atan:()=>Kt.jM,Atan2:()=>Kt.QC,Atanh:()=>Kt.Oy,AvgPool:()=>Kt.Jh,AvgPool3D:()=>Kt._k,AvgPool3DGrad:()=>Kt.IM,AvgPoolGrad:()=>Kt.RO,BatchMatMul:()=>Kt.XL,BatchToSpaceND:()=>Kt.zw,Bincount:()=>Kt.zv,BroadcastArgs:()=>Kt.eE,BroadcastTo:()=>Kt.Ly,Cast:()=>Kt.RF,Ceil:()=>Kt.gJ,ClipByValue:()=>Kt.xn,Complex:()=>Kt.Zz,ComplexAbs:()=>Kt.yj,Concat:()=>Kt.Eh,Conv2D:()=>Kt.mh,Conv2DBackpropFilter:()=>Kt.wU,Conv2DBackpropInput:()=>Kt.wm,Conv3D:()=>Kt.x1,Conv3DBackpropFilterV2:()=>Kt.o2,Conv3DBackpropInputV2:()=>Kt.ik,Cos:()=>Kt.mc,Cosh:()=>Kt.TR,CropAndResize:()=>Kt.Vc,Cumsum:()=>Kt.iH,DataStorage:()=>nl.JL,DenseBincount:()=>Kt.QR,DepthToSpace:()=>Kt.T0,DepthwiseConv2dNative:()=>Kt.ci,DepthwiseConv2dNativeBackpropFilter:()=>Kt.sL,DepthwiseConv2dNativeBackpropInput:()=>Kt.y7,Diag:()=>Kt.$w,Dilation2D:()=>Kt.p4,Dilation2DBackpropFilter:()=>Kt.Vn,Dilation2DBackpropInput:()=>Kt.ek,ENV:()=>w.Vi,Einsum:()=>Kt.$g,Elu:()=>Kt.SX,EluGrad:()=>Kt.HE,Environment:()=>w.qA,Equal:()=>Kt.hd,Erf:()=>Kt.Om,Exp:()=>Kt.NE,ExpandDims:()=>Kt.YF,Expm1:()=>Kt.Y0,FFT:()=>Kt.vw,Fill:()=>Kt.de,FlipLeftRight:()=>Kt.Uy,Floor:()=>Kt.OR,FloorDiv:()=>Kt.je,FromPixels:()=>Kt.eB,FusedBatchNorm:()=>Kt.sH,FusedConv2D:()=>Kt._V,FusedDepthwiseConv2D:()=>Kt.lu,GatherNd:()=>Kt.q1,GatherV2:()=>Kt.qi,Greater:()=>Kt.iZ,GreaterEqual:()=>Kt.Ac,IFFT:()=>Kt.Qg,Identity:()=>Kt.iJ,Imag:()=>Kt.J_,IsFinite:()=>Kt.av,IsInf:()=>Kt.iW,IsNan:()=>Kt.r7,KernelBackend:()=>nl.Zu,LRN:()=>Kt.eZ,LRNGrad:()=>Kt.Hh,LeakyRelu:()=>Kt.J$,Less:()=>Kt.vt,LessEqual:()=>Kt.CA,LinSpace:()=>Kt.e7,Log:()=>Kt.Zb,Log1p:()=>Kt.kU,LogSoftmax:()=>Kt.qC,LogicalAnd:()=>Kt.PY,LogicalNot:()=>Kt.Vf,LogicalOr:()=>Kt.MZ,Max:()=>Kt.Yo,MaxPool:()=>Kt.mT,MaxPool3D:()=>Kt.OA,MaxPool3DGrad:()=>Kt.OU,MaxPoolGrad:()=>Kt.OV,MaxPoolWithArgmax:()=>Kt.vF,Maximum:()=>Kt.BM,Mean:()=>Kt.q2,Min:()=>Kt.c1,Minimum:()=>Kt.q8,MirrorPad:()=>Kt.jQ,Mod:()=>Kt.Vb,MomentumOptimizer:()=>kn,Multinomial:()=>Kt.NZ,Multiply:()=>Kt.wY,Neg:()=>Kt.ku,NonMaxSuppressionV3:()=>Kt.uv,NonMaxSuppressionV4:()=>Kt.cy,NonMaxSuppressionV5:()=>Kt.W0,NotEqual:()=>Kt.yQ,OP_SCOPE_SUFFIX:()=>Zt.z,OneHot:()=>Kt.we,OnesLike:()=>Kt.qW,Optimizer:()=>cn,OptimizerConstructors:()=>Sn,Pack:()=>Kt.Qi,PadV2:()=>Kt.ly,Pool:()=>Kt.Kg,Pow:()=>Kt.pe,Prelu:()=>Kt.o0,Prod:()=>Kt.Dl,RMSPropOptimizer:()=>xn,Range:()=>Kt.e6,Rank:()=>En.yw,Real:()=>Kt.xJ,RealDiv:()=>Kt.oH,Reciprocal:()=>Kt.$H,Reduction:()=>Cs,Relu:()=>Kt.qk,Relu6:()=>Kt.Sb,Reshape:()=>Kt.HZ,ResizeBilinear:()=>Kt._Y,ResizeBilinearGrad:()=>Kt.zb,ResizeNearestNeighbor:()=>Kt.dp,ResizeNearestNeighborGrad:()=>Kt.Hm,Reverse:()=>Kt.mK,RotateWithOffset:()=>Kt.b9,Round:()=>Kt.e0,Rsqrt:()=>Kt.bV,SGDOptimizer:()=>_n,ScatterNd:()=>Kt.xQ,Select:()=>Kt.Ph,Selu:()=>Kt.oF,Sigmoid:()=>Kt.a5,Sign:()=>Kt.i5,Sin:()=>Kt.RQ,Sinh:()=>Kt.w3,Slice:()=>Kt.p2,Softmax:()=>Kt.Gc,Softplus:()=>Kt.MR,SpaceToBatchND:()=>Kt.TQ,SparseFillEmptyRows:()=>Kt.O3,SparseReshape:()=>Kt.nh,SparseSegmentMean:()=>Kt.YW,SparseSegmentSum:()=>Kt.Zj,SparseToDense:()=>Kt.D2,SplitV:()=>Kt.L8,Sqrt:()=>Kt.FK,Square:()=>Kt.bK,SquaredDifference:()=>Kt._t,Step:()=>Kt.h8,StridedSlice:()=>Kt.m2,StringNGrams:()=>Kt._J,StringSplit:()=>Kt.s1,StringToHashBucketFast:()=>Kt.Xk,Sub:()=>Kt.Tr,Sum:()=>Kt.GB,Tan:()=>Kt.sE,Tanh:()=>Kt.MI,Tensor:()=>St.es,TensorBuffer:()=>St.YD,Tile:()=>Kt.n9,TopK:()=>Kt.cW,Transform:()=>Kt.wx,Transpose:()=>Kt.G3,Unique:()=>Kt.kp,Unpack:()=>Kt.To,UnsortedSegmentSum:()=>Kt.Qv,Variable:()=>St._w,ZerosLike:()=>Kt.Ru,_FusedMatMul:()=>Kt.us,abs:()=>yn,acos:()=>In,acosh:()=>An,add:()=>Xe.I,addN:()=>Mn,all:()=>Tn,any:()=>Nn,argMax:()=>Cn,argMin:()=>Rn,asin:()=>On,asinh:()=>Dn,atan:()=>zn,atan2:()=>Bn,atanh:()=>Fn,avgPool:()=>$n,avgPool3d:()=>Un,backend:()=>Ke,backend_util:()=>f,basicLSTMCell:()=>Vn,batchNorm:()=>Kn,batchNorm2d:()=>Zn,batchNorm3d:()=>Xn,batchNorm4d:()=>Jn,batchToSpaceND:()=>qn.E,bincount:()=>Yn,booleanMaskAsync:()=>za,broadcastArgs:()=>Qn,broadcastTo:()=>tr.U,broadcast_util:()=>Qt,browser:()=>s,buffer:()=>Et,cast:()=>It.p,ceil:()=>er,clipByValue:()=>nr,clone:()=>At.d,complex:()=>x.P,concat:()=>jn.z,concat1d:()=>rr,concat2d:()=>ir,concat3d:()=>ar,concat4d:()=>sr,conv1d:()=>lr,conv2d:()=>or.T,conv2dTranspose:()=>hr,conv3d:()=>cr,conv3dTranspose:()=>fr,copyRegisteredKernels:()=>te.T3,cos:()=>pr.m,cosh:()=>mr.f,cosineWindow:()=>Ga,cumsum:()=>gr.z,customGrad:()=>ln,denseBincount:()=>br,deprecationWarn:()=>Re,depthToSpace:()=>yr,depthwiseConv2d:()=>vr,device_util:()=>r,diag:()=>wr,dilation2d:()=>_r,disableDeprecationWarnings:()=>Ce,dispose:()=>Pe,disposeVariables:()=>Oe,div:()=>Je.h,divNoNan:()=>Sr,dot:()=>Er,dropout:()=>ja,einsum:()=>Ir,elu:()=>Ar,enableDebugMode:()=>Ne,enableProdMode:()=>Te,enclosingPowerOfTwo:()=>Wa,engine:()=>De,env:()=>w.OB,equal:()=>kr.D,erf:()=>Mr,exp:()=>Tr.Q,expandDims:()=>Nr.d,expm1:()=>Cr,eye:()=>Or,fft:()=>ha,fill:()=>fn,findBackend:()=>He,findBackendFactory:()=>Ve,floor:()=>Dr.G,floorDiv:()=>zr.q,fused:()=>c,gather:()=>Br.I,gatherND:()=>Ua,gather_util:()=>o,getBackend:()=>We,getGradient:()=>te.uk,getKernel:()=>te.pI,getKernelsForBackend:()=>te.tr,grad:()=>nn,grads:()=>rn,greater:()=>Fr.p,greaterEqual:()=>Pr.b,ifft:()=>ca,imag:()=>Lr,image:()=>Xs,inTopKAsync:()=>Ha,io:()=>i,irfft:()=>da,isFinite:()=>$r,isInf:()=>Ur,isNaN:()=>jr,keep:()=>Le,kernel_impls:()=>p,leakyRelu:()=>Wr,less:()=>Gr.d,lessEqual:()=>Hr.z,linalg:()=>Js,linspace:()=>Vr,localResponseNormalization:()=>qr,log:()=>Kr.c,log1p:()=>Zr,logSigmoid:()=>Yr,logSoftmax:()=>ei,logSumExp:()=>ri,logicalAnd:()=>ii.H,logicalNot:()=>ai.h,logicalOr:()=>si,logicalXor:()=>oi,losses:()=>Ys,matMul:()=>qt.O,math:()=>a,max:()=>Qr,maxPool:()=>li,maxPool3d:()=>ui,maxPoolWithArgmax:()=>hi,maximum:()=>vn.g,mean:()=>ci,memory:()=>ze,meshgrid:()=>fi,min:()=>pi,minimum:()=>mi,mirrorPad:()=>gi,mod:()=>bi,moments:()=>yi,movingAverage:()=>Pa,mul:()=>Ye.d,multiRNNCell:()=>vi,multinomial:()=>wi,neg:()=>Xr.W,nextFrame:()=>ro,norm:()=>Fa,notEqual:()=>_i,oneHot:()=>Xt,ones:()=>di.i,onesLike:()=>ki,op:()=>Zt.op,outerProduct:()=>xi,pad:()=>Si.v,pad1d:()=>Ei,pad2d:()=>Ii,pad3d:()=>Ai,pad4d:()=>Mi,pool:()=>Ni,pow:()=>mn.s,prelu:()=>Ci,print:()=>Mt,prod:()=>Ri,profile:()=>Be,rand:()=>Oi,randomGamma:()=>Pi,randomNormal:()=>Li,randomUniform:()=>$i,range:()=>Ui,ready:()=>je,real:()=>ji,reciprocal:()=>Wi,registerBackend:()=>qe,registerGradient:()=>te.Li,registerKernel:()=>te.wC,relu:()=>Gi,relu6:()=>Hi,removeBackend:()=>Ge,reshape:()=>Ln.X,reverse:()=>Vi.G,reverse1d:()=>qi,reverse2d:()=>Ki,reverse3d:()=>Zi,reverse4d:()=>Xi,rfft:()=>ma,round:()=>Ji,rsqrt:()=>Yi.b,scalar:()=>hn.i,scatterND:()=>La,scatter_util:()=>l,selu:()=>Qi,separableConv2d:()=>ta,serialization:()=>u,setBackend:()=>Ue,setPlatform:()=>Ze,setdiff1dAsync:()=>ea,sigmoid:()=>Wn.X,sign:()=>na,signal:()=>Zs,sin:()=>ra.O,sinh:()=>ia.R,slice:()=>Gn.t,slice1d:()=>aa,slice2d:()=>sa,slice3d:()=>oa,slice4d:()=>la,slice_util:()=>ce,softmax:()=>ua,softplus:()=>Jr,spaceToBatchND:()=>Ti.f,sparse:()=>Qs,sparseToDense:()=>$a,spectral:()=>Ks,split:()=>fa.V,sqrt:()=>Qe._,square:()=>tn.h,squaredDifference:()=>ga,squeeze:()=>ba,stack:()=>ya.k,step:()=>va.N,stridedSlice:()=>wa,string:()=>to,sub:()=>gn.l,sum:()=>ti.S,sumOutType:()=>En.z4,tan:()=>_a,tanh:()=>Hn,tensor:()=>I,tensor1d:()=>ka,tensor2d:()=>xa,tensor3d:()=>ee,tensor4d:()=>Sa,tensor5d:()=>Ea,tensor6d:()=>Ia,tensor_util:()=>me,test_util:()=>h,tidy:()=>Fe,tile:()=>Rr.G,time:()=>$e,topk:()=>Aa,train:()=>eo,transpose:()=>Jt.p,truncatedNormal:()=>Ma,unique:()=>Ta,unregisterGradient:()=>te.bt,unregisterKernel:()=>te.nE,unsortedSegmentSum:()=>Na.p,unstack:()=>Ca.H,upcastType:()=>En.x8,util:()=>ge,valueAndGrad:()=>an,valueAndGrads:()=>sn,variable:()=>Ra,variableGrads:()=>on,version_core:()=>Me,where:()=>xr.a,whereAsync:()=>Da,zeros:()=>pa.l,zerosLike:()=>en.P});var r={};n.r(r),n.d(r,{isBrowser:()=>v,isMobile:()=>y,mockIsMobile:()=>b});var i={};n.r(i),n.d(i,{browserFiles:()=>Ot,browserHTTPRequest:()=>jt,concatenateArrayBuffers:()=>z,copyModel:()=>vt,decodeWeights:()=>C,encodeWeights:()=>N,fromMemory:()=>Ht,getLoadHandlers:()=>H,getModelArtifactsForJSON:()=>P,getModelArtifactsInfoForJSON:()=>L,getSaveHandlers:()=>G,http:()=>Ut,isHTTPScheme:()=>Lt,listModels:()=>bt,loadWeights:()=>Bt,moveModel:()=>wt,registerLoadRouter:()=>W,registerSaveRouter:()=>j,removeModel:()=>yt,weightsLoaderFactory:()=>Ft,withSaveHandler:()=>Vt});var a={};n.r(a),n.d(a,{confusionMatrix:()=>Yt});var s={};n.r(s),n.d(s,{fromPixels:()=>se,fromPixelsAsync:()=>ie,toPixels:()=>ae});var o={};n.r(o),n.d(o,{prepareAndValidate:()=>oe});var l={};n.r(l),n.d(l,{calculateShapes:()=>he,validateInput:()=>ue,validateUpdateShape:()=>le});var u={};n.r(u),n.d(u,{Serializable:()=>de,SerializationMap:()=>fe,registerClass:()=>pe});var h={};n.r(h),n.d(h,{TEST_EPSILON_FLOAT16:()=>be,encodeStrings:()=>Ae,expectArrayBuffersEqual:()=>Ie,expectArraysClose:()=>ye,expectArraysEqual:()=>ke,expectNumbersClose:()=>xe,expectPromiseToFail:()=>_e,expectValuesInRange:()=>Ee,testEpsilon:()=>ve});var c={};n.r(c),n.d(c,{conv2d:()=>Ja,depthwiseConv2d:()=>ts,matMul:()=>es});var d={};n.r(d),n.d(d,{collectGatherOpShapeInfo:()=>Qo,computeOutShape:()=>Yo,segOpComputeOptimalWindowSize:()=>Jo});var f={};n.r(f),n.d(f,{ERF_A1:()=>bo,ERF_A2:()=>yo,ERF_A3:()=>vo,ERF_A4:()=>wo,ERF_A5:()=>_o,ERF_P:()=>go,PARALLELIZE_THRESHOLD:()=>so,SELU_SCALE:()=>mo.$,SELU_SCALEALPHA:()=>mo.y,applyActivation:()=>Za,assertAndGetBroadcastShape:()=>Qt.assertAndGetBroadcastShape,assertAxesAreInnerMostDims:()=>ni.lB,assertParamsConsistent:()=>io,assignToTypedArray:()=>Mo,axesAreInnerMostDims:()=>ni.YB,calculateShapes:()=>he,checkEinsumDimSizes:()=>Do,checkPadOnDimRoundingMode:()=>Pn.m,combineLocations:()=>ni.Vh,complexWithEvenIndex:()=>Eo,complexWithOddIndex:()=>Io,computeConv2DInfo:()=>Pn.Ix,computeConv3DInfo:()=>Pn.jw,computeDefaultPad:()=>Pn.aO,computeDilation2DInfo:()=>Pn.Rf,computeOptimalWindowSize:()=>oo,computeOutAndReduceShapes:()=>ni.kz,computeOutShape:()=>ao,computePool2DInfo:()=>Pn.Xw,computePool3DInfo:()=>Pn.pl,convertConv2DDataFormat:()=>Pn.sl,decodeEinsumEquation:()=>Ro,eitherStridesOrDilationsAreOne:()=>Pn.jT,expandShapeToKeepDim:()=>ni.rv,exponent:()=>No,exponents:()=>To,fromStringArrayToUint8:()=>el,fromUint8ToStringArray:()=>tl,getAxesPermutation:()=>ni.Q3,getBroadcastDims:()=>Qt.getBroadcastDims,getComplexWithIndex:()=>Ao,getEinsumComputePath:()=>zo,getEinsumPermutation:()=>Oo,getFusedBiasGradient:()=>Ka,getFusedDyActivation:()=>qa,getImageCenter:()=>lo,getInnerMostAxes:()=>ni.sY,getPermuted:()=>ho,getReductionAxes:()=>Qt.getReductionAxes,getReshaped:()=>uo,getReshapedPermuted:()=>co,getSliceBeginCoords:()=>fo,getSliceSize:()=>po,getSparseFillEmptyRowsIndicesDenseShapeMismatch:()=>Lo,getSparseFillEmptyRowsNegativeIndexErrorMessage:()=>$o,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:()=>Uo,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:()=>Go,getSparseReshapeInputOutputMismatchErrorMessage:()=>Vo,getSparseReshapeInputOutputMultipleErrorMessage:()=>Ho,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:()=>jo,getSparseReshapeNegativeOutputDimErrorMessage:()=>Wo,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:()=>Xo,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:()=>qo,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:()=>Ko,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:()=>Zo,getUndoAxesPermutation:()=>ni.LJ,isIdentityPermutation:()=>Bo,log:()=>ko.c,mergeRealAndImagArrays:()=>xo,prepareAndValidate:()=>oe,prepareSplitSize:()=>Po,segment_util:()=>d,shouldFuse:()=>Xa,slice_util:()=>ce,splitRealAndImagArrays:()=>So,tupleValuesAreOne:()=>Pn.I0,upcastType:()=>En.x8,validateInput:()=>ue,validateUpdateShape:()=>le,warn:()=>ko.Z});var p={};n.r(p),n.d(p,{nonMaxSuppressionV3Impl:()=>ps,nonMaxSuppressionV4Impl:()=>ms,nonMaxSuppressionV5Impl:()=>gs,whereImpl:()=>Oa});var m=n(3733);let g;function b(t){g=t}function y(t){if(void 0!==g)return g;if(t||"undefined"!=typeof navigator&&null!=navigator){if(t||(t=navigator),"ReactNative"===t.product)return!0;const e=t.userAgent||t.vendor||("undefined"!=typeof window?window.opera:"");if(!e){const e=t;return e.userAgentData&&e.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}return!1}function v(){return"undefined"!=typeof window&&null!=window.document||"undefined"!=typeof WorkerGlobalScope}var w=n(7331),_=n(7671);const k=(0,w.OB)();k.registerFlag("DEBUG",(()=>!1),(t=>{t&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")})),k.registerFlag("IS_BROWSER",(()=>v())),k.registerFlag("IS_NODE",(()=>void 0!==_&&void 0!==_.versions&&void 0!==_.versions.node)),k.registerFlag("IS_CHROME",(()=>"undefined"!=typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor))),k.registerFlag("PROD",(()=>!1)),k.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",(()=>k.getBool("DEBUG"))),k.registerFlag("DEPRECATION_WARNINGS_ENABLED",(()=>!0)),k.registerFlag("IS_TEST",(()=>!1)),k.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",(()=>!0)),k.registerFlag("WRAP_TO_IMAGEBITMAP",(()=>!1));var x=n(5655),S=n(3329),E=n(709);function I(t,e,n){const r=(0,S.C)(t,n);return(0,E.H)(t,e,r,n)}var A=n(3591);const M={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8};var T=n(9208).Buffer;async function N(t,e){const n=[],r=[],i=Array.isArray(t)?t.map((t=>t.name)):Object.keys(t);for(let a=0;a<i.length;++a){const s=i[a],o=Array.isArray(t)?t[a].tensor:t[s];if("float32"!==o.dtype&&"int32"!==o.dtype&&"bool"!==o.dtype&&"string"!==o.dtype&&"complex64"!==o.dtype)throw new Error(`Unsupported dtype in weight '${s}': ${o.dtype}`);const l={name:s,shape:o.shape,dtype:o.dtype};if("string"===o.dtype){const t=new Promise((async t=>{const e=await o.bytes(),n=e.reduce(((t,e)=>t+e.length),0)+4*e.length,r=new Uint8Array(n);let i=0;for(let t=0;t<e.length;t++){const n=e[t],a=new Uint8Array(new Uint32Array([n.length]).buffer);r.set(a,i),i+=4,r.set(n,i),i+=n.length}t(r)}));r.push(t)}else r.push(o.data());null!=e&&(l.group=e),n.push(l)}return{data:R(await Promise.all(r)),specs:n}}function C(t,e){const n={};let r,i=0;for(const a of e){const e=a.name,s=a.dtype,o=a.shape,l=(0,A.NA)(o);let u;if("quantization"in a){const n=a.quantization;if("uint8"===n.dtype||"uint16"===n.dtype){if(!("min"in n)||!("scale"in n))throw new Error(`Weight ${a.name} with quantization ${n.dtype} doesn't have corresponding metadata min and scale.`)}else{if("float16"!==n.dtype)throw new Error(`Weight ${a.name} has unknown quantization dtype ${n.dtype}. Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.`);if("float32"!==s)throw new Error(`Weight ${a.name} is quantized with ${n.dtype} which only supports weights of type float32 not ${s}.`)}const o=M[n.dtype],h=t.slice(i,i+l*o),c="uint8"===n.dtype?new Uint8Array(h):new Uint16Array(h);if("float32"===s)if("uint8"===n.dtype||"uint16"===n.dtype){u=new Float32Array(c.length);for(let t=0;t<c.length;t++){const e=c[t];u[t]=e*n.scale+n.min}}else{if("float16"!==n.dtype)throw new Error(`Unsupported quantization type ${n.dtype} for weight type float32.`);void 0===r&&(r=$()),u=r(c)}else{if("int32"!==s)throw new Error(`Unsupported dtype in weight '${e}': ${s}`);if("uint8"!==n.dtype&&"uint16"!==n.dtype)throw new Error(`Unsupported quantization type ${n.dtype} for weight type int32.`);u=new Int32Array(c.length);for(let t=0;t<c.length;t++){const e=c[t];u[t]=Math.round(e*n.scale+n.min)}}i+=l*o}else if("string"===s){const e=(0,A.NA)(a.shape);u=[];for(let n=0;n<e;n++){const e=new Uint32Array(t.slice(i,i+4))[0];i+=4;const n=new Uint8Array(t.slice(i,i+e));u.push(n),i+=e}}else{const r=M[s],a=t.slice(i,i+l*r);if("float32"===s)u=new Float32Array(a);else if("int32"===s)u=new Int32Array(a);else if("bool"===s)u=new Uint8Array(a);else{if("complex64"!==s)throw new Error(`Unsupported dtype in weight '${e}': ${s}`);{u=new Float32Array(a);const t=new Float32Array(u.length/2),r=new Float32Array(u.length/2);for(let e=0;e<t.length;e++)t[e]=u[2*e],r[e]=u[2*e+1];const i=I(t,o,"float32"),s=I(r,o,"float32");n[e]=(0,x.P)(i,s),i.dispose(),s.dispose()}}i+=l*r}"complex64"!==s&&(n[e]=I(u,o,s))}return n}function R(t){if(null===t)throw new Error(`Invalid input value: ${JSON.stringify(t)}`);let e=0;const n=[];t.forEach((t=>{if(e+=t.byteLength,n.push(t.byteLength===t.buffer.byteLength?t:new t.constructor(t)),!(t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array))throw new Error(`Unsupported TypedArray subtype: ${t.constructor.name}`)}));const r=new Uint8Array(e);let i=0;return n.forEach((t=>{r.set(new Uint8Array(t.buffer),i),i+=t.byteLength})),r.buffer}const O=void 0!==T&&("undefined"==typeof Blob||"undefined"==typeof atob||"undefined"==typeof btoa);function D(t){return O?T.byteLength(t):new Blob([t]).size}function z(t){if(1===t.length)return t[0];let e=0;t.forEach((t=>{e+=t.byteLength}));const n=new Uint8Array(e);let r=0;return t.forEach((t=>{n.set(new Uint8Array(t),r),r+=t.byteLength})),n.buffer}function B(t){for(t=t.trim();t.endsWith("/");)t=t.slice(0,t.length-1);const e=t.split("/");return e[e.length-1]}function F(t,e){const n={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:e};return null!=t.signature&&(n.signature=t.signature),null!=t.userDefinedMetadata&&(n.userDefinedMetadata=t.userDefinedMetadata),null!=t.modelInitializer&&(n.modelInitializer=t.modelInitializer),null!=t.trainingConfig&&(n.trainingConfig=t.trainingConfig),n}async function P(t,e){const n={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy};if(null!=t.trainingConfig&&(n.trainingConfig=t.trainingConfig),null!=t.weightsManifest){const[r,i]=await e(t.weightsManifest);n.weightSpecs=r,n.weightData=i}return null!=t.signature&&(n.signature=t.signature),null!=t.userDefinedMetadata&&(n.userDefinedMetadata=t.userDefinedMetadata),null!=t.modelInitializer&&(n.modelInitializer=t.modelInitializer),n}function L(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:null==t.modelTopology?0:D(JSON.stringify(t.modelTopology)),weightSpecsBytes:null==t.weightSpecs?0:D(JSON.stringify(t.weightSpecs)),weightDataBytes:null==t.weightData?0:t.weightData.byteLength}}function $(){const t=function(){const t=t=>{let e=t<<13,n=0;for(;0==(8388608&e);)n-=8388608,e<<=1;return e&=-8388609,n+=947912704,e|n},e=new Uint32Array(2048);e[0]=0;for(let n=1;n<1024;n++)e[n]=t(n);for(let t=1024;t<2048;t++)e[t]=939524096+(t-1024<<13);return e}(),e=function(){const t=new Uint32Array(64);t[0]=0,t[31]=1199570944,t[32]=2147483648,t[63]=3347054592;for(let e=1;e<31;e++)t[e]=e<<23;for(let e=33;e<63;e++)t[e]=2147483648+(e-32<<23);return t}(),n=function(){const t=new Uint32Array(64);for(let e=0;e<64;e++)t[e]=1024;return t[0]=t[32]=0,t}();return r=>{const i=new ArrayBuffer(4*r.length),a=new Uint32Array(i);for(let i=0;i<r.length;i++){const s=r[i],o=t[n[s>>10]+(1023&s)]+e[s>>10];a[i]=o}return new Float32Array(i)}}class U{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return null==U.instance&&(U.instance=new U),U.instance}static registerSaveRouter(t){U.getInstance().saveRouters.push(t)}static registerLoadRouter(t){U.getInstance().loadRouters.push(t)}static getSaveHandlers(t){return U.getHandlers(t,"save")}static getLoadHandlers(t,e){return U.getHandlers(t,"load",e)}static getHandlers(t,e,n){const r=[];return("load"===e?U.getInstance().loadRouters:U.getInstance().saveRouters).forEach((e=>{const i=e(t,n);null!==i&&r.push(i)})),r}}const j=t=>U.registerSaveRouter(t),W=t=>U.registerLoadRouter(t),G=t=>U.getSaveHandlers(t),H=(t,e)=>U.getLoadHandlers(t,e),V="tensorflowjs",q="models_store",K="model_info_store";function Z(){if(!(0,w.OB)().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const t="undefined"==typeof window?self:window,e=t.indexedDB||t.mozIndexedDB||t.webkitIndexedDB||t.msIndexedDB||t.shimIndexedDB;if(null==e)throw new Error("The current browser does not appear to support IndexedDB.");return e}function X(t){const e=t.result;e.createObjectStore(q,{keyPath:"modelPath"}),e.createObjectStore(K,{keyPath:"modelPath"})}class J{constructor(t){if(this.indexedDB=Z(),null==t||!t)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=t}async save(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,t)}async load(){return this.databaseAction(this.modelPath)}databaseAction(t,e){return new Promise(((t,n)=>{const r=this.indexedDB.open(V,1);r.onupgradeneeded=()=>X(r),r.onsuccess=()=>{const i=r.result;if(null==e){const e=i.transaction(q,"readonly"),r=e.objectStore(q).get(this.modelPath);r.onsuccess=()=>{if(null==r.result)return i.close(),n(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));t(r.result.modelArtifacts)},r.onerror=t=>(i.close(),n(r.error)),e.oncomplete=()=>i.close()}else{const r=L(e),a=i.transaction(K,"readwrite");let s=a.objectStore(K);const o=s.put({modelPath:this.modelPath,modelArtifactsInfo:r});let l;o.onsuccess=()=>{l=i.transaction(q,"readwrite");const o=l.objectStore(q).put({modelPath:this.modelPath,modelArtifacts:e,modelArtifactsInfo:r});o.onsuccess=()=>t({modelArtifactsInfo:r}),o.onerror=t=>{s=a.objectStore(K);const e=s.delete(this.modelPath);e.onsuccess=()=>(i.close(),n(o.error)),e.onerror=t=>(i.close(),n(o.error))}},o.onerror=t=>(i.close(),n(o.error)),a.oncomplete=()=>{null==l?i.close():l.oncomplete=()=>i.close()}}},r.onerror=t=>n(r.error)}))}}J.URL_SCHEME="indexeddb://";const Y=t=>{return(0,w.OB)().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(J.URL_SCHEME)?(e=t.slice(J.URL_SCHEME.length),new J(e)):null;var e};U.registerSaveRouter(Y),U.registerLoadRouter(Y);class Q{constructor(){this.indexedDB=Z()}async listModels(){return new Promise(((t,e)=>{const n=this.indexedDB.open(V,1);n.onupgradeneeded=()=>X(n),n.onsuccess=()=>{const r=n.result,i=r.transaction(K,"readonly"),a=i.objectStore(K).getAll();a.onsuccess=()=>{const e={};for(const t of a.result)e[t.modelPath]=t.modelArtifactsInfo;t(e)},a.onerror=t=>(r.close(),e(a.error)),i.oncomplete=()=>r.close()},n.onerror=t=>e(n.error)}))}async removeModel(t){var e;return t=(e=t).startsWith(J.URL_SCHEME)?e.slice(J.URL_SCHEME.length):e,new Promise(((e,n)=>{const r=this.indexedDB.open(V,1);r.onupgradeneeded=()=>X(r),r.onsuccess=()=>{const i=r.result,a=i.transaction(K,"readwrite"),s=a.objectStore(K),o=s.get(t);let l;o.onsuccess=()=>{if(null==o.result)return i.close(),n(new Error(`Cannot find model with path '${t}' in IndexedDB.`));{const r=s.delete(t),a=()=>{l=i.transaction(q,"readwrite");const r=l.objectStore(q).delete(t);r.onsuccess=()=>e(o.result.modelArtifactsInfo),r.onerror=t=>n(o.error)};r.onsuccess=a,r.onerror=t=>(a(),i.close(),n(o.error))}},o.onerror=t=>(i.close(),n(o.error)),a.oncomplete=()=>{null==l?i.close():l.oncomplete=()=>i.close()}},r.onerror=t=>n(r.error)}))}}const tt="/",et="tensorflowjs_models",nt="info",rt="model_topology",it="weight_specs",at="weight_data",st="model_metadata";function ot(t){return{info:[et,t,nt].join(tt),topology:[et,t,rt].join(tt),weightSpecs:[et,t,it].join(tt),weightData:[et,t,at].join(tt),modelMetadata:[et,t,st].join(tt)}}function lt(t){for(const e of Object.values(t))window.localStorage.removeItem(e)}function ut(t){const e=t.split(tt);if(e.length<3)throw new Error(`Invalid key format: ${t}`);return e.slice(1,e.length-1).join(tt)}class ht{constructor(t){if(!(0,w.OB)().getBool("IS_BROWSER")||"undefined"==typeof window||void 0===window.localStorage)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,null==t||!t)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=t,this.keys=ot(this.modelPath)}async save(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const e=JSON.stringify(t.modelTopology),n=JSON.stringify(t.weightSpecs),r=L(t);try{this.LS.setItem(this.keys.info,JSON.stringify(r)),this.LS.setItem(this.keys.topology,e),this.LS.setItem(this.keys.weightSpecs,n),this.LS.setItem(this.keys.weightData,function(t){if(O)return T.from(t).toString("base64");const e=new Uint8Array(t);let n="";for(let t=0,r=e.length;t<r;t++)n+=String.fromCharCode(e[t]);return btoa(n)}(t.weightData));const i={format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,signature:null!=t.signature?t.signature:void 0,userDefinedMetadata:null!=t.userDefinedMetadata?t.userDefinedMetadata:void 0,modelInitializer:null!=t.modelInitializer?t.modelInitializer:void 0,trainingConfig:null!=t.trainingConfig?t.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(i)),{modelArtifactsInfo:r}}catch(t){throw lt(this.keys),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${r.modelTopologyBytes}, weightSpecsBytes=${r.weightSpecsBytes}, weightDataBytes=${r.weightDataBytes}.`)}}}async load(){const t=JSON.parse(this.LS.getItem(this.keys.info));if(null==t)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if("JSON"!==t.modelTopologyType)throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const e={},n=JSON.parse(this.LS.getItem(this.keys.topology));if(null==n)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);e.modelTopology=n;const r=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(null==r)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);e.weightSpecs=r;const i=this.LS.getItem(this.keys.modelMetadata);if(null!=i){const t=JSON.parse(i);e.format=t.format,e.generatedBy=t.generatedBy,e.convertedBy=t.convertedBy,null!=t.signature&&(e.signature=t.signature),null!=t.userDefinedMetadata&&(e.userDefinedMetadata=t.userDefinedMetadata),null!=t.modelInitializer&&(e.modelInitializer=t.modelInitializer),null!=t.trainingConfig&&(e.trainingConfig=t.trainingConfig)}const a=this.LS.getItem(this.keys.weightData);if(null==a)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return e.weightData=function(t){if(O){const e=T.from(t,"base64");return e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)}const e=atob(t),n=new Uint8Array(e.length);for(let t=0;t<e.length;++t)n.set([e.charCodeAt(t)],t);return n.buffer}(a),e}}ht.URL_SCHEME="localstorage://";const ct=t=>{return(0,w.OB)().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(ht.URL_SCHEME)?(e=t.slice(ht.URL_SCHEME.length),new ht(e)):null;var e};U.registerSaveRouter(ct),U.registerLoadRouter(ct);class dt{constructor(){(0,A.hu)((0,w.OB)().getBool("IS_BROWSER"),(()=>"Current environment is not a web browser")),(0,A.hu)("undefined"==typeof window||void 0!==window.localStorage,(()=>"Current browser does not appear to support localStorage")),this.LS=window.localStorage}async listModels(){const t={},e=et+tt,n=tt+nt;for(let r=0;r<this.LS.length;++r){const i=this.LS.key(r);i.startsWith(e)&&i.endsWith(n)&&(t[ut(i)]=JSON.parse(this.LS.getItem(i)))}return t}async removeModel(t){var e;const n=ot(t=(e=t).startsWith(ht.URL_SCHEME)?e.slice(ht.URL_SCHEME.length):e);if(null==this.LS.getItem(n.info))throw new Error(`Cannot find model at path '${t}'`);const r=JSON.parse(this.LS.getItem(n.info));return lt(n),r}}const ft="://";class pt{constructor(){this.managers={}}static getInstance(){return null==pt.instance&&(pt.instance=new pt),pt.instance}static registerManager(t,e){(0,A.hu)(null!=t,(()=>"scheme must not be undefined or null.")),t.endsWith(ft)&&(t=t.slice(0,t.indexOf(ft))),(0,A.hu)(t.length>0,(()=>"scheme must not be an empty string."));const n=pt.getInstance();(0,A.hu)(null==n.managers[t],(()=>`A model store manager is already registered for scheme '${t}'.`)),n.managers[t]=e}static getManager(t){const e=this.getInstance().managers[t];if(null==e)throw new Error(`Cannot find model manager for scheme '${t}'`);return e}static getSchemes(){return Object.keys(this.getInstance().managers)}}function mt(t){if(-1===t.indexOf(ft))throw new Error(`The url string provided does not contain a scheme. Supported schemes are: ${pt.getSchemes().join(",")}`);return{scheme:t.split(ft)[0],path:t.split(ft)[1]}}async function gt(t,e,n=!1){(0,A.hu)(t!==e,(()=>`Old path and new path are the same: '${t}'`));const r=U.getLoadHandlers(t);(0,A.hu)(r.length>0,(()=>`Copying failed because no load handler is found for source URL ${t}.`)),(0,A.hu)(r.length<2,(()=>`Copying failed because more than one (${r.length}) load handlers for source URL ${t}.`));const i=r[0],a=U.getSaveHandlers(e);(0,A.hu)(a.length>0,(()=>`Copying failed because no save handler is found for destination URL ${e}.`)),(0,A.hu)(a.length<2,(()=>`Copying failed because more than one (${r.length}) save handlers for destination URL ${e}.`));const s=a[0],o=mt(t).scheme,l=mt(t).path,u=o===mt(t).scheme,h=await i.load();n&&u&&await pt.getManager(o).removeModel(l);const c=await s.save(h);return n&&!u&&await pt.getManager(o).removeModel(l),c.modelArtifactsInfo}async function bt(){const t=pt.getSchemes(),e={};for(const n of t){const t=await pt.getManager(n).listModels();for(const r in t)e[n+ft+r]=t[r]}return e}async function yt(t){const e=mt(t);return pt.getManager(e.scheme).removeModel(e.path)}async function vt(t,e){return gt(t,e,!1)}async function wt(t,e){return gt(t,e,!0)}class _t{fetch(t,e){return fetch(t,e)}now(){return performance.now()}encode(t,e){if("utf-8"!==e&&"utf8"!==e)throw new Error(`Browser's encoder only supports utf-8, but got ${e}`);return null==this.textEncoder&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(t)}decode(t,e){return new TextDecoder(e).decode(t)}}if((0,w.OB)().get("IS_BROWSER")){(0,w.OB)().setPlatform("browser",new _t);try{pt.registerManager(ht.URL_SCHEME,new dt)}catch(t){}try{pt.registerManager(J.URL_SCHEME,new Q)}catch(t){}}var kt=n(7671);let xt;(0,w.OB)().get("IS_NODE")&&(0,w.OB)().setPlatform("node",new class{constructor(){this.util=n(8331),this.textEncoder=new this.util.TextEncoder}fetch(t,e){return null!=(0,w.OB)().global.fetch?(0,w.OB)().global.fetch(t,e):(null==xt&&(xt=n(7887)),xt(t,e))}now(){const t=kt.hrtime();return 1e3*t[0]+t[1]/1e6}encode(t,e){if("utf-8"!==e&&"utf8"!==e)throw new Error(`Node built-in encoder only supports utf-8, but got ${e}`);return this.textEncoder.encode(t)}decode(t,e){return 0===t.length?"":new this.util.TextDecoder(e).decode(t)}});var St=n(4197);function Et(t,e="float32",n){return e=e||"float32",A.Mu(t),new St.YD(t,e,n)}var It=n(6090),At=n(8429);function Mt(t,e=!1){console.log(t.toString(e))}(0,m.wv)();const Tt={buffer:Et,cast:It.p,clone:At.d,print:Mt};function Nt(t){return new Promise((t=>setTimeout(t))).then(t)}(0,St.Vp)(Tt);class Ct{constructor(t){if(!(0,w.OB)().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");t.startsWith(Ct.URL_SCHEME)&&(t=t.slice(Ct.URL_SCHEME.length)),null!=t&&0!==t.length||(t="model"),this.modelJsonFileName=t+".json",this.weightDataFileName=t+".weights.bin"}async save(t){if("undefined"==typeof document)throw new Error("Browser downloads are not supported in this environment since `document` is not present");const e=window.URL.createObjectURL(new Blob([t.weightData],{type:"application/octet-stream"}));if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{const n=F(t,[{paths:["./"+this.weightDataFileName],weights:t.weightSpecs}]),r=window.URL.createObjectURL(new Blob([JSON.stringify(n)],{type:"application/json"})),i=null==this.modelJsonAnchor?document.createElement("a"):this.modelJsonAnchor;if(i.download=this.modelJsonFileName,i.href=r,await Nt((()=>i.dispatchEvent(new MouseEvent("click")))),null!=t.weightData){const t=null==this.weightDataAnchor?document.createElement("a"):this.weightDataAnchor;t.download=this.weightDataFileName,t.href=e,await Nt((()=>t.dispatchEvent(new MouseEvent("click"))))}return{modelArtifactsInfo:L(t)}}}}Ct.URL_SCHEME="downloads://";class Rt{constructor(t){if(null==t||t.length<1)throw new Error(`When calling browserFiles, at least 1 file is required, but received ${t}`);this.jsonFile=t[0],this.weightsFiles=t.slice(1)}async load(){return new Promise(((t,e)=>{const n=new FileReader;n.onload=n=>{const r=JSON.parse(n.target.result),i=r.modelTopology;if(null==i)return void e(new Error(`modelTopology field is missing from file ${this.jsonFile.name}`));if(null==r.weightsManifest)return void e(new Error(`weightManifest field is missing from file ${this.jsonFile.name}`));if(0===this.weightsFiles.length)return void t({modelTopology:i});const a=P(r,(t=>this.loadWeights(t)));t(a)},n.onerror=t=>e(`Failed to read model topology and weights manifest JSON from file '${this.jsonFile.name}'. BrowserFiles supports loading Keras-style tf.Model artifacts only.`),n.readAsText(this.jsonFile)}))}loadWeights(t){const e=[],n=[];for(const r of t)e.push(...r.weights),n.push(...r.paths);const r=this.checkManifestAndWeightFiles(t),i=n.map((t=>this.loadWeightsFile(t,r[t])));return Promise.all(i).then((t=>[e,z(t)]))}loadWeightsFile(t,e){return new Promise(((n,r)=>{const i=new FileReader;i.onload=t=>{const e=t.target.result;n(e)},i.onerror=e=>r(`Failed to weights data from file of path '${t}'.`),i.readAsArrayBuffer(e)}))}checkManifestAndWeightFiles(t){const e=[],n=this.weightsFiles.map((t=>B(t.name))),r={};for(const i of t)i.paths.forEach((t=>{const i=B(t);if(-1!==e.indexOf(i))throw new Error(`Duplicate file basename found in weights manifest: '${i}'`);if(e.push(i),-1===n.indexOf(i))throw new Error(`Weight file with basename '${i}' is not provided.`);r[t]=this.weightsFiles[n.indexOf(i)]}));if(e.length!==this.weightsFiles.length)throw new Error(`Mismatch in the number of files in weights manifest (${e.length}) and the number of weight files provided (${this.weightsFiles.length}).`);return r}}function Ot(t){return new Rt(t)}function Dt(t,e,n,r){!function(t){(0,A.hu)(null!=t&&Array.isArray(t)&&t.length>0,(()=>"promises must be a none empty array"))}(t),function(t,e){(0,A.hu)(t>=0&&t<=1,(()=>`Progress fraction must be in range [0, 1], but got startFraction ${t}`)),(0,A.hu)(e>=0&&e<=1,(()=>`Progress fraction must be in range [0, 1], but got endFraction ${e}`)),(0,A.hu)(e>=t,(()=>`startFraction must be no more than endFraction, but got startFraction ${t} and endFraction ${e}`))}(n=null==n?0:n,r=null==r?1:r);let i=0;return Promise.all(t.map((a=>(a.then((a=>{const s=n+ ++i/t.length*(r-n);return e(s),a})),a))))}async function zt(t,e){null==e&&(e={});const n=null==e.fetchFunc?(0,w.OB)().platform.fetch:e.fetchFunc,r=t.map((t=>n(t,e.requestInit,{isBinary:!0}))),i=(null==e.onProgress?await Promise.all(r):await Dt(r,e.onProgress,0,.5)).map((t=>t.arrayBuffer()));return null==e.onProgress?await Promise.all(i):await Dt(i,e.onProgress,.5,1)}async function Bt(t,e="",n,r){return Ft((t=>zt(t,{requestInit:r})))(t,e,n)}function Ft(t){return async(e,n="",r)=>{const i=e.map((()=>!1)),a={},s=null!=r?r.map((()=>!1)):[],o=[];if(e.forEach(((t,e)=>{let n=0;t.weights.forEach((t=>{const l="quantization"in t?t.quantization.dtype:t.dtype,u=M[l]*A.NA(t.shape),h=()=>{i[e]=!0,null==a[e]&&(a[e]=[]),a[e].push({manifestEntry:t,groupOffset:n,sizeBytes:u})};null!=r?r.forEach(((e,n)=>{e===t.name&&(h(),s[n]=!0)})):h(),o.push(t.name),n+=u}))})),!s.every((t=>t))){const t=r.filter(((t,e)=>!s[e]));throw new Error(`Could not find weights in manifest with names: ${t.join(", ")}. \nManifest JSON has weights with names: ${o.join(", ")}.`)}const l=i.reduce(((t,e,n)=>(e&&t.push(n),t)),[]),u=[];l.forEach((t=>{e[t].paths.forEach((t=>{const e=n+(n.endsWith("/")?"":"/")+t;u.push(e)}))}));const h=await t(u),c={};let d=0;return l.forEach((t=>{const n=e[t].paths.length;let r=0;for(let t=0;t<n;t++)r+=h[d+t].byteLength;const i=new ArrayBuffer(r),s=new Uint8Array(i);let o=0;for(let t=0;t<n;t++){const e=new Uint8Array(h[d+t]);s.set(e,o),o+=e.byteLength}a[t].forEach((t=>{const e=C(i.slice(t.groupOffset,t.groupOffset+t.sizeBytes),[t.manifestEntry]);for(const t in e)c[t]=e[t]})),d+=n})),c}}U.registerSaveRouter((t=>(0,w.OB)().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(Ct.URL_SCHEME)?function(t="model"){return new Ct(t)}(t.slice(Ct.URL_SCHEME.length)):null));class Pt{constructor(t,e){if(this.DEFAULT_METHOD="POST",null==e&&(e={}),this.weightPathPrefix=e.weightPathPrefix,this.onProgress=e.onProgress,this.weightUrlConverter=e.weightUrlConverter,null!=e.fetchFunc?((0,A.hu)("function"==typeof e.fetchFunc,(()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)")),this.fetch=e.fetchFunc):this.fetch=(0,w.OB)().platform.fetch,(0,A.hu)(null!=t&&t.length>0,(()=>"URL path for http must not be null, undefined or empty.")),Array.isArray(t)&&(0,A.hu)(2===t.length,(()=>`URL paths for http must have a length of 2, (actual length is ${t.length}).`)),this.path=t,null!=e.requestInit&&null!=e.requestInit.body)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=e.requestInit||{}}async save(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");const e=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);e.body=new FormData;const n=F(t,[{paths:["./model.weights.bin"],weights:t.weightSpecs}]);e.body.append("model.json",new Blob([JSON.stringify(n)],{type:"application/json"}),"model.json"),null!=t.weightData&&e.body.append("model.weights.bin",new Blob([t.weightData],{type:"application/octet-stream"}),"model.weights.bin");const r=await this.fetch(this.path,e);if(r.ok)return{modelArtifactsInfo:L(t),responses:[r]};throw new Error(`BrowserHTTPRequest.save() failed due to HTTP response status ${r.status}.`)}async load(){const t=await this.fetch(this.path,this.requestInit);if(!t.ok)throw new Error(`Request to ${this.path} failed with status code ${t.status}. Please verify this URL points to the model JSON of the model to load.`);let e;try{e=await t.json()}catch(t){let e=`Failed to parse model JSON of response from ${this.path}.`;throw this.path.endsWith(".pb")?e+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":e+=" Please make sure the server is serving valid JSON for this request.",new Error(e)}const n=e.modelTopology,r=e.weightsManifest;if(null==n&&null==r)throw new Error(`The JSON from HTTP path ${this.path} contains neither model topology or manifest for weights.`);return P(e,(t=>this.loadWeights(t)))}async loadWeights(t){const e=Array.isArray(this.path)?this.path[1]:this.path,[n,r]=function(t){const e=t.lastIndexOf("/"),n=t.lastIndexOf("?");return[t.substring(0,e)+"/",n>e?t.substring(n):""]}(e),i=this.weightPathPrefix||n,a=[];for(const e of t)a.push(...e.weights);const s=[],o=[];for(const e of t)for(const t of e.paths)null!=this.weightUrlConverter?o.push(this.weightUrlConverter(t)):s.push(i+t+r);return this.weightUrlConverter&&s.push(...await Promise.all(o)),[a,z(await zt(s,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress}))]}}function Lt(t){return null!=t.match(Pt.URL_SCHEME_REGEX)}Pt.URL_SCHEME_REGEX=/^https?:\/\//;const $t=(t,e)=>{if("undefined"==typeof fetch&&(null==e||null==e.fetchFunc))return null;{let n=!0;if(n=Array.isArray(t)?t.every((t=>Lt(t))):Lt(t),n)return Ut(t,e)}return null};function Ut(t,e){return new Pt(t,e)}function jt(t,e){return Ut(t,e)}U.registerSaveRouter($t),U.registerLoadRouter($t);class Wt{constructor(t){this.modelArtifacts=t}async load(){return this.modelArtifacts}}class Gt{constructor(t){this.saveHandler=t}async save(t){return this.saveHandler(t)}}function Ht(t,e,n,r){return 1===arguments.length?null!=t.modelTopology||null!=t.weightSpecs?new Wt(t):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Wt({modelTopology:t})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Wt({modelTopology:t,weightSpecs:e,weightData:n,trainingConfig:r}))}function Vt(t){return new Gt(t)}var qt=n(7896),Kt=n(3960),Zt=n(1581);const Xt=(0,Zt.op)({oneHot_:function(t,e,n=1,r=0){if(e<2)throw new Error(`Error in oneHot: depth must be >=2, but it is ${e}`);const i={indices:(0,S._1)(t,"indices","oneHot","int32")},a={depth:e,onValue:n,offValue:r};return m.BV.runKernel(Kt.we,i,a)}});var Jt=n(8599);const Yt=(0,Zt.op)({confusionMatrix_:function(t,e,n){const r=(0,S._1)(t,"labels","confusionMatrix"),i=(0,S._1)(e,"predictions","confusionMatrix");A.hu(null==n||n>0&&Number.isInteger(n),(()=>`If provided, numClasses must be a positive integer, but got ${n}`)),A.hu(1===r.rank,(()=>`Expected the rank of labels to be 1, but got ${r.rank}`)),A.hu(1===i.rank,(()=>`Expected the rank of predictions to be 1, but got ${i.rank}`)),A.hu(r.shape[0]===i.shape[0],(()=>`Mismatch in the number of examples: ${r.shape[0]} vs. ${i.shape[0]}. Labels and predictions should have the same number of elements.`)),A.hu(n>0&&Number.isInteger(n),(()=>`numClasses is required to be a positive integer, but got ${n}`));const a=Xt((0,It.p)(r,"int32"),n),s=Xt((0,It.p)(i,"int32"),n),o=(0,Jt.p)(a),l=(0,qt.O)(o,s);return(0,It.p)(l,"int32")}});var Qt=n(5725),te=n(3796);function ee(t,e,n){if((0,A.Cq)(t),null!=e&&3!==e.length)throw new Error("tensor3d() requires shape to have three numbers");const r=(0,S.C)(t,n);if(3!==r.length&&1!==r.length)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return(0,E.H)(t,e,r,n)}let ne;function re(t,e=3){if(e>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(null==t)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");let n=!1,r=!1,i=!1,a=!1,s=!1,o=!1;if(t.data instanceof Uint8Array)n=!0;else if("undefined"!=typeof ImageData&&t instanceof ImageData)r=!0;else if("undefined"!=typeof HTMLVideoElement&&t instanceof HTMLVideoElement)i=!0;else if("undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement)a=!0;else if(null!=t.getContext)s=!0;else{if(!("undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap))throw new Error(`pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was ${t.constructor.name}`);o=!0}if(i){const e=2;if(i&&t.readyState<e)throw new Error("The video element has not loaded data yet. Please wait for `loadeddata` event on the <video> element.")}if(null!=(0,te.pI)(Kt.eB,m.BV.backendName)){const n={pixels:t},r={numChannels:e};return m.BV.runKernel(Kt.eB,n,r)}const[l,u]=i?[t.videoWidth,t.videoHeight]:[t.width,t.height];let h,c;if(s)h=t.getContext("2d").getImageData(0,0,l,u).data;else if(r||n)h=t.data;else if(a||i||o){if(null==ne)if("undefined"==typeof document){if("undefined"==typeof OffscreenCanvas||"undefined"==typeof OffscreenCanvasRenderingContext2D)throw new Error("Cannot parse input in current context. Reason: OffscreenCanvas Context2D rendering is not supported.");ne=new OffscreenCanvas(1,1).getContext("2d")}else ne=document.createElement("canvas").getContext("2d");ne.canvas.width=l,ne.canvas.height=u,ne.drawImage(t,0,0,l,u),h=ne.getImageData(0,0,l,u).data}if(4===e)c=new Int32Array(h);else{const t=l*u;c=new Int32Array(t*e);for(let n=0;n<t;n++)for(let t=0;t<e;++t)c[n*e+t]=h[4*n+t]}return ee(c,[u,l,e],"int32")}async function ie(t,e=3){let n=null;if((0,w.OB)().getBool("WRAP_TO_IMAGEBITMAP")&&function(t){return"undefined"!=typeof window&&"undefined"!=typeof ImageBitmap&&window.hasOwnProperty("createImageBitmap")&&!(t instanceof ImageBitmap)&&function(t){return null!=t&&0!==t.width&&0!==t.height}(t)&&!function(t){return null!=t&&t.data instanceof Uint8Array}(t)}(t)){let e;try{e=await createImageBitmap(t,{premultiplyAlpha:"none"})}catch(t){e=null}n=null!=e&&e.width===t.width&&e.height===t.height?e:t}else n=t;return re(n,e)}async function ae(t,e){let n=(0,S._1)(t,"img","toPixels");if(!(t instanceof St.es)){const t=n;n=(0,It.p)(t,"int32"),t.dispose()}if(2!==n.rank&&3!==n.rank)throw new Error(`toPixels only supports rank 2 or 3 tensors, got rank ${n.rank}.`);const[r,i]=n.shape.slice(0,2),a=2===n.rank?1:n.shape[2];if(a>4||2===a)throw new Error(`toPixels only supports depth of size 1, 3 or 4 but got ${a}`);if("float32"!==n.dtype&&"int32"!==n.dtype)throw new Error(`Unsupported type for toPixels: ${n.dtype}. Please use float32 or int32 tensors.`);const s=await n.data(),o="float32"===n.dtype?255:1,l=new Uint8ClampedArray(i*r*4);for(let t=0;t<r*i;++t){const e=[0,0,0,255];for(let r=0;r<a;r++){const i=s[t*a+r];if("float32"===n.dtype){if(i<0||i>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${i}.`)}else if("int32"===n.dtype&&(i<0||i>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${i}.`);1===a?(e[0]=i*o,e[1]=i*o,e[2]=i*o):e[r]=i*o}const r=4*t;l[r+0]=Math.round(e[0]),l[r+1]=Math.round(e[1]),l[r+2]=Math.round(e[2]),l[r+3]=Math.round(e[3])}if(null!=e){e.width=i,e.height=r;const t=e.getContext("2d"),n=new ImageData(l,i,r);t.putImageData(n,0,0)}return n!==t&&n.dispose(),l}const se=(0,Zt.op)({fromPixels_:re});function oe(t,e){const n=t.shape.length,r=e.shape.length;if(n<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${n}.`);if(r<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${r}.`);if("int32"!==e.dtype)throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${e.dtype}.`);if(e.shape[r-1]>n)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${e.shape[r-1]} vs. ${n}`);if(0===(0,A.NA)(t.shape))throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${t.shape}.`);const i=e.shape,a=i[i.length-1];let s=1;for(let t=0;t<i.length-1;++t)s*=i[t];const o=t.shape,l=i.slice();l.pop();let u=1;for(let t=a;t<n;++t)u*=o[t],l.push(o[t]);const h=[...(0,A.e3)(t.shape).map((t=>t/u)),1].slice(0,a);return[l,s,u,h]}function le(t,e,n){const r=e.rank>1?e.shape[e.rank-1]:1,i=e.rank>1?e.rank-1:1,a=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${n.shape}, indices.shape: ${e.shape}, shape: ${t}, sliceDim: ${r}, and batchDim: ${i}.`;if(n.rank<i)throw new Error(a+` update.rank < ${i}. `);if(t.length<r+(n.rank-i))throw new Error(a+` Output shape length < ${r+(n.rank-i)}`);if(n.rank!==i+t.length-r)throw new Error(a+" update.rank != "+(i+t.length-r));for(let t=0;t<i;++t)if(n.shape[t]!==e.shape[t])throw new Error(a+` updates.shape[${t}] (${n.shape[t]}) != indices.shape[${t}] (${e.shape[t]}).`);for(let e=0;e<n.rank-i;++e)if(n.shape[e+i]!==t[e+r])throw new Error(a+` updates.shape[${e+i}] (${n.shape[e+i]}) != shape[${e+i}] (${t[e+i]})`)}function ue(t,e,n){if(e.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${e.rank}.`);if(t.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${t.rank}.`);if("int32"!==e.dtype)throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${e.dtype}`);if(n.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${n}`);if(0===n.length){if(0===e.size)throw new Error(`Indices specified for empty output. indices shape: ${e.shape}`);if(0===t.size)throw new Error(`Updates specified for empty output. updates shape: ${t.shape}`)}le(n,e,t)}function he(t,e,n){const r=e.shape.length,i=r>1?e.shape[r-1]:1,a=n.length;let s=1;for(let t=i;t<a;++t)s*=n[t];const o=i<1?1:i;return{sliceRank:i,numUpdates:(0,A.NA)(e.shape)/o,sliceSize:s,strides:[...(0,A.e3)(n.slice(0,i)),1],outputSize:(0,A.NA)(n)}}var ce=n(6997);class de{getClassName(){return this.constructor.className}static fromConfig(t,e){return new t(e)}}class fe{constructor(){this.classNameMap={}}static getMap(){return null==fe.instance&&(fe.instance=new fe),fe.instance}static register(t){fe.getMap().classNameMap[t.className]=[t,t.fromConfig]}}function pe(t){(0,A.hu)(null!=t.className,(()=>"Class being registered does not have the static className property defined.")),(0,A.hu)("string"==typeof t.className,(()=>"className is required to be a string, but got type "+typeof t.className)),(0,A.hu)(t.className.length>0,(()=>"Class being registered has an empty-string as its className, which is disallowed.")),fe.register(t)}var me=n(382),ge=n(1987);const be=.1;function ye(t,e,n){return null==n&&(n=ve()),we(t,e,((t,e)=>Se(t,e,n)))}function ve(){return 32===m.BV.backend.floatPrecision()?.001:be}function we(t,e,n){let r=!0;if(((0,A.fU)(t)||(0,A.fU)(e))&&(r=!1),(0,A.fU)(t)&&(0,A.fU)(e)&&(r=!0),r){const n=t.constructor.name,r=e.constructor.name;if(n!==r)throw new Error(`Arrays are of different type. Actual: ${n}. Expected: ${r}`)}if(Array.isArray(t)&&Array.isArray(e)){const n=(0,S.C)(t),r=(0,S.C)(e);if(!(0,A.cO)(n,r))throw new Error(`Arrays have different shapes. Actual: [${n}]. Expected: [${r}]`)}const i=(0,A.fU)(t)?t:(0,A.xH)(t),a=(0,A.fU)(e)?e:(0,A.xH)(e);if(i.length!==a.length)throw new Error(`Arrays have different lengths actual: ${i.length} vs expected: ${a.length}.\nActual:   ${i}.\nExpected: ${a}.`);for(let t=0;t<a.length;++t){const e=i[t],r=a[t];if(!n(e,r))throw new Error(`Arrays differ: actual[${t}] = ${e}, expected[${t}] = ${r}.\nActual:   ${i}.\nExpected: ${a}.`)}}function _e(t,e){t().then((()=>e.fail()),(()=>e()))}function ke(t,e){const n="string"==typeof e||"number"==typeof e||"boolean"==typeof e?[e]:e;return(0,A.HD)(t)||(0,A.HD)(t[0])||(0,A.HD)(e)||(0,A.HD)(e[0])?we(t,n,((t,e)=>t==e)):we(t,e,((t,e)=>Se(t,e,0)))}function xe(t,e,n){if(null==n&&(n=ve()),!Se(t,e,n))throw new Error(`Numbers differ: actual === ${t}, expected === ${e}`)}function Se(t,e,n){return!isFinite(t)&&!isFinite(e)||!(isNaN(t)||isNaN(e)||Math.abs(t-e)>n)}function Ee(t,e,n){for(let r=0;r<t.length;r++)if(t[r]<e||t[r]>n)throw new Error(`Value out of range:${t[r]} low: ${e}, high: ${n}`)}function Ie(t,e){expect(new Float32Array(t)).toEqual(new Float32Array(e))}function Ae(t){for(let e=0;e<t.length;e++){const n=t[e];Array.isArray(n)?Ae(n):t[e]=(0,ge.encodeString)(n)}return t}const Me="3.12.0";function Te(){(0,w.OB)().set("PROD",!0)}function Ne(){(0,w.OB)().set("DEBUG",!0)}function Ce(){(0,w.OB)().set("DEPRECATION_WARNINGS_ENABLED",!1),console.warn("TensorFlow.js deprecation warnings have been disabled.")}function Re(t){(0,w.OB)().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(t+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function Oe(){m.BV.disposeVariables()}function De(){return m.BV}function ze(){return m.BV.memory()}function Be(t){return m.BV.profile(t)}function Fe(t,e){return m.BV.tidy(t,e)}function Pe(t){(0,me.getTensorsInContainer)(t).forEach((t=>t.dispose()))}function Le(t){return m.BV.keep(t)}function $e(t){return m.BV.time(t)}function Ue(t){return m.BV.setBackend(t)}function je(){return m.BV.ready()}function We(){return m.BV.backendName}function Ge(t){m.BV.removeBackend(t)}function He(t){return m.BV.findBackend(t)}function Ve(t){return m.BV.findBackendFactory(t)}function qe(t,e,n=1){return m.BV.registerBackend(t,e,n)}function Ke(){return m.BV.backend}function Ze(t,e){(0,w.OB)().setPlatform(t,e)}(0,St.FZ)(Re);var Xe=n(4602),Je=n(3374),Ye=n(6885),Qe=n(5483),tn=n(5064),en=n(4816);function nn(t){return A.hu(A.mf(t),(()=>"The f passed in grad(f) must be a function")),(e,n)=>{const r=(0,S._1)(e,"x","tf.grad","string_or_numeric"),i=null!=n?(0,S._1)(n,"dy","tf.grad"):null;return m.BV.tidy((()=>{const{value:e,grads:n}=m.BV.gradients((()=>t(r)),[r],i);return null!=i&&A.k5(e.shape,i.shape,"The shape of dy passed in grad(f)(x, dy) must match the shape returned by f(x)"),un(n),n[0]}))}}function rn(t){return A.hu(A.mf(t),(()=>"The f passed in grads(f) must be a function")),(e,n)=>{A.hu(Array.isArray(e),(()=>"The args passed in grads(f)(args) must be an array of `Tensor`s or `TensorLike`s"));const r=(0,S.sI)(e,"args","tf.grads","string_or_numeric"),i=null!=n?(0,S._1)(n,"dy","tf.grads"):null;return m.BV.tidy((()=>{const{value:e,grads:n}=m.BV.gradients((()=>t(...r)),r,i);return null!=i&&A.k5(e.shape,i.shape,"The shape of dy passed in grads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),un(n),n}))}}function an(t){return A.hu(A.mf(t),(()=>"The f passed in valueAndGrad(f) must be a function")),(e,n)=>{A.hu(e instanceof St.es,(()=>"The x passed in valueAndGrad(f)(x) must be a tensor")),A.hu(null==n||n instanceof St.es,(()=>"The dy passed in valueAndGrad(f)(x, dy) must be a tensor"));const{grads:r,value:i}=m.BV.gradients((()=>t(e)),[e],n);return un(r),{grad:r[0],value:i}}}function sn(t){return A.hu(A.mf(t),(()=>"The f passed in valueAndGrads(f) must be a function")),(e,n)=>{A.hu(Array.isArray(e)&&e.every((t=>t instanceof St.es)),(()=>"The args passed in valueAndGrads(f)(args) must be array of tensors")),A.hu(null==n||n instanceof St.es,(()=>"The dy passed in valueAndGrads(f)(args, dy) must be a tensor"));const r=m.BV.gradients((()=>t(...e)),e,n);return null!=n&&A.k5(r.value.shape,n.shape,"The shape of dy passed in valueAndGrads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),un(r.grads),r}}function on(t,e){A.hu(A.mf(t),(()=>"The f passed in variableGrads(f) must be a function")),A.hu(null==e||Array.isArray(e)&&e.every((t=>t instanceof St._w)),(()=>"The varList passed in variableGrads(f, varList) must be an array of variables"));const n=null!=e;if(!n){e=[];for(const t in m.BV.registeredVariables)e.push(m.BV.registeredVariables[t])}const r=n?e.filter((t=>!t.trainable)):null,i=e.length;e=e.filter((t=>t.trainable)),A.hu(e.length>0,(()=>`variableGrads() expects at least one of the input variables to be trainable, but none of the ${i} variables is trainable.`));const{value:a,grads:s}=m.BV.gradients(t,e,null,!0);A.hu(s.some((t=>null!=t)),(()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize().")),A.hu(0===a.rank,(()=>`The f passed in variableGrads(f) must return a scalar, but it returned a rank-${a.rank} tensor`));const o={};return e.forEach(((t,e)=>{null!=s[e]&&(o[t.name]=s[e])})),null!=r&&r.forEach((t=>o[t.name]=null)),{value:a,grads:o}}function ln(t){return m.BV.customGrad(t)}function un(t){if(t.filter((t=>null==t)).length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that\n    the f you passed encloses all operations that lead from x to y.")}var hn=n(9641);class cn extends de{minimize(t,e=!1,n){const{value:r,grads:i}=this.computeGradients(t,n);if(null!=n){const t=n.map((t=>({name:t.name,tensor:i[t.name]})));this.applyGradients(t)}else this.applyGradients(i);return Pe(i),e?r:(r.dispose(),null)}get iterations(){return null==this.iterations_&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(t,e){return on(t,e)}dispose(){null!=this.iterations_&&Pe(this.iterations_)}async saveIterations(){return null==this.iterations_&&(this.iterations_=0),{name:"iter",tensor:(0,hn.i)(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(t){throw new Error(`setWeights() is not implemented for this optimizer class ${this.getClassName()}`)}async extractIterations(t){return this.iterations_=(await t[0].tensor.data())[0],t.slice(1)}}Object.defineProperty(cn,Symbol.hasInstance,{value:t=>null!=t.minimize&&null!=t.computeGradients&&null!=t.applyGradients});class dn extends cn{constructor(t,e,n=null){super(),this.learningRate=t,this.rho=e,this.epsilon=n,this.accumulatedGrads=[],this.accumulatedUpdates=[],null==n&&(this.epsilon=m.BV.backend.epsilon())}applyGradients(t){(Array.isArray(t)?t.map((t=>t.name)):Object.keys(t)).forEach(((e,n)=>{const r=m.BV.registeredVariables[e];null==this.accumulatedGrads[n]&&(this.accumulatedGrads[n]={originalName:`${e}/accum_grad`,variable:Fe((()=>(0,en.P)(r).variable(!1)))}),null==this.accumulatedUpdates[n]&&(this.accumulatedUpdates[n]={originalName:`${e}/accum_var`,variable:Fe((()=>(0,en.P)(r).variable(!1)))});const i=Array.isArray(t)?t[n].tensor:t[e];if(null==i)return;const a=this.accumulatedGrads[n].variable,s=this.accumulatedUpdates[n].variable;Fe((()=>{const t=(0,Xe.I)((0,Ye.d)(a,this.rho),(0,Ye.d)((0,tn.h)(i),1-this.rho)),e=(0,Ye.d)((0,Je.h)((0,Qe._)((0,Xe.I)(s,this.epsilon)),(0,Qe._)((0,Xe.I)(a,this.epsilon))),i),n=(0,Xe.I)((0,Ye.d)(s,this.rho),(0,Ye.d)((0,tn.h)(e),1-this.rho));a.assign(t),s.assign(n);const o=(0,Xe.I)((0,Ye.d)(e,-this.learningRate),r);r.assign(o)}))})),this.incrementIterations()}dispose(){null!=this.accumulatedUpdates&&(Pe(this.accumulatedGrads.map((t=>t.variable))),Pe(this.accumulatedUpdates.map((t=>t.variable))))}async getWeights(){const t=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(t.map((t=>({name:t.originalName,tensor:t.variable}))))}async setWeights(t){const e=(t=await this.extractIterations(t)).length/2;this.accumulatedGrads=t.slice(0,e).map((t=>({originalName:t.name,variable:t.tensor.variable(!1)}))),this.accumulatedUpdates=t.slice(e,2*e).map((t=>({originalName:t.name,variable:t.tensor.variable(!1)})))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(t,e){return new t(e.learningRate,e.rho,e.epsilon)}}function fn(t,e,n){const r={shape:t,value:e,dtype:n};return m.BV.runKernel(Kt.de,{},r)}dn.className="Adadelta",pe(dn);class pn extends cn{constructor(t,e=.1){super(),this.learningRate=t,this.initialAccumulatorValue=e,this.accumulatedGrads=[]}applyGradients(t){(Array.isArray(t)?t.map((t=>t.name)):Object.keys(t)).forEach(((e,n)=>{const r=m.BV.registeredVariables[e];if(null==this.accumulatedGrads[n]){const t=!1;this.accumulatedGrads[n]={originalName:`${e}/accumulator`,variable:Fe((()=>fn(r.shape,this.initialAccumulatorValue).variable(t)))}}const i=Array.isArray(t)?t[n].tensor:t[e];if(null==i)return;const a=this.accumulatedGrads[n].variable;Fe((()=>{const t=(0,Xe.I)(a,(0,tn.h)(i));a.assign(t);const e=(0,Xe.I)((0,Ye.d)((0,Je.h)(i,(0,Qe._)((0,Xe.I)(t,m.BV.backend.epsilon()))),-this.learningRate),r);r.assign(e)}))})),this.incrementIterations()}dispose(){null!=this.accumulatedGrads&&Pe(this.accumulatedGrads.map((t=>t.variable)))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map((t=>({name:t.originalName,tensor:t.variable}))))}async setWeights(t){t=await this.extractIterations(t),this.accumulatedGrads=t.map((t=>({originalName:t.name,variable:t.tensor.variable(!1)})))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(t,e){return new t(e.learningRate,e.initialAccumulatorValue)}}pn.className="Adagrad",pe(pn);var mn=n(5277),gn=n(5630);class bn extends cn{constructor(t,e,n,r=null){super(),this.learningRate=t,this.beta1=e,this.beta2=n,this.epsilon=r,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],Fe((()=>{this.accBeta1=(0,hn.i)(e).variable(),this.accBeta2=(0,hn.i)(n).variable()})),null==r&&(this.epsilon=m.BV.backend.epsilon())}applyGradients(t){const e=Array.isArray(t)?t.map((t=>t.name)):Object.keys(t);Fe((()=>{const n=(0,gn.l)(1,this.accBeta1),r=(0,gn.l)(1,this.accBeta2);e.forEach(((e,i)=>{const a=m.BV.registeredVariables[e];null==this.accumulatedFirstMoment[i]&&(this.accumulatedFirstMoment[i]={originalName:`${e}/m`,variable:Fe((()=>(0,en.P)(a).variable(!1)))}),null==this.accumulatedSecondMoment[i]&&(this.accumulatedSecondMoment[i]={originalName:`${e}/v`,variable:Fe((()=>(0,en.P)(a).variable(!1)))});const s=Array.isArray(t)?t[i].tensor:t[e];if(null==s)return;const o=this.accumulatedFirstMoment[i].variable,l=this.accumulatedSecondMoment[i].variable,u=(0,Xe.I)((0,Ye.d)(o,this.beta1),(0,Ye.d)(s,1-this.beta1)),h=(0,Xe.I)((0,Ye.d)(l,this.beta2),(0,Ye.d)((0,tn.h)(s),1-this.beta2)),c=(0,Je.h)(u,n),d=(0,Je.h)(h,r);o.assign(u),l.assign(h);const f=(0,Xe.I)((0,Ye.d)((0,Je.h)(c,(0,Xe.I)((0,Qe._)(d),this.epsilon)),-this.learningRate),a);a.assign(f)})),this.accBeta1.assign((0,Ye.d)(this.accBeta1,this.beta1)),this.accBeta2.assign((0,Ye.d)(this.accBeta2,this.beta2))})),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),null!=this.accumulatedFirstMoment&&Pe(this.accumulatedFirstMoment.map((t=>t.variable))),null!=this.accumulatedSecondMoment&&Pe(this.accumulatedSecondMoment.map((t=>t.variable)))}async getWeights(){const t=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(t.map((t=>({name:t.originalName,tensor:t.variable}))))}async setWeights(t){t=await this.extractIterations(t),Fe((()=>{this.accBeta1.assign((0,mn.s)(this.beta1,this.iterations_+1)),this.accBeta2.assign((0,mn.s)(this.beta2,this.iterations_+1))}));const e=t.length/2;this.accumulatedFirstMoment=t.slice(0,e).map((t=>({originalName:t.name,variable:t.tensor.variable(!1)}))),this.accumulatedSecondMoment=t.slice(e,2*e).map((t=>({originalName:t.name,variable:t.tensor.variable(!1)})))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(t,e){return new t(e.learningRate,e.beta1,e.beta2,e.epsilon)}}bn.className="Adam",pe(bn);const yn=(0,Zt.op)({abs_:function(t){const e=(0,S._1)(t,"x","abs");if("complex64"===e.dtype){const t={x:e};return m.BV.runKernel(Kt.yj,t)}{const t={x:e};return m.BV.runKernel(Kt.SY,t)}}});var vn=n(9126);class wn extends cn{constructor(t,e,n,r=null,i=0){super(),this.learningRate=t,this.beta1=e,this.beta2=n,this.epsilon=r,this.decay=i,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],Fe((()=>{this.iteration=(0,hn.i)(0).variable(),this.accBeta1=(0,hn.i)(e).variable()})),null==r&&(this.epsilon=m.BV.backend.epsilon())}applyGradients(t){const e=Array.isArray(t)?t.map((t=>t.name)):Object.keys(t);Fe((()=>{const n=(0,gn.l)(1,this.accBeta1),r=(0,Je.h)(-this.learningRate,(0,Xe.I)((0,Ye.d)(this.iteration,this.decay),1));e.forEach(((e,i)=>{const a=m.BV.registeredVariables[e];null==this.accumulatedFirstMoment[i]&&(this.accumulatedFirstMoment[i]={originalName:`${e}/m`,variable:(0,en.P)(a).variable(!1)}),null==this.accumulatedWeightedInfNorm[i]&&(this.accumulatedWeightedInfNorm[i]={originalName:`${e}/v`,variable:(0,en.P)(a).variable(!1)});const s=Array.isArray(t)?t[i].tensor:t[e];if(null==s)return;const o=this.accumulatedFirstMoment[i].variable,l=this.accumulatedWeightedInfNorm[i].variable,u=(0,Xe.I)((0,Ye.d)(o,this.beta1),(0,Ye.d)(s,1-this.beta1)),h=(0,Ye.d)(l,this.beta2),c=yn(s),d=(0,vn.g)(h,c);o.assign(u),l.assign(d);const f=(0,Xe.I)((0,Ye.d)((0,Je.h)(r,n),(0,Je.h)(u,(0,Xe.I)(d,this.epsilon))),a);a.assign(f)})),this.iteration.assign((0,Xe.I)(this.iteration,1)),this.accBeta1.assign((0,Ye.d)(this.accBeta1,this.beta1))})),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),null!=this.accumulatedFirstMoment&&Pe(this.accumulatedFirstMoment.map((t=>t.variable))),null!=this.accumulatedWeightedInfNorm&&Pe(this.accumulatedWeightedInfNorm.map((t=>t.variable)))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(t){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(t,e){return new t(e.learningRate,e.beta1,e.beta2,e.epsilon,e.decay)}}wn.className="Adamax",pe(wn);class _n extends cn{constructor(t){super(),this.learningRate=t,this.setLearningRate(t)}applyGradients(t){(Array.isArray(t)?t.map((t=>t.name)):Object.keys(t)).forEach(((e,n)=>{const r=Array.isArray(t)?t[n].tensor:t[e];if(null==r)return;const i=m.BV.registeredVariables[e];Fe((()=>{const t=(0,Xe.I)((0,Ye.d)(this.c,r),i);i.assign(t)}))})),this.incrementIterations()}setLearningRate(t){this.learningRate=t,null!=this.c&&this.c.dispose(),this.c=Le((0,hn.i)(-t))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(t){if(0!==(t=await this.extractIterations(t)).length)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(t,e){return new t(e.learningRate)}}_n.className="SGD",pe(_n);class kn extends _n{constructor(t,e,n=!1){super(t),this.learningRate=t,this.momentum=e,this.useNesterov=n,this.accumulations=[],this.m=(0,hn.i)(this.momentum)}applyGradients(t){(Array.isArray(t)?t.map((t=>t.name)):Object.keys(t)).forEach(((e,n)=>{const r=m.BV.registeredVariables[e];if(null==this.accumulations[n]){const t=!1;this.accumulations[n]={originalName:`${e}/momentum`,variable:Fe((()=>(0,en.P)(r).variable(t)))}}const i=this.accumulations[n].variable,a=Array.isArray(t)?t[n].tensor:t[e];null!=a&&Fe((()=>{let t;const e=(0,Xe.I)((0,Ye.d)(this.m,i),a);t=this.useNesterov?(0,Xe.I)((0,Ye.d)(this.c,(0,Xe.I)(a,(0,Ye.d)(e,this.m))),r):(0,Xe.I)((0,Ye.d)(this.c,e),r),i.assign(e),r.assign(t)}))})),this.incrementIterations()}dispose(){this.m.dispose(),null!=this.accumulations&&Pe(this.accumulations.map((t=>t.variable)))}setMomentum(t){this.momentum=t}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map((t=>({name:t.originalName,tensor:t.variable}))))}async setWeights(t){t=await this.extractIterations(t),this.accumulations=t.map((t=>({originalName:t.name,variable:t.tensor.variable(!1)})))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(t,e){return new t(e.learningRate,e.momentum,e.useNesterov)}}kn.className="Momentum",pe(kn);class xn extends cn{constructor(t,e=.9,n=0,r=null,i=!1){if(super(),this.learningRate=t,this.decay=e,this.momentum=n,this.epsilon=r,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=i,null==r&&(this.epsilon=m.BV.backend.epsilon()),null==t)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(t){(Array.isArray(t)?t.map((t=>t.name)):Object.keys(t)).forEach(((e,n)=>{const r=m.BV.registeredVariables[e],i=!1;null==this.accumulatedMeanSquares[n]&&(this.accumulatedMeanSquares[n]={originalName:`${e}/rms`,variable:Fe((()=>(0,en.P)(r).variable(i)))}),null==this.accumulatedMoments[n]&&(this.accumulatedMoments[n]={originalName:`${e}/momentum`,variable:Fe((()=>(0,en.P)(r).variable(i)))}),null==this.accumulatedMeanGrads[n]&&this.centered&&(this.accumulatedMeanGrads[n]={originalName:`${e}/mg`,variable:Fe((()=>(0,en.P)(r).variable(i)))});const a=Array.isArray(t)?t[n].tensor:t[e];if(null==a)return;const s=this.accumulatedMeanSquares[n].variable,o=this.accumulatedMoments[n].variable;Fe((()=>{const t=(0,Xe.I)((0,Ye.d)(s,this.decay),(0,Ye.d)((0,tn.h)(a),1-this.decay));if(this.centered){const e=this.accumulatedMeanGrads[n].variable,i=(0,Xe.I)((0,Ye.d)(e,this.decay),(0,Ye.d)(a,1-this.decay)),l=(0,Je.h)((0,Ye.d)(a,this.learningRate),(0,Qe._)((0,gn.l)(t,(0,Xe.I)((0,tn.h)(i),this.epsilon)))),u=(0,Xe.I)((0,Ye.d)(o,this.momentum),l);s.assign(t),e.assign(i),o.assign(u);const h=(0,gn.l)(r,u);r.assign(h)}else{const t=(0,Xe.I)((0,Ye.d)(s,this.decay),(0,Ye.d)((0,tn.h)(a),1-this.decay)),e=(0,Xe.I)((0,Ye.d)(o,this.momentum),(0,Je.h)((0,Ye.d)(a,this.learningRate),(0,Qe._)((0,Xe.I)(t,this.epsilon))));s.assign(t),o.assign(e);const n=(0,gn.l)(r,e);r.assign(n)}}))})),this.incrementIterations()}dispose(){null!=this.accumulatedMeanSquares&&Pe(this.accumulatedMeanSquares.map((t=>t.variable))),null!=this.accumulatedMeanGrads&&this.centered&&Pe(this.accumulatedMeanGrads.map((t=>t.variable))),null!=this.accumulatedMoments&&Pe(this.accumulatedMoments.map((t=>t.variable)))}async getWeights(){const t=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&t.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(t.map((t=>({name:t.originalName,tensor:t.variable}))))}async setWeights(t){t=await this.extractIterations(t);const e=this.centered?t.length/3:t.length/2,n=!1;this.accumulatedMeanSquares=t.slice(0,e).map((t=>({originalName:t.name,variable:t.tensor.variable(n)}))),this.accumulatedMoments=t.slice(e,2*e).map((t=>({originalName:t.name,variable:t.tensor.variable(n)}))),this.centered&&(this.accumulatedMeanGrads=t.slice(2*e,3*e).map((t=>({originalName:t.name,variable:t.tensor.variable(n)}))))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(t,e){return new t(e.learningRate,e.decay,e.momentum,e.epsilon,e.centered)}}xn.className="RMSProp",pe(xn);class Sn{static sgd(t){return new _n(t)}static momentum(t,e,n=!1){return new kn(t,e,n)}static rmsprop(t,e=.9,n=0,r=null,i=!1){return new xn(t,e,n,r,i)}static adam(t=.001,e=.9,n=.999,r=null){return new bn(t,e,n,r)}static adadelta(t=.001,e=.95,n=null){return new dn(t,e,n)}static adamax(t=.002,e=.9,n=.999,r=null,i=0){return new wn(t,e,n,r,i)}static adagrad(t,e=.1){return new pn(t,e)}}var En=n(5904);const In=(0,Zt.op)({acos_:function(t){const e={x:(0,S._1)(t,"x","acos")};return m.BV.runKernel(Kt.VG,e)}}),An=(0,Zt.op)({acosh_:function(t){const e={x:(0,S._1)(t,"x","acosh")};return m.BV.runKernel(Kt.Sp,e)}}),Mn=(0,Zt.op)({addN_:function(t){A.hu(Array.isArray(t),(()=>"The argument passed to tf.addN() must be a list of tensors")),A.hu(t.length>=1,(()=>`Must pass at least one tensor to tf.addN(), but got ${t.length}`));const e=t.map(((t,e)=>(0,S._1)(t,`tensors${e}`,"addN"))),n=e[0];e.forEach((t=>{if(t.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")})),e.forEach((t=>{if(!A.cO(t.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")}));const r=e;return m.BV.runKernel(Kt.Xz,r)}}),Tn=(0,Zt.op)({all_:function(t,e=null,n=!1){const r={x:(0,S._1)(t,"x","all","bool")},i={axis:e,keepDims:n};return m.BV.runKernel(Kt.oT,r,i)}}),Nn=(0,Zt.op)({any_:function(t,e=null,n=!1){const r={x:(0,S._1)(t,"x","any","bool")},i={axis:e,keepDims:n};return m.BV.runKernel(Kt.IK,r,i)}}),Cn=(0,Zt.op)({argMax_:function(t,e=0){const n={x:(0,S._1)(t,"x","argMax")},r={axis:e};return m.BV.runKernel(Kt.sJ,n,r)}}),Rn=(0,Zt.op)({argMin_:function(t,e=0){const n={x:(0,S._1)(t,"x","argMin")},r={axis:e};return m.BV.runKernel(Kt.aJ,n,r)}}),On=(0,Zt.op)({asin_:function(t){const e={x:(0,S._1)(t,"x","asin")};return m.BV.runKernel(Kt.M2,e)}}),Dn=(0,Zt.op)({asinh_:function(t){const e={x:(0,S._1)(t,"x","asinh")};return m.BV.runKernel(Kt.qw,e)}}),zn=(0,Zt.op)({atan_:function(t){const e={x:(0,S._1)(t,"x","atan")};return m.BV.runKernel(Kt.jM,e)}}),Bn=(0,Zt.op)({atan2_:function(t,e){let n=(0,S._1)(t,"a","atan2"),r=(0,S._1)(e,"b","atan2");[n,r]=(0,me.makeTypesMatch)(n,r);const i={a:n,b:r};return m.BV.runKernel(Kt.QC,i)}}),Fn=(0,Zt.op)({atanh_:function(t){const e={x:(0,S._1)(t,"x","atanh")};return m.BV.runKernel(Kt.Oy,e)}});var Pn=n(7791),Ln=n(4374);const $n=(0,Zt.op)({avgPool_:function(t,e,n,r,i){const a=(0,S._1)(t,"x","avgPool","float32");A.hu(Pn.jT(n,1),(()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${n} and dilations '1'`));let s=a,o=!1;3===a.rank&&(o=!0,s=(0,Ln.X)(a,[1,a.shape[0],a.shape[1],a.shape[2]])),A.hu(4===s.rank,(()=>`Error in avgPool: x must be rank 4 but got rank ${s.rank}.`)),Pn.m("avgPool",r,i);const l={x:s},u={filterSize:e,strides:n,pad:r,dimRoundingMode:i};let h=m.BV.runKernel(Kt.Jh,l,u);return h=(0,It.p)(h,a.dtype),o?(0,Ln.X)(h,[h.shape[1],h.shape[2],h.shape[3]]):h}}),Un=(0,Zt.op)({avgPool3d_:function(t,e,n,r,i,a="NDHWC"){const s=(0,S._1)(t,"x","avgPool3d","float32");let o=s,l=!1;4===s.rank&&(l=!0,o=(0,Ln.X)(s,[1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]])),A.hu(5===o.rank,(()=>`Error in avgPool3d: x must be rank 5 but got rank ${o.rank}.`)),A.hu("NDHWC"===a,(()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${a}`)),(0,Pn.m)("avgPool3d",r,i);const u={x:o},h={filterSize:e,strides:n,pad:r,dimRoundingMode:i,dataFormat:a};let c=m.BV.runKernel(Kt._k,u,h);return c=(0,It.p)(c,o.dtype),l?(0,Ln.X)(c,[c.shape[1],c.shape[2],c.shape[3],c.shape[4]]):c}});var jn=n(1437),Wn=n(8885),Gn=n(8128);const Hn=(0,Zt.op)({tanh_:function(t){const e={x:(0,S._1)(t,"x","tanh","float32")};return m.BV.runKernel(Kt.MI,e)}}),Vn=(0,Zt.op)({basicLSTMCell_:function(t,e,n,r,i,a){const s=(0,S._1)(t,"forgetBias","basicLSTMCell"),o=(0,S._1)(e,"lstmKernel","basicLSTMCell"),l=(0,S._1)(n,"lstmBias","basicLSTMCell"),u=(0,S._1)(r,"data","basicLSTMCell"),h=(0,S._1)(i,"c","basicLSTMCell"),c=(0,S._1)(a,"h","basicLSTMCell"),d=(0,jn.z)([u,c],1),f=(0,qt.O)(d,o),p=(0,Xe.I)(f,l),m=p.shape[0],g=p.shape[1]/4,b=[m,g],y=(0,Gn.t)(p,[0,0],b),v=(0,Gn.t)(p,[0,g],b),w=(0,Gn.t)(p,[0,2*g],b),_=(0,Gn.t)(p,[0,3*g],b),k=(0,Xe.I)((0,Ye.d)((0,Wn.X)(y),Hn(v)),(0,Ye.d)(h,(0,Wn.X)((0,Xe.I)(s,w))));return[k,(0,Ye.d)(Hn(k),(0,Wn.X)(_))]}});var qn=n(406);const Kn=(0,Zt.op)({batchNorm_:function(t,e,n,r,i,a){null==a&&(a=.001);const s=(0,S._1)(t,"x","batchNorm"),o=(0,S._1)(e,"mean","batchNorm"),l=(0,S._1)(n,"variance","batchNorm");let u,h;null!=i&&(u=(0,S._1)(i,"scale","batchNorm")),null!=r&&(h=(0,S._1)(r,"offset","batchNorm")),A.hu(o.rank===l.rank,(()=>"Batch normalization gradient requires mean and variance to have equal ranks.")),A.hu(null==h||o.rank===h.rank,(()=>"Batch normalization gradient requires mean and offset to have equal ranks.")),A.hu(null==u||o.rank===u.rank,(()=>"Batch normalization gradient requires mean and scale to have equal ranks."));const c=function(t){let e;return e=0===t.rank||1===t.rank?(0,Ln.X)(t,[1,1,1,t.size]):2===t.rank?(0,Ln.X)(t,[1,1,t.shape[0],t.shape[1]]):3===t.rank?(0,Ln.X)(t,[1,t.shape[0],t.shape[1],t.shape[2]]):t,e}(s),d={x:c,scale:u,offset:h,mean:o,variance:l},f={varianceEpsilon:a},p=m.BV.runKernel(Kt.sH,d,f);return(0,Ln.X)(p,s.shape)}}),Zn=(0,Zt.op)({batchNorm2d_:function(t,e,n,r,i,a){const s=(0,S._1)(t,"x","batchNorm"),o=(0,S._1)(e,"mean","batchNorm"),l=(0,S._1)(n,"variance","batchNorm");let u,h;return null!=i&&(u=(0,S._1)(i,"scale","batchNorm")),null!=r&&(h=(0,S._1)(r,"offset","batchNorm")),A.hu(2===s.rank,(()=>`Error in batchNorm2D: x must be rank 2 but got rank ${s.rank}.`)),A.hu(2===o.rank||1===o.rank,(()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${o.rank}.`)),A.hu(2===l.rank||1===l.rank,(()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${l.rank}.`)),null!=u&&A.hu(2===u.rank||1===u.rank,(()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${u.rank}.`)),null!=h&&A.hu(2===h.rank||1===h.rank,(()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${h.rank}.`)),Kn(s,o,l,h,u,a)}}),Xn=(0,Zt.op)({batchNorm3d_:function(t,e,n,r,i,a){const s=(0,S._1)(t,"x","batchNorm"),o=(0,S._1)(e,"mean","batchNorm"),l=(0,S._1)(n,"variance","batchNorm");let u,h;return null!=i&&(u=(0,S._1)(i,"scale","batchNorm")),null!=r&&(h=(0,S._1)(r,"offset","batchNorm")),A.hu(3===s.rank,(()=>`Error in batchNorm3D: x must be rank 3 but got rank ${s.rank}.`)),A.hu(3===o.rank||1===o.rank,(()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${o.rank}.`)),A.hu(3===l.rank||1===l.rank,(()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${l.rank}.`)),null!=u&&A.hu(3===u.rank||1===u.rank,(()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${u.rank}.`)),null!=h&&A.hu(3===h.rank||1===h.rank,(()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${h.rank}.`)),Kn(s,o,l,h,u,a)}}),Jn=(0,Zt.op)({batchNorm4d_:function(t,e,n,r,i,a){const s=(0,S._1)(t,"x","batchNorm"),o=(0,S._1)(e,"mean","batchNorm"),l=(0,S._1)(n,"variance","batchNorm");let u,h;return null!=i&&(u=(0,S._1)(i,"scale","batchNorm")),null!=r&&(h=(0,S._1)(r,"offset","batchNorm")),A.hu(4===s.rank,(()=>`Error in batchNorm4D: x must be rank 4 but got rank ${s.rank}.`)),A.hu(4===o.rank||1===o.rank,(()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${o.rank}.`)),A.hu(4===l.rank||1===l.rank,(()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${l.rank}.`)),null!=u&&A.hu(4===u.rank||1===u.rank,(()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${u.rank}.`)),null!=h&&A.hu(4===h.rank||1===h.rank,(()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${h.rank}.`)),Kn(s,o,l,h,u,a)}}),Yn=(0,Zt.op)({bincount_:function(t,e,n){const r=(0,S._1)(t,"x","bincount"),i=(0,S._1)(e,"weights","bincount");A.hu("int32"===r.dtype,(()=>`Error in bincount: input dtype must be int32, but got ${r.dtype}`)),A.hu(n>=0,(()=>`size must be non-negative, but got ${n}.`)),A.hu(i.size===r.size||0===i.size,(()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${r.shape}, weights shape: ${i.shape}.`));const a={x:r,weights:i},s={size:n};return m.BV.runKernel(Kt.zv,a,s)}}),Qn=(0,Zt.op)({broadcastArgs_:function(t,e){const n=(0,S._1)(t,"s0","broadcastArgs","int32"),r=(0,S._1)(e,"s1","broadcastArgs","int32");if(1!==n.rank)throw new Error(`broadcastArgs(): first input must be a vector (rank=1). Has rank ${n.rank}`);if(1!==r.rank)throw new Error(`broadcastArgs(): second input must be a vector (rank=1). Has rank ${r.rank}`);const i={s0:n,s1:r};return m.BV.runKernel(Kt.eE,i)}});var tr=n(3934);const er=(0,Zt.op)({ceil_:function(t){const e={x:(0,S._1)(t,"x","ceil","float32")};return m.BV.runKernel(Kt.gJ,e)}}),nr=(0,Zt.op)({clipByValue_:function(t,e,n){const r=(0,S._1)(t,"x","clipByValue");A.hu(e<=n,(()=>`Error in clip: min (${e}) must be less than or equal to max (${n}).`));const i={x:r},a={clipValueMin:e,clipValueMax:n};return m.BV.runKernel(Kt.xn,i,a)}}),rr=(0,Zt.op)({concat1d_:function(t){return(0,jn.z)(t,0)}}),ir=(0,Zt.op)({concat2d_:function(t,e){return(0,jn.z)(t,e)}}),ar=(0,Zt.op)({concat3d_:function(t,e){return(0,jn.z)(t,e)}}),sr=(0,Zt.op)({concat4d_:function(t,e){return(0,jn.z)(t,e)}});var or=n(1747);const lr=(0,Zt.op)({conv1d_:function(t,e,n,r,i="NWC",a=1,s){const o=(0,S._1)(t,"x","conv1d"),l=(0,S._1)(e,"filter","conv1d");let u=o,h=!1;2===o.rank&&(h=!0,u=(0,Ln.X)(o,[1,o.shape[0],o.shape[1]])),A.hu(3===u.rank,(()=>`Error in conv1d: input must be rank 3, but got rank ${u.rank}.`)),A.hu(3===l.rank,(()=>`Error in conv1d: filter must be rank 3, but got rank ${l.rank}.`)),Pn.m("conv1d",r,s),A.hu(u.shape[2]===l.shape[1],(()=>`Error in conv1d: depth of input (${u.shape[2]}) must match input depth for filter ${l.shape[1]}.`)),A.hu(Pn.jT(n,a),(()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${n} and dilation '${a}'`)),A.hu("NWC"===i,(()=>`Error in conv1d: got dataFormat of ${i} but only NWC is currently supported.`));const c=(0,Ln.X)(l,[1,l.shape[0],l.shape[1],l.shape[2]]),d=(0,Ln.X)(u,[u.shape[0],1,u.shape[1],u.shape[2]]),f=[1,n],p=[1,a],m=(0,or.T)(d,c,f,r,"NHWC",p,s);return h?(0,Ln.X)(m,[m.shape[2],m.shape[3]]):(0,Ln.X)(m,[m.shape[0],m.shape[2],m.shape[3]])}});var ur=n(2330);const hr=(0,Zt.op)({conv2dTranspose_:function(t,e,n,r,i,a){const s=(0,S._1)(t,"x","conv2dTranspose"),o=(0,S._1)(e,"filter","conv2dTranspose");return(0,ur._)(n,s,o,r,i,"NHWC",a)}}),cr=(0,Zt.op)({conv3d_:function(t,e,n,r,i="NDHWC",a=[1,1,1]){const s=(0,S._1)(t,"x","conv3d"),o=(0,S._1)(e,"filter","conv3d");let l=s,u=!1;4===s.rank&&(u=!0,l=(0,Ln.X)(s,[1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]])),A.hu(5===l.rank,(()=>`Error in conv3d: input must be rank 5, but got rank ${l.rank}.`)),A.hu(5===o.rank,(()=>`Error in conv3d: filter must be rank 5, but got rank ${o.rank}.`)),A.hu(l.shape[4]===o.shape[3],(()=>`Error in conv3d: depth of input (${l.shape[4]}) must match input depth for filter ${o.shape[3]}.`)),A.hu((0,Pn.jT)(n,a),(()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${n} and dilations '${a}'`)),A.hu("NDHWC"===i,(()=>`Error in conv3d: got dataFormat of ${i} but only NDHWC is currently supported.`));const h={x:l,filter:o},c={strides:n,pad:r,dataFormat:i,dilations:a},d=m.BV.runKernel(Kt.x1,h,c);return u?(0,Ln.X)(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}});var dr=n(7332);const fr=(0,Zt.op)({conv3dTranspose_:function(t,e,n,r,i){const a=(0,S._1)(t,"x","conv3dTranspose"),s=(0,S._1)(e,"filter","conv3dTranspose");return(0,dr._)(n,a,s,r,i)}});var pr=n(4420),mr=n(1246),gr=n(8754);const br=(0,Zt.op)({denseBincount_:function(t,e,n,r=!1){const i=(0,S._1)(t,"x","denseBincount"),a=(0,S._1)(e,"weights","denseBincount");A.hu("int32"===i.dtype,(()=>`Error in denseBincount: input dtype must be int32, but got ${i.dtype}`)),A.hu(i.rank<=2,(()=>`Error in denseBincount: input must be at most rank 2, but got rank ${i.rank}.`)),A.hu(n>=0,(()=>`size must be non-negative, but got ${n}.`)),A.hu(a.size===i.size||0===a.size,(()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${i.shape}, weights shape: ${a.shape}.`));const s={x:i,weights:a},o={size:n,binaryOutput:r};return m.BV.runKernel(Kt.QR,s,o)}}),yr=(0,Zt.op)({depthToSpace_:function(t,e,n="NHWC"){const r=(0,S._1)(t,"x","depthToSpace","float32"),i="NHWC"===n?r.shape[1]:r.shape[2],a="NHWC"===n?r.shape[2]:r.shape[3],s="NHWC"===n?r.shape[3]:r.shape[1];A.hu(e>1,(()=>`blockSize should be > 1 for depthToSpace, but was: ${e}`)),A.hu(i*e>=0,(()=>`Negative dimension size caused by overflow when multiplying\n    ${i} and ${e}  for depthToSpace with input shape\n    ${r.shape}`)),A.hu(a*e>=0,(()=>`Negative dimension size caused by overflow when multiplying\n    ${a} and ${e} for depthToSpace with input shape\n        ${r.shape}`)),A.hu(s%(e*e)==0,(()=>`Dimension size must be evenly divisible by ${e*e} but is ${s} for depthToSpace with input shape ${r.shape}`));const o={x:r},l={blockSize:e,dataFormat:n};return m.BV.runKernel(Kt.T0,o,l)}}),vr=(0,Zt.op)({depthwiseConv2d_:function(t,e,n,r,i="NHWC",a=[1,1],s){const o=(0,S._1)(t,"x","depthwiseConv2d","float32"),l=(0,S._1)(e,"filter","depthwiseConv2d","float32");let u=o,h=!1;3===o.rank&&(h=!0,u=(0,Ln.X)(o,[1,o.shape[0],o.shape[1],o.shape[2]])),A.hu(4===u.rank,(()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${u.rank}.`)),A.hu(4===l.rank,(()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${l.rank}.`)),A.hu(u.shape[3]===l.shape[2],(()=>`Error in depthwiseConv2d: number of input channels (${u.shape[3]}) must match the inChannels dimension in filter ${l.shape[2]}.`)),Pn.m("depthwiseConv2d",r,s);const c={x:u,filter:l},d={strides:n,pad:r,dataFormat:i,dilations:a,dimRoundingMode:s},f=m.BV.runKernel(Kt.ci,c,d);return h?(0,Ln.X)(f,[f.shape[1],f.shape[2],f.shape[3]]):f}}),wr=(0,Zt.op)({diag_:function(t){const e={x:(0,S._1)(t,"x","diag")};return m.BV.runKernel(Kt.$w,e)}}),_r=(0,Zt.op)({dilation2d_:function(t,e,n,r,i=[1,1],a="NHWC"){const s=(0,S._1)(t,"x","dilation2d"),o=(0,S._1)(e,"filter","dilation2d");A.hu(3===s.rank||4===s.rank,(()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${s.rank}.`)),A.hu(3===o.rank,(()=>`Error in dilation2d: filter must be rank 3, but got rank ${o.rank}.`)),A.hu("NHWC"===a,(()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${a}`));let l=s,u=!1;3===s.rank&&(l=(0,Ln.X)(s,[1,s.shape[0],s.shape[1],s.shape[2]]),u=!0);const h={x:l,filter:o},c={strides:n,pad:r,dilations:i},d=m.BV.runKernel(Kt.p4,h,c);return u?(0,Ln.X)(d,[d.shape[1],d.shape[2],d.shape[3]]):d}});var kr=n(4897),xr=n(2648);const Sr=(0,Zt.op)({divNoNan_:function(t,e){let n=(0,S._1)(t,"a","div"),r=(0,S._1)(e,"b","div");[n,r]=(0,me.makeTypesMatch)(n,r);const i=(0,Je.h)(n,r),a=(0,en.P)(i),s=(0,kr.D)(r,a);return(0,xr.a)(s,a,i)}}),Er=(0,Zt.op)({dot_:function(t,e){const n=(0,S._1)(t,"t1","dot"),r=(0,S._1)(e,"t2","dot");A.hu(!(1!==n.rank&&2!==n.rank||1!==r.rank&&2!==r.rank),(()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${n.rank} and ${r.rank}.`));const i=1===n.rank?n.size:n.shape[1],a=1===r.rank?r.size:r.shape[0];if(A.hu(i===a,(()=>`Error in dot: inner dimensions of inputs must match, but got ${i} and ${a}.`)),1===n.rank&&1===r.rank){const t=(0,Ln.X)(n,[1,-1]),e=(0,Ln.X)(r,[-1,1]),i=(0,qt.O)(t,e);return(0,Ln.X)(i,[])}if(1===n.rank&&2===r.rank){const t=(0,Ln.X)(n,[1,-1]),e=(0,Ln.X)(r,[r.shape[0],r.shape[1]]),i=(0,qt.O)(t,e);return(0,Ln.X)(i,[i.size])}if(2===n.rank&&1===r.rank){const t=(0,Ln.X)(r,[-1,1]),e=(0,qt.O)(n,t);return(0,Ln.X)(e,[e.size])}{const t=(0,Ln.X)(r,[r.shape[0],r.shape[1]]);return(0,qt.O)(n,t)}}}),Ir=(0,Zt.op)({einsum_:function(t,...e){const n=e.map(((t,e)=>(0,S._1)(t,`tensors${e}`,"einsum"))),r={equation:t};return m.BV.runKernel(Kt.$g,n,r)}}),Ar=(0,Zt.op)({elu_:function(t){const e={x:(0,S._1)(t,"x","elu","float32")};return m.BV.runKernel(Kt.SX,e)}}),Mr=(0,Zt.op)({erf_:function(t){let e=(0,S._1)(t,"x","erf");A.hu("int32"===e.dtype||"float32"===e.dtype,(()=>"Input dtype must be `int32` or `float32`.")),"int32"===e.dtype&&(e=(0,It.p)(e,"float32"));const n={x:e};return m.BV.runKernel(Kt.Om,n)}});var Tr=n(4540),Nr=n(5216);const Cr=(0,Zt.op)({expm1_:function(t){const e={x:(0,S._1)(t,"x","expm1")};return m.BV.runKernel(Kt.Y0,e)}});var Rr=n(9773);const Or=(0,Zt.op)({eye_:function(t,e,n,r="float32"){null==e&&(e=t);const i=Et([t,e],r),a=t<=e?t:e;for(let t=0;t<a;++t)i.set(1,t,t);const s=(0,Ln.X)(i.toTensor(),[t,e]);if(null==n)return s;if(1===n.length)return(0,Rr.G)((0,Nr.d)(s,0),[n[0],1,1]);if(2===n.length)return(0,Rr.G)((0,Nr.d)((0,Nr.d)(s,0),0),[n[0],n[1],1,1]);if(3===n.length)return(0,Rr.G)((0,Nr.d)((0,Nr.d)((0,Nr.d)(s,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${n.length}D.`)}});var Dr=n(7988),zr=n(6223),Br=n(9419),Fr=n(6962),Pr=n(3930);const Lr=(0,Zt.op)({imag_:function(t){const e={input:(0,S._1)(t,"input","imag")};return m.BV.runKernel(Kt.J_,e)}}),$r=(0,Zt.op)({isFinite_:function(t){const e={x:(0,S._1)(t,"x","isFinite")};return m.BV.runKernel(Kt.av,e)}}),Ur=(0,Zt.op)({isInf_:function(t){const e={x:(0,S._1)(t,"x","isInf")};return m.BV.runKernel(Kt.iW,e)}}),jr=(0,Zt.op)({isNaN_:function(t){const e={x:(0,S._1)(t,"x","isNaN")};return m.BV.runKernel(Kt.r7,e)}}),Wr=(0,Zt.op)({leakyRelu_:function(t,e=.2){const n={x:(0,S._1)(t,"x","leakyRelu")},r={alpha:e};return m.BV.runKernel(Kt.J$,n,r)}});var Gr=n(1314),Hr=n(2894);function Vr(t,e,n){if(n<=0)throw new Error("The number of values should be positive.");const r={start:t,stop:e,num:n};return m.BV.runKernel(Kt.e7,{},r)}const qr=(0,Zt.op)({localResponseNormalization_:function(t,e=5,n=1,r=1,i=.5){const a=(0,S._1)(t,"x","localResponseNormalization");A.hu(4===a.rank||3===a.rank,(()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got\n               rank ${a.rank}.`)),A.hu(A.GN(e),(()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${e}.`));let s=a,o=!1;3===a.rank&&(o=!0,s=(0,Ln.X)(a,[1,a.shape[0],a.shape[1],a.shape[2]]));const l={x:s},u={depthRadius:e,bias:n,alpha:r,beta:i},h=m.BV.runKernel(Kt.eZ,l,u);return o?(0,Ln.X)(h,[h.shape[1],h.shape[2],h.shape[3]]):h}});var Kr=n(1273);const Zr=(0,Zt.op)({log1p_:function(t){const e={x:(0,S._1)(t,"x","log1p")};return m.BV.runKernel(Kt.kU,e)}});var Xr=n(1353);const Jr=(0,Zt.op)({softplus_:function(t){const e={x:(0,S._1)(t,"x","softplus")};return m.BV.runKernel(Kt.MR,e)}}),Yr=(0,Zt.op)({logSigmoid_:function(t){const e=(0,S._1)(t,"x","logSigmoid"),n=ln((t=>({value:(0,Xr.W)(Jr((0,Xr.W)(t))),gradFunc:e=>(0,Ye.d)(e,(0,Wn.X)((0,Xr.W)(t)))})));return n(e)}}),Qr=(0,Zt.op)({max_:function(t,e=null,n=!1){const r={x:(0,S._1)(t,"x","max")},i={reductionIndices:e,keepDims:n};return m.BV.runKernel(Kt.Yo,r,i)}});var ti=n(1614);const ei=(0,Zt.op)({logSoftmax_:function(t,e=-1){const n=(0,S._1)(t,"logits","logSoftmax");if(-1===e&&(e=n.rank-1),e!==n.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and axis was ${e}`);const r=ln(((t,n)=>{const r=Qr(t,e,!0),i=(0,gn.l)(t,r),a=(0,gn.l)((0,It.p)(i,"float32"),(0,Kr.c)((0,ti.S)((0,Tr.Q)(i),e,!0)));return n([a]),{value:a,gradFunc:(t,n)=>{const[r]=n,i=(0,Tr.Q)(r);return(0,gn.l)(t,(0,Ye.d)((0,ti.S)(t,e,!0),i))}}}));return r(n)}});var ni=n(617);const ri=(0,Zt.op)({logSumExp_:function(t,e=null,n=!1){const r=(0,S._1)(t,"x","logSumExp"),i=(0,A.EC)(e,r.shape),a=Qr(r,i,!0),s=(0,gn.l)(r,a),o=(0,Tr.Q)(s),l=(0,ti.S)(o,i),u=(0,Kr.c)(l),h=(0,Xe.I)((0,Ln.X)(a,u.shape),u);if(n){const t=(0,ni.rv)(h.shape,i);return(0,Ln.X)(h,t)}return h}});var ii=n(7183),ai=n(5599);const si=(0,Zt.op)({logicalOr_:function(t,e){const n=(0,S._1)(t,"a","logicalOr","bool"),r=(0,S._1)(e,"b","logicalOr","bool");(0,Qt.assertAndGetBroadcastShape)(n.shape,r.shape);const i={a:n,b:r};return m.BV.runKernel(Kt.MZ,i)}}),oi=(0,Zt.op)({logicalXor_:function(t,e){const n=(0,S._1)(t,"a","logicalXor","bool"),r=(0,S._1)(e,"b","logicalXor","bool");return(0,Qt.assertAndGetBroadcastShape)(n.shape,r.shape),(0,ii.H)(si(t,e),(0,ai.h)((0,ii.H)(t,e)))}}),li=(0,Zt.op)({maxPool_:function(t,e,n,r,i){const a=(0,S._1)(t,"x","maxPool");let s=a,o=!1;3===a.rank&&(o=!0,s=(0,Ln.X)(a,[1,a.shape[0],a.shape[1],a.shape[2]])),A.hu(4===s.rank,(()=>`Error in maxPool: input must be rank 4 but got rank ${s.rank}.`)),A.hu(Pn.jT(n,1),(()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${n} and dilations '1'`)),Pn.m("maxPool",r,i);const l={x:s},u={filterSize:e,strides:n,pad:r,dimRoundingMode:i},h=m.BV.runKernel(Kt.mT,l,u);return o?(0,Ln.X)(h,[h.shape[1],h.shape[2],h.shape[3]]):h}}),ui=(0,Zt.op)({maxPool3d_:function(t,e=[1,1,1],n,r,i,a="NDHWC"){const s=(0,S._1)(t,"x","maxPool3d");let o=s,l=!1;4===s.rank&&(l=!0,o=(0,Ln.X)(s,[1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]])),A.hu(5===o.rank,(()=>`Error in maxPool3d: x must be rank 5 but got rank ${o.rank}.`)),A.hu("NDHWC"===a,(()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${a}`)),(0,Pn.m)("maxPool3d",r,i);const u={x:o},h={filterSize:e,strides:n,pad:r,dimRoundingMode:i,dataFormat:a},c=m.BV.runKernel(Kt.OA,u,h);return l?(0,Ln.X)(c,[c.shape[1],c.shape[2],c.shape[3],c.shape[4]]):c}}),hi=(0,Zt.op)({maxPoolWithArgmax_:function(t,e,n,r,i=!1){const a={x:(0,S._1)(t,"x","maxPoolWithArgmax")},s={filterSize:e,strides:n,pad:r,includeBatchInIndex:i},o=m.BV.runKernel(Kt.vF,a,s);return{result:o[0],indexes:o[1]}}}),ci=(0,Zt.op)({mean_:function(t,e=null,n=!1){const r={x:(0,S._1)(t,"x","mean")},i={axis:e,keepDims:n};return m.BV.runKernel(Kt.q2,r,i)}});var di=n(9798);function fi(t,e,{indexing:n="xy"}={}){if("xy"!==n&&"ij"!==n)throw new TypeError(`${n} is not a valid third argument to meshgrid`);if(void 0===t)return[];let r=(0,S._1)(t,"x","meshgrid",t instanceof St.es?t.dtype:"float32");if(void 0===e)return[r];let i=(0,S._1)(e,"y","meshgrid",e instanceof St.es?e.dtype:"float32");const a=(0,A.NA)(r.shape),s=(0,A.NA)(i.shape);return"xy"===n?(r=(0,Ln.X)(r,[1,-1]),i=(0,Ln.X)(i,[-1,1]),[(0,qt.O)((0,di.i)([s,1],r.dtype),r),(0,qt.O)(i,(0,di.i)([1,a],i.dtype))]):(r=(0,Ln.X)(r,[-1,1]),i=(0,Ln.X)(i,[1,-1]),[(0,qt.O)(r,(0,di.i)([1,s],r.dtype)),(0,qt.O)((0,di.i)([a,1],i.dtype),i)])}const pi=(0,Zt.op)({min_:function(t,e=null,n=!1){const r={x:(0,S._1)(t,"x","min")},i={axis:e,keepDims:n};return m.BV.runKernel(Kt.c1,r,i)}}),mi=(0,Zt.op)({minimum_:function(t,e){let n=(0,S._1)(t,"a","minimum"),r=(0,S._1)(e,"b","minimum");[n,r]=(0,me.makeTypesMatch)(n,r),"bool"===n.dtype&&(n=(0,It.p)(n,"int32"),r=(0,It.p)(r,"int32")),(0,Qt.assertAndGetBroadcastShape)(n.shape,r.shape);const i={a:n,b:r};return m.BV.runKernel(Kt.q8,i)}}),gi=(0,Zt.op)({mirrorPad_:function(t,e,n){A.hu("reflect"===n||"symmetric"===n,(()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${n}.`));const r=(0,S._1)(t,"x","mirrorPad");if(0===r.rank)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");A.hu(e.length===r.rank,(()=>`Padding doesn't match input. Must be ${r.rank}. Got ${e.length}.`));const i="reflect"===n?1:0;for(let t=0;t<r.rank;t++)A.hu(2===e[t].length,(()=>"Invalid number of paddings. Must be length of 2 each.")),A.hu(e[t][0]>=0&&e[t][0]<=r.shape[t]-i&&e[t][1]>=0&&e[t][1]<=r.shape[t]-i,(()=>`Padding in dimension ${t} cannot be greater than or equal to ${r.shape[t]-i} or less than 0 for input of shape ${r.shape}`));const a={paddings:e,mode:n},s={x:r};return m.BV.runKernel(Kt.jQ,s,a)}}),bi=(0,Zt.op)({mod_:function(t,e){let n=(0,S._1)(t,"a","mod"),r=(0,S._1)(e,"b","mod");[n,r]=(0,me.makeTypesMatch)(n,r);const i={a:n,b:r};return m.BV.runKernel(Kt.Vb,i)}}),yi=(0,Zt.op)({moments_:function(t,e=null,n=!1){t=(0,S._1)(t,"x","moments");const r=(0,A.EC)(e,t.shape),i=ci(t,r,n);let a=i.shape;n||(a=(0,ni.rv)(i.shape,r));const s=(0,tn.h)((0,gn.l)((0,It.p)(t,"float32"),(0,Ln.X)(i,a)));return{mean:i,variance:ci(s,r,n)}}}),vi=(0,Zt.op)({multiRNNCell_:function(t,e,n,r){const i=(0,S._1)(e,"data","multiRNNCell"),a=(0,S.sI)(n,"c","multiRNNCell"),s=(0,S.sI)(r,"h","multiRNNCell");let o=i;const l=[];for(let e=0;e<t.length;e++){const n=t[e](o,a[e],s[e]);l.push(n[0]),l.push(n[1]),o=n[1]}const u=[],h=[];for(let t=0;t<l.length;t+=2)u.push(l[t]),h.push(l[t+1]);return[u,h]}}),wi=(0,Zt.op)({multinomial_:function(t,e,n,r=!1){const i=(0,S._1)(t,"logits","multinomial"),a=i.size,s=i.rank;if(a<2)throw new Error(`Error in multinomial: you need at least 2 outcomes, but got ${a}.`);if(s>2)throw new Error(`Rank of probabilities must be 1 or 2, but is ${s}`);n=n||Math.random();const o={logits:1===s?(0,Ln.X)(i,[1,-1]):i},l={numSamples:e,seed:n,normalized:r},u=m.BV.runKernel(Kt.NZ,o,l);return 1===s?(0,Ln.X)(u,[u.size]):u}}),_i=(0,Zt.op)({notEqual_:function(t,e){let n=(0,S._1)(t,"a","notEqual","string_or_numeric"),r=(0,S._1)(e,"b","notEqual","string_or_numeric");[n,r]=(0,me.makeTypesMatch)(n,r),(0,Qt.assertAndGetBroadcastShape)(n.shape,r.shape);const i={a:n,b:r};return m.BV.runKernel(Kt.yQ,i)}}),ki=(0,Zt.op)({onesLike_:function(t){const e={x:(0,S._1)(t,"x","onesLike")};return m.BV.runKernel(Kt.qW,e)}}),xi=(0,Zt.op)({outerProduct_:function(t,e){const n=(0,S._1)(t,"v1","outerProduct"),r=(0,S._1)(e,"v2","outerProduct");A.hu(1===n.rank&&1===r.rank,(()=>`Error in outerProduct: inputs must be rank 1, but got ranks ${n.rank} and ${r.rank}.`));const i=(0,Ln.X)(n,[-1,1]),a=(0,Ln.X)(r,[1,-1]);return(0,qt.O)(i,a)}});var Si=n(3650);const Ei=(0,Zt.op)({pad1d_:function(t,e,n=0){return(0,A.hu)(2===e.length,(()=>"Invalid number of paddings. Must be length of 2.")),(0,Si.v)(t,[e],n)}}),Ii=(0,Zt.op)({pad2d_:function(t,e,n=0){return(0,A.hu)(2===e.length&&2===e[0].length&&2===e[1].length,(()=>"Invalid number of paddings. Must be length of 2 each.")),(0,Si.v)(t,e,n)}}),Ai=(0,Zt.op)({pad3d_:function(t,e,n=0){return(0,A.hu)(3===e.length&&2===e[0].length&&2===e[1].length&&2===e[2].length,(()=>"Invalid number of paddings. Must be length of 2 each.")),(0,Si.v)(t,e,n)}}),Mi=(0,Zt.op)({pad4d_:function(t,e,n=0){return(0,A.hu)(4===e.length&&2===e[0].length&&2===e[1].length&&2===e[2].length&&2===e[3].length,(()=>"Invalid number of paddings. Must be length of 2 each.")),(0,Si.v)(t,e,n)}});var Ti=n(5841);const Ni=(0,Zt.op)({pool_:function(t,e,n,r,i,a,s){null==i&&(i=[1,1]),null==a&&(a=1),0===r&&(r="valid");const o=(0,S._1)(t,"x","maxPool");let l=o,u=!1;3===o.rank&&(u=!0,l=(0,Ln.X)(o,[1,o.shape[0],o.shape[1],o.shape[2]])),A.hu(Pn.jT(a,i),(()=>`Error in pool: Either strides or dilations must be 1. Got strides ${a} and dilations '${i}'`));const h=Pn.Xw(l.shape,e,a,i,r),c=[h.dilationHeight,h.dilationWidth];let d;d="same"===r?function(t,e){const n=t.map(((t,n)=>t+(t-1)*(e[n]-1))),r=n.map((t=>t-1)),i=r.map((t=>Math.floor(t/2))),a=r.map(((t,e)=>t-i[e]));return r.map(((t,e)=>[i[e],a[e]]))}([h.filterHeight,h.filterWidth],c):[[0,0],[0,0]];const f=1===c[0]&&1===c[1],[p,m]=function(t,e,n){const r=n.map((t=>t[0])),i=n.map((t=>t[1])),a=t.concat(r,i),s=e.map(((t,e)=>(t-a[e]%t)%t)),o=i.map(((t,e)=>t+s[e])),l=e.map(((t,e)=>[r[e],o[e]])),u=e.map(((t,e)=>[0,s[e]]));return[l,u]}([h.inHeight,h.inWidth],c,d),g=f?r:"valid",b=f?l:(0,Ti.f)(l,c,p),y=("avg"===n?()=>$n(b,e,a,g,s):()=>li(b,e,a,g,s))(),v=f?y:(0,qn.E)(y,c,m);return u?(0,Ln.X)(v,[v.shape[1],v.shape[2],v.shape[3]]):v}}),Ci=(0,Zt.op)({prelu_:function(t,e){const n={x:(0,S._1)(t,"x","prelu"),alpha:(0,S._1)(e,"alpha","prelu")};return m.BV.runKernel(Kt.o0,n)}}),Ri=(0,Zt.op)({prod_:function(t,e=null,n=!1){let r=(0,S._1)(t,"x","prod");"bool"===r.dtype&&(r=(0,It.p)(r,"int32"));const i={x:r},a={axis:e,keepDims:n};return m.BV.runKernel(Kt.Dl,i,a)}}),Oi=(0,Zt.op)({rand_:function(t,e,n){const r=(0,A.NA)(t);let i=null;if(null==n||"float32"===n)i=new Float32Array(r);else if("int32"===n)i=new Int32Array(r);else{if("bool"!==n)throw new Error(`Unknown data type ${n}`);i=new Uint8Array(r)}for(let t=0;t<r;t++)i[t]=e();return m.BV.makeTensor(i,t,n)}});var Di=n(3883);class zi{constructor(t,e,n,r,i){this.mean=t,this.stdDev=e,this.dtype=n,this.nextVal=NaN,this.truncated=r,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);const a=i||Math.random();this.random=Di.alea(a.toString())}nextValue(){if(!isNaN(this.nextVal)){const t=this.nextVal;return this.nextVal=NaN,t}let t,e,n=!1;for(;!n;){let r,i,a;do{r=2*this.random()-1,i=2*this.random()-1,a=r*r+i*i}while(a>=1||0===a);const s=Math.sqrt(-2*Math.log(a)/a);t=this.mean+this.stdDev*r*s,e=this.mean+this.stdDev*i*s,this.truncated&&!this.isValidTruncated(t)||(n=!0)}return this.truncated&&!this.isValidTruncated(e)||(this.nextVal=this.convertValue(e)),this.convertValue(t)}convertValue(t){return null==this.dtype||"float32"===this.dtype?t:Math.round(t)}isValidTruncated(t){return t<=this.upper&&t>=this.lower}}class Bi{constructor(t,e,n,r){this.alpha=t,this.beta=1/e,this.dtype=n;const i=r||Math.random();this.randu=Di.alea(i.toString()),this.randn=new zi(0,1,n,!1,this.randu()),this.d=t<1?t+2/3:t-1/3,this.c=1/Math.sqrt(9*this.d)}nextValue(){let t,e,n,r,i,a;for(;;){do{r=this.randn.nextValue(),a=1+this.c*r}while(a<=0);if(a*=a*a,t=r*r,e=1-.331*t*t,n=.5*t+this.d*(1-a+Math.log(a)),i=this.randu(),i<e||Math.log(i)<n)break}return a=1/this.beta*this.d*a,this.alpha<1&&(a*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(a)}convertValue(t){return"float32"===this.dtype?t:Math.round(t)}}class Fi{constructor(t=0,e=1,n,r){if(this.canReturnFloat=()=>null==this.dtype||"float32"===this.dtype,this.min=t,this.range=e-t,this.dtype=n,null==r&&(r=Math.random()),"number"==typeof r&&(r=r.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${t} - ${e} <= 1 and dtype is not float`);this.random=Di.alea(r)}convertValue(t){return this.canReturnFloat()?t:Math.round(t)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}const Pi=(0,Zt.op)({randomGamma_:function(t,e,n=1,r="float32",i){if(null==n&&(n=1),null==r&&(r="float32"),"float32"!==r&&"int32"!==r)throw new Error(`Unsupported data type ${r}`);const a=new Bi(e,n,r,i),s=Et(t,r);for(let t=0;t<s.values.length;t++)s.values[t]=a.nextValue();return s.toTensor()}}),Li=(0,Zt.op)({randomNormal_:function(t,e=0,n=1,r,i){if(null!=r&&"bool"===r)throw new Error(`Unsupported data type ${r}`);const a=new zi(e,n,r,!1,i),s=Et(t,r);for(let t=0;t<s.values.length;t++)s.values[t]=a.nextValue();return s.toTensor()}}),$i=(0,Zt.op)({randomUniform_:function(t,e=0,n=1,r="float32",i){const a=Et(t,r),s=new Fi(e,n,null,i);for(let t=0;t<a.values.length;t++)a.values[t]=s.nextValue();return a.toTensor()}});function Ui(t,e,n=1,r="float32"){if(0===n)throw new Error("Cannot have a step of zero");const i={start:t,stop:e,step:n,dtype:r};return m.BV.runKernel(Kt.e6,{},i)}const ji=(0,Zt.op)({real_:function(t){const e={input:(0,S._1)(t,"input","real")};return m.BV.runKernel(Kt.xJ,e)}}),Wi=(0,Zt.op)({reciprocal_:function(t){const e={x:(0,S._1)(t,"x","reciprocal")};return m.BV.runKernel(Kt.$H,e)}}),Gi=(0,Zt.op)({relu_:function(t){const e={x:(0,S._1)(t,"x","relu")};return m.BV.runKernel(Kt.qk,e)}}),Hi=(0,Zt.op)({relu6_:function(t){const e={x:(0,S._1)(t,"x","relu6")};return m.BV.runKernel(Kt.Sb,e)}});var Vi=n(4271);const qi=(0,Zt.op)({reverse1d_:function(t){const e=(0,S._1)(t,"x","reverse");return A.hu(1===e.rank,(()=>`Error in reverse1D: x must be rank 1 but got rank ${e.rank}.`)),(0,Vi.G)(e,0)}}),Ki=(0,Zt.op)({reverse2d_:function(t,e){const n=(0,S._1)(t,"x","reverse");return A.hu(2===n.rank,(()=>`Error in reverse2D: x must be rank 2 but got rank ${n.rank}.`)),(0,Vi.G)(n,e)}}),Zi=(0,Zt.op)({reverse3d_:function(t,e){const n=(0,S._1)(t,"x","reverse");return A.hu(3===n.rank,(()=>`Error in reverse3D: x must be rank 3 but got rank ${n.rank}.`)),(0,Vi.G)(n,e)}}),Xi=(0,Zt.op)({reverse4d_:function(t,e){const n=(0,S._1)(t,"x","reverse");return A.hu(4===n.rank,(()=>`Error in reverse4D: x must be rank 4 but got rank ${n.rank}.`)),(0,Vi.G)(n,e)}}),Ji=(0,Zt.op)({round_:function(t){const e={x:(0,S._1)(t,"x","round")};return m.BV.runKernel(Kt.e0,e)}});var Yi=n(8526);const Qi=(0,Zt.op)({selu_:function(t){const e={x:(0,S._1)(t,"x","selu")};return m.BV.runKernel(Kt.oF,e)}}),ta=(0,Zt.op)({separableConv2d_:function(t,e,n,r,i,a=[1,1],s="NHWC"){const o=(0,S._1)(t,"x","separableConv2d"),l=(0,S._1)(e,"depthwiseFilter","separableConv2d"),u=(0,S._1)(n,"pointwiseFilter","separableConv2d");let h=o,c=!1;if(3===o.rank&&(c=!0,h=(0,Ln.X)(o,[1,o.shape[0],o.shape[1],o.shape[2]])),"NCHW"===s)throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");A.hu(4===h.rank,(()=>`Error in separableConv2d: input must be rank 4, but got rank ${h.rank}.`)),A.hu(4===l.rank,(()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${l.rank}.`)),A.hu(4===u.rank,(()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${l.rank}.`)),A.hu(1===u.shape[0],(()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${u.shape[0]}.`)),A.hu(1===u.shape[1],(()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${u.shape[1]}.`));const d=l.shape[2],f=l.shape[3];A.hu(u.shape[2]===d*f,(()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${d*f}, but got ${u.shape[2]}.`));const p=vr(h,l,r,i,s,a),m=(0,or.T)(p,u,1,"valid",s);return c?(0,Ln.X)(m,[m.shape[1],m.shape[2],m.shape[3]]):m}}),ea=async function(t,e){const n=(0,S._1)(t,"x","setdiff1d"),r=(0,S._1)(e,"y","setdiff1d");A.hu(n.dtype===r.dtype,(()=>`x and y should have the same dtype, but got x (${n.dtype}) and y (${r.dtype}).`)),A.hu(1===n.rank,(()=>`x should be 1D tensor, but got x (${n.shape}).`)),A.hu(1===r.rank,(()=>`y should be 1D tensor, but got y (${r.shape}).`));const i=await n.data(),a=await r.data(),s=new Set(a);let o=0;for(let t=0;t<i.length;t++)s.has(i[t])||o++;const l=new St.YD([o],n.dtype),u=new St.YD([o],"int32");for(let t=0,e=0;t<i.length;t++)s.has(i[t])||(l.values[e]=i[t],u.values[e]=t,e++);return[l.toTensor(),u.toTensor()]},na=(0,Zt.op)({sign_:function(t){const e={x:(0,S._1)(t,"x","sign")};return m.BV.runKernel(Kt.i5,e)}});var ra=n(262),ia=n(4184);const aa=(0,Zt.op)({slice1d_:function(t,e,n){const r=(0,S._1)(t,"x","slice1d");return A.hu(1===r.rank,(()=>`slice1d expects a rank-1 tensor, but got a rank-${r.rank} tensor`)),(0,Gn.t)(r,[e],[n])}}),sa=(0,Zt.op)({slice2d_:function(t,e,n){const r=(0,S._1)(t,"x","slice2d");return A.hu(2===r.rank,(()=>`slice2d expects a rank-2 tensor, but got a rank-${r.rank} tensor`)),(0,Gn.t)(r,e,n)}}),oa=(0,Zt.op)({slice3d_:function(t,e,n){const r=(0,S._1)(t,"x","slice3d");return A.hu(3===r.rank,(()=>`slice3d expects a rank-3 tensor, but got a rank-${r.rank} tensor`)),(0,Gn.t)(r,e,n)}}),la=(0,Zt.op)({slice4d_:function(t,e,n){const r=(0,S._1)(t,"x","slice4d");return A.hu(4===r.rank,(()=>`slice4d expects a rank-4 tensor, but got a rank-${r.rank} tensor`)),(0,Gn.t)(r,e,n)}}),ua=(0,Zt.op)({softmax_:function(t,e=-1){const n=(0,S._1)(t,"logits","softmax","float32");if(-1===e&&(e=n.rank-1),e!==n.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and dim was ${e}`);const r={logits:n},i={dim:e};return m.BV.runKernel(Kt.Gc,r,i)}}),ha=(0,Zt.op)({fft_:function(t){(0,A.hu)("complex64"===t.dtype,(()=>`The dtype for tf.spectral.fft() must be complex64 but got ${t.dtype}.`));const e={input:t};return m.BV.runKernel(Kt.vw,e)}}),ca=(0,Zt.op)({ifft_:function(t){(0,A.hu)("complex64"===t.dtype,(()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${t.dtype}.`));const e={input:t};return m.BV.runKernel(Kt.Qg,e)}}),da=(0,Zt.op)({irfft_:function(t){const e=t.shape[t.shape.length-1],n=t.size/e;let r;if(e<=2){const i=(0,Ln.X)(t,[n,e]);r=ca(i)}else{const i=[n,2*(e-1)],a=(0,Ln.X)(ji(t),[n,e]),s=(0,Ln.X)(Lr(t),[n,e]),o=(0,Vi.G)((0,Gn.t)(a,[0,1],[n,e-2]),1),l=(0,Ye.d)((0,Vi.G)((0,Gn.t)(s,[0,1],[n,e-2]),1),(0,hn.i)(-1)),u=(0,jn.z)([a,o],1),h=(0,jn.z)([s,l],1),c=(0,Ln.X)((0,x.P)(u,h),[i[0],i[1]]);r=ca(c)}if(r=ji(r),3===t.rank&&0!==t.shape[0]){const e=r,n=t.shape[0];r=(0,Ln.X)(r,[n,r.shape[0]/n,r.shape[1]]),e.dispose()}return r}});var fa=n(5859),pa=n(4265);const ma=(0,Zt.op)({rfft_:function(t,e){(0,A.hu)("float32"===t.dtype,(()=>`The dtype for rfft() must be real value but got ${t.dtype}`));let n=t.shape[t.shape.length-1];const r=t.size/n;let i;if(null!=e&&e<n){const r=t.shape.map((t=>0)),a=t.shape.map((t=>t));a[t.shape.length-1]=e,i=(0,Gn.t)(t,r,a),n=e}else if(null!=e&&e>n){const r=t.shape.map((t=>t));r[t.shape.length-1]=e-n,i=(0,jn.z)([t,(0,pa.l)(r)],t.shape.length-1),n=e}else i=t;const a=(0,en.P)(i),s=(0,Ln.X)((0,x.P)(i,a),[r,n]),o=ha(s),l=Math.floor(n/2)+1,u=ji(o),h=Lr(o),c=(0,fa.V)(u,[l,n-l],u.shape.length-1),d=(0,fa.V)(h,[l,n-l],h.shape.length-1),f=i.shape.slice();return f[i.shape.length-1]=l,(0,Ln.X)((0,x.P)(c[0],d[0]),f)}}),ga=(0,Zt.op)({squaredDifference_:function(t,e){let n=(0,S._1)(t,"a","squaredDifference"),r=(0,S._1)(e,"b","squaredDifference");[n,r]=(0,me.makeTypesMatch)(n,r),(0,Qt.assertAndGetBroadcastShape)(n.shape,r.shape);const i={a:n,b:r};return m.BV.runKernel(Kt._t,i,{})}}),ba=(0,Zt.op)({squeeze_:function(t,e){const n=(0,S._1)(t,"x","squeeze");return(0,Ln.X)(n,(0,A.bp)(n.shape,e).newShape)}});var ya=n(8673),va=n(4272);const wa=(0,Zt.op)({stridedSlice_:function(t,e,n,r,i=0,a=0,s=0,o=0,l=0){const u={x:(0,S._1)(t,"x","stridedSlice","string_or_numeric")},h={begin:e,end:n,strides:r,beginMask:i,endMask:a,ellipsisMask:s,newAxisMask:o,shrinkAxisMask:l};return m.BV.runKernel(Kt.m2,u,h)}}),_a=(0,Zt.op)({tan_:function(t){const e={x:(0,S._1)(t,"x","tan","float32")};return m.BV.runKernel(Kt.sE,e)}});function ka(t,e){(0,A.Cq)(t);const n=(0,S.C)(t,e);if(1!==n.length)throw new Error("tensor1d() requires values to be a flat/TypedArray");return(0,E.H)(t,null,n,e)}function xa(t,e,n){if((0,A.Cq)(t),null!=e&&2!==e.length)throw new Error("tensor2d() requires shape to have two numbers");const r=(0,S.C)(t,n);if(2!==r.length&&1!==r.length)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return(0,E.H)(t,e,r,n)}function Sa(t,e,n){if((0,A.Cq)(t),null!=e&&4!==e.length)throw new Error("tensor4d() requires shape to have four numbers");const r=(0,S.C)(t,n);if(4!==r.length&&1!==r.length)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return(0,E.H)(t,e,r,n)}function Ea(t,e,n){if((0,A.Cq)(t),null!=e&&5!==e.length)throw new Error("tensor5d() requires shape to have five numbers");const r=(0,S.C)(t,n);if(5!==r.length&&1!==r.length)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return(0,E.H)(t,e,r,n)}function Ia(t,e,n){if((0,A.Cq)(t),null!=e&&6!==e.length)throw new Error("tensor6d() requires shape to have six numbers");const r=(0,S.C)(t,n);if(6!==r.length&&1!==r.length)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return e=e||r,(0,E.H)(t,e,r,n)}const Aa=(0,Zt.op)({topk_:function(t,e=1,n=!0){const r=(0,S._1)(t,"x","topk");if(0===r.rank)throw new Error("topk() expects the input to be of rank 1 or higher");const i=r.shape[r.shape.length-1];if(e<0)throw new Error(`'k' passed to topk() must be >= 0 but got ${e}`);if(e>i)throw new Error(`'k' passed to topk() must be <= the last dimension (${i}) but got ${e}`);const a={x:r},s={k:e,sorted:n},[o,l]=m.BV.runKernel(Kt.cW,a,s);return{values:o,indices:l}}}),Ma=(0,Zt.op)({truncatedNormal_:function(t,e=0,n=1,r,i){if(null!=r&&"bool"===r)throw new Error("Unsupported data type $ { dtype }");const a=new zi(e,n,r,!0,i),s=Et(t,r);for(let t=0;t<s.values.length;t++)s.values[t]=a.nextValue();return s.toTensor()}}),Ta=(0,Zt.op)({unique_:function(t,e=0){const n=(0,S._1)(t,"x","unique","string_or_numeric");(0,A.hu)(n.rank>0,(()=>"The input tensor must be at least 1D"));const r={x:n},i={axis:e},[a,s]=m.BV.runKernel(Kt.kp,r,i);return{values:a,indices:s}}});var Na=n(5370),Ca=n(8347);function Ra(t,e=!0,n,r){return m.BV.makeVariable(t,e,n,r)}function Oa(t,e){const n=[];for(let t=0;t<e.length;t++)e[t]&&n.push(t);const r=Et(t,"int32"),i=Et([n.length,t.length],"int32");for(let e=0;e<n.length;e++){const a=r.indexToLoc(n[e]),s=e*t.length;i.values.set(a,s)}return i.toTensor()}const Da=async function(t){const e=(0,S._1)(t,"condition","whereAsync","bool"),n=await e.data(),r=Oa(e.shape,n);return t!==e&&e.dispose(),r},za=async function(t,e,n){const r=(0,S._1)(t,"tensor","boolMask"),i=(0,S._1)(e,"mask","boolMask","bool"),a=null==n?0:n,s=i.rank,o=r.shape;A.hu(s>0,(()=>"mask cannot be scalar")),A.k5(o.slice(a,a+s),i.shape,"mask's shape must match the first K dimensions of tensor's shape,");let l=1;for(let t=a;t<a+s;t++)l*=o[t];const u=o.slice(0,a).concat([l],o.slice(a+s)),h=(0,Ln.X)(r,u),c=(0,Ln.X)(i,[-1]),d=await Da(c),f=ba(d,[1]),p=(0,Br.I)(h,f,a);return t!==r&&r.dispose(),e!==i&&i.dispose(),f.dispose(),h.dispose(),c.dispose(),d.dispose(),p};function Ba(t,e,n=null){if(0===t.rank)return yn(t);if(1!==t.rank&&null===n)return Ba((0,Ln.X)(t,[-1]),e,n);if(1===t.rank||"number"==typeof n||Array.isArray(n)&&1===n.length){if(1===e)return(0,ti.S)(yn(t),n);if(e===1/0)return Qr(yn(t),n);if(e===-1/0)return pi(yn(t),n);if("euclidean"===e||2===e)return(0,Qe._)((0,ti.S)((0,mn.s)(yn(t),(0,hn.i)(2,"int32")),n));throw new Error(`Error in norm: invalid ord value: ${e}`)}if(Array.isArray(n)&&2===n.length){if(1===e)return Qr((0,ti.S)(yn(t),n[0]),n[1]-1);if(e===1/0)return Qr((0,ti.S)(yn(t),n[1]),n[0]);if(e===-1/0)return pi((0,ti.S)(yn(t),n[1]),n[0]);if("fro"===e||"euclidean"===e)return(0,Qe._)((0,ti.S)((0,tn.h)(t),n));throw new Error(`Error in norm: invalid ord value: ${e}`)}throw new Error(`Error in norm: invalid axis: ${n}`)}const Fa=(0,Zt.op)({norm_:function(t,e="euclidean",n=null,r=!1){const i=Ba(t=(0,S._1)(t,"x","norm"),e,n);let a=i.shape;if(r){const e=(0,A.EC)(n,t.shape);a=ni.rv(i.shape,e)}return(0,Ln.X)(i,a)}}),Pa=(0,Zt.op)({movingAverage_:function(t,e,n,r,i=!0){const a=(0,S._1)(t,"v","movingAverage"),s=(0,S._1)(e,"x","movingAverage"),o=(0,S._1)(n,"decay","movingAverage");(0,me.assertTypesMatch)(a,s),A.hu(A.cO(a.shape,s.shape),(()=>"Shape mismatch in v and x"));const l=(0,hn.i)(1),u=(0,gn.l)(l,o);let h=(0,Ye.d)((0,gn.l)(s,a),u);if(i){A.hu(null!=r,(()=>"When using zeroDebias: true, step is required."));const t=(0,S._1)(r,"step","movingAverage");h=(0,Je.h)(h,(0,gn.l)(l,(0,mn.s)(o,t)))}return(0,Xe.I)(a,h)}}),La=(0,Zt.op)({scatterND_:function(t,e,n){const r=(0,S._1)(t,"indices","scatterND","int32"),i=(0,S._1)(e,"updates","scatterND");ue(i,r,n);const a={indices:r,updates:i},s={shape:n};return m.BV.runKernel(Kt.xQ,a,s)}}),$a=(0,Zt.op)({sparseToDense_:function(t,e,n,r=0){const i=(0,S._1)(t,"sparseIndices","sparseToDense","int32"),a=(0,S._1)(e,"sparseValues","sparseToDense"),s=(0,S._1)(r,"defaultValue","sparseToDense",a.dtype);!function(t,e,n,r){if("int32"!==t.dtype)throw new Error(`tf.sparseToDense() expects the indices to be int32 type, but the dtype was ${t.dtype}.`);if(t.rank>2)throw new Error(`sparseIndices should be a scalar, vector, or matrix, but got shape ${t.shape}.`);const i=t.rank>0?t.shape[0]:1,a=t.rank>1?t.shape[1]:1;if(n.length!==a)throw new Error(`outputShape has incorrect number of elements:, ${n.length}, should be: ${a}.`);const s=e.size;if(0!==e.rank&&(1!==e.rank||s!==i))throw new Error(`sparseValues has incorrect shape ${e.shape}, should be [] or [${i}]`);if(e.dtype!==r.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}(i,a,n,s);const o={sparseIndices:i,sparseValues:a,defaultValue:s},l={outputShape:n};return m.BV.runKernel(Kt.D2,o,l)}}),Ua=(0,Zt.op)({gatherND_:function(t,e){const n=(0,S._1)(e,"indices","gatherND","int32"),r={params:(0,S._1)(t,"x","gatherND","string_or_numeric"),indices:n};return m.BV.runKernel(Kt.q1,r)}}),ja=(0,Zt.op)({dropout_:function(t,e,n,r){const i=(0,S._1)(t,"x","dropout");if(A.hu("float32"===i.dtype,(()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${i.dtype} tensor instead.`)),A.hu(e>=0&&e<1,(()=>`rate must be a float in the range [0, 1), but got ${e}.`)),0===e)return t instanceof St.es?i.clone():i;const a=function(t,e){if(null==e)return t.shape.slice();if(A.cO(t.shape,e))return e;if(t.shape.length===e.length){const n=[];for(let r=0;r<t.shape.length;r++)null==e[r]&&null!=t.shape[r]?n.push(t.shape[r]):n.push(e[r]);return n}return e}(i,n),s=1-e,o=(0,Je.h)((0,Dr.G)((0,Xe.I)($i(a,0,1,"float32",r),s)),s);return(0,Ye.d)(i,o)}});function Wa(t){return Math.floor(Math.pow(2,Math.ceil(Math.log(t)/Math.log(2))))}function Ga(t,e,n){const r=1-t%2,i=new Float32Array(t);for(let a=0;a<t;++a){const s=2*Math.PI*a/(t+r-1);i[a]=e-n*Math.cos(s)}return ka(i,"float32")}const Ha=async function(t,e,n=1){const r=(0,S._1)(t,"predictions","inTopK"),i=(0,S._1)(e,"targets","inTopK");(0,A.hu)(r.rank>1,(()=>`inTopK() expects the predictions to be of rank 2 or higher, but got ${r.rank}`)),(0,A.hu)(r.rank-1===i.rank,(()=>`predictions rank should be 1 larger than targets rank, but got predictions rank ${r.rank} and targets rank ${i.rank}`)),(0,A.k5)(r.shape.slice(0,r.shape.length-1),i.shape,"predictions's shape should be align with the targets' shape, except the last dimension.");const a=r.shape[r.shape.length-1];(0,A.hu)(n>0&&n<=a,(()=>`'k' passed to inTopK() must be > 0 && <= the predictions last dimension (${a}), but got ${n}`));const s=await r.data(),o=await i.data(),[l,u]=[s.length/a,a],h=(0,A.WP)("bool",l);for(let t=0;t<l;t++){const e=t*u,r=s.subarray(e,e+u),i=[];for(let t=0;t<r.length;t++)i.push({value:r[t],index:t});i.sort(((t,e)=>e.value-t.value)),h[t]=0;for(let e=0;e<n;e++)if(i[e].index===o[t]){h[t]=1;break}}return t!==r&&r.dispose(),e!==i&&i.dispose(),I(h,i.shape,"bool")};var Va=n(6762);function qa(t,e,n){if(null==n||"linear"===n)return t;if("relu"===n)return(0,Ye.d)(t,(0,va.N)(e));throw new Error(`Cannot compute gradient for fused activation ${n}.`)}function Ka(t,e){let n=e;const r=Qt.getReductionAxes(t.shape,e.shape);return r.length>0&&(n=(0,ti.S)(n,r)),(0,Ln.X)(n,t.shape)}function Za(t,e,n,r){if("linear"===e)return t;if("relu"===e)return Gi(t);if("elu"===e)return Ar(t);if("relu6"===e)return Hi(t);if("prelu"===e)return Ci(t,n);if("leakyrelu"===e)return Wr(t,r);if("sigmoid"===e)return(0,Wn.X)(t);throw new Error(`Unknown fused activation ${e}.`)}const Xa=(t,e)=>!(t>0)||"linear"===e,Ja=(0,Zt.op)({fusedConv2d_:function({x:t,filter:e,strides:n,pad:r,dataFormat:i="NHWC",dilations:a=[1,1],dimRoundingMode:s,bias:o,activation:l="linear",preluActivationWeights:u,leakyreluAlpha:h}){if(l=l||"linear",!1===Xa(m.BV.state.gradientDepth,l)){let c=(0,or.T)(t,e,n,r,i,a,s);return null!=o&&(c=(0,Xe.I)(c,o)),Za(c,l,u,h)}const c=(0,S._1)(t,"x","conv2d","float32"),d=(0,S._1)(e,"filter","conv2d","float32");let f=c,p=!1;3===c.rank&&(p=!0,f=(0,Ln.X)(c,[1,c.shape[0],c.shape[1],c.shape[2]])),A.hu(4===f.rank,(()=>`Error in fused conv2d: input must be rank 4, but got rank ${f.rank}.`)),A.hu(4===d.rank,(()=>`Error in fused conv2d: filter must be rank 4, but got rank ${d.rank}.`)),Pn.m("fused conv2d",r,s),A.hu(f.shape[3]===d.shape[2],(()=>`Error in conv2d: depth of input (${f.shape[3]}) must match input depth for filter ${d.shape[2]}.`)),A.hu(Pn.jT(n,a),(()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${a}'`)),A.hu("NHWC"===i,(()=>`Error in conv2d: got dataFormat of ${i} but only NHWC is currently supported.`));const g=Pn.Ix(f.shape,d.shape,n,a,r,s);let b,y;null!=o&&(b=(0,S._1)(o,"bias","fused conv2d"),[b]=(0,me.makeTypesMatch)(b,c),Qt.assertAndGetBroadcastShape(g.outShape,b.shape)),null!=u&&(y=(0,S._1)(u,"prelu weights","fused conv2d"));const v=(t,e)=>{const[i,s,o,u]=e,h=qa(t,o,l);A.hu(Pn.I0(a),(()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${a}'`));const c=[(0,ur._)(s.shape,h,i,n,r),(0,Va.p)(s,h,i.shape,n,r)];if(null!=u){const t=Ka(u,h);c.push(t)}return c},w={x:f,filter:d,bias:b,preluActivationWeights:y},_={strides:n,pad:r,dataFormat:i,dilations:a,dimRoundingMode:s,activation:l,leakyreluAlpha:h};if(null==o){const t=ln(((t,e,n)=>{let r=m.BV.runKernel(Kt._V,w,_);return n([e,t,r]),p&&(r=(0,Ln.X)(r,[r.shape[1],r.shape[2],r.shape[3]])),{value:r,gradFunc:v}}));return t(f,d)}{const t=ln(((t,e,n,r)=>{let i=m.BV.runKernel(Kt._V,w,_);return r([e,t,i,n]),p&&(i=(0,Ln.X)(i,[i.shape[1],i.shape[2],i.shape[3]])),{value:i,gradFunc:v}}));return t(f,d,b)}}});var Ya=n(5105),Qa=n(2172);const ts=(0,Zt.op)({fusedDepthwiseConv2d_:function({x:t,filter:e,strides:n,pad:r,dataFormat:i="NHWC",dilations:a=[1,1],dimRoundingMode:s,bias:o,activation:l="linear",preluActivationWeights:u,leakyreluAlpha:h}){if(!1===Xa(m.BV.state.gradientDepth,l)){let c=vr(t,e,n,r,i,a,s);return null!=o&&(c=(0,Xe.I)(c,o)),Za(c,l,u,h)}const c=(0,S._1)(t,"x","depthwiseConv2d","float32"),d=(0,S._1)(e,"filter","depthwiseConv2d","float32");let f=c,p=!1;3===c.rank&&(p=!0,f=(0,Ln.X)(c,[1,c.shape[0],c.shape[1],c.shape[2]])),A.hu(4===f.rank,(()=>`Error in fused depthwiseConv2d: input must be rank 4, but got rank ${f.rank}.`)),A.hu(4===d.rank,(()=>`Error in fused depthwiseConv2d: filter must be rank 4, but got rank ${d.rank}.`)),A.hu(f.shape[3]===d.shape[2],(()=>`Error in fused depthwiseConv2d: number of input channels (${f.shape[3]}) must match the inChannels dimension in filter ${d.shape[2]}.`)),null==a&&(a=[1,1]),A.hu(Pn.jT(n,a),(()=>`Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides ${n} and dilations '${a}'`)),Pn.m("fused depthwiseConv2d",r,s);const g=Pn.Ix(f.shape,d.shape,n,a,r,s,!0);let b,y;null!=o&&(b=(0,S._1)(o,"bias","fused conv2d"),[b]=(0,me.makeTypesMatch)(b,c),Qt.assertAndGetBroadcastShape(g.outShape,b.shape)),null!=u&&(y=(0,S._1)(u,"prelu weights","fused depthwiseConv2d"));const v=(t,e)=>{A.hu(Pn.I0(a),(()=>`Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '${a}'`));const[i,o,u,h]=e,c=qa(t,u,l),d=(0,Qa.v)(o.shape,c,i,n,r,a,s),f=(0,Ya.z)(o,c,i.shape,n,r,a,s);return null!=h?[d,f,Ka(b,c)]:[d,f]},w={x:f,filter:d,bias:b,preluActivationWeights:y},_={strides:n,pad:r,dataFormat:i,dilations:a,dimRoundingMode:s,activation:l,leakyreluAlpha:h};if(null==o){const t=ln(((t,e,n)=>{let r=m.BV.runKernel(Kt.lu,w,_);return n([e,t,r]),p&&(r=(0,Ln.X)(r,[r.shape[1],r.shape[2],r.shape[3]])),{value:r,gradFunc:v}}));return t(f,d)}{const t=ln(((t,e,n,r)=>{let i=m.BV.runKernel(Kt.lu,w,_);return r([e,t,i,n]),p&&(i=(0,Ln.X)(i,[i.shape[1],i.shape[2],i.shape[3]])),{value:i,gradFunc:v}}));return t(f,d,b)}}}),es=(0,Zt.op)({fusedMatMul_:function({a:t,b:e,transposeA:n=!1,transposeB:r=!1,bias:i,activation:a="linear",preluActivationWeights:s,leakyreluAlpha:o}){if(!1===Xa(m.BV.state.gradientDepth,a)){let l=(0,qt.O)(t,e,n,r);return null!=i&&(l=(0,Xe.I)(l,i)),Za(l,a,s,o)}let l=(0,S._1)(t,"a","fused matMul"),u=(0,S._1)(e,"b","fused matMul");[l,u]=(0,me.makeTypesMatch)(l,u);const h=n?l.shape[l.rank-2]:l.shape[l.rank-1],c=r?u.shape[u.rank-1]:u.shape[u.rank-2],d=n?l.shape[l.rank-1]:l.shape[l.rank-2],f=r?u.shape[u.rank-2]:u.shape[u.rank-1],p=l.shape.slice(0,-2),g=u.shape.slice(0,-2),b=A.NA(p),y=A.NA(g);A.hu(h===c,(()=>`Error in fused matMul: inner shapes (${h}) and (${c}) of Tensors with shapes ${l.shape} and ${u.shape} and transposeA=${n} and transposeB=${r} must match.`));const v=Qt.assertAndGetBroadcastShape(l.shape.slice(0,-2),u.shape.slice(0,-2)).concat([d,f]),w=n?(0,Ln.X)(l,[b,h,d]):(0,Ln.X)(l,[b,d,h]),_=r?(0,Ln.X)(u,[y,f,c]):(0,Ln.X)(u,[y,c,f]);let k,x;null!=i&&(k=(0,S._1)(i,"bias","fused matMul"),[k]=(0,me.makeTypesMatch)(k,l),Qt.assertAndGetBroadcastShape(v,k.shape)),null!=s&&(x=(0,S._1)(s,"prelu weights","fused matMul"));const E=(t,e)=>{const[s,o,l,u]=e,h=qa((0,Ln.X)(t,l.shape),l,a);let c,d;return n||r?!n&&r?(c=(0,qt.O)(h,o,!1,!1),d=(0,qt.O)(h,s,!0,!1)):n&&!r?(c=(0,qt.O)(o,h,!1,!0),d=(0,qt.O)(s,h,!1,!1)):(c=(0,qt.O)(o,h,!0,!0),d=(0,qt.O)(h,s,!0,!0)):(c=(0,qt.O)(h,o,!1,!0),d=(0,qt.O)(s,h,!0,!1)),null!=i?[c,d,Ka(u,h)]:[c,d]},I={a:w,b:_,bias:k,preluActivationWeights:x},M={transposeA:n,transposeB:r,activation:a,leakyreluAlpha:o};if(null==i){const t=ln(((t,e,n)=>{const r=m.BV.runKernel(Kt.us,I,M);return n([t,e,r]),{value:(0,Ln.X)(r,v),gradFunc:E}}));return t(w,_)}{const t=ln(((t,e,n,r)=>{const i=m.BV.runKernel(Kt.us,I,M);return r([t,e,i,n]),{value:(0,Ln.X)(i,v),gradFunc:E}}));return t(w,_,k)}}}),ns=(0,Zt.op)({hammingWindow_:function(t){return Ga(t,.54,.46)}}),rs=(0,Zt.op)({hannWindow_:function(t){return Ga(t,.5,.5)}}),is=(0,Zt.op)({frame_:function(t,e,n,r=!1,i=0){let a=0;const s=[];for(;a+e<=t.size;)s.push((0,Gn.t)(t,a,e)),a+=n;if(r)for(;a<t.size;){const r=a+e-t.size,o=(0,jn.z)([(0,Gn.t)(t,a,e-r),fn([r],i)]);s.push(o),a+=n}return 0===s.length?xa([],[0,e]):(0,Ln.X)((0,jn.z)(s),[s.length,e])}}),as=(0,Zt.op)({stft_:function(t,e,n,r,i=rs){null==r&&(r=Wa(e));const a=is(t,e,n),s=(0,Ye.d)(a,i(e));return ma(s,r)}}),ss=(0,Zt.op)({cropAndResize_:function(t,e,n,r,i="bilinear",a=0){const s=(0,S._1)(t,"image","cropAndResize"),o=(0,S._1)(e,"boxes","cropAndResize","float32"),l=(0,S._1)(n,"boxInd","cropAndResize","int32"),u=o.shape[0];A.hu(4===s.rank,(()=>`Error in cropAndResize: image must be rank 4,but got rank ${s.rank}.`)),A.hu(2===o.rank&&4===o.shape[1],(()=>`Error in cropAndResize: boxes must be have size [${u},4] but had shape ${o.shape}.`)),A.hu(1===l.rank&&l.shape[0]===u,(()=>`Error in cropAndResize: boxInd must be have size [${u}] but had shape ${o.shape}.`)),A.hu(2===r.length,(()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${r.length}.`)),A.hu(r[0]>=1&&r[1]>=1,(()=>`cropSize must be atleast [1,1], but was ${r}`)),A.hu("bilinear"===i||"nearest"===i,(()=>`method must be bilinear or nearest, but was ${i}`));const h={image:s,boxes:o,boxInd:l},c={method:i,extrapolationValue:a,cropSize:r};return m.BV.runKernel(Kt.Vc,h,c)}}),os=(0,Zt.op)({flipLeftRight_:function(t){const e=(0,S._1)(t,"image","flipLeftRight","float32");A.hu(4===e.rank,(()=>`Error in flipLeftRight: image must be rank 4,but got rank ${e.rank}.`));const n={image:e};return m.BV.runKernel(Kt.Uy,n,{})}}),ls=(0,Zt.op)({grayscaleToRGB_:function(t){const e=(0,S._1)(t,"image","grayscaleToRGB"),n=e.rank-1,r=e.shape[n];A.hu(e.rank>=2,(()=>`Error in grayscaleToRGB: images must be at least rank 2, but got rank ${e.rank}.`)),A.hu(1===r,(()=>`Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ${r}.`));const i=new Array(e.rank);return i.fill(1,0,n),i[n]=3,(0,Rr.G)(e,i)}}),us=(0,Zt.op)({rotateWithOffset_:function(t,e,n=0,r=.5){const i=(0,S._1)(t,"image","rotateWithOffset","float32");A.hu(4===i.rank,(()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${i.rank}.`));const a={image:i},s={radians:e,fillValue:n,center:r};return m.BV.runKernel(Kt.b9,a,s)}});function hs(t,e,n,r,i,a){null==r&&(r=.5),null==i&&(i=Number.NEGATIVE_INFINITY),null==a&&(a=0);const s=t.shape[0];return n=Math.min(n,s),A.hu(0<=r&&r<=1,(()=>`iouThreshold must be in [0, 1], but was '${r}'`)),A.hu(2===t.rank,(()=>`boxes must be a 2D tensor, but was of rank '${t.rank}'`)),A.hu(4===t.shape[1],(()=>`boxes must have 4 columns, but 2nd dimension was ${t.shape[1]}`)),A.hu(1===e.rank,(()=>"scores must be a 1D tensor")),A.hu(e.shape[0]===s,(()=>`scores has incompatible shape with boxes. Expected ${s}, but was ${e.shape[0]}`)),A.hu(0<=a&&a<=1,(()=>`softNmsSigma must be in [0, 1], but was '${a}'`)),{maxOutputSize:n,iouThreshold:r,scoreThreshold:i,softNmsSigma:a}}const cs=(0,Zt.op)({nonMaxSuppression_:function(t,e,n,r=.5,i=Number.NEGATIVE_INFINITY){const a=(0,S._1)(t,"boxes","nonMaxSuppression","float32"),s=(0,S._1)(e,"scores","nonMaxSuppression","float32"),o=hs(a,s,n,r,i),l={maxOutputSize:n=o.maxOutputSize,iouThreshold:r=o.iouThreshold,scoreThreshold:i=o.scoreThreshold};return m.BV.runKernel(Kt.uv,{boxes:a,scores:s},l)}});function ds(t,e,n){const r=function(t,e,n){return function(t,e,n){let r=0,i=t.length,a=0,s=!1;for(;r<i;){a=r+(i-r>>>1);const o=n(e,t[a]);o>0?r=a+1:(i=a,s=!o)}return s?r:-r-1}(t,e,n||fs)}(t,e,n),i=r<0?-(r+1):r;t.splice(i,0,e)}function fs(t,e){return t>e?1:t<e?-1:0}function ps(t,e,n,r,i){return bs(t,e,n,r,i,0)}function ms(t,e,n,r,i,a){return bs(t,e,n,r,i,0,!1,a,!0)}function gs(t,e,n,r,i,a){return bs(t,e,n,r,i,a,!0)}function bs(t,e,n,r,i,a,s=!1,o=!1,l=!1){const u=[];for(let t=0;t<e.length;t++)e[t]>i&&u.push({score:e[t],boxIndex:t,suppressBeginIndex:0});u.sort(ws);const h=a>0?-.5/a:0,c=[],d=[];for(;c.length<n&&u.length>0;){const e=u.pop(),{score:n,boxIndex:a,suppressBeginIndex:s}=e;if(n<i)break;let o=!1;for(let n=c.length-1;n>=s;--n){const s=ys(t,a,c[n]);if(s>=r){o=!0;break}if(e.score=e.score*vs(r,h,s),e.score<=i)break}e.suppressBeginIndex=c.length,o||(e.score===n?(c.push(a),d.push(e.score)):e.score>i&&ds(u,e,ws))}const f=c.length,p=n-f;o&&p>0&&(c.push(...new Array(p).fill(0)),d.push(...new Array(p).fill(0)));const m={selectedIndices:c};return s&&(m.selectedScores=d),l&&(m.validOutputs=f),m}function ys(t,e,n){const r=t.subarray(4*e,4*e+4),i=t.subarray(4*n,4*n+4),a=Math.min(r[0],r[2]),s=Math.min(r[1],r[3]),o=Math.max(r[0],r[2]),l=Math.max(r[1],r[3]),u=Math.min(i[0],i[2]),h=Math.min(i[1],i[3]),c=Math.max(i[0],i[2]),d=Math.max(i[1],i[3]),f=(o-a)*(l-s),p=(c-u)*(d-h);if(f<=0||p<=0)return 0;const m=Math.max(a,u),g=Math.max(s,h),b=Math.min(o,c),y=Math.min(l,d),v=Math.max(b-m,0)*Math.max(y-g,0);return v/(f+p-v)}function vs(t,e,n){const r=Math.exp(e*n*n);return n<=t?r:0}function ws(t,e){return t.score-e.score||t.score===e.score&&e.boxIndex-t.boxIndex}const _s=(0,Zt.op)({nonMaxSuppressionWithScore_:function(t,e,n,r=.5,i=Number.NEGATIVE_INFINITY,a=0){const s=(0,S._1)(t,"boxes","nonMaxSuppression"),o=(0,S._1)(e,"scores","nonMaxSuppression"),l=hs(s,o,n,r,i,a),u={boxes:s,scores:o},h={maxOutputSize:n=l.maxOutputSize,iouThreshold:r=l.iouThreshold,scoreThreshold:i=l.scoreThreshold,softNmsSigma:a=l.softNmsSigma},c=m.BV.runKernel(Kt.W0,u,h);return{selectedIndices:c[0],selectedScores:c[1]}}}),ks=(0,Zt.op)({nonMaxSuppressionPadded_:function(t,e,n,r=.5,i=Number.NEGATIVE_INFINITY,a=!1){const s=(0,S._1)(t,"boxes","nonMaxSuppression"),o=(0,S._1)(e,"scores","nonMaxSuppression"),l=hs(s,o,n,r,i,null),u={boxes:s,scores:o},h={maxOutputSize:l.maxOutputSize,iouThreshold:l.iouThreshold,scoreThreshold:l.scoreThreshold,padToMaxOutputSize:a},c=m.BV.runKernel(Kt.cy,u,h);return{selectedIndices:c[0],validOutputs:c[1]}}}),xs=(0,Zt.op)({resizeBilinear_:function(t,e,n=!1,r=!1){const i=(0,S._1)(t,"images","resizeBilinear");A.hu(3===i.rank||4===i.rank,(()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${i.rank}.`)),A.hu(2===e.length,(()=>`Error in resizeBilinear: new shape must 2D, but got shape ${e}.`)),A.hu(!1===r||!1===n,(()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false."));let a=i,s=!1;3===i.rank&&(s=!0,a=(0,Ln.X)(i,[1,i.shape[0],i.shape[1],i.shape[2]]));const[]=e,o={images:a},l={alignCorners:n,halfPixelCenters:r,size:e},u=m.BV.runKernel(Kt._Y,o,l);return s?(0,Ln.X)(u,[u.shape[1],u.shape[2],u.shape[3]]):u}}),Ss=(0,Zt.op)({resizeNearestNeighbor_:function(t,e,n=!1,r=!1){const i=(0,S._1)(t,"images","resizeNearestNeighbor");A.hu(3===i.rank||4===i.rank,(()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${i.rank}.`)),A.hu(2===e.length,(()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${e}.`)),A.hu("float32"===i.dtype||"int32"===i.dtype,(()=>"`images` must have `int32` or `float32` as dtype")),A.hu(!1===r||!1===n,(()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false."));let a=i,s=!1;3===i.rank&&(s=!0,a=(0,Ln.X)(i,[1,i.shape[0],i.shape[1],i.shape[2]]));const[]=e,o={images:a},l={alignCorners:n,halfPixelCenters:r,size:e},u=m.BV.runKernel(Kt.dp,o,l);return s?(0,Ln.X)(u,[u.shape[1],u.shape[2],u.shape[3]]):u}}),Es=(0,Zt.op)({threshold_:function(t,e="binary",n=!1,r=.5){const i=(0,S._1)(t,"image","threshold"),a=i.shape[0]*i.shape[1];let s,o,l,u,h=(0,Ye.d)(ka([r]),255);if(A.hu(3===i.rank,(()=>`Error in threshold: image must be rank 3,but got rank ${i.rank}.`)),A.hu(3===i.shape[2]||1===i.shape[2],(()=>`Error in threshold: image color channel must be equal to 3 or 1but got ${i.shape[2]}.`)),A.hu("int32"===i.dtype||"float32"===i.dtype,(()=>`Error in dtype: image dtype must be int32 or float32,but got dtype ${i.dtype}.`)),A.hu("otsu"===e||"binary"===e,(()=>`Method must be binary or otsu, but was ${e}`)),3===i.shape[2]){[s,o,l]=(0,fa.V)(i,[1,1,1],-1);const t=(0,Ye.d)(s,.2989),e=(0,Ye.d)(o,.587),n=(0,Ye.d)(l,.114);u=(0,Xe.I)((0,Xe.I)(t,e),n)}else u=t;"otsu"===e&&(h=function(t,e){let n,r,i,a,s,o,l=ka([-1]),u=ka([0]),h=ka([0]);for(let c=0;c<t.size-1;c++){n=(0,Gn.t)(t,0,c+1),r=(0,Gn.t)(t,c+1),s=(0,Je.h)((0,ti.S)(n),e),o=(0,Je.h)((0,ti.S)(r),e);const d=(0,ti.S)((0,Ye.d)(n,Ui(0,n.size)));i=(0,Je.h)(d,(0,ti.S)(n));const f=fn(r.shape,n.size),p=(0,Xe.I)(Ui(0,r.size),f),m=(0,Ye.d)(r,p);a=(0,Je.h)((0,ti.S)(m),(0,ti.S)(r));const g=(0,gn.l)(i,a),b=(0,gn.l)(i,a),y=(0,Ye.d)(s,o);h=(0,Ye.d)((0,Ye.d)(y,g),b);const v=(0,Fr.p)(h,u);u=(0,xr.a)(v,h,u),l=(0,xr.a)(v,ka([c]),l)}return l}(Yn((0,It.p)(Ji(u),"int32"),I([]),256),a));const c=n?(0,Hr.z)(u,h):(0,Fr.p)(u,h);return(0,It.p)((0,Ye.d)(c,255),"int32")}}),Is=(0,Zt.op)({transform_:function(t,e,n="nearest",r="constant",i=0,a){const s=(0,S._1)(t,"image","transform","float32"),o=(0,S._1)(e,"transforms","transform","float32");A.hu(4===s.rank,(()=>`Error in transform: image must be rank 4,but got rank ${s.rank}.`)),A.hu(2===o.rank&&(o.shape[0]===s.shape[0]||1===o.shape[0])&&8===o.shape[1],(()=>"Error in transform: Input transform should be batch x 8 or 1 x 8")),A.hu(null==a||2===a.length,(()=>`Error in transform: outputShape must be [height, width] or null, but got ${a}.`));const l={image:s,transforms:o},u={interpolation:n,fillMode:r,fillValue:i,outputShape:a};return m.BV.runKernel(Kt.wx,l,u)}}),As=(0,Zt.op)({bandPart_:function(t,e,n){(0,A.hu)(e%1==0,(()=>`bandPart(): numLower must be an integer, got ${e}.`)),(0,A.hu)(n%1==0,(()=>`bandPart(): numUpper must be an integer, got ${n}.`));const r=(0,S._1)(t,"a","bandPart");(0,A.hu)(r.rank>=2,(()=>`bandPart(): Rank must be at least 2, got ${r.rank}.`));const i=r.shape,[a,s]=r.shape.slice(-2);if(!(e<=a))throw new Error(`bandPart(): numLower (${e}) must not be greater than the number of rows (${a}).`);if(!(n<=s))throw new Error(`bandPart(): numUpper (${n}) must not be greater than the number of columns (${s}).`);e<0&&(e=a),n<0&&(n=s);const o=(0,Ln.X)(Ui(0,a,1,"int32"),[-1,1]),l=Ui(0,s,1,"int32"),u=(0,gn.l)(o,l),h=(0,ii.H)((0,Hr.z)(u,(0,hn.i)(+e,"int32")),(0,Pr.b)(u,(0,hn.i)(-n,"int32"))),c=(0,pa.l)([a,s],r.dtype);return(0,Ln.X)((0,ya.k)((0,Ca.H)((0,Ln.X)(r,[-1,a,s])).map((t=>(0,xr.a)(h,t,c)))),i)}}),Ms=(0,Zt.op)({gramSchmidt_:function(t){let e;if(Array.isArray(t)){e=!1,(0,A.hu)(null!=t&&t.length>0,(()=>"Gram-Schmidt process: input must not be null, undefined, or empty"));const n=t[0].shape[0];for(let e=1;e<t.length;++e)(0,A.hu)(t[e].shape[0]===n,(()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${t[e].shape[0]} vs. ${n})`))}else e=!0,t=(0,fa.V)(t,t.shape[0],0).map((t=>ba(t,[0])));(0,A.hu)(t.length<=t[0].shape[0],(()=>`Gram-Schmidt: Number of vectors (${t.length}) exceeds number of dimensions (${t[0].shape[0]}).`));const n=[],r=t;for(let e=0;e<t.length;++e)n.push(m.BV.tidy((()=>{let t=r[e];if(e>0)for(let r=0;r<e;++r){const e=(0,Ye.d)((0,ti.S)((0,Ye.d)(n[r],t)),n[r]);t=(0,gn.l)(t,e)}return(0,Je.h)(t,Fa(t,"euclidean"))})));return e?(0,ya.k)(n,0):n}});function Ts(t,e=!1){return m.BV.tidy((()=>{(0,A.hu)(2===t.shape.length,(()=>`qr2d() requires a 2D Tensor, but got a ${t.shape.length}D Tensor.`));const n=t.shape[0],r=t.shape[1];let i=Or(n),a=(0,At.d)(t);const s=xa([[1]],[1,1]);let o=(0,At.d)(s);const l=n>=r?r:n;for(let t=0;t<l;++t){const e=a,l=o,u=i;[o,a,i]=m.BV.tidy((()=>{const e=(0,Gn.t)(a,[t,t],[n-t,1]),l=Fa(e),u=(0,Gn.t)(a,[t,t],[1,1]),h=(0,xr.a)((0,Fr.p)(u,0),xa([[-1]]),xa([[1]])),c=(0,gn.l)(u,(0,Ye.d)(h,l)),d=(0,Je.h)(e,c);o=1===d.shape[0]?(0,At.d)(s):(0,jn.z)([s,(0,Gn.t)(d,[1,0],[d.shape[0]-1,d.shape[1]])],0);const f=(0,Xr.W)((0,Je.h)((0,qt.O)(h,c),l)),p=(0,Gn.t)(a,[t,0],[n-t,r]),m=(0,Ye.d)(f,o),g=(0,Jt.p)(o);if(0===t)a=(0,gn.l)(p,(0,qt.O)(m,(0,qt.O)(g,p)));else{const e=(0,gn.l)(p,(0,qt.O)(m,(0,qt.O)(g,p)));a=(0,jn.z)([(0,Gn.t)(a,[0,0],[t,r]),e],0)}const b=(0,Jt.p)(m),y=(0,Gn.t)(i,[0,t],[n,i.shape[1]-t]);if(0===t)i=(0,gn.l)(y,(0,qt.O)((0,qt.O)(y,o),b));else{const e=(0,gn.l)(y,(0,qt.O)((0,qt.O)(y,o),b));i=(0,jn.z)([(0,Gn.t)(i,[0,0],[n,t]),e],1)}return[o,a,i]})),Pe([e,l,u])}return!e&&n>r&&(i=(0,Gn.t)(i,[0,0],[n,r]),a=(0,Gn.t)(a,[0,0],[r,r])),[i,a]}))}const Ns=(0,Zt.op)({qr_:function(t,e=!1){if((0,A.hu)(t.rank>=2,(()=>`qr() requires input tensor to have a rank >= 2, but got rank ${t.rank}`)),2===t.rank)return Ts(t,e);{const n=t.shape.slice(0,t.shape.length-2).reduce(((t,e)=>t*e)),r=(0,Ca.H)((0,Ln.X)(t,[n,t.shape[t.shape.length-2],t.shape[t.shape.length-1]]),0),i=[],a=[];return r.forEach((t=>{const[n,r]=Ts(t,e);i.push(n),a.push(r)})),[(0,Ln.X)((0,ya.k)(i,0),t.shape),(0,Ln.X)((0,ya.k)(a,0),t.shape)]}}});var Cs;!function(t){t[t.NONE=0]="NONE",t[t.MEAN=1]="MEAN",t[t.SUM=2]="SUM",t[t.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"}(Cs||(Cs={}));const Rs=(0,Zt.op)({computeWeightedLoss_:function(t,e,n=Cs.SUM_BY_NONZERO_WEIGHTS){const r=(0,S._1)(t,"losses","computeWeightedLoss");let i=null;null!=e&&(i=(0,S._1)(e,"weights","computeWeightedLoss"));const a=null==i?r:(0,Ye.d)(r,i);if(n===Cs.NONE)return a;if(n===Cs.SUM)return(0,ti.S)(a);if(n===Cs.MEAN){if(null==i)return ci(a);{const t=r.size/i.size,e=(0,Je.h)((0,ti.S)(a),(0,ti.S)(i));return t>1?(0,Je.h)(e,(0,hn.i)(t)):e}}if(n===Cs.SUM_BY_NONZERO_WEIGHTS){if(null==i)return(0,Je.h)((0,ti.S)(a),(0,hn.i)(r.size));{const t=(0,Ye.d)(i,(0,di.i)(r.shape)),e=(0,It.p)((0,ti.S)(_i(t,(0,hn.i)(0))),"float32");return(0,Je.h)((0,ti.S)(a),e)}}throw Error(`Unknown reduction: ${n}`)}}),Os=(0,Zt.op)({absoluteDifference_:function(t,e,n,r=Cs.SUM_BY_NONZERO_WEIGHTS){const i=(0,S._1)(t,"labels","absoluteDifference"),a=(0,S._1)(e,"predictions","absoluteDifference");let s=null;null!=n&&(s=(0,S._1)(n,"weights","absoluteDifference")),(0,A.k5)(i.shape,a.shape,"Error in absoluteDifference: ");const o=yn((0,gn.l)(i,a));return Rs(o,s,r)}}),Ds=(0,Zt.op)({cosineDistance_:function(t,e,n,r,i=Cs.SUM_BY_NONZERO_WEIGHTS){const a=(0,S._1)(t,"labels","cosineDistance"),s=(0,S._1)(e,"predictions","cosineDistance");let o=null;null!=r&&(o=(0,S._1)(r,"weights","cosineDistance")),(0,A.k5)(a.shape,s.shape,"Error in cosineDistance: ");const l=(0,hn.i)(1),u=(0,gn.l)(l,(0,ti.S)((0,Ye.d)(a,s),n,!0));return Rs(u,o,i)}}),zs=(0,Zt.op)({hingeLoss_:function(t,e,n,r=Cs.SUM_BY_NONZERO_WEIGHTS){let i=(0,S._1)(t,"labels","hingeLoss");const a=(0,S._1)(e,"predictions","hingeLoss");let s=null;null!=n&&(s=(0,S._1)(n,"weights","hingeLoss")),(0,A.k5)(i.shape,a.shape,"Error in hingeLoss: ");const o=(0,hn.i)(1);i=(0,gn.l)((0,Ye.d)((0,hn.i)(2),i),o);const l=Gi((0,gn.l)(o,(0,Ye.d)(i,a)));return Rs(l,s,r)}}),Bs=(0,Zt.op)({huberLoss_:function(t,e,n,r=1,i=Cs.SUM_BY_NONZERO_WEIGHTS){const a=(0,S._1)(t,"labels","huberLoss"),s=(0,S._1)(e,"predictions","huberLoss");let o=null;null!=n&&(o=(0,S._1)(n,"weights","huberLoss")),(0,A.k5)(a.shape,s.shape,"Error in huberLoss: ");const l=(0,hn.i)(r),u=yn((0,gn.l)(s,a)),h=mi(u,l),c=(0,gn.l)(u,h),d=(0,Xe.I)((0,Ye.d)((0,hn.i)(.5),(0,tn.h)(h)),(0,Ye.d)(l,c));return Rs(d,o,i)}}),Fs=(0,Zt.op)({logLoss_:function(t,e,n,r=1e-7,i=Cs.SUM_BY_NONZERO_WEIGHTS){const a=(0,S._1)(t,"labels","logLoss"),s=(0,S._1)(e,"predictions","logLoss");let o=null;null!=n&&(o=(0,S._1)(n,"weights","logLoss")),(0,A.k5)(a.shape,s.shape,"Error in logLoss: ");const l=(0,hn.i)(1),u=(0,hn.i)(r),h=(0,Xr.W)((0,Ye.d)(a,(0,Kr.c)((0,Xe.I)(s,u)))),c=(0,Ye.d)((0,gn.l)(l,a),(0,Kr.c)((0,Xe.I)((0,gn.l)(l,s),u))),d=(0,gn.l)(h,c);return Rs(d,o,i)}}),Ps=(0,Zt.op)({meanSquaredError_:function(t,e,n,r=Cs.SUM_BY_NONZERO_WEIGHTS){const i=(0,S._1)(t,"labels","meanSquaredError"),a=(0,S._1)(e,"predictions","meanSquaredError");let s=null;null!=n&&(s=(0,S._1)(n,"weights","meanSquaredError")),(0,A.k5)(i.shape,a.shape,"Error in meanSquaredError: ");const o=ga(i,a);return Rs(o,s,r)}}),Ls=(0,Zt.op)({sigmoidCrossEntropy_:function(t,e,n,r=0,i=Cs.SUM_BY_NONZERO_WEIGHTS){let a=(0,S._1)(t,"multiClassLabels","sigmoidCrossEntropy");const s=(0,S._1)(e,"logits","sigmoidCrossEntropy");let o=null;if(null!=n&&(o=(0,S._1)(n,"weights","sigmoidCrossEntropy")),(0,A.k5)(a.shape,s.shape,"Error in sigmoidCrossEntropy: "),r>0){const t=(0,hn.i)(r),e=(0,hn.i)(1),n=(0,hn.i)(.5);a=(0,Xe.I)((0,Ye.d)(a,(0,gn.l)(e,t)),(0,Ye.d)(n,t))}const l=function(t,e){const n=(0,S._1)(t,"labels","sigmoidCrossEntropyWithLogits"),r=(0,S._1)(e,"logits","sigmoidCrossEntropyWithLogits");(0,A.k5)(n.shape,r.shape,"Error in sigmoidCrossEntropyWithLogits: ");const i=Gi(r),a=(0,Ye.d)(r,n),s=Zr((0,Tr.Q)((0,Xr.W)(yn(r))));return(0,Xe.I)((0,gn.l)(i,a),s)}(a,s);return Rs(l,o,i)}}),$s=(0,Zt.op)({softmaxCrossEntropy_:function(t,e,n,r=0,i=Cs.SUM_BY_NONZERO_WEIGHTS){let a=(0,S._1)(t,"onehotLabels","softmaxCrossEntropy");const s=(0,S._1)(e,"logits","softmaxCrossEntropy");let o=null;if(null!=n&&(o=(0,S._1)(n,"weights","softmaxCrossEntropy")),(0,A.k5)(a.shape,s.shape,"Error in softmaxCrossEntropy: "),r>0){const t=(0,hn.i)(r),e=(0,hn.i)(1),n=(0,hn.i)(a.shape[1]);a=(0,Xe.I)((0,Ye.d)(a,(0,gn.l)(e,t)),(0,Je.h)(t,n))}const l=function(t,e,n=-1){if(-1===n&&(n=e.rank-1),n!==e.rank-1)throw Error(`Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank ${e.rank} and dim was ${n}`);const r=ln(((t,e,r)=>{const i=ri(e,[n],!0),a=(0,gn.l)((0,It.p)(e,"float32"),i);r([t,a]);const s=(0,Xr.W)((0,Ye.d)(a,t));return{value:(0,ti.S)(s,[n]),gradFunc:(t,e)=>{const[r,i]=e,a=(0,ni.rv)(t.shape,[n]);return[(0,Ye.d)((0,Ln.X)(t,a),(0,gn.l)((0,It.p)(r,"float32"),(0,Tr.Q)(i))),(0,Ye.d)((0,Ln.X)(t,a),(0,gn.l)((0,Tr.Q)(i),(0,It.p)(r,"float32")))]}}}));return r(t,e)}(a,s);return Rs(l,o,i)}}),Us=(0,Zt.op)({sparseFillEmptyRows_:function(t,e,n,r){const i=(0,S._1)(t,"indices","sparseFillEmptyRows","int32"),a=(0,S._1)(e,"values","sparseFillEmptyRows"),s=(0,S._1)(n,"denseShape","sparseFillEmptyRows","int32"),o=(0,S._1)(r,"defaultValue","sparseFillEmptyRows",a.dtype);if(2!==i.rank)throw new Error(`Indices should be Tensor2D but received shape\n        ${i.shape}`);if(1!==a.rank)throw new Error(`Values should be Tensor1D but received shape ${a.shape}`);if(1!==s.rank)throw new Error(`Dense shape should be Tensor1D but received shape ${s.shape}`);if(0!==o.rank)throw new Error(`Default value should be a scalar but received shape ${o.shape}`);const l={indices:i,values:a,denseShape:s,defaultValue:o},u=m.BV.runKernel(Kt.O3,l);return{outputIndices:u[0],outputValues:u[1],emptyRowIndicator:u[2],reverseIndexMap:u[3]}}}),js=(0,Zt.op)({sparseReshape_:function(t,e,n){const r=(0,S._1)(t,"inputIndices","sparseReshape","int32"),i=(0,S._1)(e,"inputShape","sparseReshape","int32"),a=(0,S._1)(n,"newShape","sparseReshape","int32");if(2!==r.rank)throw new Error(`Input indices should be Tensor2D but received shape\n        ${r.shape}`);if(1!==i.rank)throw new Error(`Input shape should be Tensor1D but received shape ${i.shape}`);if(1!==a.rank)throw new Error(`New shape should be Tensor1D but received shape ${a.shape}`);const s={inputIndices:r,inputShape:i,newShape:a},o=m.BV.runKernel(Kt.nh,s);return{outputIndices:o[0],outputShape:o[1]}}}),Ws=(0,Zt.op)({sparseSegmentMean_:function(t,e,n){const r=(0,S._1)(t,"data","sparseSegmentMean"),i=(0,S._1)(e,"indices","sparseSegmentMean","int32"),a=(0,S._1)(n,"segmentIds","sparseSegmentMean","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==i.rank)throw new Error(`Indices should be Tensor1D but received shape\n          ${i.shape}`);if(1!==a.rank)throw new Error(`Segment ids should be Tensor1D but received shape\n          ${a.shape}`);const s={data:r,indices:i,segmentIds:a};return m.BV.runKernel(Kt.YW,s)}}),Gs=(0,Zt.op)({sparseSegmentSum_:function(t,e,n){const r=(0,S._1)(t,"data","sparseSegmentSum"),i=(0,S._1)(e,"indices","sparseSegmentSum","int32"),a=(0,S._1)(n,"segmentIds","sparseSegmentSum","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==i.rank)throw new Error(`Indices should be Tensor1D but received shape\n         ${i.shape}`);if(1!==a.rank)throw new Error(`Segment ids should be Tensor1D but received shape\n         ${a.shape}`);const s={data:r,indices:i,segmentIds:a};return m.BV.runKernel(Kt.Zj,s)}}),Hs=(0,Zt.op)({stringNGrams_:function(t,e,n,r,i,a,s,o){const l=(0,S._1)(t,"data","stringNGrams","string");if("string"!==l.dtype)throw new Error("Data must be of datatype string");if(1!==l.shape.length)throw new Error(`Data must be a vector, saw: ${l.shape}`);const u=(0,S._1)(e,"dataSplits","stringNGrams");if("int32"!==u.dtype)throw new Error("Data splits must be of datatype int32");const h={separator:n,nGramWidths:r,leftPad:i,rightPad:a,padWidth:s,preserveShortSequences:o},c={data:l,dataSplits:u},d=m.BV.runKernel(Kt._J,c,h);return{nGrams:d[0],nGramsSplits:d[1]}}}),Vs=(0,Zt.op)({stringSplit_:function(t,e,n=!0){const r=(0,S._1)(t,"input","stringSplit","string"),i=(0,S._1)(e,"delimiter","stringSplit","string");if(1!==r.rank)throw new Error(`Input should be Tensor1D but received shape ${r.shape}`);if(0!==i.rank)throw new Error(`Delimiter should be a scalar but received shape ${i.shape}`);const a={skipEmpty:n},s={input:r,delimiter:i},o=m.BV.runKernel(Kt.s1,s,a);return{indices:o[0],values:o[1],shape:o[2]}}}),qs=(0,Zt.op)({stringToHashBucketFast_:function(t,e){const n=(0,S._1)(t,"input","stringToHashBucketFast","string"),r={numBuckets:e};if(e<=0)throw new Error("Number of buckets must be at least 1");const i={input:n};return m.BV.runKernel(Kt.Xk,i,r)}}),Ks={fft:ha,ifft:ca,rfft:ma,irfft:da},Zs={hammingWindow:ns,hannWindow:rs,frame:is,stft:as},Xs={flipLeftRight:os,grayscaleToRGB:ls,resizeNearestNeighbor:Ss,resizeBilinear:xs,rotateWithOffset:us,cropAndResize:ss,nonMaxSuppression:cs,nonMaxSuppressionAsync:async function(t,e,n,r=.5,i=Number.NEGATIVE_INFINITY){const a=(0,S._1)(t,"boxes","nonMaxSuppressionAsync"),s=(0,S._1)(e,"scores","nonMaxSuppressionAsync"),o=hs(a,s,n,r,i);n=o.maxOutputSize,r=o.iouThreshold,i=o.scoreThreshold;const l=await Promise.all([a.data(),s.data()]),u=l[0],h=l[1],{selectedIndices:c}=ps(u,h,n,r,i);return a!==t&&a.dispose(),s!==e&&s.dispose(),ka(c,"int32")},nonMaxSuppressionWithScore:_s,nonMaxSuppressionWithScoreAsync:async function(t,e,n,r=.5,i=Number.NEGATIVE_INFINITY,a=0){const s=(0,S._1)(t,"boxes","nonMaxSuppressionAsync"),o=(0,S._1)(e,"scores","nonMaxSuppressionAsync"),l=hs(s,o,n,r,i,a);n=l.maxOutputSize,r=l.iouThreshold,i=l.scoreThreshold,a=l.softNmsSigma;const u=await Promise.all([s.data(),o.data()]),h=u[0],c=u[1],{selectedIndices:d,selectedScores:f}=gs(h,c,n,r,i,a);return s!==t&&s.dispose(),o!==e&&o.dispose(),{selectedIndices:ka(d,"int32"),selectedScores:ka(f)}},nonMaxSuppressionPadded:ks,nonMaxSuppressionPaddedAsync:async function(t,e,n,r=.5,i=Number.NEGATIVE_INFINITY,a=!1){const s=(0,S._1)(t,"boxes","nonMaxSuppressionAsync"),o=(0,S._1)(e,"scores","nonMaxSuppressionAsync"),l=hs(s,o,n,r,i,null),u=l.maxOutputSize,h=l.iouThreshold,c=l.scoreThreshold,[d,f]=await Promise.all([s.data(),o.data()]),{selectedIndices:p,validOutputs:m}=ms(d,f,u,h,c,a);return s!==t&&s.dispose(),o!==e&&o.dispose(),{selectedIndices:ka(p,"int32"),validOutputs:(0,hn.i)(m,"int32")}},threshold:Es,transform:Is},Js={bandPart:As,gramSchmidt:Ms,qr:Ns},Ys={absoluteDifference:Os,computeWeightedLoss:Rs,cosineDistance:Ds,hingeLoss:zs,huberLoss:Bs,logLoss:Fs,meanSquaredError:Ps,sigmoidCrossEntropy:Ls,softmaxCrossEntropy:$s},Qs={sparseFillEmptyRows:Us,sparseReshape:js,sparseSegmentMean:Ws,sparseSegmentSum:Gs},to={stringNGrams:Hs,stringSplit:Vs,stringToHashBucketFast:qs},eo={sgd:Sn.sgd,momentum:Sn.momentum,adadelta:Sn.adadelta,adagrad:Sn.adagrad,rmsprop:Sn.rmsprop,adamax:Sn.adamax,adam:Sn.adam},no="undefined"!=typeof requestAnimationFrame?requestAnimationFrame:"undefined"!=typeof setImmediate?setImmediate:t=>t();function ro(){return new Promise((t=>no((()=>t()))))}function io(t,e){const n=t[0].length;t.forEach(((t,e)=>{A.hu(t.length===n,(()=>`Error in concat${n}D: rank of tensors[${e}] must be the same as the rank of the rest (${n})`))})),A.hu(e>=0&&e<n,(()=>`Error in concat${n}D: axis must be between 0 and ${n-1}.`));const r=t[0];t.forEach(((t,i)=>{for(let a=0;a<n;a++)A.hu(a===e||t[a]===r[a],(()=>`Error in concat${n}D: Shape of tensors[${i}] (${t}) does not match the shape of the rest (${r}) along the non-concatenated axis ${i}.`))}))}function ao(t,e){const n=t[0].slice();for(let r=1;r<t.length;r++)n[e]+=t[r][e];return n}const so=30;function oo(t){return t<=so?t:(0,A.jP)(t,Math.floor(Math.sqrt(t)))}function lo(t,e,n){return[n*("number"==typeof t?t:t[0]),e*("number"==typeof t?t:t[1])]}function uo(t,e,n,r=!0){let i=[];if(r)i=i.concat(e.slice(0)),i.push(t[0]/n),i=i.concat(t.slice(1));else{i=i.concat(t[0]);const n=e.length;for(let r=0;r<n;++r)i=i.concat([t[r+1]/e[r],e[r]]);i=i.concat(t.slice(n+1))}return i}function ho(t,e,n=!0){const r=[];if(n){r.push(e);for(let n=e+1;n<t;++n)n<=2*e?(r.push(n),r.push(n-(e+1))):r.push(n)}else{const n=[],i=[];for(let r=1;r<t;++r)r>=2*e+1||r%2==1?i.push(r):n.push(r);r.push(...n),r.push(0),r.push(...i)}return r}function co(t,e,n,r=!0){const i=[];r?i.push(t[0]/n):i.push(t[0]*n);for(let n=1;n<t.length;++n)n<=e.length?r?i.push(e[n-1]*t[n]):i.push(t[n]/e[n-1]):i.push(t[n]);return i}function fo(t,e){const n=[0];for(let r=0;r<e;++r)n.push(t[r][0]);return n}function po(t,e,n){const r=t.slice(0,1);for(let i=0;i<n;++i)r.push(t[i+1]-e[i][0]-e[i][1]);return r}var mo=n(7827);const go=.3275911,bo=.254829592,yo=-.284496736,vo=1.421413741,wo=-1.453152027,_o=1.061405429;var ko=n(8496);function xo(t,e){if(t.length!==e.length)throw new Error(`Cannot merge real and imag arrays of different lengths. real:${t.length}, imag: ${e.length}.`);const n=new Float32Array(2*t.length);for(let r=0;r<n.length;r+=2)n[r]=t[r/2],n[r+1]=e[r/2];return n}function So(t){const e=new Float32Array(t.length/2),n=new Float32Array(t.length/2);for(let r=0;r<t.length;r+=2)e[r/2]=t[r],n[r/2]=t[r+1];return{real:e,imag:n}}function Eo(t){const e=Math.ceil(t.length/4),n=new Float32Array(e),r=new Float32Array(e);for(let e=0;e<t.length;e+=4)n[Math.floor(e/4)]=t[e],r[Math.floor(e/4)]=t[e+1];return{real:n,imag:r}}function Io(t){const e=Math.floor(t.length/4),n=new Float32Array(e),r=new Float32Array(e);for(let e=2;e<t.length;e+=4)n[Math.floor(e/4)]=t[e],r[Math.floor(e/4)]=t[e+1];return{real:n,imag:r}}function Ao(t,e){return{real:t[2*e],imag:t[2*e+1]}}function Mo(t,e,n,r){t[2*r]=e,t[2*r+1]=n}function To(t,e){const n=new Float32Array(t/2),r=new Float32Array(t/2);for(let i=0;i<Math.ceil(t/2);i++){const a=(e?2:-2)*Math.PI*(i/t);n[i]=Math.cos(a),r[i]=Math.sin(a)}return{real:n,imag:r}}function No(t,e,n){const r=(n?2:-2)*Math.PI*(t/e);return{real:Math.cos(r),imag:Math.sin(r)}}const Co=/->/g;function Ro(t,e){const n=((t=t.replace(/\s/g,"")).length-t.replace(Co,"").length)/"->".length;if(n<1)throw new Error("Equations without an arrow are not supported.");if(n>1)throw new Error('Equation must contain exactly one arrow ("->").');const[r,i]=t.split("->");(0,A.hu)(-1===r.indexOf("..."),(()=>'The ellipsis notation ("...") is not supported yet.'));const a=r.split(","),s=a.length;if(e!==s)throw new Error(`Expected ${s} input tensors, received ${e}`);if(s>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");const o=[];for(let t=0;t<i.length;++t){const e=i[t];if(!a.some((t=>-1!==t.indexOf(e))))throw new Error(`Output subscripts contain the label ${e} not present in the input subscripts.`);-1===o.indexOf(e)&&o.push(e)}for(let t=0;t<r.length;++t){const e=r[t];-1===o.indexOf(e)&&","!==e&&o.push(e)}const l=new Array(a.length);for(let t=0;t<s;++t){if(new Set(a[t].split("")).size!==a[t].length)throw new Error(`Found duplicate axes in input component ${a[t]}. Support for duplicate axes in input is not implemented yet.`);l[t]=[];for(let e=0;e<a[t].length;++e)l[t].push(o.indexOf(a[t][e]))}const u=o.length,h=[];for(let t=i.length;t<u;++t)h.push(t);return{allDims:o,summedDims:h,idDims:l}}function Oo(t,e){let n=new Array(t);n.fill(-1);for(let t=0;t<e.length;++t)n[e[t]]=t;const r=[];for(let e=0;e<t;++e)-1===n[e]&&r.push(e);return n=n.filter((t=>-1!==t)),{permutationIndices:n,expandDims:r}}function Do(t,e,n){const r=new Array(t);for(let t=0;t<n.length;++t){const i=n[t].shape;for(let n=0;n<e[t].length;++n)void 0===r[e[t][n]]?r[e[t][n]]=i[n]:(0,A.hu)(r[e[t][n]]===i[n],(()=>`Expected dimension ${r[e[t][n]]} at axis ${n} of input shaped ${JSON.stringify(i)}, but got dimension ${i[n]}`))}}function zo(t,e){const n=t,r=[];let i=0;0===t.length&&n.push(-1),i=t.length+1;for(let t=0;t<i;++t)r.push([]);const a=[];for(let t=0;t<n.length;++t){const i=Fo(e,n[t]);for(const e of i)-1===a.indexOf(e)&&(r[t].push(e),a.push(e))}return{path:n,steps:r}}function Bo(t){return t.every(((t,e)=>t===e))}function Fo(t,e){const n=[];for(let r=0;r<t.length;++r)0!==t[r].length&&-1===t[r].indexOf(e)&&-1!==e||n.push(r);return n}function Po(t,e,n=0){let r=[];if("number"==typeof e)(0,A.hu)(t.shape[n]%e==0,(()=>"Number of splits must evenly divide the axis.")),r=new Array(e).fill(t.shape[n]/e);else{const i=e.reduce(((t,e)=>(-1===e&&(t+=1),t)),0);(0,A.hu)(i<=1,(()=>"There should be only one negative value in split array."));const a=e.indexOf(-1);if(-1!==a){const r=e.reduce(((t,e)=>e>0?t+e:t));e[a]=t.shape[n]-r}(0,A.hu)(t.shape[n]===e.reduce(((t,e)=>t+e)),(()=>"The sum of sizes must match the size of the axis dimension.")),r=e}return r}function Lo(t){return`Received SparseTensor with denseShape[0] = 0 but\n  indices.shape[0] = ${t}`}function $o(t,e){return`indices(${t}, 0) is invalid: ${e} < 0`}function Uo(t,e,n){return`indices(${t}, 0) is invalid: ${e} >= ${n}`}function jo(t,e){return`only one output dimension may be -1, not both ${t} and ${e}`}function Wo(t,e){return`size ${t} must be non-negative, not ${e}`}function Go(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function Ho(t,e){return`Input to reshape is a SparseTensor with ${(0,A.NA)(t)}\n  dense values, but the requested shape requires a multiple of ${(0,A.NA)(e)}. inputShape=${t} outputShape= ${e}`}function Vo(t,e){return`Input to reshape is a tensor with ${(0,A.NA)(t)} dense values, but the requested shape has ${(0,A.NA)(e)}. inputShape=${t} outputShape=${e}`}function qo(){return"segment ids must be >= 0"}function Ko(){return"segment ids are not increasing"}function Zo(t,e){return`Segment id ${t} out of range [0, ${e}), possibly because segmentIds input is not sorted.`}function Xo(t,e,n){return`Bad: indices[${t}] == ${e} out of range [0, ${n})`}function Jo(t,e){let n,r=!1;for(t<=so?(n=t,r=!0):n=(0,A.jP)(t,Math.floor(Math.sqrt(t)));!r;)n>e||n===t?r=!0:n=(0,A.jP)(t,n+1);return n}function Yo(t,e,n){const r=[],i=t.length;for(let a=0;a<i;a++)a!==e?r.push(t[a]):r.push(n);return r}function Qo(t,e,n,r){const i=e.shape.length,a=t.shape.length;if(0!==r&&(r<-i||r>i))throw new Error(`Expect batchDims in the range of [-${i}, ${i}], but got ${r}`);if(r<0&&(r+=i),r>a)throw new Error(`batchDims (${r}) must be less than rank(x) (\n    ${a}).`);if(n<r)throw new Error(`batchDims (${r}) must be less than or equal to axis (${n}).`);for(let n=0;n<r;++n)if(t.shape[n]!==e.shape[n])throw new Error(`x.shape[${n}]: ${t.shape[n]} should be equal to indices.shape[${n}]: ${e.shape[n]}.`);const s=t.shape[n],o=[];let l=1,u=1,h=1;for(let e=0;e<r;++e)o.push(t.shape[e]),l*=t.shape[e];for(let e=r;e<n;e++)o.push(t.shape[e]),u*=t.shape[e];for(let t=r;t<i;t++)o.push(e.shape[t]);for(let e=n+1;e<a;e++)o.push(t.shape[e]),h*=t.shape[e];return{batchSize:l,sliceSize:h,outerSize:u,dimSize:s,outputShape:o}}function tl(t){try{return t.map((t=>(0,ge.decodeString)(t)))}catch(t){throw new Error(`Failed to decode encoded string bytes into utf-8, error: ${t}`)}}function el(t){return t.map((t=>(0,ge.encodeString)(t)))}var nl=n(7607)},3960:(t,e,n)=>{"use strict";n.d(e,{SY:()=>r,VG:()=>i,Sp:()=>a,mm:()=>s,Xz:()=>o,oT:()=>l,IK:()=>u,sJ:()=>h,aJ:()=>c,M2:()=>d,qw:()=>f,jM:()=>p,Oy:()=>m,QC:()=>g,Jh:()=>b,RO:()=>y,_k:()=>v,IM:()=>w,XL:()=>_,zw:()=>k,zv:()=>x,Ly:()=>S,eE:()=>E,RF:()=>I,gJ:()=>A,xn:()=>M,Zz:()=>T,yj:()=>N,Eh:()=>C,mh:()=>R,wU:()=>O,wm:()=>D,x1:()=>z,o2:()=>B,ik:()=>F,mc:()=>P,TR:()=>L,iH:()=>$,Vc:()=>U,QR:()=>j,T0:()=>W,ci:()=>G,sL:()=>H,y7:()=>V,$w:()=>q,p4:()=>K,ek:()=>Z,Vn:()=>X,oH:()=>J,$g:()=>Y,SX:()=>Q,HE:()=>tt,Om:()=>et,hd:()=>nt,NE:()=>rt,YF:()=>it,Y0:()=>at,vw:()=>st,de:()=>ot,Uy:()=>lt,OR:()=>ut,je:()=>ht,sH:()=>ct,qi:()=>dt,q1:()=>ft,iZ:()=>pt,Ac:()=>mt,iJ:()=>gt,Qg:()=>bt,J_:()=>yt,av:()=>vt,iW:()=>wt,r7:()=>_t,J$:()=>kt,vt:()=>xt,CA:()=>St,e7:()=>Et,Zb:()=>It,kU:()=>At,PY:()=>Mt,Vf:()=>Tt,MZ:()=>Nt,qC:()=>Ct,eZ:()=>Rt,Hh:()=>Ot,Yo:()=>Dt,BM:()=>zt,mT:()=>Bt,OV:()=>Ft,OA:()=>Pt,OU:()=>Lt,vF:()=>$t,q2:()=>Ut,c1:()=>jt,q8:()=>Wt,jQ:()=>Gt,Vb:()=>Ht,NZ:()=>Vt,wY:()=>qt,ku:()=>Kt,yQ:()=>Zt,uv:()=>Xt,cy:()=>Jt,W0:()=>Yt,qW:()=>Qt,we:()=>te,Qi:()=>ee,ly:()=>ne,Kg:()=>re,pe:()=>ie,o0:()=>ae,Dl:()=>se,e6:()=>oe,xJ:()=>le,$H:()=>ue,qk:()=>he,HZ:()=>ce,dp:()=>de,Hm:()=>fe,_Y:()=>pe,zb:()=>me,Sb:()=>ge,mK:()=>be,e0:()=>ye,bV:()=>ve,xQ:()=>we,Ph:()=>_e,oF:()=>ke,p2:()=>xe,RQ:()=>Se,w3:()=>Ee,i5:()=>Ie,a5:()=>Ae,MR:()=>Me,FK:()=>Te,GB:()=>Ne,TQ:()=>Ce,L8:()=>Re,Gc:()=>Oe,O3:()=>De,nh:()=>ze,YW:()=>Be,Zj:()=>Fe,D2:()=>Pe,_t:()=>Le,bK:()=>$e,m2:()=>Ue,_J:()=>je,s1:()=>We,Xk:()=>Ge,Tr:()=>He,sE:()=>Ve,MI:()=>qe,n9:()=>Ke,cW:()=>Ze,wx:()=>Xe,G3:()=>Je,kp:()=>Ye,To:()=>Qe,Qv:()=>tn,Ru:()=>en,h8:()=>nn,eB:()=>rn,b9:()=>an,us:()=>sn,_V:()=>on,lu:()=>ln});const r="Abs",i="Acos",a="Acosh",s="Add",o="AddN",l="All",u="Any",h="ArgMax",c="ArgMin",d="Asin",f="Asinh",p="Atan",m="Atanh",g="Atan2",b="AvgPool",y="AvgPoolGrad",v="AvgPool3D",w="AvgPool3DGrad",_="BatchMatMul",k="BatchToSpaceND",x="Bincount",S="BroadcastTo",E="BroadcastArgs",I="Cast",A="Ceil",M="ClipByValue",T="Complex",N="ComplexAbs",C="Concat",R="Conv2D",O="Conv2DBackpropFilter",D="Conv2DBackpropInput",z="Conv3D",B="Conv3DBackpropFilterV2",F="Conv3DBackpropInputV2",P="Cos",L="Cosh",$="Cumsum",U="CropAndResize",j="DenseBincount",W="DepthToSpace",G="DepthwiseConv2dNative",H="DepthwiseConv2dNativeBackpropFilter",V="DepthwiseConv2dNativeBackpropInput",q="Diag",K="Dilation2D",Z="Dilation2DBackpropInput",X="Dilation2DBackpropFilter",J="RealDiv",Y="Einsum",Q="Elu",tt="EluGrad",et="Erf",nt="Equal",rt="Exp",it="ExpandDims",at="Expm1",st="FFT",ot="Fill",lt="FlipLeftRight",ut="Floor",ht="FloorDiv",ct="FusedBatchNorm",dt="GatherV2",ft="GatherNd",pt="Greater",mt="GreaterEqual",gt="Identity",bt="IFFT",yt="Imag",vt="IsFinite",wt="IsInf",_t="IsNan",kt="LeakyRelu",xt="Less",St="LessEqual",Et="LinSpace",It="Log",At="Log1p",Mt="LogicalAnd",Tt="LogicalNot",Nt="LogicalOr",Ct="LogSoftmax",Rt="LRN",Ot="LRNGrad",Dt="Max",zt="Maximum",Bt="MaxPool",Ft="MaxPoolGrad",Pt="MaxPool3D",Lt="MaxPool3DGrad",$t="MaxPoolWithArgmax",Ut="Mean",jt="Min",Wt="Minimum",Gt="MirrorPad",Ht="Mod",Vt="Multinomial",qt="Multiply",Kt="Neg",Zt="NotEqual",Xt="NonMaxSuppressionV3",Jt="NonMaxSuppressionV4",Yt="NonMaxSuppressionV5",Qt="OnesLike",te="OneHot",ee="Pack",ne="PadV2",re="Pool",ie="Pow",ae="Prelu",se="Prod",oe="Range",le="Real",ue="Reciprocal",he="Relu",ce="Reshape",de="ResizeNearestNeighbor",fe="ResizeNearestNeighborGrad",pe="ResizeBilinear",me="ResizeBilinearGrad",ge="Relu6",be="Reverse",ye="Round",ve="Rsqrt",we="ScatterNd",_e="Select",ke="Selu",xe="Slice",Se="Sin",Ee="Sinh",Ie="Sign",Ae="Sigmoid",Me="Softplus",Te="Sqrt",Ne="Sum",Ce="SpaceToBatchND",Re="SplitV",Oe="Softmax",De="SparseFillEmptyRows",ze="SparseReshape",Be="SparseSegmentMean",Fe="SparseSegmentSum",Pe="SparseToDense",Le="SquaredDifference",$e="Square",Ue="StridedSlice",je="StringNGrams",We="StringSplit",Ge="StringToHashBucketFast",He="Sub",Ve="Tan",qe="Tanh",Ke="Tile",Ze="TopK",Xe="Transform",Je="Transpose",Ye="Unique",Qe="Unpack",tn="UnsortedSegmentSum",en="ZerosLike",nn="Step",rn="FromPixels",an="RotateWithOffset",sn="_FusedMatMul",on="FusedConv2D",ln="FusedDepthwiseConv2D"},3796:(t,e,n)=>{"use strict";n.d(e,{pI:()=>l,uk:()=>u,tr:()=>h,wC:()=>c,Li:()=>d,nE:()=>f,bt:()=>p,T3:()=>m});var r=n(7331),i=n(1208),a=n(8496);const s=(0,i.R)("kernelRegistry",(()=>new Map)),o=(0,i.R)("gradRegistry",(()=>new Map));function l(t,e){const n=g(t,e);return s.get(n)}function u(t){return o.get(t)}function h(t){const e=s.entries(),n=[];for(;;){const{done:r,value:i}=e.next();if(r)break;const[a,s]=i,[o]=a.split("_");o===t&&n.push(s)}return n}function c(t){const{kernelName:e,backendName:n}=t,r=g(e,n);s.has(r)&&a.Z(`The kernel '${e}' for backend '${n}' is already registered`),s.set(r,t)}function d(t){const{kernelName:e}=t;o.has(e)&&(0,r.OB)().getBool("DEBUG")&&a.Z(`Overriding the gradient for '${e}'`),o.set(e,t)}function f(t,e){const n=g(t,e);if(!s.has(n))throw new Error(`The kernel '${t}' for backend '${e}' is not registered`);s.delete(n)}function p(t){if(!o.has(t))throw new Error(`The gradient '${t}' for backend is not registered`);o.delete(t)}function m(t,e){h(t).forEach((t=>{c(Object.assign({},t,{backendName:e}))}))}function g(t,e){return`${e}_${t}`}},8496:(t,e,n)=>{"use strict";n.d(e,{Z:()=>i,c:()=>a});var r=n(7331);function i(...t){(0,r.OB)().getBool("IS_TEST")||(0,r.OB)().getBool("PROD")||console.warn(...t)}function a(...t){(0,r.OB)().getBool("IS_TEST")||(0,r.OB)().getBool("PROD")||console.log(...t)}},4602:(t,e,n)=>{"use strict";n.d(e,{I:()=>o});var r=n(3733),i=n(3960),a=n(382),s=n(3329);const o=(0,n(1581).op)({add_:function(t,e){let n=(0,s._1)(t,"a","add"),o=(0,s._1)(e,"b","add");[n,o]=(0,a.makeTypesMatch)(n,o);const l={a:n,b:o};return r.BV.runKernel(i.mm,l)}})},617:(t,e,n)=>{"use strict";n.d(e,{YB:()=>i,Vh:()=>a,kz:()=>s,rv:()=>o,lB:()=>l,Q3:()=>u,LJ:()=>h,sY:()=>c});var r=n(3591);function i(t,e){for(let n=0;n<t.length;++n)if(t[t.length-n-1]!==e-1-n)return!1;return!0}function a(t,e,n){const r=t.length+e.length,i=[];let a=0,s=0;for(let o=0;o<r;o++)-1===n.indexOf(o)?i.push(t[a++]):i.push(e[s++]);return i}function s(t,e){const n=[],r=t.length;for(let i=0;i<r;i++)-1===e.indexOf(i)&&n.push(t[i]);return[n,e.map((e=>t[e]))]}function o(t,e){return a(t,e.map((t=>1)),e)}function l(t,e,n){r.hu(i(e,n),(()=>`${t} supports only inner-most axes for now. Got axes ${e} and rank-${n} input.`))}function u(t,e){if(i(t,e))return null;const n=[];for(let r=0;r<e;++r)-1===t.indexOf(r)&&n.push(r);return t.forEach((t=>n.push(t))),n}function h(t){return t.map(((t,e)=>[e,t])).sort(((t,e)=>t[1]-e[1])).map((t=>t[0]))}function c(t,e){const n=[];for(let r=e-t;r<e;++r)n.push(r);return n}},406:(t,e,n)=>{"use strict";n.d(e,{E:()=>o});var r=n(3733),i=n(3960),a=n(3329),s=n(3591);const o=(0,n(1581).op)({batchToSpaceND_:function(t,e,n){const o=(0,a._1)(t,"x","batchToSpaceND"),l=e.reduce(((t,e)=>t*e));s.hu(o.rank>=1+e.length,(()=>`input rank is ${o.rank} but should be > than blockShape.length ${e.length}`)),s.hu(n.length===e.length,(()=>`crops.length is ${n.length} but should be equal to blockShape.length  ${e.length}`)),s.hu(o.shape[0]%l==0,(()=>`input tensor batch is ${o.shape[0]} but is not divisible by the product of the elements of blockShape ${e.join(" * ")} === ${l}`));const u={x:o},h={blockShape:e,crops:n};return r.BV.runKernel(i.zw,u,h)}})},3934:(t,e,n)=>{"use strict";n.d(e,{U:()=>u});var r=n(3733),i=n(3960),a=n(3329),s=n(8429),o=n(1581),l=n(4374);const u=(0,o.op)({broadcastTo_:function(t,e){let n=(0,a._1)(t,"broadcastTo","x");const o=n.shape;if(e.some((t=>!(t>0)||t%1!=0)))throw new Error(`broadcastTo(): Invalid broadcast shape [${e}].`);if(e.length<n.rank)throw new Error(`broadcastTo(): shape.length=${e.length} < input.rank=${n.rank}.`);if(e.length>n.rank){const t=n.shape.slice();for(;t.length<e.length;)t.unshift(1);n=(0,l.X)(n,t)}const u=n.shape,h=Array.from(e);for(let t=e.length-1;t>=0;t--)if(u[t]===e[t])h[t]=1;else if(1!==n.shape[t])throw new Error(`broadcastTo(): [${o}] cannot be broadcast to [${e}].`);const c=h.map(((t,e)=>t>1?e:-1)).filter((t=>t>=0));if(0===c.length)return(0,s.d)(n);const d={x:n},f={reps:h};return r.BV.runKernel(i.n9,d,f)}})},5725:(t,e,n)=>{"use strict";function r(t,e){const n=t.length,r=[];for(let i=0;i<n;i++){const a=n-1-i,s=t[a]||1;(e[e.length-1-i]||1)>1&&1===s&&r.unshift(a)}return r}function i(t,e){const n=[];for(let r=0;r<e.length;r++){const i=t[t.length-r-1],a=e.length-r-1,s=e[a];(null==i||1===i&&s>1)&&n.unshift(a)}return n}function a(t,e){const n=[],r=Math.max(t.length,e.length);for(let i=0;i<r;i++){let r=t[t.length-i-1];null==r&&(r=1);let a=e[e.length-i-1];if(null==a&&(a=1),1===r)n.unshift(a);else if(1===a)n.unshift(r);else{if(r!==a)throw Error(`Operands could not be broadcast together with shapes ${t} and ${e}.`);n.unshift(r)}}return n}n.r(e),n.d(e,{getBroadcastDims:()=>r,getReductionAxes:()=>i,assertAndGetBroadcastShape:()=>a})},6090:(t,e,n)=>{"use strict";n.d(e,{p:()=>o});var r=n(3733),i=n(3960),a=n(3329),s=n(3591);const o=(0,n(1581).op)({cast_:function(t,e){const n=(0,a._1)(t,"x","cast");if(!s.LP(e))throw new Error(`Failed to cast to unknown dtype ${e}`);if("string"===e&&"string"!==n.dtype||"string"!==e&&"string"===n.dtype)throw new Error("Only strings can be casted to strings");const o={x:n},l={dtype:e};return r.BV.runKernel(i.RF,o,l)}})},8429:(t,e,n)=>{"use strict";n.d(e,{d:()=>s});var r=n(3733),i=n(3960),a=n(3329);const s=(0,n(1581).op)({clone_:function(t){const e={x:(0,a._1)(t,"x","clone","string_or_numeric")};return r.BV.runKernel(i.iJ,e)}})},5655:(t,e,n)=>{"use strict";n.d(e,{P:()=>o});var r=n(3733),i=n(3960),a=n(3329),s=n(3591);const o=(0,n(1581).op)({complex_:function(t,e){const n=(0,a._1)(t,"real","complex"),o=(0,a._1)(e,"imag","complex");s.k5(n.shape,o.shape,`real and imag shapes, ${n.shape} and ${o.shape}, must match in call to tf.complex().`);const l={real:n,imag:o};return r.BV.runKernel(i.Zz,l)}})},1437:(t,e,n)=>{"use strict";n.d(e,{z:()=>l});var r=n(3733),i=n(3960),a=n(3329),s=n(3591),o=n(8429);const l=(0,n(1581).op)({concat_:function(t,e=0){(0,s.hu)(t.length>=1,(()=>"Pass at least one tensor to concat"));const n=(0,a.sI)(t,"tensors","concat","string_or_numeric");if("complex64"===n[0].dtype&&n.forEach((t=>{if("complex64"!==t.dtype)throw new Error(`Cannot concatenate complex64 tensors with a tensor\n          with dtype ${t.dtype}. `)})),1===n.length)return(0,o.d)(n[0]);const l=n,u={axis:e};return r.BV.runKernel(i.Eh,l,u)}})},1747:(t,e,n)=>{"use strict";n.d(e,{T:()=>h});var r=n(3733),i=n(3960),a=n(3329),s=n(3591),o=n(7791),l=n(1581),u=n(4374);const h=(0,l.op)({conv2d_:function(t,e,n,l,h="NHWC",c=[1,1],d){const f=(0,a._1)(t,"x","conv2d","float32"),p=(0,a._1)(e,"filter","conv2d","float32");let m=f,g=!1;3===f.rank&&(g=!0,m=(0,u.X)(f,[1,f.shape[0],f.shape[1],f.shape[2]])),s.hu(4===m.rank,(()=>`Error in conv2d: input must be rank 4, but got rank ${m.rank}.`)),s.hu(4===p.rank,(()=>`Error in conv2d: filter must be rank 4, but got rank ${p.rank}.`)),o.m("conv2d",l,d);const b="NHWC"===h?m.shape[3]:m.shape[1];s.hu(b===p.shape[2],(()=>`Error in conv2d: depth of input (${b}) must match input depth for filter ${p.shape[2]}.`)),s.hu(o.jT(n,c),(()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${c}'`));const y={x:m,filter:p},v={strides:n,pad:l,dataFormat:h,dilations:c,dimRoundingMode:d},w=r.BV.runKernel(i.mh,y,v);return g?(0,u.X)(w,[w.shape[1],w.shape[2],w.shape[3]]):w}})},6762:(t,e,n)=>{"use strict";n.d(e,{p:()=>u});var r=n(3733),i=n(3960),a=n(3591),s=n(7791),o=n(1581),l=n(4374);const u=(0,o.op)({conv2DBackpropFilter_:function(t,e,n,o,u,h="NHWC",c){let d=t;3===t.rank&&(d=(0,l.X)(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let f=e;3===f.rank&&(f=(0,l.X)(e,[1,e.shape[0],e.shape[1],e.shape[2]])),a.hu(4===d.rank,(()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${d.shape}.`)),a.hu(4===f.rank,(()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${f.shape}.`)),a.hu(4===n.length,(()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${n}.`));const p="NHWC"===h?d.shape[3]:d.shape[1],m="NHWC"===h?f.shape[3]:f.shape[1];a.hu(p===n[2],(()=>`Error in conv2dDerFilter: depth of input ${p}) must match input depth in filter (${n[2]}.`)),a.hu(m===n[3],(()=>`Error in conv2dDerFilter: depth of dy (${m}) must match output depth for filter (${n[3]}).`)),s.m("conv2dDerFilter",u,c);const g={x:d,dy:f},b={strides:o,pad:u,dataFormat:h,dimRoundingMode:c,filterShape:n};return r.BV.runKernel(i.wU,g,b)}})},2330:(t,e,n)=>{"use strict";n.d(e,{_:()=>u});var r=n(3733),i=n(3960),a=n(3591),s=n(7791),o=n(1581),l=n(4374);const u=(0,o.op)({conv2DBackpropInput_:function(t,e,n,o,u,h="NHWC",c){a.hu(t.length===e.rank,(()=>`Length of inShape (${t.length}) and rank of dy (${e.rank}) must match`));let d=t,f=e,p=!1;3===e.rank&&(p=!0,f=(0,l.X)(e,[1,e.shape[0],e.shape[1],e.shape[2]]),d=[1,t[0],t[1],t[2]]),a.hu(4===d.length,(()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${d.length}.`)),a.hu(4===f.rank,(()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${f.rank}`)),a.hu(4===n.rank,(()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${n.rank}`));const m="NHWC"===h?d[3]:d[1],g="NHWC"===h?f.shape[3]:f.shape[1];a.hu(m===n.shape[2],(()=>`Error in conv2dDerInput: depth of input (${m}) must match input depth for filter ${n.shape[2]}.`)),a.hu(g===n.shape[3],(()=>`Error in conv2dDerInput: depth of output (${g}) must match output depth for filter ${n.shape[3]}.`)),s.m("conv2dDerInput",u,c);const b={dy:f,filter:n},y={strides:o,pad:u,dataFormat:h,dimRoundingMode:c,inputShape:d},v=r.BV.runKernel(i.wm,b,y);return p?(0,l.X)(v,[v.shape[1],v.shape[2],v.shape[3]]):v}})},7332:(t,e,n)=>{"use strict";n.d(e,{_:()=>l});var r=n(3733),i=n(3960),a=n(3591),s=n(1581),o=n(4374);const l=(0,s.op)({conv3DBackpropInput_:function(t,e,n,s,l){a.hu(t.length===e.rank,(()=>`Length of inShape (${t.length}) and rank of dy (${e.rank}) must match`));let u=t,h=e,c=!1;4===e.rank&&(c=!0,h=(0,o.X)(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]),u=[1,t[0],t[1],t[2],t[3]]);const d=u[4],f=h.shape[4];a.hu(5===u.length,(()=>`Error in conv3dDerInput: inShape must be length 5, but got length ${u.length}.`)),a.hu(5===h.rank,(()=>`Error in conv3dDerInput: dy must be rank 5, but got rank ${h.rank}`)),a.hu(5===n.rank,(()=>`Error in conv3dDerInput: filter must be rank 5, but got rank ${n.rank}`)),a.hu(d===n.shape[3],(()=>`Error in conv3dDerInput: depth of input (${d}) must match input depth for filter ${n.shape[3]}.`)),a.hu(f===n.shape[4],(()=>`Error in conv3dDerInput: depth of output (${f}) must match output depth for filter ${n.shape[4]}.`));const p={dy:h,filter:n},m={pad:l,strides:s,inputShape:u},g=r.BV.runKernel(i.ik,p,m);return c?(0,o.X)(g,[g.shape[1],g.shape[2],g.shape[3],g.shape[4]]):g}})},7791:(t,e,n)=>{"use strict";n.d(e,{Rf:()=>i,Xw:()=>a,pl:()=>s,Ix:()=>o,jw:()=>l,aO:()=>u,I0:()=>p,jT:()=>m,sl:()=>g,m:()=>b});var r=n(3591);function i(t,e,n,r,i="NHWC",a){return o(t,[...e,t[3]],n,a,r,null,null,g(i))}function a(t,e,n,r,i,a,s="channelsLast"){const[l,u]=h(e);let c;if("channelsLast"===s)c=[l,u,t[3],t[3]];else{if("channelsFirst"!==s)throw new Error(`Unknown dataFormat ${s}`);c=[l,u,t[1],t[1]]}return o(t,c,n,r,i,a,!1,s)}function s(t,e,n,r,i,a,s="NDHWC"){const[o,u,h]=c(e);let d,f;if("NDHWC"===s)f="channelsLast",d=[o,u,h,t[4],t[4]];else{if("NCDHW"!==s)throw new Error(`Unknown dataFormat ${s}`);f="channelsFirst",d=[o,u,h,t[1],t[1]]}return l(t,d,n,r,i,!1,f,a)}function o(t,e,n,r,i,a,s=!1,o="channelsLast"){let[l,c,p,m]=[-1,-1,-1,-1];if("channelsLast"===o)[l,c,p,m]=t;else{if("channelsFirst"!==o)throw new Error(`Unknown dataFormat ${o}`);[l,m,c,p]=t}const[g,b,,y]=e,[v,w]=h(n),[_,k]=h(r),x=d(g,_),S=d(b,k),{padInfo:E,outHeight:I,outWidth:A}=function(t,e,n,r,i,a,s,o,l){let h,c,d;if("number"==typeof t){h={top:t,bottom:t,left:t,right:t,type:0===t?"VALID":"NUMBER"};const i=function(t,e,n,r,i){null==r&&(r=u(t,e,n));const a=t[1];return[f((t[0]-e+2*r)/n+1,i),f((a-e+2*r)/n+1,i)]}([e,n],a,r,t,o);c=i[0],d=i[1]}else if("same"===t){c=Math.ceil(e/r),d=Math.ceil(n/i);const t=Math.max(0,(c-1)*r+a-e),o=Math.max(0,(d-1)*i+s-n),l=Math.floor(t/2),u=t-l,f=Math.floor(o/2);h={top:l,bottom:u,left:f,right:o-f,type:"SAME"}}else if("valid"===t)h={top:0,bottom:0,left:0,right:0,type:"VALID"},c=Math.ceil((e-a+1)/r),d=Math.ceil((n-s+1)/i);else{if("object"!=typeof t)throw Error(`Unknown padding parameter: ${t}`);{const u="channelsLast"===l?t[1][0]:t[2][0],p="channelsLast"===l?t[1][1]:t[2][1],m="channelsLast"===l?t[2][0]:t[3][0],g="channelsLast"===l?t[2][1]:t[3][1];h={top:u,bottom:p,left:m,right:g,type:0===u&&0===p&&0===m&&0===g?"VALID":"EXPLICIT"},c=f((e-a+u+p)/r+1,o),d=f((n-s+m+g)/i+1,o)}}return{padInfo:h,outHeight:c,outWidth:d}}(i,c,p,v,w,x,S,a,o),M=s?y*m:y;let T;return"channelsFirst"===o?T=[l,M,I,A]:"channelsLast"===o&&(T=[l,I,A,M]),{batchSize:l,dataFormat:o,inHeight:c,inWidth:p,inChannels:m,outHeight:I,outWidth:A,outChannels:M,padInfo:E,strideHeight:v,strideWidth:w,filterHeight:g,filterWidth:b,effectiveFilterHeight:x,effectiveFilterWidth:S,dilationHeight:_,dilationWidth:k,inShape:t,outShape:T,filterShape:e}}function l(t,e,n,r,i,a=!1,s="channelsLast",o){let[l,h,p,m,g]=[-1,-1,-1,-1,-1];if("channelsLast"===s)[l,h,p,m,g]=t;else{if("channelsFirst"!==s)throw new Error(`Unknown dataFormat ${s}`);[l,g,h,p,m]=t}const[b,y,v,,w]=e,[_,k,x]=c(n),[S,E,I]=c(r),A=d(b,S),M=d(y,E),T=d(v,I),{padInfo:N,outDepth:C,outHeight:R,outWidth:O}=function(t,e,n,r,i,a,s,o,l,h,c){let d,p,m,g;if("number"==typeof t){d={top:t,bottom:t,left:t,right:t,front:t,back:t,type:0===t?"VALID":"NUMBER"};const a=function(t,e,n,r,i,a){null==i&&(i=u(t,e,r));const s=t[1],o=t[2];return[f((t[0]-e+2*i)/r+1,a),f((s-e+2*i)/r+1,a),f((o-e+2*i)/r+1,a),1]}([e,n,r,1],o,0,i,t,c);p=a[0],m=a[1],g=a[2]}else if("same"===t){p=Math.ceil(e/i),m=Math.ceil(n/a),g=Math.ceil(r/s);const t=(p-1)*i+o-e,u=(m-1)*a+l-n,c=(g-1)*s+h-r,f=Math.floor(t/2),b=t-f,y=Math.floor(u/2),v=u-y,w=Math.floor(c/2);d={top:y,bottom:v,left:w,right:c-w,front:f,back:b,type:"SAME"}}else{if("valid"!==t)throw Error(`Unknown padding parameter: ${t}`);d={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},p=Math.ceil((e-o+1)/i),m=Math.ceil((n-l+1)/a),g=Math.ceil((r-h+1)/s)}return{padInfo:d,outDepth:p,outHeight:m,outWidth:g}}(i,h,p,m,_,k,x,A,M,T,o),D=a?w*g:w;let z;return"channelsFirst"===s?z=[l,D,C,R,O]:"channelsLast"===s&&(z=[l,C,R,O,D]),{batchSize:l,dataFormat:s,inDepth:h,inHeight:p,inWidth:m,inChannels:g,outDepth:C,outHeight:R,outWidth:O,outChannels:D,padInfo:N,strideDepth:_,strideHeight:k,strideWidth:x,filterDepth:b,filterHeight:y,filterWidth:v,effectiveFilterDepth:A,effectiveFilterHeight:M,effectiveFilterWidth:T,dilationDepth:S,dilationHeight:E,dilationWidth:I,inShape:t,outShape:z,filterShape:e}}function u(t,e,n,r=1){const i=d(e,r);return Math.floor((t[0]*(n-1)-n+i)/2)}function h(t){return"number"==typeof t?[t,t,t]:2===t.length?[t[0],t[1],1]:t}function c(t){return"number"==typeof t?[t,t,t]:t}function d(t,e){return e<=1?t:t+(t-1)*(e-1)}function f(t,e){if(!e)return Math.trunc(t);switch(e){case"round":return Math.round(t);case"ceil":return Math.ceil(t);case"floor":return Math.floor(t);default:throw new Error(`Unknown roundingMode ${e}`)}}function p(t){const[e,n,r]=h(t);return 1===e&&1===n&&1===r}function m(t,e){return p(t)||p(e)}function g(t){if("NHWC"===t)return"channelsLast";if("NCHW"===t)return"channelsFirst";throw new Error(`Unknown dataFormat ${t}`)}function b(t,e,n){if(null!=n){if("string"==typeof e)throw Error(`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${e}.`);if("number"==typeof e)r.hu(r.GN(e),(()=>`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${e}.`));else{if("object"!=typeof e)throw Error(`Error in ${t}: Unknown padding parameter: ${e}`);e.forEach((e=>{e.forEach((e=>{r.hu(r.GN(e),(()=>`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${e}.`))}))}))}}}},4420:(t,e,n)=>{"use strict";n.d(e,{m:()=>s});var r=n(3733),i=n(3960),a=n(3329);const s=(0,n(1581).op)({cos_:function(t){const e={x:(0,a._1)(t,"x","cos","float32")};return r.BV.runKernel(i.mc,e)}})},1246:(t,e,n)=>{"use strict";n.d(e,{f:()=>s});var r=n(3733),i=n(3960),a=n(3329);const s=(0,n(1581).op)({cosh_:function(t){const e={x:(0,a._1)(t,"x","cosh","float32")};return r.BV.runKernel(i.TR,e)}})},8754:(t,e,n)=>{"use strict";n.d(e,{z:()=>s});var r=n(3733),i=n(3960),a=n(3329);const s=(0,n(1581).op)({cumsum_:function(t,e=0,n=!1,s=!1){const o={x:(0,a._1)(t,"x","cumsum")},l={axis:e,exclusive:n,reverse:s};return r.BV.runKernel(i.iH,o,l)}})},5105:(t,e,n)=>{"use strict";n.d(e,{z:()=>o});var r=n(3733),i=n(3960),a=n(1581),s=n(4374);const o=(0,a.op)({depthwiseConv2dNativeBackpropFilter_:function(t,e,n,a,o,l=[1,1],u){let h=t;3===t.rank&&(h=(0,s.X)(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let c=e;3===c.rank&&(c=(0,s.X)(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const d={x:h,dy:c},f={strides:a,pad:o,dimRoundingMode:u,dilations:l,filterShape:n};return r.BV.runKernel(i.sL,d,f)}})},2172:(t,e,n)=>{"use strict";n.d(e,{v:()=>o});var r=n(3733),i=n(3960),a=n(1581),s=n(4374);const o=(0,a.op)({depthwiseConv2dNativeBackpropInput_:function(t,e,n,a,o,l=[1,1],u){let h=e,c=!1;3===e.rank&&(c=!0,h=(0,s.X)(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const d={dy:h,filter:n},f={strides:a,pad:o,dimRoundingMode:u,dilations:l,inputShape:t},p=r.BV.runKernel(i.y7,d,f);return c?(0,s.X)(p,[p.shape[1],p.shape[2],p.shape[3]]):p}})},3374:(t,e,n)=>{"use strict";n.d(e,{h:()=>l});var r=n(3733),i=n(3960),a=n(382),s=n(3329),o=n(6223);const l=(0,n(1581).op)({div_:function(t,e){let n=(0,s._1)(t,"a","div"),l=(0,s._1)(e,"b","div");if([n,l]=(0,a.makeTypesMatch)(n,l),"int32"===n.dtype&&"int32"===l.dtype)return(0,o.q)(n,l);const u={a:n,b:l};return r.BV.runKernel(i.oH,u,{})}})},4897:(t,e,n)=>{"use strict";n.d(e,{D:()=>l});var r=n(3733),i=n(3960),a=n(382),s=n(3329),o=n(5725);const l=(0,n(1581).op)({equal_:function(t,e){let n=(0,s._1)(t,"a","equal","string_or_numeric"),l=(0,s._1)(e,"b","equal","string_or_numeric");[n,l]=(0,a.makeTypesMatch)(n,l),(0,o.assertAndGetBroadcastShape)(n.shape,l.shape);const u={a:n,b:l};return r.BV.runKernel(i.hd,u)}})},4540:(t,e,n)=>{"use strict";n.d(e,{Q:()=>s});var r=n(3733),i=n(3960),a=n(3329);const s=(0,n(1581).op)({exp_:function(t){const e={x:(0,a._1)(t,"x","exp")};return r.BV.runKernel(i.NE,e)}})},5216:(t,e,n)=>{"use strict";n.d(e,{d:()=>o});var r=n(3733),i=n(3960),a=n(3329),s=n(3591);const o=(0,n(1581).op)({expandDims_:function(t,e=0){const n=(0,a._1)(t,"x","expandDims","string_or_numeric");s.hu(e<=n.rank,(()=>"Axis must be <= rank of the tensor"));const o={input:n},l={dim:e};return r.BV.runKernel(i.YF,o,l)}})},7988:(t,e,n)=>{"use strict";n.d(e,{G:()=>s});var r=n(3733),i=n(3960),a=n(3329);const s=(0,n(1581).op)({floor_:function(t){const e={x:(0,a._1)(t,"x","floor","float32")};return r.BV.runKernel(i.OR,e)}})},6223:(t,e,n)=>{"use strict";n.d(e,{q:()=>o});var r=n(3733),i=n(3960),a=n(382),s=n(3329);const o=(0,n(1581).op)({floorDiv_:function(t,e){let n=(0,s._1)(t,"a","floorDiv"),o=(0,s._1)(e,"b","floorDiv");[n,o]=(0,a.makeTypesMatch)(n,o);const l={a:n,b:o};return r.BV.runKernel(i.je,l)}})},9419:(t,e,n)=>{"use strict";n.d(e,{I:()=>s});var r=n(3733),i=n(3960),a=n(3329);const s=(0,n(1581).op)({gather_:function(t,e,n=0,s=0){const o={x:(0,a._1)(t,"x","gather"),indices:(0,a._1)(e,"indices","gather","int32")},l={axis:n,batchDims:s};return r.BV.runKernel(i.qi,o,l)}})},6962:(t,e,n)=>{"use strict";n.d(e,{p:()=>l});var r=n(3733),i=n(3960),a=n(382),s=n(3329),o=n(5725);const l=(0,n(1581).op)({greater_:function(t,e){let n=(0,s._1)(t,"a","greater","string_or_numeric"),l=(0,s._1)(e,"b","greater","string_or_numeric");[n,l]=(0,a.makeTypesMatch)(n,l),(0,o.assertAndGetBroadcastShape)(n.shape,l.shape);const u={a:n,b:l};return r.BV.runKernel(i.iZ,u)}})},3930:(t,e,n)=>{"use strict";n.d(e,{b:()=>l});var r=n(3733),i=n(3960),a=n(382),s=n(3329),o=n(5725);const l=(0,n(1581).op)({greaterEqual_:function(t,e){let n=(0,s._1)(t,"a","greaterEqual","string_or_numeric"),l=(0,s._1)(e,"b","greaterEqual","string_or_numeric");[n,l]=(0,a.makeTypesMatch)(n,l),(0,o.assertAndGetBroadcastShape)(n.shape,l.shape);const u={a:n,b:l};return r.BV.runKernel(i.Ac,u)}})},1314:(t,e,n)=>{"use strict";n.d(e,{d:()=>l});var r=n(3733),i=n(3960),a=n(382),s=n(3329),o=n(5725);const l=(0,n(1581).op)({less_:function(t,e){let n=(0,s._1)(t,"a","less","string_or_numeric"),l=(0,s._1)(e,"b","less","string_or_numeric");[n,l]=(0,a.makeTypesMatch)(n,l),(0,o.assertAndGetBroadcastShape)(n.shape,l.shape);const u={a:n,b:l};return r.BV.runKernel(i.vt,u)}})},2894:(t,e,n)=>{"use strict";n.d(e,{z:()=>l});var r=n(3733),i=n(3960),a=n(382),s=n(3329),o=n(5725);const l=(0,n(1581).op)({lessEqual_:function(t,e){let n=(0,s._1)(t,"a","lessEqual","string_or_numeric"),l=(0,s._1)(e,"b","lessEqual","string_or_numeric");[n,l]=(0,a.makeTypesMatch)(n,l),(0,o.assertAndGetBroadcastShape)(n.shape,l.shape);const u={a:n,b:l};return r.BV.runKernel(i.CA,u)}})},1273:(t,e,n)=>{"use strict";n.d(e,{c:()=>s});var r=n(3733),i=n(3960),a=n(3329);const s=(0,n(1581).op)({log_:function(t){const e={x:(0,a._1)(t,"x","log","float32")};return r.BV.runKernel(i.Zb,e)}})},7183:(t,e,n)=>{"use strict";n.d(e,{H:()=>o});var r=n(3733),i=n(3960),a=n(3329),s=n(5725);const o=(0,n(1581).op)({logicalAnd_:function(t,e){const n=(0,a._1)(t,"a","logicalAnd","bool"),o=(0,a._1)(e,"b","logicalAnd","bool");(0,s.assertAndGetBroadcastShape)(n.shape,o.shape);const l={a:n,b:o};return r.BV.runKernel(i.PY,l)}})},5599:(t,e,n)=>{"use strict";n.d(e,{h:()=>s});var r=n(3733),i=n(3960),a=n(3329);const s=(0,n(1581).op)({logicalNot_:function(t){const e={x:(0,a._1)(t,"x","logicalNot","bool")};return r.BV.runKernel(i.Vf,e)}})},7896:(t,e,n)=>{"use strict";n.d(e,{O:()=>o});var r=n(3733),i=n(3960),a=n(382),s=n(3329);const o=(0,n(1581).op)({matMul_:function(t,e,n=!1,o=!1){let l=(0,s._1)(t,"a","matMul"),u=(0,s._1)(e,"b","matMul");[l,u]=(0,a.makeTypesMatch)(l,u);const h={a:l,b:u},c={transposeA:n,transposeB:o};return r.BV.runKernel(i.XL,h,c)}})},9126:(t,e,n)=>{"use strict";n.d(e,{g:()=>u});var r=n(3733),i=n(3960),a=n(382),s=n(3329),o=n(5725),l=n(6090);const u=(0,n(1581).op)({maximum_:function(t,e){let n=(0,s._1)(t,"a","maximum"),u=(0,s._1)(e,"b","maximum");[n,u]=(0,a.makeTypesMatch)(n,u),"bool"===n.dtype&&(n=(0,l.p)(n,"int32"),u=(0,l.p)(u,"int32")),(0,o.assertAndGetBroadcastShape)(n.shape,u.shape);const h={a:n,b:u};return r.BV.runKernel(i.BM,h)}})},6885:(t,e,n)=>{"use strict";n.d(e,{d:()=>o});var r=n(3733),i=n(3960),a=n(382),s=n(3329);const o=(0,n(1581).op)({mul_:function(t,e){let n=(0,s._1)(t,"a","mul"),o=(0,s._1)(e,"b","mul");[n,o]=(0,a.makeTypesMatch)(n,o);const l={a:n,b:o};return r.BV.runKernel(i.wY,l)}})},1353:(t,e,n)=>{"use strict";n.d(e,{W:()=>s});var r=n(3733),i=n(3960),a=n(3329);const s=(0,n(1581).op)({neg_:function(t){const e={x:(0,a._1)(t,"x","neg")};return r.BV.runKernel(i.ku,e)}})},9798:(t,e,n)=>{"use strict";n.d(e,{i:()=>o});var r=n(3733),i=n(3591),a=n(5655),s=n(4265);function o(t,e="float32"){if("complex64"===e){const e=o(t,"float32"),n=(0,s.l)(t,"float32");return(0,a.P)(e,n)}const n=(0,i.p8)((0,i.NA)(t),e);return r.BV.makeTensor(n,t,e)}},1581:(t,e,n)=>{"use strict";n.d(e,{z:()=>a,op:()=>s});var r=n(3733),i=n(3591);const a="__op";function s(t){const e=Object.keys(t);if(1!==e.length)throw new Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${e.length} keys.`);let n=e[0];const s=t[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n+=a;const o=(...t)=>{r.BV.startScope(n);try{const e=s(...t);return(0,i.tI)(e)&&console.error("Cannot return a Promise inside of tidy."),r.BV.endScope(e),e}catch(t){throw r.BV.endScope(null),t}};return Object.defineProperty(o,"name",{value:n,configurable:!0}),o}},3650:(t,e,n)=>{"use strict";n.d(e,{v:()=>s});var r=n(3733),i=n(3960),a=n(3329);const s=(0,n(1581).op)({pad_:function(t,e,n=0){const s=(0,a._1)(t,"x","pad");if(0===s.rank)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const o={paddings:e,constantValue:n},l={x:s};return r.BV.runKernel(i.ly,l,o)}})},5277:(t,e,n)=>{"use strict";n.d(e,{s:()=>o});var r=n(3733),i=n(3960),a=n(382),s=n(3329);const o=(0,n(1581).op)({pow_:function(t,e){let n=(0,s._1)(t,"base","pow"),o=(0,s._1)(e,"exp","pow");[n,o]=(0,a.makeTypesMatch)(n,o);const l={a:n,b:o};return r.BV.runKernel(i.pe,l)}})},4374:(t,e,n)=>{"use strict";n.d(e,{X:()=>s});var r=n(3733),i=n(3960),a=n(3329);const s=(0,n(1581).op)({reshape_:function(t,e){const n={x:(0,a._1)(t,"x","reshape","string_or_numeric")},s={shape:e};return r.BV.runKernel(i.HZ,n,s)}})},4271:(t,e,n)=>{"use strict";n.d(e,{G:()=>s});var r=n(3733),i=n(3960),a=n(3329);const s=(0,n(1581).op)({reverse_:function(t,e){const n={x:(0,a._1)(t,"x","reverse")},s={dims:e};return r.BV.runKernel(i.mK,n,s)}})},8526:(t,e,n)=>{"use strict";n.d(e,{b:()=>s});var r=n(3733),i=n(3960),a=n(3329);const s=(0,n(1581).op)({rsqrt_:function(t){const e={x:(0,a._1)(t,"x","rsqrt","float32")};return r.BV.runKernel(i.bV,e)}})},9641:(t,e,n)=>{"use strict";n.d(e,{i:()=>a});var r=n(3591),i=n(709);function a(t,e){if(((0,r.fU)(t)&&"string"!==e||Array.isArray(t))&&"complex64"!==e)throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if("string"===e&&(0,r.fU)(t)&&!(t instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return(0,i.H)(t,[],[],e)}},7827:(t,e,n)=>{"use strict";n.d(e,{y:()=>r,$:()=>i});const r=1.7580993408473768,i=1.0507009873554805},8885:(t,e,n)=>{"use strict";n.d(e,{X:()=>s});var r=n(3733),i=n(3960),a=n(3329);const s=(0,n(1581).op)({sigmoid_:function(t){const e={x:(0,a._1)(t,"x","sigmoid","float32")};return r.BV.runKernel(i.a5,e)}})},262:(t,e,n)=>{"use strict";n.d(e,{O:()=>s});var r=n(3733),i=n(3960),a=n(3329);const s=(0,n(1581).op)({sin_:function(t){const e={x:(0,a._1)(t,"x","sin","float32")};return r.BV.runKernel(i.RQ,e)}})},4184:(t,e,n)=>{"use strict";n.d(e,{R:()=>s});var r=n(3733),i=n(3960),a=n(3329);const s=(0,n(1581).op)({sinh_:function(t){const e={x:(0,a._1)(t,"x","sinh")};return r.BV.runKernel(i.w3,e)}})},8128:(t,e,n)=>{"use strict";n.d(e,{t:()=>s});var r=n(3733),i=n(3960),a=n(3329);const s=(0,n(1581).op)({slice_:function(t,e,n){const s=(0,a._1)(t,"x","slice","string_or_numeric");if(0===s.rank)throw new Error("Slicing scalar is not possible");const o={x:s},l={begin:e,size:n};return r.BV.runKernel(i.p2,o,l)}})},6997:(t,e,n)=>{"use strict";n.r(e),n.d(e,{assertParamsValid:()=>i,maskToAxes:()=>a,computeOutShape:()=>s,stridesWithElidedDims:()=>o,getNormalizedAxes:()=>h,startIndicesWithElidedDims:()=>c,stopIndicesWithElidedDims:()=>d,stridesForAxis:()=>f,startForAxis:()=>p,stopForAxis:()=>m,isSliceContinous:()=>g,computeFlatOffset:()=>b,parseSliceParams:()=>y,sliceInfo:()=>v});var r=n(3591);function i(t,e,n){const i=t.shape.length;r.hu(i===e.length,(()=>`Error in slice${i}D: Length of begin ${e} must match the rank of the array (${i}).`)),r.hu(i===n.length,(()=>`Error in slice${i}D: Length of size ${n} must match the rank of the array (${i}).`));for(let a=0;a<i;++a)r.hu(e[a]+n[a]<=t.shape[a],(()=>`Error in slice${i}D: begin[${a}] + size[${a}] (${e[a]+n[a]}) would overflow input.shape[${a}] (${t.shape[a]})`))}function a(t){const e=[];let n=0;for(;t>0;)1&t&&e.push(n),t/=2,n++;return e}function s(t,e,n){const r=[];for(let i=0;i<t.length;i++)r[i]=Math.ceil((e[i]-t[i])/n[i]);return r}function o(t,e,n,r){const i=[...t];for(let t=i.length;t<r.length;t++)i.push(1);for(let t=0;t<n;t++)0===t?i[e]=1:(i.splice(e,0,1),i.pop());return i}function l(t,e,n){return n<=t?n:n-(e-1)}function u(t,e){const n=[];for(let r=0;r<t;r++)n.push(e+r);return n}function h(t,e,n,r,i,a,s,l,u){const h=t.length;let g=new Array(h),b=new Array(h),y=new Array(h);if(e.length&&n>0){const u=e[0],h=n+1;g=c(s,u,h,r,t),b=d(l,u,h,i,t),y=o(a,u,h,t)}else for(let e=0;e<h;e++)g[e]=p(s,r,a,t,e,u),b[e]=m(l,i,a,t,e,u),y[e]=f(a,e,u);return{begin:g,end:b,strides:y}}function c(t,e,n,r,i){const a=[...i],s=u(n,e);for(let i=0;i<a.length;i++)if(s.indexOf(i)>-1)a[i]=0;else{const s=l(e,n,i);let o=r[s];t&1<<s&&(o=0),a[i]=o}return a}function d(t,e,n,i,a){const s=[...a],o=u(n,e);for(let r=0;r<s.length;r++)if(o.indexOf(r)>-1)s[r]=Number.MAX_SAFE_INTEGER;else{const a=l(e,n,r);let o=i[a];t&1<<a&&(o=Number.MAX_SAFE_INTEGER),s[r]=o}for(let t=0;t<s.length;t++){const e=a[t];s[t]<0&&(s[t]+=e),s[t]=r.uZ(0,s[t],a[t])}return s}function f(t,e,n){let r=t[e];return(n&1<<e||null==r)&&(r=1),r}function p(t,e,n,i,a,s){let o=e[a];const l=n[a]||1;(t&1<<a||s&1<<a||null==o)&&(o=l>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);const u=i[a];return o<0&&(o+=u),o=r.uZ(0,o,u-1),o}function m(t,e,n,i,a,s){let o=e[a];const l=n[a]||1;(t&1<<a||s&1<<a||null==o)&&(o=l>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);const u=i[a];return o<0&&(o+=u),o=l>0?r.uZ(0,o,u):r.uZ(-1,o,u-1),o}function g(t,e,n){let r=n.length;for(let t=0;t<n.length;t++)if(n[t]>1){r=t;break}for(let i=r+1;i<n.length;i++)if(e[i]>0||n[i]!==t[i])return!1;return!0}function b(t,e){let n=t.length>0?t[t.length-1]:1;for(let r=0;r<t.length-1;r++)n+=t[r]*e[r];return n}function y(t,e,n){let i;const a=t.shape.length;let s;return i="number"==typeof e?[e,...new Array(a-1).fill(0)]:e.length<a?e.concat(new Array(a-e.length).fill(0)):e.slice(),i.forEach((t=>{r.hu(-1!==t,(()=>"slice() does not support negative begin indexing."))})),s=null==n?new Array(a).fill(-1):"number"==typeof n?[n,...new Array(a-1).fill(-1)]:n.length<a?n.concat(new Array(a-n.length).fill(-1)):n,s=s.map(((e,n)=>e>=0?e:(r.hu(-1===e,(()=>`Negative size values should be exactly -1 but got ${e} for the slice() size at index ${n}.`)),t.shape[n]-i[n]))),[i,s]}function v(t,e,n,r,i,a,s,o,l){let u;if(null==r?(u=new Array(e.length),u.fill(1)):u=r,null!=s&&0!=(s&s-1))throw new Error("Multiple ellipses in slice is not allowed.");let h=!1;const c={dims:u.length,numAddAxisAfterEllipsis:0,begin:e.slice(),end:n.slice(),strides:u.slice(),beginMask:i,endMask:a,ellipsisMask:s,newAxisMask:o,shrinkAxisMask:l};for(let t=0;t<c.dims;t++)h&&0!=(1<<t&o)&&c.numAddAxisAfterEllipsis++,1<<t&s&&(h=!0);h||(c.ellipsisMask|=1<<c.dims,c.dims++);const d={dims:t.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};!function(t,e){e.beginMask=0,e.endMask=0,e.shrinkAxisMask=0;let n=0;e.beginValid=null!=t.begin,e.endValid=null!=t.end,e.begin=new Array(e.dims),e.end=new Array(e.dims),e.strides=new Array(e.dims),e.finalShapeGatherIndices=[],e.finalShapeGatherIndicesSparse=[],e.inputShapeGatherIndicesSparse=new Array(e.dims);for(let r=0;r<t.dims;r++)if(1<<r&t.ellipsisMask){const i=Math.min(e.dims-(t.dims-r)+1+t.numAddAxisAfterEllipsis,e.dims);for(;n<i;n++)e.begin[n]=0,e.end[n]=0,e.strides[n]=1,e.beginMask|=1<<n,e.endMask|=1<<n,e.finalShapeGatherIndices.push(n),e.finalShapeGatherIndicesSparse.push(-1),e.inputShapeGatherIndicesSparse[n]=r}else if(1<<r&t.newAxisMask)e.finalShapeGatherIndices.push(-2),e.finalShapeGatherIndicesSparse.push(-1);else{if(n===e.begin.length)throw Error(`Index out of range using input dim ${n}; input has only ${e.dims} dims, ${e.begin.length}.`);null!=t.begin&&(e.begin[n]=t.begin[r]),null!=t.end&&(e.end[n]=t.end[r]),e.strides[n]=t.strides[r],t.beginMask&1<<r&&(e.beginMask|=1<<n),t.endMask&1<<r&&(e.endMask|=1<<n),t.shrinkAxisMask&1<<r?(e.finalShapeGatherIndices.push(-1),e.finalShapeGatherIndicesSparse.push(-1),e.shrinkAxisMask|=1<<n):(e.finalShapeGatherIndices.push(n),e.finalShapeGatherIndicesSparse.push(r)),e.inputShapeGatherIndicesSparse[n]=r,n++}}(c,d);let f=!0,p=!0,m=!0;const g=[],b=[];for(let e=0;e<t.length;++e){if(0===d.strides[e])throw Error(`strides[${e}] must be non-zero`);const n=!!(d.shrinkAxisMask&1<<e),r=t[e];if(-1===r){g.push(n?1:-1);continue}const i=[d.beginMask&1<<e,d.endMask&1<<e],a=[d.strides[e]>0?0:-1,d.strides[e]>0?r:r-1];if(n&&d.strides[e]<=0)throw Error("only stride 1 allowed on non-range indexing.");m=m&&1===d.strides[e];const s=!!(d.beginMask&1<<e&&d.endMask&1<<e);if(d.beginValid&&d.endValid){if(n){const t=d.begin[e]<0?r+d.begin[e]:d.begin[e];if(d.begin[e]=t,d.end[e]=d.begin[e]+1,t<0||t>=r)throw Error(`slice index ${d.begin[e]} of dimension ${e} out of bounds.`)}else d.begin[e]=w(d.begin[e],0,d.strides[e],r,i,a),d.end[e]=w(d.end[e],1,d.strides[e],r,i,a);const t=1===d.strides[e]&&0===d.begin[e]&&d.end[e]===r;f=f&&t,p=p&&(0===e&&1===d.strides[e]||t)}else f=f&&1===d.strides[e]&&s,p=p&&(0===e&&1===d.strides[e]||s);let o,l=!1;if(d.beginValid&&d.endValid?(o=d.end[e]-d.begin[e],l=!0):n?(o=1,l=!0):s&&r>=0&&(o=d.strides[e]<0?-r:r,l=!0),l){let t;t=0===o||o<0!=d.strides[e]<0?0:Math.trunc(o/d.strides[e])+(o%d.strides[e]!=0?1:0),g.push(t)}else g.push(-1)}for(let t=0;t<d.finalShapeGatherIndices.length;++t){const e=d.finalShapeGatherIndices[t];e>=0?b.push(g[e]):-2===e&&b.push(1)}const y=b.filter(((t,e)=>-2!==d.finalShapeGatherIndices[e]));return{finalShapeSparse:y,finalShape:b,isIdentity:f,sliceDim0:p,isSimpleSlice:m,begin:d.begin,end:d.end,strides:d.strides}}function w(t,e,n,r,i,a){if(i[e])return n>0?a[e]:a[e+1&1];{const e=t<0?r+t:t;return e<a[0]?a[0]:e>a[1]?a[1]:e}}},5841:(t,e,n)=>{"use strict";n.d(e,{f:()=>o});var r=n(3733),i=n(3960),a=n(3329),s=n(3591);const o=(0,n(1581).op)({spaceToBatchND_:function(t,e,n){const o=(0,a._1)(t,"x","spaceToBatchND");s.hu(o.rank>=1+e.length,(()=>`input rank ${o.rank} should be > than [blockShape] ${e.length}`)),s.hu(n.length===e.length,(()=>`paddings.shape[0] ${n.length} must be equal to [blockShape] ${e.length}`)),s.hu(o.shape.reduce(((t,r,i)=>i>0&&i<=e.length?t&&(r+n[i-1][0]+n[i-1][1])%e[i-1]==0:t),!0),(()=>`input spatial dimensions ${o.shape.slice(1)} with paddings ${n.toString()} must be divisible by blockShapes ${e.toString()}`));const l={x:o},u={blockShape:e,paddings:n};return r.BV.runKernel(i.TQ,l,u)}})},5859:(t,e,n)=>{"use strict";n.d(e,{V:()=>s});var r=n(3733),i=n(3960),a=n(3329);const s=(0,n(1581).op)({split_:function(t,e,n=0){const s={x:(0,a._1)(t,"x","split")},o={numOrSizeSplits:e,axis:n};return r.BV.runKernel(i.L8,s,o)}})},5483:(t,e,n)=>{"use strict";n.d(e,{_:()=>s});var r=n(3733),i=n(3960),a=n(3329);const s=(0,n(1581).op)({sqrt_:function(t){const e={x:(0,a._1)(t,"x","sqrt","float32")};return r.BV.runKernel(i.FK,e)}})},5064:(t,e,n)=>{"use strict";n.d(e,{h:()=>a});var r=n(3733),i=n(3329);const a=(0,n(1581).op)({square_:function(t){const e=(0,i._1)(t,"x","square");return r.BV.runKernel("Square",{x:e},{})}})},8673:(t,e,n)=>{"use strict";n.d(e,{k:()=>o});var r=n(3733),i=n(3960),a=n(3329),s=n(3591);const o=(0,n(1581).op)({stack_:function(t,e=0){const n=(0,a.sI)(t,"tensors","stack","string_or_numeric");s.hu(n.length>=1,(()=>"Pass at least one tensor to tf.stack")),n.length>0&&s.hu(e<=n[0].rank,(()=>"Axis must be <= rank of the tensor"));const o=n,l={axis:e};return r.BV.runKernel(i.Qi,o,l)}})},4272:(t,e,n)=>{"use strict";n.d(e,{N:()=>s});var r=n(3733),i=n(3960),a=n(3329);const s=(0,n(1581).op)({step_:function(t,e=0){const n={x:(0,a._1)(t,"x","step")},s={alpha:e};return r.BV.runKernel(i.h8,n,s)}})},5630:(t,e,n)=>{"use strict";n.d(e,{l:()=>o});var r=n(3733),i=n(3960),a=n(382),s=n(3329);const o=(0,n(1581).op)({sub_:function(t,e){let n=(0,s._1)(t,"a","sub"),o=(0,s._1)(e,"b","sub");[n,o]=(0,a.makeTypesMatch)(n,o);const l={a:n,b:o};return r.BV.runKernel(i.Tr,l)}})},1614:(t,e,n)=>{"use strict";n.d(e,{S:()=>o});var r=n(3733),i=n(3960),a=n(3329),s=n(6090);const o=(0,n(1581).op)({sum_:function(t,e=null,n=!1){let o=(0,a._1)(t,"x","sum");"bool"===o.dtype&&(o=(0,s.p)(o,"int32"));const l={x:o},u={axis:e,keepDims:n};return r.BV.runKernel(i.GB,l,u)}})},709:(t,e,n)=>{"use strict";n.d(e,{H:()=>s});var r=n(3733),i=n(3591),a=n(1987);function s(t,e,n,s){if(null==s&&(s=(0,i.D2)(t)),"complex64"===s)throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!(0,i.fU)(t)&&!Array.isArray(t)&&"number"!=typeof t&&"boolean"!=typeof t&&"string"!=typeof t)throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(null!=e){(0,i.Mu)(e);const t=(0,i.NA)(e),r=(0,i.NA)(n);(0,i.hu)(t===r,(()=>`Based on the provided shape, [${e}], the tensor should have ${t} values but has ${r}`));for(let t=0;t<n.length;++t){const r=n[t],a=t!==n.length-1||r!==(0,i.NA)(e.slice(t));(0,i.hu)(n[t]===e[t]||!a,(()=>`Error creating a new Tensor. Inferred shape (${n}) does not match the provided shape (${e}). `))}}return(0,i.fU)(t)||Array.isArray(t)||(t=[t]),e=e||n,t="string"!==s?(0,a.toTypedArray)(t,s):(0,i.xH)(t,[],!0),r.BV.makeTensor(t,e,s)}},9773:(t,e,n)=>{"use strict";n.d(e,{G:()=>o});var r=n(3733),i=n(3960),a=n(3329),s=n(3591);const o=(0,n(1581).op)({tile_:function(t,e){const n=(0,a._1)(t,"x","tile","string_or_numeric");s.hu(n.rank===e.length,(()=>`Error in transpose: rank of input ${n.rank} must match length of reps ${e}.`));const o={x:n},l={reps:e};return r.BV.runKernel(i.n9,o,l)}})},8599:(t,e,n)=>{"use strict";n.d(e,{p:()=>o});var r=n(3733),i=n(3960),a=n(3329),s=n(3591);const o=(0,n(1581).op)({transpose_:function(t,e){const n=(0,a._1)(t,"x","transpose");if(null==e&&(e=n.shape.map(((t,e)=>e)).reverse()),s.hu(n.rank===e.length,(()=>`Error in transpose: rank of input ${n.rank} must match length of perm ${e}.`)),e.forEach((t=>{s.hu(t>=0&&t<n.rank,(()=>"All entries in 'perm' must be between 0 and "+(n.rank-1)+` but got ${e}`))})),n.rank<=1)return n.clone();const o={x:n},l={perm:e};return r.BV.runKernel(i.G3,o,l)}})},5370:(t,e,n)=>{"use strict";n.d(e,{p:()=>o});var r=n(3733),i=n(3960),a=n(3329),s=n(3591);const o=(0,n(1581).op)({unsortedSegmentSum_:function(t,e,n){const o=(0,a._1)(t,"x","unsortedSegmentSum"),l=(0,a._1)(e,"segmentIds","unsortedSegmentSum","int32");(0,s.hu)((0,s.GN)(n),(()=>"numSegments must be of dtype int"));const u={x:o,segmentIds:l},h={numSegments:n};return r.BV.runKernel(i.Qv,u,h)}})},8347:(t,e,n)=>{"use strict";n.d(e,{H:()=>o});var r=n(3733),i=n(3960),a=n(3329),s=n(3591);const o=(0,n(1581).op)({unstack_:function(t,e=0){const n=(0,a._1)(t,"x","unstack","string_or_numeric");s.hu(e>=-n.shape.length&&e<n.shape.length,(()=>`Axis = ${e} is not in [-${n.shape.length}, ${n.shape.length})`));const o={value:n},l={axis:e};return r.BV.runKernel(i.To,o,l)}})},2648:(t,e,n)=>{"use strict";n.d(e,{a:()=>l});var r=n(3733),i=n(3960),a=n(3329),s=n(3934),o=n(5725);const l=(0,n(1581).op)({where_:function(t,e,n){const l=(0,a._1)(e,"a","where"),u=(0,a._1)(n,"b","where"),h=(0,a._1)(t,"condition","where","bool"),c=(0,o.assertAndGetBroadcastShape)((0,o.assertAndGetBroadcastShape)(h.shape,l.shape),u.shape),d={condition:(0,s.U)(h,c),t:(0,s.U)(l,c),e:(0,s.U)(u,c)};return r.BV.runKernel(i.Ph,d)}})},4265:(t,e,n)=>{"use strict";n.d(e,{l:()=>s});var r=n(3733),i=n(3591),a=n(5655);function s(t,e="float32"){if("complex64"===e){const e=s(t,"float32"),n=s(t,"float32");return(0,a.P)(e,n)}const n=(0,i.wT)((0,i.NA)(t),e);return r.BV.makeTensor(n,t,e)}},4816:(t,e,n)=>{"use strict";n.d(e,{P:()=>s});var r=n(3733),i=n(3960),a=n(3329);const s=(0,n(1581).op)({zerosLike_:function(t){const e={x:(0,a._1)(t,"x","zerosLike")};return r.BV.runKernel(i.Ru,e)}})},4197:(t,e,n)=>{"use strict";n.d(e,{es:()=>y,YD:()=>c,_w:()=>v,FZ:()=>b,Vp:()=>g,Vi:()=>m});var r=n(1208),i=n(3591);function a(t,e,n,r){const a=(0,i.e3)(e),o=function(t,e,n,r){const a=(0,i.NA)(e),o=r[r.length-1],l=new Array(o).fill(0),h=e.length,c="complex64"===n?u(t):t;if(h>1)for(let t=0;t<a/o;t++){const e=t*o;for(let t=0;t<o;t++)l[t]=Math.max(l[t],s(c[e+t],0,n).length)}return l}(t,e,n,a),h=e.length,c=l(t,e,n,a,o),d=["Tensor"];return r&&(d.push(`  dtype: ${n}`),d.push(`  rank: ${h}`),d.push(`  shape: [${e}]`),d.push("  values:")),d.push(c.map((t=>"    "+t)).join("\n")),d.join("\n")}function s(t,e,n){let r;return r=Array.isArray(t)?`${parseFloat(t[0].toFixed(7))} + ${parseFloat(t[1].toFixed(7))}j`:(0,i.HD)(t)?`'${t}'`:"bool"===n?o(t):parseFloat(t.toFixed(7)).toString(),(0,i.oj)(r,e)}function o(t){return 0===t?"false":"true"}function l(t,e,n,r,i,a=!0){const h="complex64"===n?2:1,c=e[0],d=e.length;if(0===d)return"complex64"===n?[s(u(t)[0],0,n)]:"bool"===n?[o(t[0])]:[t[0].toString()];if(1===d){if(c>20){const e=3*h;let r=Array.from(t.slice(0,e)),a=Array.from(t.slice((c-3)*h,c*h));return"complex64"===n&&(r=u(r),a=u(a)),["["+r.map(((t,e)=>s(t,i[e],n))).join(", ")+", ..., "+a.map(((t,e)=>s(t,i[c-3+e],n))).join(", ")+"]"]}return["["+("complex64"===n?u(t):Array.from(t)).map(((t,e)=>s(t,i[e],n))).join(", ")+"]"]}const f=e.slice(1),p=r.slice(1),m=r[0]*h,g=[];if(c>20){for(let e=0;e<3;e++){const r=e*m,a=r+m;g.push(...l(t.slice(r,a),f,n,p,i,!1))}g.push("...");for(let e=c-3;e<c;e++){const r=e*m,a=r+m;g.push(...l(t.slice(r,a),f,n,p,i,e===c-1))}}else for(let e=0;e<c;e++){const r=e*m,a=r+m;g.push(...l(t.slice(r,a),f,n,p,i,e===c-1))}const b=2===d?",":"";g[0]="["+g[0]+b;for(let t=1;t<g.length-1;t++)g[t]=" "+g[t]+b;let y=",\n";for(let t=2;t<d;t++)y+="\n";return g[g.length-1]=" "+g[g.length-1]+"]"+(a?"":y),g}function u(t){const e=[];for(let n=0;n<t.length;n+=2)e.push([t[n],t[n+1]]);return e}var h=n(1987);class c{constructor(t,e,n){if(this.dtype=e,this.shape=t.slice(),this.size=i.NA(t),null!=n){const t=n.length;i.hu(t===this.size,(()=>`Length of values '${t}' does not match the size inferred by the shape '${this.size}'.`))}if("complex64"===e)throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=n||i.rQ(e,this.size),this.strides=(0,i.e3)(t)}set(t,...e){0===e.length&&(e=[0]),i.hu(e.length===this.rank,(()=>`The number of provided coordinates (${e.length}) must match the rank (${this.rank})`));const n=this.locToIndex(e);this.values[n]=t}get(...t){0===t.length&&(t=[0]);let e=0;for(const n of t){if(n<0||n>=this.shape[e]){const e=`Requested out of range element at ${t}.   Buffer shape=${this.shape}`;throw new Error(e)}e++}let n=t[t.length-1];for(let e=0;e<t.length-1;++e)n+=this.strides[e]*t[e];return this.values[n]}locToIndex(t){if(0===this.rank)return 0;if(1===this.rank)return t[0];let e=t[t.length-1];for(let n=0;n<t.length-1;++n)e+=this.strides[n]*t[n];return e}indexToLoc(t){if(0===this.rank)return[];if(1===this.rank)return[t];const e=new Array(this.shape.length);for(let n=0;n<e.length-1;++n)e[n]=Math.floor(t/this.strides[n]),t-=e[n]*this.strides[n];return e[e.length-1]=t,e}get rank(){return this.shape.length}toTensor(){return d().makeTensor(this.values,this.shape,this.dtype)}}let d=null,f=null,p=null;function m(t){d=t}function g(t){f=t}function b(t){p=t}class y{constructor(t,e,n,r){this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=e||"float32",this.size=i.NA(t),this.strides=(0,i.e3)(t),this.dataId=n,this.id=r,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const t=await this.data();return f.buffer(this.shape,this.dtype,t)}bufferSync(){return f.buffer(this.shape,this.dtype,this.dataSync())}async array(){const t=await this.data();return(0,i.GX)(this.shape,t,"complex64"===this.dtype)}arraySync(){return(0,i.GX)(this.shape,this.dataSync(),"complex64"===this.dtype)}async data(){this.throwIfDisposed();const t=d().read(this.dataId);if("string"===this.dtype){const e=await t;try{return e.map((t=>h.decodeString(t)))}catch(t){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return t}dataSync(){this.throwIfDisposed();const t=d().readSync(this.dataId);if("string"===this.dtype)try{return t.map((t=>h.decodeString(t)))}catch(t){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return t}async bytes(){this.throwIfDisposed();const t=await d().read(this.dataId);return"string"===this.dtype?t:new Uint8Array(t.buffer)}dispose(){this.isDisposed||(d().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(t=!1){return f.print(this,t)}clone(){return this.throwIfDisposed(),f.clone(this)}toString(t=!1){return a(this.dataSync(),this.shape,this.dtype,t)}cast(t){return this.throwIfDisposed(),f.cast(this,t)}variable(t=!0,e,n){return this.throwIfDisposed(),d().makeVariable(this,t,e,n)}}Object.defineProperty(y,Symbol.hasInstance,{value:t=>!!t&&null!=t.data&&null!=t.dataSync&&null!=t.throwIfDisposed}),(0,r.R)("Tensor",(()=>y));class v extends y{constructor(t,e,n,r){super(t.shape,t.dtype,t.dataId,r),this.trainable=e,this.name=n}assign(t){if(t.dtype!==this.dtype)throw new Error(`dtype of the new value (${t.dtype}) and previous value (${this.dtype}) must match`);if(!i.cO(t.shape,this.shape))throw new Error(`shape of the new value (${t.shape}) and previous value (${this.shape}) must match`);d().disposeTensor(this),this.dataId=t.dataId,d().incRef(this,null)}dispose(){d().disposeVariable(this),this.isDisposedInternal=!0}}Object.defineProperty(v,Symbol.hasInstance,{value:t=>t instanceof y&&null!=t.assign&&t.assign instanceof Function})},382:(t,e,n)=>{"use strict";n.r(e),n.d(e,{makeTypesMatch:()=>s,assertTypesMatch:()=>o,isTensorInList:()=>l,getTensorsInContainer:()=>u});var r=n(4197),i=n(5904),a=n(3591);function s(t,e){if(t.dtype===e.dtype)return[t,e];const n=(0,i.x8)(t.dtype,e.dtype);return[t.cast(n),e.cast(n)]}function o(t,e){(0,a.hu)(t.dtype===e.dtype,(()=>`The dtypes of the first(${t.dtype}) and second(${e.dtype}) input must match`))}function l(t,e){return e.some((e=>e.id===t.id))}function u(t){const e=[];return h(t,e,new Set),e}function h(t,e,n){if(null==t)return;if(t instanceof r.es)return void e.push(t);if(i=t,!Array.isArray(i)&&"object"!=typeof i)return;var i;const a=t;for(const t in a){const r=a[t];n.has(r)||(n.add(r),h(r,e,n))}}},3329:(t,e,n)=>{"use strict";n.d(e,{C:()=>l,_1:()=>c,sI:()=>d});var r=n(3733),i=n(7331),a=n(4197),s=n(3591),o=n(1987);function l(t,e){let n=t;if((0,s.fU)(t))return"string"===e?[]:[t.length];if(!Array.isArray(t))return[];const r=[];for(;Array.isArray(n)||(0,s.fU)(n)&&"string"!==e;)r.push(n.length),n=n[0];return Array.isArray(t)&&(0,i.OB)().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&u(t,r,[]),r}function u(t,e,n){if(n=n||[],!Array.isArray(t)&&!(0,s.fU)(t))return void(0,s.hu)(0===e.length,(()=>`Element arr[${n.join("][")}] is a primitive, but should be an array/TypedArray of ${e[0]} elements`));(0,s.hu)(e.length>0,(()=>`Element arr[${n.join("][")}] should be a primitive, but is an array of ${t.length} elements`)),(0,s.hu)(t.length===e[0],(()=>`Element arr[${n.join("][")}] should have ${e[0]} elements, but has ${t.length} elements`));const r=e.slice(1);for(let e=0;e<t.length;++e)u(t[e],r,n.concat(e))}function h(t,e,n,r){if("string_or_numeric"!==t){if(null==t)throw new Error("Expected dtype cannot be null.");if("numeric"!==t&&t!==e||"numeric"===t&&"string"===e)throw new Error(`Argument '${n}' passed to '${r}' must be ${t} tensor, but got ${e} tensor`)}}function c(t,e,n,i="numeric"){if(t instanceof a.es)return h(i,t.dtype,e,n),t;let u=(0,s.D2)(t);if("string"!==u&&["bool","int32","float32"].indexOf(i)>=0&&(u=i),h(i,u,e,n),null==t||!(0,s.fU)(t)&&!Array.isArray(t)&&"number"!=typeof t&&"boolean"!=typeof t&&"string"!=typeof t){const r=null==t?"null":t.constructor.name;throw new Error(`Argument '${e}' passed to '${n}' must be a Tensor or TensorLike, but got '${r}'`)}const c=l(t,u);(0,s.fU)(t)||Array.isArray(t)||(t=[t]);const d="string"!==u?(0,o.toTypedArray)(t,u):(0,s.xH)(t,[],!0);return r.BV.makeTensor(d,c,u)}function d(t,e,n,r="numeric"){if(!Array.isArray(t))throw new Error(`Argument ${e} passed to ${n} must be a \`Tensor[]\` or \`TensorLike[]\``);return t.map(((t,i)=>c(t,`${e}[${i}]`,n,r)))}},5904:(t,e,n)=>{"use strict";var r,i,a,s,o;n.d(e,{yw:()=>r,x8:()=>u,z4:()=>h}),function(t){t.R0="R0",t.R1="R1",t.R2="R2",t.R3="R3",t.R4="R4",t.R5="R5",t.R6="R6"}(r||(r={})),function(t){t.float32="float32",t.int32="int32",t.bool="int32",t.complex64="complex64"}(i||(i={})),function(t){t.float32="float32",t.int32="int32",t.bool="bool",t.complex64="complex64"}(a||(a={})),function(t){t.float32="float32",t.int32="float32",t.bool="float32",t.complex64="complex64"}(s||(s={})),function(t){t.float32="complex64",t.int32="complex64",t.bool="complex64",t.complex64="complex64"}(o||(o={}));const l={float32:s,int32:i,bool:a,complex64:o};function u(t,e){if("string"===t||"string"===e){if("string"===t&&"string"===e)return"string";throw new Error(`Can not upcast ${t} with ${e}`)}return l[t][e]}function h(t){return u(t,"int32")}},1987:(t,e,n)=>{"use strict";n.r(e),n.d(e,{arraysEqual:()=>i.cO,assert:()=>i.hu,assertNonNegativeIntegerDimensions:()=>i.Mu,assertNonNull:()=>i.Cq,assertShapesMatch:()=>i.k5,bytesFromStringArray:()=>i.Ub,bytesPerElement:()=>i.bT,checkConversionForErrors:()=>i.D5,clamp:()=>i.uZ,computeStrides:()=>i.e3,createScalarValue:()=>v,createShuffledIndices:()=>i.U$,decodeString:()=>S,distSquared:()=>i.E7,encodeString:()=>x,fetch:()=>k,fingerPrint64:()=>y,flatten:()=>i.xH,getArrayFromDType:()=>i.rQ,getTypedArrayFromDType:()=>i.WP,hasEncodingLoss:()=>i.QB,hexToLong:()=>o,indexToLoc:()=>i.NE,inferDtype:()=>i.D2,inferFromImplicitShape:()=>i.JZ,isBoolean:()=>i.jn,isFunction:()=>i.mf,isInt:()=>i.GN,isNumber:()=>i.hj,isPromise:()=>i.tI,isScalarShape:()=>i.N9,isString:()=>i.HD,isTypedArray:()=>i.fU,isValidDtype:()=>i.LP,locToIndex:()=>i.qy,makeOnesTypedArray:()=>i.p8,makeZerosNestedTypedArray:()=>i.l6,makeZerosTypedArray:()=>i.wT,nearestDivisor:()=>i.jP,nearestLargerEven:()=>i.nY,now:()=>_,parseAxisParam:()=>i.EC,randUniform:()=>i.bj,repeatedTry:()=>i.WD,rightPad:()=>i.oj,shuffle:()=>i.TV,shuffleCombo:()=>i.d7,sizeFromShape:()=>i.NA,sizeToSquarishShape:()=>i.YP,squeezeShape:()=>i.bp,sum:()=>i.Sm,swap:()=>i.LF,tanh:()=>i.AE,toNestedArray:()=>i.GX,toTypedArray:()=>w});var r=n(7331),i=n(3591),a=n(4255);const s=n.n(a)()||a;function o(t){return s.fromString(t,!0,16)}const l=o("c3a5c85c97cb3127"),u=o("b492b66fbe98f273"),h=o("9ae16a3b2f90404f");function c(t){return t.xor(t.shru(47))}function d(t,e,n){const r=t.slice(e,e+n);return s.fromBytes(Array.from(r),!0,!0)}function f(t,e){return d(t,e,8)}function p(t,e){return d(t,e,4)}function m(t,e){return 0===e?t:t.shru(e).or(t.shl(64-e))}function g(t,e,n=o("9ddfea08eb382d69")){let r=t.xor(e).mul(n);r=r.xor(r.shru(47));let i=e.xor(r).mul(n);return i=i.xor(i.shru(47)),i=i.mul(n),i}function b(t,e,n,r){return function(t,e,n,r,i,a){i=i.add(t),a=m(a.add(i).add(r),21);const s=i;return i=(i=i.add(e)).add(n),a=a.add(m(i,44)),[i.add(r),a.add(s)]}(f(t,e),f(t,e+8),f(t,e+16),f(t,e+24),n,r)}function y(t,e=t.length){const n=s.fromNumber(81,!0);if(e<=32)return e<=16?function(t,e=t.length){if(e>=8){const n=h.add(2*e),r=f(t,0).add(h),i=f(t,e-8);return g(m(i,37).mul(n).add(r),m(r,25).add(i).mul(n),n)}if(e>=4){const n=h.add(2*e);return g(p(t,0).shl(3).add(e),p(t,e-4),n)}if(e>0){const n=t[0]+(t[e>>1]<<8),r=e+(t[e-1]<<2);return c(h.mul(n).xor(l.mul(r))).mul(h)}return h}(t,e):function(t,e=t.length){const n=h.add(2*e),r=f(t,0).mul(u),i=f(t,8),a=f(t,e-8).mul(n),s=f(t,e-16).mul(h);return g(m(r.add(i),43).add(m(a,30)).add(s),r.add(m(i.add(h),18)).add(a),n)}(t,e);if(e<=64)return function(t,e=t.length){const n=h.add(2*e),r=f(t,0).mul(h),i=f(t,8),a=f(t,e-8).mul(n),s=f(t,e-16).mul(h),o=m(r.add(i),43).add(m(a,30)).add(s),l=g(o,r.add(m(i.add(h),18)).add(a),n),u=f(t,16).mul(n),c=f(t,24),d=o.add(f(t,e-32)).mul(n),p=l.add(f(t,e-24)).mul(n);return g(m(u.add(c),43).add(m(d,30)).add(p),u.add(m(c.add(r),18)).add(d),n)}(t,e);let r=n,i=n.mul(u).add(113),a=c(i.mul(h).add(113)).mul(h),o=[s.UZERO,s.UZERO],d=[s.UZERO,s.UZERO];r=r.mul(h).add(f(t,0));let y=0;const v=64*(e-1>>6),w=v+(e-1&63)-63;do{r=m(r.add(i).add(o[0]).add(f(t,y+8)),37).mul(u),i=m(i.add(o[1]).add(f(t,y+48)),42).mul(u),r=r.xor(d[1]),i=i.add(o[0]).add(f(t,y+40)),a=m(a.add(d[0]),33).mul(u),o=b(t,y,o[1].mul(u),r.add(d[0])),d=b(t,y+32,a.add(d[1]),i.add(f(t,y+16))),[a,r]=[r,a],y+=64}while(y!==v);const _=u.add(a.and(255).shl(1));return y=w,d[0]=d[0].add(e-1&63),o[0]=o[0].add(d[0]),d[0]=d[0].add(o[0]),r=m(r.add(i).add(o[0]).add(f(t,y+8)),37).mul(_),i=m(i.add(o[1]).add(f(t,y+48)),42).mul(_),r=r.xor(d[1].mul(9)),i=i.add(o[0].mul(9).add(f(t,y+40))),a=m(a.add(d[0]),33).mul(_),o=b(t,y,o[1].mul(_),r.add(d[0])),d=b(t,y+32,a.add(d[1]),i.add(f(t,y+16))),[a,r]=[r,a],g(g(o[0],d[0],_).add(c(i).mul(l)).add(a),g(o[1],d[1],_).add(r),_)}function v(t,e){return"string"===e?x(t):w([t],e)}function w(t,e){if("string"===e)throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(t)&&(t=i.xH(t)),(0,r.OB)().getBool("DEBUG")&&i.D5(t,e),function(t,e){return t instanceof Float32Array&&"float32"===e||t instanceof Int32Array&&"int32"===e||t instanceof Uint8Array&&"bool"===e}(t,e))return t;if(null==e||"float32"===e||"complex64"===e)return new Float32Array(t);if("int32"===e)return new Int32Array(t);if("bool"===e){const e=new Uint8Array(t.length);for(let n=0;n<e.length;++n)0!==Math.round(t[n])&&(e[n]=1);return e}throw new Error(`Unknown data type ${e}`)}function _(){return(0,r.OB)().platform.now()}function k(t,e){return(0,r.OB)().platform.fetch(t,e)}function x(t,e="utf-8"){return e=e||"utf-8",(0,r.OB)().platform.encode(t,e)}function S(t,e="utf-8"){return e=e||"utf-8",(0,r.OB)().platform.decode(t,e)}},3591:(t,e,n)=>{"use strict";function r(t){let e=t.length,n=0;for(;e>0;)n=Math.random()*e|0,e--,o(t,e,n)}function i(t,e){if(t.length!==e.length)throw new Error(`Array sizes must match to be shuffled together First array length was ${t.length}Second array length was ${e.length}`);let n=t.length,r=0;for(;n>0;)r=Math.random()*n|0,n--,o(t,n,r),o(e,n,r)}function a(t,e,n){return Math.max(t,Math.min(e,n))}function s(t){return t%2==0?t:t+1}function o(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function l(t){let e=0;for(let n=0;n<t.length;n++)e+=t[n];return e}function u(t,e){const n=Math.random();return e*n+(1-n)*t}function h(t,e){let n=0;for(let r=0;r<t.length;r++){const i=Number(t[r])-Number(e[r]);n+=i*i}return n}function c(t,e){if(!t)throw new Error("string"==typeof e?e:e())}function d(t,e,n=""){c(b(t,e),(()=>n+` Shapes ${t} and ${e} must match`))}function f(t){c(null!=t,(()=>"The input to the tensor constructor must be a non-null value."))}function p(t,e=[],n=!1){if(null==e&&(e=[]),Array.isArray(t)||R(t)&&!n)for(let r=0;r<t.length;++r)p(t[r],e,n);else e.push(t);return e}function m(t){if(0===t.length)return 1;let e=t[0];for(let n=1;n<t.length;n++)e*=t[n];return e}function g(t){return 0===t.length}function b(t,e){if(t===e)return!0;if(null==t||null==e)return!1;if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function y(t){return t%1==0}function v(t){if(null!=Math.tanh)return Math.tanh(t);if(t===1/0)return 1;if(t===-1/0)return-1;{const e=Math.exp(2*t);return(e-1)/(e+1)}}function w(t){const e=Math.ceil(Math.sqrt(t));return[e,Math.ceil(t/e)]}function _(t){const e=new Uint32Array(t);for(let n=0;n<t;++n)e[n]=n;return r(e),e}function k(t,e){return e<=t.length?t:t+" ".repeat(e-t.length)}function x(t,e=(t=>0),n){return new Promise(((r,i)=>{let a=0;const s=()=>{if(t())return void r();a++;const o=e(a);null!=n&&a>=n?i():setTimeout(s,o)};s()}))}function S(t,e){let n=1,r=-1;for(let e=0;e<t.length;++e)if(t[e]>=0)n*=t[e];else if(-1===t[e]){if(-1!==r)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${r} and dim ${e}`);r=e}else if(t[e]<0)throw Error(`Shapes can not be < 0. Found ${t[e]} at dim ${e}`);if(-1===r){if(e>0&&e!==n)throw Error(`Size(${e}) must match the product of shape ${t}`);return t}if(0===n)throw Error(`Cannot infer the missing size in [${t}] when there are 0 elements`);if(e%n!=0)throw Error(`The implicit shape can't be a fractional number. Got ${e} / ${n}`);const i=t.slice();return i[r]=e/n,i}function E(t,e){const n=e.length;return t=null==t?e.map(((t,e)=>e)):[].concat(t),c(t.every((t=>t>=-n&&t<n)),(()=>`All values in axis param must be in range [-${n}, ${n}) but got axis ${t}`)),c(t.every((t=>y(t))),(()=>`All values in axis param must be integers but got axis ${t}`)),t.map((t=>t<0?n+t:t))}function I(t,e){const n=[],r=[],i=null!=e&&Array.isArray(e)&&0===e.length,a=null==e||i?null:E(e,t).sort();let s=0;for(let e=0;e<t.length;++e){if(null!=a){if(a[s]===e&&1!==t[e])throw new Error(`Can't squeeze axis ${e} since its dim '${t[e]}' is not 1`);(null==a[s]||a[s]>e)&&1===t[e]&&(n.push(t[e]),r.push(e)),a[s]<=e&&s++}1!==t[e]&&(n.push(t[e]),r.push(e))}return{newShape:n,keptDims:r}}function A(t,e){let n=null;if(null==t||"float32"===t)n=new Float32Array(e);else if("int32"===t)n=new Int32Array(e);else{if("bool"!==t)throw new Error(`Unknown data type ${t}`);n=new Uint8Array(e)}return n}function M(t,e){let n=null;if(null==t||"float32"===t)n=new Float32Array(e);else if("int32"===t)n=new Int32Array(e);else if("bool"===t)n=new Uint8Array(e);else{if("string"!==t)throw new Error(`Unknown data type ${t}`);n=new Array(e)}return n}function T(t,e){for(let n=0;n<t.length;n++){const r=t[n];if(isNaN(r)||!isFinite(r))throw Error(`A tensor of type ${e} being uploaded contains ${r}.`)}}function N(t){return"bool"===t||"complex64"===t||"float32"===t||"int32"===t||"string"===t}function C(t,e){return!("complex64"===e||"float32"===e&&"complex64"!==t||"int32"===e&&"float32"!==t&&"complex64"!==t||"bool"===e&&"bool"===t)}function R(t){return t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray}function O(t){if("float32"===t||"int32"===t)return 4;if("complex64"===t)return 8;if("bool"===t)return 1;throw new Error(`Unknown dtype ${t}`)}function D(t){if(null==t)return 0;let e=0;return t.forEach((t=>e+=t.length)),e}function z(t){return"string"==typeof t||t instanceof String}function B(t){return"boolean"==typeof t}function F(t){return"number"==typeof t}function P(t){return Array.isArray(t)?P(t[0]):t instanceof Float32Array?"float32":t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray?"int32":F(t)?"float32":z(t)?"string":B(t)?"bool":"float32"}function L(t){return!!(t&&t.constructor&&t.call&&t.apply)}function $(t,e){for(let n=e;n<t;++n)if(t%n==0)return n;return t}function U(t){const e=t.length;if(e<2)return[];const n=new Array(e-1);n[e-2]=t[e-1];for(let r=e-3;r>=0;--r)n[r]=n[r+1]*t[r+1];return n}function j(t,e,n,r=!1){const i=new Array;if(1===e.length){const a=e[0]*(r?2:1);for(let e=0;e<a;e++)i[e]=n[t+e]}else{const a=e[0],s=e.slice(1),o=s.reduce(((t,e)=>t*e))*(r?2:1);for(let e=0;e<a;e++)i[e]=j(t+e*o,s,n,r)}return i}function W(t,e,n=!1){if(0===t.length)return e[0];const r=t.reduce(((t,e)=>t*e))*(n?2:1);if(0===r)return[];if(r!==e.length)throw new Error(`[${t}] does not match the input size ${e.length}${n?" for a complex tensor":""}.`);return j(0,t,e,n)}function G(t,e){const n=H(t,e);for(let t=0;t<n.length;t++)n[t]=1;return n}function H(t,e){if(null==e||"float32"===e||"complex64"===e)return new Float32Array(t);if("int32"===e)return new Int32Array(t);if("bool"===e)return new Uint8Array(t);throw new Error(`Unknown data type ${e}`)}function V(t,e){const n=t.reduce(((t,e)=>t*e),1);if(null==e||"float32"===e)return W(t,new Float32Array(n));if("int32"===e)return W(t,new Int32Array(n));if("bool"===e)return W(t,new Uint8Array(n));throw new Error(`Unknown data type ${e}`)}function q(t){t.forEach((e=>{c(Number.isInteger(e)&&e>=0,(()=>`Tensor must have a shape comprised of positive integers but got shape [${t}].`))}))}function K(t,e,n){if(0===e)return 0;if(1===e)return t[0];let r=t[t.length-1];for(let e=0;e<t.length-1;++e)r+=n[e]*t[e];return r}function Z(t,e,n){if(0===e)return[];if(1===e)return[t];const r=new Array(e);for(let e=0;e<r.length-1;++e)r[e]=Math.floor(t/n[e]),t-=r[e]*n[e];return r[r.length-1]=t,r}function X(t){return t&&t.then&&"function"==typeof t.then}n.d(e,{TV:()=>r,d7:()=>i,uZ:()=>a,nY:()=>s,LF:()=>o,Sm:()=>l,bj:()=>u,E7:()=>h,hu:()=>c,k5:()=>d,Cq:()=>f,xH:()=>p,NA:()=>m,N9:()=>g,cO:()=>b,GN:()=>y,AE:()=>v,YP:()=>w,U$:()=>_,oj:()=>k,WD:()=>x,JZ:()=>S,EC:()=>E,bp:()=>I,WP:()=>A,rQ:()=>M,D5:()=>T,LP:()=>N,QB:()=>C,fU:()=>R,bT:()=>O,Ub:()=>D,HD:()=>z,jn:()=>B,hj:()=>F,D2:()=>P,mf:()=>L,jP:()=>$,e3:()=>U,GX:()=>W,p8:()=>G,wT:()=>H,l6:()=>V,Mu:()=>q,qy:()=>K,NE:()=>Z,tI:()=>X})},4402:(t,e,n)=>{"use strict";n.r(e),n.d(e,{Callback:()=>nh,CallbackList:()=>ea,CustomCallback:()=>ia,EarlyStopping:()=>ah,History:()=>ra,InputSpec:()=>ji,LayerVariable:()=>Li,LayersModel:()=>us,RNN:()=>go,Sequential:()=>ds,SymbolicTensor:()=>Wi,callbacks:()=>sh,constraints:()=>r,initializers:()=>i,input:()=>gs,layers:()=>a,loadLayersModel:()=>ms,metrics:()=>s,model:()=>fs,models:()=>o,registerCallbackConstructor:()=>bs,regularizers:()=>l,sequential:()=>ps,version_layers:()=>Pa});var r={};n.r(r),n.d(r,{maxNorm:()=>lr,minMaxNorm:()=>cr,nonNeg:()=>hr,unitNorm:()=>ur});var i={};n.r(i),n.d(i,{constant:()=>bi,glorotNormal:()=>Si,glorotUniform:()=>xi,heNormal:()=>Ei,heUniform:()=>Ii,identity:()=>_i,leCunNormal:()=>Ai,leCunUniform:()=>Mi,ones:()=>gi,orthogonal:()=>Ti,randomNormal:()=>vi,randomUniform:()=>yi,truncatedNormal:()=>wi,varianceScaling:()=>ki,zeros:()=>mi});var a={};n.r(a),n.d(a,{Layer:()=>qi,RNN:()=>go,RNNCell:()=>bo,activation:()=>Fl,add:()=>Vl,alphaDropout:()=>Bu,average:()=>ql,averagePooling1d:()=>nu,averagePooling2d:()=>au,averagePooling3d:()=>lu,avgPool1d:()=>ru,avgPool2d:()=>su,avgPool3d:()=>uu,avgPooling1d:()=>iu,avgPooling2d:()=>ou,avgPooling3d:()=>hu,batchNormalization:()=>Ql,bidirectional:()=>Mu,concatenate:()=>Kl,conv1d:()=>Ml,conv2d:()=>Tl,conv2dTranspose:()=>Nl,conv3d:()=>Cl,conv3dTranspose:()=>Rl,convLstm2d:()=>Su,convLstm2dCell:()=>Eu,cropping2D:()=>Dl,dense:()=>Pl,depthwiseConv2d:()=>Bl,dot:()=>Yl,dropout:()=>Ll,elu:()=>kl,embedding:()=>Hl,flatten:()=>Ul,gaussianDropout:()=>zu,gaussianNoise:()=>Du,globalAveragePooling1d:()=>cu,globalAveragePooling2d:()=>du,globalMaxPool1d:()=>Nu,globalMaxPool2d:()=>Cu,globalMaxPooling1d:()=>fu,globalMaxPooling2d:()=>pu,gru:()=>yu,gruCell:()=>vu,input:()=>gs,inputLayer:()=>_l,layerNormalization:()=>tu,leakyReLU:()=>Sl,lstm:()=>wu,lstmCell:()=>_u,masking:()=>Fu,maxPool1d:()=>Ru,maxPool2d:()=>Ou,maxPooling1d:()=>mu,maxPooling2d:()=>gu,maxPooling3d:()=>bu,maximum:()=>Zl,minimum:()=>Xl,multiply:()=>Jl,permute:()=>Gl,prelu:()=>El,reLU:()=>xl,repeatVector:()=>jl,reshape:()=>Wl,rnn:()=>Iu,separableConv2d:()=>Ol,simpleRNN:()=>ku,simpleRNNCell:()=>xu,softmax:()=>Il,spatialDropout1d:()=>$l,stackedRNNCells:()=>Au,thresholdedReLU:()=>Al,timeDistributed:()=>Tu,upSampling2d:()=>zl,zeroPadding2d:()=>eu});var s={};n.r(s),n.d(s,{MAPE:()=>Ku,MSE:()=>Ju,binaryAccuracy:()=>Pu,binaryCrossentropy:()=>Lu,categoricalAccuracy:()=>Uu,categoricalCrossentropy:()=>ju,cosineProximity:()=>Hu,mape:()=>Zu,meanAbsoluteError:()=>Vu,meanAbsolutePercentageError:()=>qu,meanSquaredError:()=>Xu,mse:()=>Yu,precision:()=>Wu,recall:()=>Gu,sparseCategoricalAccuracy:()=>$u});var o={};n.r(o),n.d(o,{modelFromJSON:()=>cs});var l={};n.r(l),n.d(l,{l1:()=>th,l1l2:()=>Qu,l2:()=>eh});var u=n(1420),h=n(3960),c=n(6090),d=n(6885),f=n(4272);const p={kernelName:h.SY,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>(0,d.d)(t,(0,f.N)((0,c.p)(n,"float32"),-1))}}};var m=n(3374),g=n(1353),b=n(9641),y=n(5483),v=n(5064),w=n(5630);const _={kernelName:h.VG,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const e=(0,v.h)((0,c.p)(n,"float32")),r=(0,y._)((0,w.l)((0,b.i)(1),e));return(0,g.W)((0,m.h)(t,r))}}}},k={kernelName:h.Sp,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const e=(0,y._)((0,w.l)((0,v.h)((0,c.p)(n,"float32")),1));return(0,m.h)(t,e)}}}};var x=n(5725),S=n(4374),E=n(1614);const I={kernelName:h.mm,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,i=x.assertAndGetBroadcastShape(n.shape,r.shape);return{a:()=>{let e=t;const r=x.getReductionAxes(n.shape,i);return r.length>0&&(e=(0,E.S)(e,r)),(0,S.X)(e,n.shape)},b:()=>{let e=t;const n=x.getReductionAxes(r.shape,i);return n.length>0&&(e=(0,E.S)(e,n)),(0,S.X)(e,r.shape)}}}},A={kernelName:h.Xz,saveAllInputs:!0,gradFunc:(t,e)=>{const n={};return e.forEach(((e,r)=>{n[r]=()=>t.clone()})),n}};var M=n(4816);const T={kernelName:h.sJ,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>(0,M.P)(n)}}},N={kernelName:h.aJ,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>(0,M.P)(n)}}},C={kernelName:h.M2,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>(0,m.h)(t,(0,y._)((0,w.l)((0,b.i)(1),(0,v.h)((0,c.p)(n,"float32")))))}}};var R=n(4602);const O={kernelName:h.qw,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const e=(0,y._)((0,R.I)((0,b.i)(1),(0,v.h)((0,c.p)(n,"float32"))));return(0,m.h)(t,e)}}}},D={kernelName:h.QC,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,i=(0,x.assertAndGetBroadcastShape)(n.shape,r.shape);return{a:()=>{const e=(0,R.I)((0,v.h)(n),(0,v.h)(r));let a=(0,d.d)(t,(0,m.h)(r,e));const s=(0,x.getReductionAxes)(n.shape,i);return s.length>0&&(a=(0,E.S)(a,s)),(0,S.X)(a,n.shape)},b:()=>{const e=(0,R.I)((0,v.h)(n),(0,v.h)(r));let a=(0,g.W)((0,d.d)(t,(0,m.h)(n,e)));const s=(0,x.getReductionAxes)(r.shape,i);return s.length>0&&(a=(0,E.S)(a,s)),(0,S.X)(a,r.shape)}}}},z={kernelName:h.jM,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>(0,m.h)(t,(0,R.I)((0,v.h)((0,c.p)(n,"float32")),1))}}},B={kernelName:h.Oy,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>(0,m.h)(t,(0,w.l)((0,b.i)(1),(0,v.h)((0,c.p)(n,"float32"))))}}};var F=n(3733),P=n(3329),L=n(3591),$=n(7791),U=n(1581);const j=(0,U.op)({avgPool3dGrad_:function(t,e,n,r,i,a){const s=(0,P._1)(t,"dy","avgPool3dGrad"),o=(0,P._1)(e,"input","avgPool3dGrad");let l=s,u=o,c=!1;4===o.rank&&(c=!0,l=(0,S.X)(s,[1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]]),u=(0,S.X)(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),L.hu(5===l.rank,(()=>`Error in avgPool3dGrad: dy must be rank 5 but got rank ${l.rank}.`)),L.hu(5===u.rank,(()=>`Error in avgPool3dGrad: input must be rank 5 but got rank ${u.rank}.`)),(0,$.m)("avgPool3dGrad",i,a);const d={dy:l,input:u},f={filterSize:n,strides:r,pad:i,dimRoundingMode:a},p=F.BV.runKernel(h.IM,d,f);return c?(0,S.X)(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}}),W={kernelName:h._k,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{filterSize:i,strides:a,pad:s,dimRoundingMode:o}=n;return{x:()=>j(t,r,i,a,s,o)}}},G=(0,U.op)({avgPoolGrad_:function(t,e,n,r,i){const a=(0,P._1)(t,"dy","avgPoolGrad"),s=(0,P._1)(e,"input","avgPoolGrad");L.hu(s.rank===a.rank,(()=>`Rank of input (${s.rank}) does not match rank of dy (${a.rank})`));let o=s,l=a,u=!1;3===s.rank&&(u=!0,o=(0,S.X)(s,[1,s.shape[0],s.shape[1],s.shape[2]]),l=(0,S.X)(a,[1,a.shape[0],a.shape[1],a.shape[2]])),L.hu(4===l.rank,(()=>`Error in avgPoolGrad: dy must be rank 4 but got rank ${l.rank}.`)),L.hu(4===o.rank,(()=>`Error in avgPoolGrad: input must be rank 4 but got rank ${o.rank}.`));const c={dy:l,input:o},d={filterSize:n,strides:r,pad:i},f=F.BV.runKernel(h.RO,c,d);return u?(0,S.X)(f,[f.shape[1],f.shape[2],f.shape[3]]):f}}),H={kernelName:h.Jh,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{filterSize:i,strides:a,pad:s}=n;return{x:()=>G(t,r,i,a,s)}}};var V=n(7896);const q={kernelName:h.XL,inputsToSave:["a","b"],gradFunc:(t,e,n)=>{const[r,i]=e,{transposeA:a,transposeB:s}=n;return a||s?!a&&s?{a:()=>(0,V.O)(t,i,!1,!1),b:()=>(0,V.O)(t,r,!0,!1)}:a&&!s?{a:()=>(0,V.O)(i,t,!1,!0),b:()=>(0,V.O)(r,t,!1,!1)}:{a:()=>(0,V.O)(i,t,!0,!0),b:()=>(0,V.O)(t,r,!0,!0)}:{a:()=>(0,V.O)(t,i,!1,!0),b:()=>(0,V.O)(r,t,!0,!1)}}};var K=n(5841);const Z={kernelName:h.zw,gradFunc:(t,e,n)=>{const{blockShape:r,crops:i}=n;return{x:()=>(0,K.f)(t,r,i)}}},X={kernelName:h.Ly,gradFunc:(t,e,n)=>{const r=n,i=r.inputShape,a=r.shape,s=Array.from(a);for(let t=i.length-1;t>=0;t--)if(i[t]===a[t])s[t]=1;else if(1!==i[t])throw new Error(`broadcastTo(): [${i}] cannot be broadcast to [${a}].`);const o=[];for(let t=0;t<s.length;t++)s[t]>1&&o.push(t);return{x:()=>(0,E.S)(t,o,!0)}}},J={kernelName:h.RF,gradFunc:t=>({x:()=>t.clone()})},Y={kernelName:h.gJ,gradFunc:t=>({x:()=>(0,M.P)(t)})};var Q=n(3930),tt=n(2894),et=n(7183),nt=n(2648);const rt={kernelName:h.xn,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{clipValueMin:i,clipValueMax:a}=n;return{x:()=>(0,nt.a)((0,et.H)((0,Q.b)(r,i),(0,tt.z)(r,a)),t,(0,M.P)(t))}}},it={kernelName:h.yj,inputsToSave:["x"],gradFunc:p.gradFunc};var at=n(5859);const st={kernelName:h.Eh,saveAllInputs:!0,gradFunc:(t,e,n)=>{const r=e.map((t=>t.shape)),{axis:i}=n,a=(0,L.EC)(i,e[0].shape)[0],s=r.map((t=>t[a]));return(0,at.V)(t,s,a).map((t=>()=>t))}};var ot=n(6762),lt=n(2330);const ut={kernelName:h.mh,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const[r,i]=e,{dilations:a,strides:s,pad:o,dataFormat:l}=n;return L.hu($.I0(a),(()=>`Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${a}'`)),{x:()=>(0,lt._)(r.shape,t,i,s,o,l),filter:()=>(0,ot.p)(r,t,i.shape,s,o,l)}}};var ht=n(1747);const ct={kernelName:h.wm,inputsToSave:["dy","filter"],gradFunc:(t,e,n)=>{const[r,i]=e,{strides:a,pad:s,dataFormat:o,dimRoundingMode:l}=n;return{dy:()=>(0,ht.T)(t,i,a,s,o,1,l),filter:()=>(0,ot.p)(t,r,i.shape,a,s,o,l)}}},dt=(0,U.op)({conv3DBackpropFilter_:function(t,e,n,r,i){let a=t;4===t.rank&&(a=(0,S.X)(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]));let s=e;4===s.rank&&(s=(0,S.X)(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]])),L.hu(5===a.rank,(()=>`Error in conv3dDerFilter: input must be rank 5, but got shape ${a.shape}.`)),L.hu(5===s.rank,(()=>`Error in conv3dDerFilter: dy must be rank 5, but got shape ${s.shape}.`)),L.hu(5===n.length,(()=>`Error in conv3dDerFilter: filterShape must be length 5, but got ${n}.`)),L.hu(a.shape[4]===n[3],(()=>`Error in conv3dDerFilter: depth of input ${a.shape[4]}) must match input depth in filter (${n[3]}.`)),L.hu(s.shape[4]===n[4],(()=>`Error in conv3dDerFilter: depth of dy (${s.shape[4]}) must match output depth for filter (${n[4]}).`));const o={x:a,dy:s},l={strides:r,pad:i,filterShape:n};return F.BV.runKernel(h.o2,o,l)}});var ft=n(7332);const pt={kernelName:h.x1,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const{dilations:r,strides:i,pad:a}=n;L.hu((0,$.I0)(r),(()=>`Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${r}'`));const[s,o]=e;return{x:()=>(0,ft._)(s.shape,t,o,i,a),filter:()=>dt(s,t,o.shape,i,a)}}};var mt=n(262);const gt={kernelName:h.mc,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>(0,d.d)((0,g.W)((0,mt.O)((0,c.p)(n,"float32"))),t)}}};var bt=n(4184);const yt={kernelName:h.TR,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>(0,d.d)((0,bt.R)((0,c.p)(n,"float32")),t)}}};var vt=n(617),wt=n(8754),_t=n(8599);const kt={kernelName:h.iH,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{axis:i,exclusive:a,reverse:s}=n;return{x:()=>{const e=(0,vt.Q3)([i],r.rank);let n=(0,wt.z)(t,i,a,!s);return null!=e&&(n=(0,_t.p)(n,e)),n}}}};var xt=n(5105),St=n(2172);const Et={kernelName:h.ci,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const{dilations:r,strides:i,pad:a,dimRoundingMode:s}=n,o=null==r?[1,1]:r;L.hu($.I0(o),(()=>`Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations '${o}'`));const[l,u]=e;return L.hu(4===l.rank,(()=>`Error in gradient of depthwiseConv2dNative: input must be rank 4, but got rank ${l.rank}.`)),L.hu(4===u.rank,(()=>`Error in gradient of depthwiseConv2dNative: filter must be rank 4, but got rank ${u.rank}.`)),L.hu(l.shape[3]===u.shape[2],(()=>`Error in gradient of depthwiseConv2d: number of input channels (${l.shape[3]}) must match the inChannels dimension in filter ${u.shape[2]}.`)),L.hu($.jT(i,o),(()=>`Error in gradient of depthwiseConv2d: Either strides or dilations must be  1. Got strides ${i} and dilations '${o}'.`)),$.m("depthwiseConv2d",a,s),{x:()=>(0,St.v)(l.shape,t,u,i,a,o,s),filter:()=>(0,xt.z)(l,t,u.shape,i,a,o,s)}}},It={kernelName:h.p4,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const[r,i]=e,a={x:r,filter:i,dy:t},s={x:r,filter:i,dy:t};return{x:()=>F.BV.runKernel(h.ek,a,n),filter:()=>F.BV.runKernel(h.Vn,s,n)}}},At={kernelName:h.SX,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e,r={dy:t,y:n};return{x:()=>F.BV.runKernel(h.HE,r)}}};var Mt=n(4540);const Tt={kernelName:h.Om,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e,r=(0,d.d)((0,Mt.Q)((0,g.W)((0,v.h)(n))),2/Math.sqrt(Math.PI));return{x:()=>(0,d.d)(t,r)}}},Nt={kernelName:h.NE,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>(0,d.d)(t,n)}}},Ct={kernelName:h.YF,inputsToSave:["input"],gradFunc:(t,e)=>{const[n]=e;return{input:()=>(0,S.X)(t,n.shape)}}},Rt={kernelName:h.Y0,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>(0,d.d)(t,(0,Mt.Q)(n))}}},Ot={kernelName:h.OR,gradFunc:t=>({x:()=>(0,M.P)(t)})},Dt={kernelName:h.je,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,i=(0,x.assertAndGetBroadcastShape)(n.shape,r.shape);return{a:()=>{const e=(0,m.h)(t,(0,c.p)(r,"float32")),a=(0,x.getReductionAxes)(n.shape,i);return a.length>0?(0,S.X)((0,E.S)(e,a),n.shape):e},b:()=>{let e=(0,d.d)(t,(0,c.p)(n,"float32"));const a=(0,x.getReductionAxes)(r.shape,i);a.length>0&&(e=(0,S.X)((0,E.S)(e,a),r.shape));const s=(0,v.h)(r);return(0,g.W)((0,m.h)(e,(0,c.p)(s,"float32")))}}}};var zt=n(8526),Bt=n(9773);const Ft={kernelName:h.sH,inputsToSave:["x","mean","variance","scale"],gradFunc:(t,e,n)=>{const{varianceEpsilon:r}=n,[i,a,s,o]=e,l=null==o?(0,b.i)(1):o,u=(0,x.getReductionAxes)(a.shape,i.shape),h=[];if(1===a.rank){for(let t=0;t<i.shape.length-1;++t)h.push(i.shape[t]);h.push(1)}const c=(0,w.l)(i,a),f=(0,d.d)(t,l),p=(0,zt.b)((0,R.I)(s,(0,b.i)(r))),m=(0,d.d)((0,d.d)((0,d.d)(p,p),p),(0,b.i)(-.5));return{x:()=>1===a.rank?(0,S.X)((0,d.d)((0,d.d)(t,(0,Bt.G)((0,S.X)(p,[1,1,1,a.shape[0]]),h)),l),i.shape):(0,S.X)((0,d.d)((0,d.d)(t,p),l),i.shape),mean:()=>{let t=(0,d.d)((0,d.d)(p,(0,b.i)(-1)),f);return 1===a.rank&&(t=(0,E.S)(t,u)),(0,S.X)(t,a.shape)},variance:()=>{let t=(0,d.d)((0,d.d)(m,c),f);return 1===a.rank&&(t=(0,E.S)(t,u)),(0,S.X)(t,a.shape)},scale:()=>{const e=(0,d.d)(c,p);let n=(0,d.d)(t,e);return 1===a.rank&&(n=(0,E.S)(n,u)),(0,S.X)(n,a.shape)},offset:()=>{let e=t;return 1===a.rank&&(e=(0,E.S)(e,u)),(0,S.X)(e,a.shape)}}}};var Pt=n(5370);const Lt={kernelName:h.qi,inputsToSave:["x","indices"],gradFunc:(t,e,n)=>{const[r,i]=e,{axis:a}=n,s=(0,L.EC)(a,r.shape)[0];return{x:()=>{const e=r.shape,n=i.size,o=e.slice(0,s),l=o.length,u=e.slice(a,e.length).slice(1),h=u.length,c=$t(0,l),d=$t(l+1,l+1+h),f=Ut([o,[n],u]),p=(0,S.X)(t,f),m=(0,S.X)(i,[n]),g=Ut([[l],c,d]),b=(0,_t.p)(p,g);let y=(0,Pt.p)(b,m,r.shape[s]);const v=(0,vt.LJ)(g);return y=(0,_t.p)(y,v),y},indices:()=>i}}};function $t(t,e){const n=[];for(let r=t;r<e;++r)n.push(r);return n}function Ut(t){const e=[];for(let n=0;n<t.length;++n)for(let r=0;r<t[n].length;++r)e.push(t[n][r]);return e}const jt={kernelName:h.Ac,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e;return{a:()=>(0,M.P)(n),b:()=>(0,M.P)(r)}}},Wt={kernelName:h.iJ,gradFunc:t=>({x:()=>(0,c.p)(t,"float32")})},Gt={kernelName:h.av,gradFunc:t=>({x:()=>(0,M.P)(t)})},Ht={kernelName:h.iW,gradFunc:t=>({x:()=>(0,M.P)(t)})},Vt={kernelName:h.r7,gradFunc:t=>({x:()=>(0,M.P)(t)})};var qt=n(6962);const Kt={kernelName:h.J$,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{alpha:i}=n,a=(0,qt.p)(r,0);return{x:()=>(0,nt.a)(a,t,(0,d.d)(t,i))}}},Zt={kernelName:h.kU,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>(0,m.h)(t,(0,R.I)(n,1))}}},Xt={kernelName:h.Zb,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>(0,m.h)(t,(0,c.p)(n,"float32"))}}},Jt={kernelName:h.qC,inputsToSave:[],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r]=e,{axis:i}=n;return{logits:()=>{const e=(0,Mt.Q)(r);return(0,w.l)(t,(0,d.d)((0,E.S)(t,i,!0),e))}}}},Yt=(0,U.op)({localResponseNormalizationBackprop_:function(t,e,n,r=5,i=1,a=1,s=.5){const o={x:t,y:e,dy:n},l={depthRadius:r,bias:i,alpha:a,beta:s};return F.BV.runKernel(h.Hh,o,l)}}),Qt={kernelName:h.eZ,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r,i]=e,{depthRadius:a,bias:s,alpha:o,beta:l}=n;return{x:()=>Yt(r,i,t,a,s,o,l)}}};var te=n(4897);function ee(t,e,n,r){return e.rank<n.rank&&(e=(0,S.X)(e,vt.rv(e.shape,r))),t.rank<n.rank&&(t=(0,S.X)(t,vt.rv(t.shape,r))),{x:()=>(0,d.d)(t,(0,c.p)((0,te.D)(n,e),t.dtype))}}const ne={kernelName:h.Yo,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const r=n,{reductionIndices:i}=r,a=e[0],s=ee(t,e[1],a,L.EC(i,a.shape));return{x:()=>s.x()}}};var re=n(1314);const ie={kernelName:h.BM,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e;return{a:()=>(0,d.d)(t,(0,c.p)((0,Q.b)(n,r),"float32")),b:()=>(0,d.d)(t,(0,c.p)((0,re.d)(n,r),"float32"))}}},ae=(0,U.op)({maxPool3dGrad_:function(t,e,n,r,i,a,s){const o=(0,P._1)(t,"dy","maxPool3dGrad"),l=(0,P._1)(e,"input","maxPool3dGrad"),u=(0,P._1)(n,"output","maxPool3dGrad");let c=o,d=l,f=u,p=!1;4===l.rank&&(p=!0,c=(0,S.X)(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]]),d=(0,S.X)(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]]),f=(0,S.X)(u,[1,u.shape[0],u.shape[1],u.shape[2],u.shape[3]])),L.hu(5===c.rank,(()=>`Error in maxPool3dGrad: dy must be rank 5 but got rank ${c.rank}.`)),L.hu(5===d.rank,(()=>`Error in maxPool3dGrad: input must be rank 5 but got rank ${d.rank}.`)),L.hu(5===f.rank,(()=>`Error in maxPool3dGrad: output must be rank 5 but got rank ${f.rank}.`)),(0,$.m)("maxPool3dGrad",a,s);const m={dy:c,input:d,output:f},g={filterSize:r,strides:i,pad:a,dimRoundingMode:s},b=F.BV.runKernel(h.OU,m,g);return p?(0,S.X)(b,[b.shape[1],b.shape[2],b.shape[3],b.shape[4]]):b}}),se={kernelName:h.OA,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r,i]=e,{filterSize:a,strides:s,pad:o,dimRoundingMode:l}=n;return{x:()=>ae(t,r,i,a,s,o,l)}}},oe=(0,U.op)({maxPoolGrad_:function(t,e,n,r,i,a,s){const o=(0,P._1)(t,"dy","maxPoolGrad"),l=(0,P._1)(e,"input","maxPoolGrad"),u=(0,P._1)(n,"output","maxPoolGrad");L.hu(l.rank===o.rank,(()=>`Rank of input (${l.rank}) does not match rank of dy (${o.rank})`)),L.hu(4===o.rank,(()=>`Error in maxPoolGrad: dy must be rank 4 but got rank ${o.rank}.`)),L.hu(4===l.rank,(()=>`Error in maxPoolGrad: input must be rank 4 but got rank ${l.rank}.`)),$.m("maxPoolGrad",a,s);const c={dy:o,input:l,output:u},d={filterSize:r,strides:i,pad:a,dimRoundingMode:s};return F.BV.runKernel(h.OV,c,d)}}),le={kernelName:h.mT,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r,i]=e,{filterSize:a,strides:s,pad:o}=n;return{x:()=>oe(t,r,i,a,s,o)}}};var ue=n(9798);const he={kernelName:h.q2,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{axis:i}=n,a=L.EC(i,r.shape),s=(0,vt.kz)(r.shape,a)[1],o=L.NA(s);return{x:()=>{const e=r.shape.slice();a.forEach((t=>{e[t]=1}));const n=(0,S.X)(t,e);return(0,m.h)((0,d.d)(n,(0,ue.i)(r.shape,"float32")),o)}}}},ce={kernelName:h.c1,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const r=n,{axis:i}=r,[a,s]=e,o=ee(t,s,a,L.EC(i,a.shape));return{x:()=>o.x()}}},de={kernelName:h.q8,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e;return{a:()=>(0,d.d)(t,(0,c.p)((0,tt.z)(n,r),"float32")),b:()=>(0,d.d)(t,(0,c.p)((0,qt.p)(n,r),"float32"))}}};var fe=n(8128);const pe={kernelName:h.jQ,inputsToSave:["x"],gradFunc:(t,e,n)=>{const r=e[0],{paddings:i}=n,a=i.map((t=>t[0]));return{x:()=>(0,fe.t)(t,a,r.shape)}}};var me=n(7988);const ge={kernelName:h.Vb,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,i=(0,x.assertAndGetBroadcastShape)(n.shape,r.shape);return{a:()=>{const e=(0,x.getReductionAxes)(n.shape,i);return e.length>0?(0,S.X)((0,E.S)(t,e),n.shape):t},b:()=>{const e=(0,d.d)(t,(0,g.W)((0,me.G)((0,m.h)(n,r)))),a=(0,x.getReductionAxes)(r.shape,i);return a.length>0?(0,S.X)((0,E.S)(e,a),r.shape):e}}}},be={kernelName:h.wY,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,i=(0,x.assertAndGetBroadcastShape)(n.shape,r.shape);return{a:()=>{const e=(0,d.d)(t,(0,c.p)(r,"float32")),a=(0,x.getReductionAxes)(n.shape,i);return a.length>0?(0,S.X)((0,E.S)(e,a),n.shape):e},b:()=>{const e=(0,d.d)(t,(0,c.p)(n,"float32")),a=(0,x.getReductionAxes)(r.shape,i);return a.length>0?(0,S.X)((0,E.S)(e,a),r.shape):e}}}},ye={kernelName:h.ku,gradFunc:t=>({x:()=>(0,g.W)(t)})};var ve=n(4265);const we={kernelName:h.we,inputsToSave:["indices"],gradFunc:(t,e)=>{const n=e[0];return{indices:()=>(0,ve.l)(n.shape,"float32")}}},_e={kernelName:h.qW,gradFunc:t=>({x:()=>(0,M.P)(t)})};var ke=n(8347);const xe={kernelName:h.Qi,saveAllInputs:!0,gradFunc:(t,e,n)=>{const{axis:r}=n;return(0,ke.H)(t,r).map((t=>()=>t))}},Se={kernelName:h.ly,inputsToSave:["x"],gradFunc:(t,e,n)=>{const r=e[0],{paddings:i}=n,a=i.map((t=>t[0]));return{x:()=>(0,fe.t)(t,a,r.shape)}}};var Ee=n(1273),Ie=n(5277);const Ae={kernelName:h.pe,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:(t,e)=>{const[n,r,i]=e,a=n,s=r,o=x.assertAndGetBroadcastShape(a.shape,s.shape);return{a:()=>{const e=(0,c.p)(s,"float32");let n=(0,d.d)(t,(0,d.d)(e,(0,Ie.s)(a,(0,w.l)(e,(0,b.i)(1)))));const r=x.getReductionAxes(a.shape,o);return r.length>0&&(n=(0,E.S)(n,r)),(0,S.X)(n,a.shape)},b:()=>{const e=(0,qt.p)(a,0),n=(0,nt.a)(e,(0,Ee.c)(a),(0,M.P)(a));let r=(0,d.d)(t,(0,d.d)(i,n));const l=x.getReductionAxes(s.shape,o);return l.length>0&&(r=(0,E.S)(r,l)),(0,S.X)(r,s.shape)}}}},Me={kernelName:h.o0,inputsToSave:["x","alpha"],gradFunc:(t,e)=>{const[n,r]=e,i=(0,qt.p)(n,0);return{x:()=>(0,nt.a)(i,t,(0,d.d)(t,r)),alpha:()=>{let e=(0,nt.a)(i,(0,M.P)(t),(0,d.d)(t,n));const a=(0,x.getReductionAxes)(r.shape,t.shape);return a.length>0&&(e=(0,E.S)(e,a)),(0,S.X)(e,r.shape)}}}},Te={kernelName:h.oH,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,i=x.assertAndGetBroadcastShape(n.shape,r.shape);return{a:()=>{const e=(0,m.h)(t,(0,c.p)(r,"float32")),a=x.getReductionAxes(n.shape,i);return a.length>0?(0,S.X)((0,E.S)(e,a),n.shape):e},b:()=>{let e=(0,d.d)(t,(0,c.p)(n,"float32"));const a=x.getReductionAxes(r.shape,i);a.length>0&&(e=(0,S.X)((0,E.S)(e,a),r.shape));const s=(0,v.h)(r);return(0,g.W)((0,m.h)(e,(0,c.p)(s,"float32")))}}}},Ne={kernelName:h.$H,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>(0,m.h)(t,(0,g.W)((0,v.h)(n)))}}},Ce={kernelName:h.Sb,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e,r=(0,d.d)((0,tt.z)(n,6),(0,f.N)(n));return{x:()=>(0,d.d)(t,(0,c.p)(r,"float32"))}}},Re={kernelName:h.qk,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>(0,d.d)(t,(0,c.p)((0,f.N)(n),"float32"))}}},Oe={kernelName:h.HZ,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>(0,S.X)(t,n.shape)}}},De={kernelName:h._Y,inputsToSave:["images"],gradFunc:(t,e,n)=>{const[r]=e,i={dy:t,images:r};return{images:()=>F.BV.runKernel(h.zb,i,n)}}},ze={kernelName:h.dp,inputsToSave:["images"],gradFunc:(t,e,n)=>{const[r]=e,i={dy:t,images:r};return{images:()=>F.BV.runKernel(h.Hm,i,n)}}};var Be=n(4271);const Fe={kernelName:h.mK,gradFunc:(t,e,n)=>{const{dims:r}=n,i=(0,L.EC)(r,t.shape);return{x:()=>(0,Be.G)(t,i)}}},Pe={kernelName:h.e0,gradFunc:t=>({x:()=>(0,M.P)(t)})},Le={kernelName:h.bV,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>(0,g.W)((0,m.h)(t,(0,d.d)((0,Ie.s)(n,1.5),2)))}}};var $e=n(5599);const Ue={kernelName:h.Ph,inputsToSave:["condition"],gradFunc:(t,e)=>{const[n]=e;return{condition:()=>(0,c.p)((0,M.P)(n),"float32"),t:()=>(0,d.d)(t,(0,c.p)(n,t.dtype)),e:()=>(0,d.d)(t,(0,c.p)((0,$e.h)(n),t.dtype))}}};var je=n(7827);const We={kernelName:h.oF,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const e=(0,qt.p)(n,(0,b.i)(0)),r=(0,b.i)(je.y),i=(0,b.i)(je.$),a=(0,d.d)(t,i),s=(0,d.d)((0,d.d)(t,r),(0,Mt.Q)((0,c.p)(n,"float32")));return(0,nt.a)(e,a,s)}}}},Ge={kernelName:h.a5,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>(0,d.d)(t,(0,d.d)(n,(0,w.l)((0,b.i)(1),n)))}}},He={kernelName:h.i5,gradFunc:t=>({x:()=>(0,M.P)(t)})};var Ve=n(4420);const qe={kernelName:h.RQ,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>(0,d.d)((0,Ve.m)((0,c.p)(n,"float32")),t)}}};var Ke=n(1246);const Ze={kernelName:h.w3,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>(0,d.d)((0,Ke.f)((0,c.p)(n,"float32")),t)}}};var Xe=n(3650),Je=n(6997);const Ye={kernelName:h.p2,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{begin:i,size:a}=n,s=r.shape,[o,l]=(0,Je.parseSliceParams)(r,i,a),u=[];for(let e=0;e<t.rank;e++)u.push([o[e],s[e]-o[e]-l[e]]);return{x:()=>(0,Xe.v)(t,u)}}},Qe={kernelName:h.Gc,outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r]=e,{dim:i}=n,a=(0,d.d)(t,r);return{logits:()=>(0,w.l)(a,(0,d.d)((0,E.S)(a,[i],!0),r))}}};var tn=n(8885);const en={kernelName:h.MR,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>(0,d.d)(t,(0,tn.X)(n))}}};var nn=n(406);const rn={kernelName:h.TQ,gradFunc:(t,e,n)=>{const{blockShape:r,paddings:i}=n;return{x:()=>(0,nn.E)(t,r,i)}}};var an=n(1437);const sn={kernelName:h.L8,gradFunc:(t,e,n)=>{const{axis:r}=n;return{x:()=>(0,an.z)(t,r)}}},on={kernelName:h.FK,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>(0,m.h)(t,(0,d.d)((0,y._)((0,c.p)(n,"float32")),2))}}},ln={kernelName:h.bK,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>(0,d.d)(t,(0,d.d)((0,c.p)(n,"float32"),2))}}},un={kernelName:h._t,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,i=(0,b.i)(2);return{a:()=>(0,d.d)(t,(0,d.d)(i,(0,w.l)(n,r))),b:()=>(0,d.d)(t,(0,d.d)(i,(0,w.l)(r,n)))}}},hn={kernelName:h.h8,gradFunc:t=>({x:()=>(0,M.P)(t)})},cn={kernelName:h.Tr,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,i=x.assertAndGetBroadcastShape(n.shape,r.shape);return{a:()=>{let e=t;const r=x.getReductionAxes(n.shape,i);return r.length>0&&(e=(0,E.S)(e,r)),(0,S.X)(e,n.shape)},b:()=>{let e=t;const n=x.getReductionAxes(r.shape,i);return n.length>0&&(e=(0,E.S)(e,n)),(0,S.X)((0,g.W)(e),r.shape)}}}},dn={kernelName:h.GB,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,i=r.shape.slice(),{axis:a}=n;(0,L.EC)(a,r.shape).forEach((t=>{i[t]=1}));const s=(0,S.X)(t,i),o=(0,d.d)(s,(0,ue.i)(r.shape,"float32"));return{x:()=>o}}},fn={kernelName:h.sE,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>(0,m.h)(t,(0,v.h)((0,Ve.m)(n)))}}},pn={kernelName:h.MI,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>(0,d.d)((0,w.l)((0,b.i)(1),(0,v.h)(n)),t)}}},mn={kernelName:h.n9,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{reps:i}=n;return{x:()=>{let e=(0,M.P)(r);if(1===r.rank)for(let n=0;n<i[0];++n)e=(0,R.I)(e,(0,fe.t)(t,[n*r.shape[0]],[r.shape[0]]));else if(2===r.rank)for(let n=0;n<i[0];++n)for(let a=0;a<i[1];++a)e=(0,R.I)(e,(0,fe.t)(t,[n*r.shape[0],a*r.shape[1]],[r.shape[0],r.shape[1]]));else if(3===r.rank)for(let n=0;n<i[0];++n)for(let a=0;a<i[1];++a)for(let s=0;s<i[2];++s)e=(0,R.I)(e,(0,fe.t)(t,[n*r.shape[0],a*r.shape[1],s*r.shape[2]],[r.shape[0],r.shape[1],r.shape[2]]));else{if(4!==r.rank)throw new Error(`Gradient for tile operation is not implemented for rank-${r.rank} tensors yet.`);for(let n=0;n<i[0];++n)for(let a=0;a<i[1];++a)for(let s=0;s<i[2];++s)for(let o=0;o<i[3];++o)e=(0,R.I)(e,(0,fe.t)(t,[n*r.shape[0],a*r.shape[1],s*r.shape[2],o*r.shape[3]],[r.shape[0],r.shape[1],r.shape[2],r.shape[3]]))}return e}}}},gn={kernelName:h.G3,gradFunc:(t,e,n)=>{const r=n,{perm:i}=r,a=vt.LJ(i);return{x:()=>(0,_t.p)(t,a)}}};var bn=n(8673);const yn={kernelName:h.To,gradFunc:(t,e,n)=>{const r=n,{axis:i}=r;return{value:()=>(0,bn.k)(t,i)}}};var vn=n(5216),wn=n(9419),_n=n(9126);const kn={kernelName:h.Qv,inputsToSave:["segmentIds"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>function(t,e){const n=(0,_n.g)(e,(0,M.P)(e)),r=(0,wn.I)(t,n);let i=(0,Q.b)(e,(0,b.i)(0,"int32"));const a=r.rank-i.rank;for(let t=0;t<a;++t)i=(0,vn.d)(i,t+1);i=(0,et.H)(i,(0,ue.i)(r.shape,"bool"));const s=(0,M.P)(r);return(0,nt.a)(i,r,s)}(t,n)}}},xn={kernelName:h.Ru,gradFunc:t=>({x:()=>(0,M.P)(t)})};var Sn=n(3796);const En=[p,_,k,I,A,T,N,C,O,D,z,B,W,H,q,Z,X,J,Y,rt,it,st,ct,ut,pt,gt,yt,kt,Et,It,Te,At,Tt,Nt,Ct,Rt,Dt,Ot,Ft,Lt,jt,Wt,Gt,Ht,Vt,Kt,Zt,Xt,Jt,Qt,ne,ne,ie,se,le,he,ce,de,pe,ge,be,ye,we,_e,xe,Se,Se,Ae,Me,Ne,Ce,Re,Oe,De,ze,Fe,Pe,Le,Ue,We,Ge,He,qe,Ze,Ye,Qe,en,rn,rn,sn,sn,on,un,ln,hn,cn,dn,fn,pn,mn,gn,yn,kn,xn];for(const t of En)(0,Sn.Li)(t);let In;function An(){return null==In&&(In=(0,u.backend)().epsilon()),In}class Mn extends Error{constructor(t){super(t),Object.setPrototypeOf(this,Mn.prototype)}}class Tn extends Error{constructor(t){super(t),Object.setPrototypeOf(this,Tn.prototype)}}class Nn extends Error{constructor(t){super(t),Object.setPrototypeOf(this,Nn.prototype)}}class Cn extends Error{constructor(t){super(t),Object.setPrototypeOf(this,Cn.prototype)}}class Rn extends Error{constructor(t){super(t),Object.setPrototypeOf(this,Rn.prototype)}}function On(t,e){if(Array.isArray(t)){let n=[];for(let r=0;r<e;r++)n=n.concat(t);return n}{const n=new Array(e);return n.fill(t),n}}function Dn(t,e){if(!t)throw new Rn(e)}function zn(t,e){let n=0;for(const r of t)r===e&&n++;return n}function Bn(t){return 1===t.length?t[0]:t}function Fn(t){return Array.isArray(t)?t:[t]}function Pn(t){const e=t.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return"_"!==e[0]?e:"private"+e}function Ln(t){return t.length<=1||-1===t.indexOf("_")?t:t.replace(/[_]+(\w|$)/g,((t,e)=>e.toUpperCase()))}Error;let $n={};function Un(t){if(null==t)return null;const e={};return e.className=t.getClassName(),e.config=t.getConfig(),e}function jn(t){if(null!=t&&"object"==typeof t)if(Array.isArray(t))t.forEach((t=>jn(t)));else{const e=Object.keys(t);for(const n of e){const e=t[n];null!=e&&"object"==typeof e&&(Array.isArray(e)||"ndarray"!==e.type||"number"!=typeof e.value?jn(e):t[n]=e.value)}}}function Wn(t,e={},n={},r="object",i=!1){if("string"==typeof t){const i=t;let a;if(i in n)a=n[i];else if(i in $n)a=$n[i];else if(a=e[i],null==a)throw new Nn(`Unknown ${r}: ${t}. This may be due to one of the following reasons:\n1. The ${r} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.\n2. The custom ${r} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);return a}{const a=t;if(null==a.className||null==a.config)throw new Nn(`${r}: Improper config format: ${JSON.stringify(a)}.\n'className' and 'config' must set.`);const s=a.className;let o,l;if(s in n?[o,l]=n[s]:s in $n?[o,l]=$n.className:s in e&&([o,l]=e[s]),null==o)throw new Nn(`Unknown ${r}: ${s}. This may be due to one of the following reasons:\n1. The ${r} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.\n2. The custom ${r} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);if(null!=l){const t={};for(const e of Object.keys($n))t[e]=$n[e];for(const e of Object.keys(n))t[e]=n[e];a.config.customObjects=t;const e=Object.assign({},$n);for(const t of Object.keys(n))$n[t]=n[t];jn(a.config);const r=l(o,a.config,n,i);return $n=Object.assign({},e),r}{const t=Object.assign({},$n);for(const t of Object.keys(n))$n[t]=n[t];const e=new o(a.config);return $n=Object.assign({},t),e}}}function Gn(t,e){return-1*function(t,e){return t<e?-1:t>e?1:0}(t,e)}function Hn(t){if(null==t)return t;const e=[];for(const n of t)-1===e.indexOf(n)&&e.push(n);return e}function Vn(t){if(null==t)throw new Nn(`Invalid value in obj: ${JSON.stringify(t)}`);for(const e in t)if(t.hasOwnProperty(e))return!1;return!0}function qn(t,e,n){if(null!=n&&t.indexOf(n)<0)throw new Nn(`${n} is not a valid ${e}.  Valid values are ${t} or null/undefined.`)}function Kn(t,e,n=0,r=1/0){return Dn(n>=0),Dn(r>=n),Array.isArray(t)&&t.length>=n&&t.length<=r&&t.every((t=>typeof t===e))}function Zn(t,e){Array.isArray(t)?(u.util.assert(t.length>0,(()=>`${e} is unexpectedly an empty array.`)),t.forEach(((t,n)=>Zn(t,`element ${n+1} of ${e}`)))):u.util.assert(Number.isInteger(t)&&t>0,(()=>`Expected ${e} to be a positive integer, but got ${Xn(t)}.`))}function Xn(t){return null===t?"null":Array.isArray(t)?"["+t.map((t=>Xn(t))).join(",")+"]":"string"==typeof t?`"${t}"`:`${t}`}function Jn(t){return"relu"===t?"relu":"linear"===t?"linear":"elu"===t?"elu":null}function Yn(t,e){return(0,u.tidy)((()=>u.sqrt(u.sum(u.mul(t,t),e,!0))))}class Qn extends u.serialization.Serializable{getConfig(){return{}}}class tr extends Qn{constructor(t){super(),this.defaultMaxValue=2,this.defaultAxis=0,this.maxValue=null!=t.maxValue?t.maxValue:this.defaultMaxValue,this.axis=null!=t.axis?t.axis:this.defaultAxis}apply(t){return(0,u.tidy)((()=>{const e=Yn(t,this.axis),n=u.clipByValue(e,0,this.maxValue);return u.mul(t,u.div(n,u.add(An(),e)))}))}getConfig(){return{maxValue:this.maxValue,axis:this.axis}}}tr.className="MaxNorm",u.serialization.registerClass(tr);class er extends Qn{constructor(t){super(),this.defaultAxis=0,this.axis=null!=t.axis?t.axis:this.defaultAxis}apply(t){return(0,u.tidy)((()=>u.div(t,u.add(An(),Yn(t,this.axis)))))}getConfig(){return{axis:this.axis}}}er.className="UnitNorm",u.serialization.registerClass(er);class nr extends Qn{apply(t){return u.relu(t)}}nr.className="NonNeg",u.serialization.registerClass(nr);class rr extends Qn{constructor(t){super(),this.defaultMinValue=0,this.defaultMaxValue=1,this.defaultRate=1,this.defaultAxis=0,this.minValue=null!=t.minValue?t.minValue:this.defaultMinValue,this.maxValue=null!=t.maxValue?t.maxValue:this.defaultMaxValue,this.rate=null!=t.rate?t.rate:this.defaultRate,this.axis=null!=t.axis?t.axis:this.defaultAxis}apply(t){return(0,u.tidy)((()=>{const e=Yn(t,this.axis),n=u.add(u.mul(this.rate,u.clipByValue(e,this.minValue,this.maxValue)),u.mul(1-this.rate,e));return u.mul(t,u.div(n,u.add(An(),e)))}))}getConfig(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}}rr.className="MinMaxNorm",u.serialization.registerClass(rr);const ir={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function ar(t){return Un(t)}function sr(t,e={}){return Wn(t,u.serialization.SerializationMap.getMap().classNameMap,e,"constraint")}function or(t){return null==t?null:"string"==typeof t?sr({className:t in ir?ir[t]:t,config:{}}):t instanceof Qn?t:sr(t)}function lr(t){return new tr(t)}function ur(t){return new er(t)}function hr(){return new nr}function cr(t){return new rr(t)}const dr=["channelsFirst","channelsLast"],fr=["nearest","bilinear"],pr=["valid","same","causal"],mr=["max","avg"],gr=["sum","mul","concat","ave"],br=new Map;function yr(t){qn(dr,"DataFormat",t)}function vr(t){qn(pr,"PaddingMode",t)}function wr(t){qn(mr,"PoolMode",t)}const _r=[];function kr(t,e){_r.push(t);try{const t=e();return _r.pop(),t}catch(t){throw _r.pop(),t}}function xr(t){if(!Ir(t))throw new Error("Not a valid tensor name: '"+t+"'");return(0===_r.length?"":_r.join("/")+"/")+t}function Sr(t){if(!Ir(t))throw new Error("Not a valid tensor name: '"+t+"'");br.has(t)||br.set(t,0);const e=br.get(t);if(br.set(t,br.get(t)+1),e>0){const n=`${t}_${e}`;return br.set(n,1),n}return t}const Er=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function Ir(t){return!!t.match(Er)}function Ar(t,e,n){null==e&&(e=0),null==n&&(n=t.length);let r=1;for(let i=e;i<n;++i)r*=t[i];return r}function Mr(t){if(0===t.length)return Number.NaN;let e=Number.POSITIVE_INFINITY;for(let n=0;n<t.length;n++){const r=t[n];r<e&&(e=r)}return e}function Tr(t){if(0===t.length)return Number.NaN;let e=Number.NEGATIVE_INFINITY;for(let n=0;n<t.length;n++){const r=t[n];r>e&&(e=r)}return e}function Nr(t,e){if(e<t)throw new Nn(`end (${e}) < begin (${t}) is forbidden.`);const n=[];for(let r=t;r<e;++r)n.push(r);return n}function Cr(t,e){return u.cast(t,e)}function Rr(t,e=-1){const n=t.shape.slice();return e<0&&(e=n.length+e+1),n.splice(e,0,1),u.reshape(t,n)}function Or(t,e,n){return(0,u.tidy)((()=>{switch(t.rank){case 1:return u.slice1d(t,e,n);case 2:return u.slice2d(t,[e,0],[n,t.shape[1]]);case 3:return u.slice3d(t,[e,0,0],[n,t.shape[1],t.shape[2]]);case 4:return u.slice4d(t,[e,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3]]);case 5:return u.slice(t,[e,0,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3],t.shape[4]]);case 6:return u.slice(t,[e,0,0,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3],t.shape[4],t.shape[5]]);default:throw new Nn(`sliceAlongFirstAxis() received an unsupported tensor rank: ${t.rank}`)}}))}function Dr(t,e,n){return(0,u.tidy)((()=>{switch(t.rank){case 1:return u.slice1d(t,e,n);case 2:return u.slice2d(t,[0,e],[t.shape[0],n]);case 3:return u.slice3d(t,[0,0,e],[t.shape[0],t.shape[1],n]);case 4:return u.slice4d(t,[0,0,0,e],[t.shape[0],t.shape[1],t.shape[2],n]);default:throw new Nn(`sliceAlongLastAxis() received an unsupported tensor rank: ${t.rank}`)}}))}function zr(t,e,n,r){return(0,u.tidy)((()=>{switch(t.rank){case 1:return u.slice1d(t,e,n);case 2:switch(r){case 1:return Or(t,e,n);case 2:return Dr(t,e,n);default:throw new Nn(`The axis is not within the rank of the tensor ${r}`)}case 3:switch(r){case 1:return Or(t,e,n);case 2:return u.slice3d(t,[0,e,0],[t.shape[0],n,t.shape[2]]);case 3:return Dr(t,e,n);default:throw new Nn(`The axis is not within the rank of the tensor ${r}`)}case 4:switch(r){case 1:return Or(t,e,n);case 2:return u.slice4d(t,[0,e,0,0],[t.shape[0],n,t.shape[2],t.shape[3]]);case 3:return u.slice4d(t,[0,0,e,0],[t.shape[0],t.shape[1],n,t.shape[3]]);case 4:return Dr(t,e,n);default:throw new Nn(`The axis is not within the rank of the tensor ${r}`)}default:throw new Nn(`sliceAlongLastAxis() received an unsupported tensor rank: ${t.rank}`)}}))}function Br(t,e=-1){let n;return e<0&&(n=t[0].rank,e=0!==n?n:0),e===t[0].rank&&(e=-1),u.concat(t,e)}function Fr(t,e){switch(t.rank){case 1:return u.concat1d([t,e]);case 2:return u.concat2d([t,e],0);case 3:return u.concat3d([t,e],0);case 4:return u.concat4d([t,e],0);default:throw new Nn(`concatAlongFirstAxis() received an unsupported tensor rank: ${t.rank}`)}}function Pr(t,e){if(Array.isArray(e)||(e=[e]),t.rank!==e.length)throw new Nn(`The length of input n (${e.length}) does not match the number of dimensions in input x (${t.rank})`);return u.tile(t,e)}function Lr(t,e=0,n=1,r,i){return u.randomNormal(t,e,n,r,i)}function $r(t,e,n,r){if(t.rank<2||e.rank<2)throw new Cn(`dot requires both inputs to be rank >= 2 but got x shape = ${t.shape} and y shape = ${e.shape}`);if(e.rank>=3&&t.shape.slice(-1)[0]!==e.shape.slice(-2)[0])throw new Cn(`If rank y >= 3, then the second last dim of y must equal the last dim of x but got x shape = ${t.shape} and  y shape = ${e.shape}`);if(2===t.rank&&2===e.rank){const i=!1,a=!1;return u.fused.matMul({a:t,b:e,transposeA:i,transposeB:a,bias:r?Wr(t.rank,r,"channelsLast"):null,activation:n})}{const i=t.shape.slice(),a=i.pop();t=u.reshape(t,[-1,a]);const s=e.shape.slice(),o=s.pop(),l=s.pop(),h=[...s,o],c=Array.from({length:e.rank},((t,n)=>0===n?e.rank-2:n<=e.rank-2?n-1:n));e=u.reshape(u.transpose(e,c),[l,-1]);const d=[...i,...h],f=!1,p=!1;return u.reshape(u.fused.matMul({a:t,b:e,transposeA:f,transposeB:p,bias:r?Wr(t.rank,r,"channelsLast"):null,activation:n}),d)}}function Ur(t,e,n){return(0,u.tidy)((()=>(e=Array.isArray(e)?(0,u.tensor1d)(e,"int32"):u.cast(e,"int32"),u.gather(t,e,n))))}function jr(t){return u.mul(t,t)}function Wr(t,e,n){const r=e.shape;if(1!==e.rank&&e.rank!==t)throw new Nn(`Unexpected bias dimensions: ${e.rank}; expected it to be 1 or ${t}`);if(5===t){if("channelsFirst"===n)return 1===r.length?u.reshape(e,[1,r[0],1,1,1]):u.reshape(e,[1,r[3],r[0],r[1],r[2]]);if("channelsLast"===n)return 1===r.length?u.reshape(e,[1,1,1,1,r[0]]):u.reshape(e,[1].concat(r))}else if(4===t){if("channelsFirst"===n)return 1===r.length?u.reshape(e,[1,r[0],1,1]):u.reshape(e,[1,r[2],r[0],r[1]]);if("channelsLast"===n)return 1===r.length?u.reshape(e,[1,1,1,r[0]]):u.reshape(e,[1].concat(r))}else if(3===t){if("channelsFirst"===n)return 1===r.length?u.reshape(e,[1,r[0],1]):u.reshape(e,[1,r[1],r[0]]);if("channelsLast"===n)return 1===r.length?u.reshape(e,[1,1,r[0]]):u.reshape(e,[1].concat(r))}else if(t<3)return e;throw new Nn(`Unsupported input rank by biasAdd: ${e.rank}`)}function Gr(t,e,n){return(0,u.tidy)((()=>(null==n&&(n="channelsLast"),yr(n),u.add(t,Wr(t.rank,e,n)))))}function Hr(t,e,n,r){return(0,u.tidy)((()=>u.dropout(t,e,n,r)))}function Vr(t,e,n=!1){return n?t():e()}const qr=["fanIn","fanOut","fanAvg"],Kr=["normal","uniform","truncatedNormal"];class Zr extends u.serialization.Serializable{fromConfigUsesCustomObjects(){return!1}getConfig(){return{}}}class Xr extends Zr{apply(t,e){return(0,u.zeros)(t,e)}}Xr.className="Zeros",u.serialization.registerClass(Xr);class Jr extends Zr{apply(t,e){return(0,u.ones)(t,e)}}Jr.className="Ones",u.serialization.registerClass(Jr);class Yr extends Zr{constructor(t){if(super(),"object"!=typeof t)throw new Nn(`Expected argument of type ConstantConfig but got ${t}`);if(void 0===t.value)throw new Nn(`config must have value set but got ${t}`);this.value=t.value}apply(t,e){return(0,u.tidy)((()=>(0,u.mul)((0,u.scalar)(this.value),(0,u.ones)(t,e))))}getConfig(){return{value:this.value}}}Yr.className="Constant",u.serialization.registerClass(Yr);class Qr extends Zr{constructor(t){super(),this.DEFAULT_MINVAL=-.05,this.DEFAULT_MAXVAL=.05,this.minval=t.minval||this.DEFAULT_MINVAL,this.maxval=t.maxval||this.DEFAULT_MAXVAL,this.seed=t.seed}apply(t,e){return(0,u.randomUniform)(t,this.minval,this.maxval,e)}getConfig(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}}Qr.className="RandomUniform",u.serialization.registerClass(Qr);class ti extends Zr{constructor(t){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=t.mean||this.DEFAULT_MEAN,this.stddev=t.stddev||this.DEFAULT_STDDEV,this.seed=t.seed}apply(t,e){if("float32"!==(e=e||"float32")&&"int32"!==e)throw new Cn(`randomNormal does not support dType ${e}.`);return Lr(t,this.mean,this.stddev,e,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}ti.className="RandomNormal",u.serialization.registerClass(ti);class ei extends Zr{constructor(t){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=t.mean||this.DEFAULT_MEAN,this.stddev=t.stddev||this.DEFAULT_STDDEV,this.seed=t.seed}apply(t,e){if("float32"!==(e=e||"float32")&&"int32"!==e)throw new Cn(`truncatedNormal does not support dType ${e}.`);return(0,u.truncatedNormal)(t,this.mean,this.stddev,e,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}ei.className="TruncatedNormal",u.serialization.registerClass(ei);class ni extends Zr{constructor(t){super(),this.gain=null!=t.gain?t.gain:1}apply(t,e){return(0,u.tidy)((()=>{if(2!==t.length||t[0]!==t[1])throw new Nn("Identity matrix initializer can only be used for 2D square matrices.");return(0,u.mul)(this.gain,(0,u.eye)(t[0]))}))}getConfig(){return{gain:this.gain}}}ni.className="Identity",u.serialization.registerClass(ni);class ri extends Zr{constructor(t){if(super(),t.scale<0)throw new Nn(`scale must be a positive float. Got: ${t.scale}`);var e;this.scale=null==t.scale?1:t.scale,this.mode=null==t.mode?"fanIn":t.mode,e=this.mode,qn(qr,"FanMode",e),this.distribution=null==t.distribution?"normal":t.distribution,function(t){qn(Kr,"Distribution",t)}(this.distribution),this.seed=t.seed}apply(t,e){const n=function(t,e="channelsLast"){let n,r;if(yr(e),2===t.length)n=t[0],r=t[1];else if(-1!==[3,4,5].indexOf(t.length)){if("channelsFirst"===e){const e=Ar(t,2);n=t[1]*e,r=t[0]*e}else if("channelsLast"===e){const e=Ar(t,0,t.length-2);n=t[t.length-2]*e,r=t[t.length-1]*e}}else{const e=Ar(t);n=Math.sqrt(e),r=Math.sqrt(e)}return[n,r]}(t),r=n[0],i=n[1];let a=this.scale;if("fanIn"===this.mode?a/=Math.max(1,r):"fanOut"===this.mode?a/=Math.max(1,i):a/=Math.max(1,(r+i)/2),"normal"===this.distribution){const n=Math.sqrt(a);if("float32"!==(e=e||"float32")&&"int32"!==e)throw new Cn(`${this.getClassName()} does not support dType ${e}.`);return(0,u.truncatedNormal)(t,0,n,e,this.seed)}{const n=Math.sqrt(3*a);return(0,u.randomUniform)(t,-n,n,e)}}getConfig(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}}ri.className="VarianceScaling",u.serialization.registerClass(ri);class ii extends ri{constructor(t){super({scale:1,mode:"fanAvg",distribution:"uniform",seed:null==t?null:t.seed})}getClassName(){return ri.className}}ii.className="GlorotUniform",u.serialization.registerClass(ii);class ai extends ri{constructor(t){super({scale:1,mode:"fanAvg",distribution:"normal",seed:null==t?null:t.seed})}getClassName(){return ri.className}}ai.className="GlorotNormal",u.serialization.registerClass(ai);class si extends ri{constructor(t){super({scale:2,mode:"fanIn",distribution:"normal",seed:null==t?null:t.seed})}getClassName(){return ri.className}}si.className="HeNormal",u.serialization.registerClass(si);class oi extends ri{constructor(t){super({scale:2,mode:"fanIn",distribution:"uniform",seed:null==t?null:t.seed})}getClassName(){return ri.className}}oi.className="HeUniform",u.serialization.registerClass(oi);class li extends ri{constructor(t){super({scale:1,mode:"fanIn",distribution:"normal",seed:null==t?null:t.seed})}getClassName(){return ri.className}}li.className="LeCunNormal",u.serialization.registerClass(li);class ui extends ri{constructor(t){super({scale:1,mode:"fanIn",distribution:"uniform",seed:null==t?null:t.seed})}getClassName(){return ri.className}}ui.className="LeCunNormal",u.serialization.registerClass(ui);class hi extends Zr{constructor(t){if(super(),this.DEFAULT_GAIN=1,this.gain=null==t.gain?this.DEFAULT_GAIN:t.gain,this.seed=t.seed,null!=this.seed)throw new Cn("Random seed is not implemented for Orthogonal Initializer yet.")}apply(t,e){return(0,u.tidy)((()=>{if(t.length<2)throw new Cn("Shape must be at least 2D.");t[0]*t[1]>2e3&&console.warn(`Orthogonal initializer is being called on a matrix with more than 2000 (${t[0]*t[1]}) elements: Slowness may result.`);const e=Lr(t[0]>t[1]?[t[1],t[0]]:t,0,1,"float32");let n=u.linalg.gramSchmidt(e);return t[0]>t[1]&&(n=(0,u.transpose)(n)),(0,u.mul)(this.gain,n)}))}getConfig(){return{gain:this.gain,seed:this.seed}}}hi.className="Orthogonal",u.serialization.registerClass(hi);const ci={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function di(t,e={}){return Wn(t,u.serialization.SerializationMap.getMap().classNameMap,e,"initializer")}function fi(t){return Un(t)}function pi(t){if("string"==typeof t){const e=t in ci?ci[t]:t;if("GlorotNormal"===e)return new ai;if("GlorotUniform"===e)return new ii;if("HeNormal"===e)return new si;if("HeUniform"===e)return new oi;if("LeCunNormal"===e)return new li;if("LeCunUniform"===e)return new ui;{const t={};return t.className=e,t.config={},di(t)}}return t instanceof Zr?t:di(t)}function mi(){return new Xr}function gi(){return new Jr}function bi(t){return new Yr(t)}function yi(t){return new Qr(t)}function vi(t){return new ti(t)}function wi(t){return new ei(t)}function _i(t){return new ni(t)}function ki(t){return new ri(t)}function xi(t){return new ii(t)}function Si(t){return new ai(t)}function Ei(t){return new si(t)}function Ii(t){return new oi(t)}function Ai(t){return new li(t)}function Mi(t){return new ui(t)}function Ti(t){return new hi(t)}let Ni=0;function Ci(){return Ni++}const Ri={};function Oi(t=""){return t in Ri||(Ri[t]=0),Ri[t]+=1,t+Ri[t].toString()}function Di(t){return Array.isArray(t)&&Array.isArray(t[0])}function zi(t){return 0===t.length?[]:Array.isArray(t[0])?t:[t]}function Bi(t){let e;if(Array.isArray(t)){if(1!==t.length)throw new Nn(`Expected Tensor length to be 1; got ${t.length}`);e=t[0]}else e=t;return e}function Fi(t){if(Array.isArray(t)&&Array.isArray(t[0])){if(1===t.length)return(t=t)[0];throw new Nn(`Expected exactly 1 Shape; got ${t.length}`)}return t}function Pi(t){let e=0;for(const n of t)0===n.shape.length?e+=1:e+=n.shape.reduce(((t,e)=>t*e));return e}class Li{constructor(t,e="float32",n="Variable",r=!0,i=null){this.dtype=null==e?"float32":e,this.shape=t.shape,this.id=Ci(),n=null==n?"Variable":n,this.originalName=xr(n),this.name=Sr(this.originalName),this.trainable_=r,this.constraint=i,this.val=u.variable(t,this.trainable_,this.name,this.dtype)}read(){return this.assertNotDisposed(),this.val}write(t){return this.assertNotDisposed(),function(t,e){if(t.shape.toString()!==e.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(t.shape)+" vs. "+JSON.stringify(e.shape))}(this.val,t),this.val.id!==t.id&&(this.val.assign(t),null!=this.constraint&&this.val.assign(this.constraint.apply(this.val))),this}dispose(){this.assertNotDisposed(),this.val.dispose()}assertNotDisposed(){if(this.val.isDisposed)throw new Error(`LayersVariable ${this.name} is already disposed.`)}get trainable(){return this.trainable_}set trainable(t){this.trainable_=t,this.val.trainable=t}}function $i(t){return t.map((t=>t.read()))}function Ui(t){t.forEach((t=>{t[0].write(t[1])}))}class ji{constructor(t){this.dtype=t.dtype,this.shape=t.shape,null!=t.shape?this.ndim=t.shape.length:this.ndim=t.ndim,this.maxNDim=t.maxNDim,this.minNDim=t.minNDim,this.axes=t.axes||{}}}class Wi{constructor(t,e,n,r,i,a,s){this.dtype=t,this.shape=e,this.sourceLayer=n,this.inputs=r,this.callArgs=i,this.outputTensorIndex=s,this.id=Ci(),null!=a&&(this.originalName=xr(a),this.name=Sr(this.originalName)),this.rank=e.length}}let Gi=0;class Hi{constructor(t,e){this.callArgs=e,this.id=Gi++,this.outboundLayer=t.outboundLayer,this.inboundLayers=t.inboundLayers,this.nodeIndices=t.nodeIndices,this.tensorIndices=t.tensorIndices,this.inputTensors=t.inputTensors,this.outputTensors=t.outputTensors,this.inputMasks=t.inputMasks,this.outputMasks=t.outputMasks,this.inputShapes=t.inputShapes,this.outputShapes=t.outputShapes;for(const e of t.inboundLayers)null!=e&&e.outboundNodes.push(this);t.outboundLayer.inboundNodes.push(this)}getConfig(){const t=[];for(const e of this.inboundLayers)null!=e?t.push(e.name):t.push(null);return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:t,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}}let Vi=0;class qi extends u.serialization.Serializable{constructor(t={}){super(),this._callHook=null,this._addedWeightNames=[],this._stateful=!1,this.id=Vi++,this.activityRegularizer=null,this.inputSpec=null,this.supportsMasking=!1,this._trainableWeights=[],this._nonTrainableWeights=[],this._losses=[],this._updates=[],this._built=!1,this.inboundNodes=[],this.outboundNodes=[];let e=t.name;if(!e){const t=this.getClassName();e=Pn(t)+"_"+Oi(t)}if(this.name=e,this.trainable_=null==t.trainable||t.trainable,null!=t.inputShape||null!=t.batchInputShape){let e;if(null!=t.batchInputShape)e=t.batchInputShape;else if(null!=t.inputShape){let n=null;null!=t.batchSize&&(n=t.batchSize),e=[n].concat(t.inputShape)}this.batchInputShape=e;let n=t.dtype;null==n&&(n=t.inputDType),null==n&&(n="float32"),this.dtype=n}null!=t.weights?this.initialWeights=t.weights:this.initialWeights=null,this._refCount=null,this.fastWeightInitDuringBuild=!1}static nodeKey(t,e){return t.name+"_ib-"+e.toString()}getNodeAtIndex(t,e){if(0===this.inboundNodes.length)throw new Tn(`The layer has never been called and thus has no defined ${e}.`);if(this.inboundNodes.length<=t)throw new Nn(`Asked to get ${e} at node ${t}, but the layer has only ${this.inboundNodes.length} inbound nodes.`);return this.inboundNodes[t]}getInputAt(t){return Bn(this.getNodeAtIndex(t,"input").inputTensors)}getOutputAt(t){return Bn(this.getNodeAtIndex(t,"output").outputTensors)}get input(){if(this.inboundNodes.length>1)throw new Mn(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use \`getInputAt(nodeIndex)\` instead.`);if(0===this.inboundNodes.length)throw new Mn(`Layer ${this.name} is not connected, no input to return.`);return Bn(this.getNodeAtIndex(0,"input").inputTensors)}get output(){if(0===this.inboundNodes.length)throw new Mn(`Layer ${this.name} has no inbound nodes.`);if(this.inboundNodes.length>1)throw new Mn(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use \`getOutputAt(nodeIndex)\` instead.`);return Bn(this.getNodeAtIndex(0,"output").outputTensors)}get losses(){return this._losses}calculateLosses(){return this.losses.map((t=>t()))}get updates(){return this._updates}get built(){return this._built}set built(t){this._built=t}get trainable(){return this.trainable_}set trainable(t){this._trainableWeights.forEach((e=>e.trainable=t)),this.trainable_=t}get trainableWeights(){return this.trainable_?this._trainableWeights.filter((t=>t.trainable)):[]}set trainableWeights(t){this._trainableWeights=t}get nonTrainableWeights(){return this.trainable?this._trainableWeights.filter((t=>!t.trainable)).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)}set nonTrainableWeights(t){this._nonTrainableWeights=t}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}get stateful(){return this._stateful}resetStates(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}assertInputCompatibility(t){if(t=Fn(t),null==this.inputSpec||0===this.inputSpec.length)return;const e=Fn(this.inputSpec);if(t.length!==e.length)throw new Nn(`Layer ${this.name} expects ${e.length} inputs, but it received ${t.length} input tensors. Input received: ${t}`);for(let n=0;n<t.length;n++){const r=t[n],i=e[n];if(null==i)continue;const a=r.rank;if(null!=i.ndim&&a!==i.ndim)throw new Nn(`Input ${n} is incompatible with layer ${this.name}: expected ndim=${i.ndim}, found ndim=${a}`);if(null!=i.maxNDim&&a>i.maxNDim)throw new Nn(`Input ${n} is incompatible with layer ${this.name}: expected max_ndim=${i.maxNDim}, found ndim=${a}`);if(null!=i.minNDim&&a<i.minNDim)throw new Nn(`Input ${n} is incompatible with layer ${this.name}: expected min_ndim=${i.minNDim}, found ndim=${a}.`);if(null!=i.dtype&&r.dtype!==i.dtype)throw new Nn(`Input ${n} is incompatible with layer ${this.name} : expected dtype=${i.dtype}, found dtype=${r.dtype}.`);if(i.axes){const t=r.shape;for(const e in i.axes){const r=Number(e),a=i.axes[e],s=r>=0?t[r]:t[t.length+r];if(null!=a&&-1===[a,null].indexOf(s))throw new Nn(`Input ${n} is incompatible with layer ${this.name}: expected axis ${r} of input shape to have value ${a} but got shape ${t}.`)}}if(null!=i.shape)for(let t=0;t<i.shape.length;++t){const e=i.shape[t],a=r.shape[t];if(null!=e&&null!=a&&e!==a)throw new Nn(`Input ${n} is incompatible with layer ${this.name}: expected shape=${i.shape}, found shape=${r.shape}.`)}}}call(t,e){return t}invokeCallHook(t,e){null!=this._callHook&&this._callHook(t,e)}setCallHook(t){this._callHook=t}clearCallHook(){this._callHook=null}apply(t,e){e=e||{},this.assertNotDisposed();const n=Fn(t);let r=!0;for(const t of n)if(!(t instanceof Wi)){r=!1;break}let i=!0;for(const t of n)if(t instanceof Wi){i=!1;break}if(r===i)throw new Nn("Arguments to apply() must be all SymbolicTensors or all Tensors");return kr(this.name,(()=>{if(!this.built){this.assertInputCompatibility(t);const e=[];for(const n of Fn(t))e.push(n.shape);this.build(Bn(e)),this.built=!0,this.initialWeights&&this.setWeights(this.initialWeights),null===this._refCount&&i&&(this._refCount=1)}if(this.assertInputCompatibility(t),i){let r=this.call(t,e);const i=Fn(r),a=[];for(let t of i)-1!==n.indexOf(t)&&(t=t.clone()),a.push(t);if(r=Bn(a),null!=this.activityRegularizer)throw new Cn("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return r}{const n=function(t){t=Fn(t);const e=[];for(const n of t)e.push(n.shape);return Bn(e)}(t),r=this.computeOutputShape(n);let i;const a="float32";if(this.warnOnIncompatibleInputShape(Array.isArray(t)?n[0]:n),i=null!=r&&r.length>0&&Array.isArray(r[0])?r.map(((n,r)=>new Wi(a,n,this,Fn(t),e,this.name,r))):new Wi(a,r,this,Fn(t),e,this.name),this.addInboundNode(t,i,null,null,n,r,e),this._refCount++,null!=this.activityRegularizer)throw new Cn("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return i}}))}warnOnIncompatibleInputShape(t){if(null!=this.batchInputShape)if(t.length!==this.batchInputShape.length)console.warn(`The rank of the input tensor provided (shape: ${JSON.stringify(t)}) does not match that of the batchInputShape (${JSON.stringify(this.batchInputShape)}) of the layer ${this.name}`);else{let e=!1;this.batchInputShape.forEach(((n,r)=>{null!=n&&null!=t[r]&&t[r]!==n&&(e=!0)})),e&&console.warn(`The shape of the input tensor (${JSON.stringify(t)}) does not match the expectation of layer ${this.name}: ${JSON.stringify(this.batchInputShape)}`)}}get outputShape(){if(null==this.inboundNodes||0===this.inboundNodes.length)throw new Mn(`The layer ${this.name} has never been called and thus has no defined output shape.`);const t=[];for(const e of this.inboundNodes){const n=JSON.stringify(e.outputShapes);-1===t.indexOf(n)&&t.push(n)}if(1===t.length){const t=this.inboundNodes[0].outputShapes;return Array.isArray(t)&&Array.isArray(t[0])&&1===t.length?t[0]:t}throw new Mn(`The layer ${this.name} has multiple inbound nodes with different output shapes. Hence the notion of "output shape" is ill-defined for the layer.`)}countParams(){if(!this.built)throw new Tn(`You tried to call countParams() on ${this.name}, but the layer is not built yet. Build it first by calling build(batchInputShape).`);return Pi(this.weights)}build(t){this.built=!0}getWeights(t=!1){return $i(t?this.trainableWeights:this.weights)}setWeights(t){(0,u.tidy)((()=>{const e=this.weights;if(e.length!==t.length)throw new Nn(`You called setWeights(weights) on layer "${this.name}" with a weight list of length ${t.length}, but the layer was expecting ${e.length} weights. Provided weights: ${t}...`);if(0===e.length)return;const n=[],r=$i(e);for(let i=0;i<r.length;++i){const a=r[i],s=e[i],o=t[i];if(!u.util.arraysEqual(a.shape,o.shape))throw new Nn(`Layer weight shape ${a.shape} not compatible with provided weight shape ${o.shape}`);n.push([s,o])}Ui(n)}))}addWeight(t,e,n,r,i,a,s,o){if(-1!==this._addedWeightNames.indexOf(t))throw new Nn(`Duplicate weight name ${t} for layer ${this.name}`);this._addedWeightNames.push(t),null==n&&(n="float32"),this.fastWeightInitDuringBuild&&(r=null!=o?o():pi("zeros"));const l=r.apply(e,n),u=new Li(l,n,t,a,s);return l.dispose(),null!=i&&this.addLoss((()=>i.apply(u.read()))),null==a&&(a=!0),a?this._trainableWeights.push(u):this._nonTrainableWeights.push(u),u}setFastWeightInitDuringBuild(t){this.fastWeightInitDuringBuild=t}addLoss(t){null==t||Array.isArray(t)&&0===t.length||(t=Fn(t),void 0!==this._losses&&null!==this._losses&&this.losses.push(...t))}computeOutputShape(t){return t}computeMask(t,e){if(!this.supportsMasking){if(null!=e){if(!Array.isArray(e))throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`);e.forEach((t=>{if(null!=t)throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`)}))}return null}return e}addInboundNode(t,e,n,r,i,a,s=null){const o=Fn(t);e=Fn(e),n=Fn(n),r=Fn(r),i=zi(i),a=zi(a);const l=[],u=[],h=[];for(const t of o)l.push(t.sourceLayer),u.push(t.nodeIndex),h.push(t.tensorIndex);new Hi({outboundLayer:this,inboundLayers:l,nodeIndices:u,tensorIndices:h,inputTensors:o,outputTensors:e,inputMasks:n,outputMasks:r,inputShapes:i,outputShapes:a},s);for(let t=0;t<e.length;t++)e[t].sourceLayer=this,e[t].nodeIndex=this.inboundNodes.length-1,e[t].tensorIndex=t}getConfig(){const t={name:this.name,trainable:this.trainable};return null!=this.batchInputShape&&(t.batchInputShape=this.batchInputShape),null!=this.dtype&&(t.dtype=this.dtype),t}disposeWeights(){return this.weights.forEach((t=>t.dispose())),this.weights.length}assertNotDisposed(){if(0===this._refCount)throw new Error(`Layer '${this.name}' is already disposed.`)}dispose(){if(!this.built)throw new Error(`Cannot dispose Layer ${this.name} because it has not been built yet.`);if(null===this._refCount)throw new Error(`Cannot dispose Layer ${this.name} because it has not been used yet.`);this.assertNotDisposed();let t=0;return 0==--this._refCount&&(t=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:t}}}function Ki(t,e,n){if((null==e||null!=n&&n>0)&&(e=t.sourceLayer,n=t.nodeIndex),0===e.inboundNodes.length)return[t];{const t=e.inboundNodes[n];if(0===t.inboundLayers.length)return t.inputTensors;{const e=[];for(let n=0;n<t.inboundLayers.length;n++){const r=Ki(t.inputTensors[n],t.inboundLayers[n],t.nodeIndices[n]);for(const t of r)-1===e.indexOf(t)&&e.push(t)}return e}}}class Zi extends qi{constructor(t){if(super({dtype:t.dtype,name:null!=t.name?t.name:Oi("input").toString()}),null==t.batchSize&&(t.batchSize=null),null==t.sparse&&(t.sparse=!1),this.trainable=!1,this.built=!0,this.sparse=t.sparse,null!=t.inputShape&&null!=t.batchInputShape)throw new Nn("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");let e=t.batchInputShape;if(null==e){if(null==t.inputShape)throw new Nn("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");e=[t.batchSize].concat(t.inputShape)}else if(null!=t.batchSize)throw new Nn("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");const n=t.dtype||"float32";this.batchInputShape=e,this.dtype=n,this.inputSpec=[{shape:e}];const r=new Wi(this.dtype,this.batchInputShape,this,[],{},this.name);r.nodeIndex=0,r.tensorIndex=0,new Hi({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[r],outputTensors:[r],inputMasks:[null],outputMasks:[null],inputShapes:[e],outputShapes:[e]})}apply(t,e){throw new Nn(`Cannot pass any input to an InputLayer's apply() method. InputLayer name: ${this.name}`)}dispose(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}getConfig(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}}function Xi(t){if(null==t.batchShape&&null==t.shape)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(null!=t.batchShape&&null!=t.shape)throw new Nn("Please provide either a `shape` or `batchShape` argument to Input, but not both.");let e=t.batchShape;null!=t.shape&&null==e&&(e=[null].concat(t.shape));let n=t.dtype;return null==n&&(n="float32"),new Zi({batchInputShape:e,name:t.name,dtype:n,sparse:t.sparse}).inboundNodes[0].outputTensors[0]}async function Ji(t){if(null==t)return;const e=[],n=[],r=[];for(const i in t){const a=t[i];if("number"!=typeof a){const t=a;e.push(t.data()),n.push(i),r.push(t)}}if(e.length>0){const i=await Promise.all(e);for(let e=0;e<i.length;++e)t[n[e]]=i[e][0];(0,u.dispose)(r)}}function Yi(t){if(null!=t)for(const e in t){const n=t[e];"number"!=typeof n&&n.dispose()}}var Qi;Zi.className="InputLayer",u.serialization.registerClass(Zi),function(t){t[t.SILENT=0]="SILENT",t[t.VERBOSE=1]="VERBOSE"}(Qi||(Qi={}));class ta{constructor(){this.validationData=null}setParams(t){this.params=t}async onEpochBegin(t,e){}async onEpochEnd(t,e){}async onBatchBegin(t,e){}async onBatchEnd(t,e){}async onTrainBegin(t){}async onTrainEnd(t){}setModel(t){}}class ea{constructor(t,e=10){null==t&&(t=[]),this.callbacks=t,this.queueLength=e}append(t){this.callbacks.push(t)}setParams(t){for(const e of this.callbacks)e.setParams(t)}setModel(t){for(const e of this.callbacks)e.setModel(t)}async onEpochBegin(t,e){null==e&&(e={});for(const n of this.callbacks)await n.onEpochBegin(t,e)}async onEpochEnd(t,e){null==e&&(e={});for(const n of this.callbacks)await n.onEpochEnd(t,e)}async onBatchBegin(t,e){null==e&&(e={});for(const n of this.callbacks)await n.onBatchBegin(t,e)}async onBatchEnd(t,e){null==e&&(e={});for(const n of this.callbacks)await n.onBatchEnd(t,e)}async onTrainBegin(t){null==t&&(t={});for(const e of this.callbacks)await e.onTrainBegin(t)}async onTrainEnd(t){null==t&&(t={});for(const e of this.callbacks)await e.onTrainEnd(t)}}class na extends ta{constructor(){super()}async onEpochBegin(t){this.seen=0,this.totals={}}async onBatchEnd(t,e){null==e&&(e={});const n=null==e.size?0:e.size;this.seen+=n;for(const t in e){const r=e[t];if("number"==typeof r)this.totals.hasOwnProperty(t)||(this.totals[t]=0),this.totals[t]=this.totals[t]+r*n;else{let e;t in this.totals?e=this.totals[t]:this.totals[t]=0;const i=(0,u.tidy)((()=>(0,u.add)(this.totals[t],(0,u.mul)(r,n))));this.totals[t]=i,null!=e&&e.dispose()}}}async onEpochEnd(t,e){if(null!=e)for(const t of this.params.metrics)null!=this.totals[t]&&("number"==typeof this.totals[t]?e[t]=this.totals[t]/this.seen:(0,u.tidy)((()=>{const n=(0,u.mul)((0,u.div)(1,this.seen),this.totals[t]);e[t]=n,this.totals[t].dispose(),(0,u.keep)(e[t])})))}}class ra extends ta{async onTrainBegin(t){this.epoch=[],this.history={}}async onEpochEnd(t,e){null==e&&(e={}),this.epoch.push(t);for(const t in e)null==this.history[t]&&(this.history[t]=[]),this.history[t].push(e[t])}async syncData(){const t=[],e=[],n=[];for(const r in this.history){const i=this.history[r];for(let a=0;a<i.length;++a)if("number"!=typeof i[a]){const s=i[a];t.push(s.data()),e.push(r),n.push(a)}}const r=await Promise.all(t);for(let t=0;t<r.length;++t)this.history[e[t]][n[t]].dispose(),this.history[e[t]][n[t]]=r[t][0]}}class ia extends ta{constructor(t,e){if(super(),this.currentEpoch=0,this.nowFunc=t.nowFunc,this.nextFrameFunc=t.nextFrameFunc||u.nextFrame,this.yieldEvery=e||"auto","auto"===this.yieldEvery&&(this.yieldEvery=125),"never"===this.yieldEvery&&null!=t.onYield)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");u.util.isNumber(this.yieldEvery)&&(this.maybeWait=function(t,e,n){let r,i=null!=n?n():u.util.now();return(...a)=>{const s=null!=n?n():u.util.now();return s-i<e||(i=s,r=t(...a)),r}}(this.maybeWait.bind(this),this.yieldEvery,this.nowFunc)),this.trainBegin=t.onTrainBegin,this.trainEnd=t.onTrainEnd,this.epochBegin=t.onEpochBegin,this.epochEnd=t.onEpochEnd,this.batchBegin=t.onBatchBegin,this.batchEnd=t.onBatchEnd,this.yield=t.onYield}async maybeWait(t,e,n){const r=[];null!=this.yield&&(await Ji(n),r.push(this.yield(t,e,n))),r.push(this.nextFrameFunc()),await Promise.all(r)}async onEpochBegin(t,e){this.currentEpoch=t,null!=this.epochBegin&&(await Ji(e),await this.epochBegin(t,e))}async onEpochEnd(t,e){const n=[];null!=this.epochEnd&&(await Ji(e),n.push(this.epochEnd(t,e))),"epoch"===this.yieldEvery&&n.push(this.nextFrameFunc()),await Promise.all(n)}async onBatchBegin(t,e){null!=this.batchBegin&&(await Ji(e),await this.batchBegin(t,e))}async onBatchEnd(t,e){const n=[];null!=this.batchEnd&&(await Ji(e),n.push(this.batchEnd(t,e))),"batch"===this.yieldEvery?n.push(this.nextFrameFunc()):u.util.isNumber(this.yieldEvery)&&n.push(this.maybeWait(this.currentEpoch,t,e)),await Promise.all(n)}async onTrainBegin(t){null!=this.trainBegin&&(await Ji(t),await this.trainBegin(t))}async onTrainEnd(t){null!=this.trainEnd&&(await Ji(t),await this.trainEnd(t))}}function aa(t,e){return null==t&&(t={}),t instanceof ta?[t]:Array.isArray(t)&&t[0]instanceof ta?t:Fn(t).map((t=>new ia(t,e)))}class sa{constructor(){}static registerCallbackConstructor(t,e){u.util.assert(t>=0&&Number.isInteger(t),(()=>`Verbosity level is expected to be an integer >= 0, but got ${t}`)),sa.checkForDuplicate(e),null==sa.constructors[t]&&(sa.constructors[t]=[]),sa.constructors[t].push(e)}static checkForDuplicate(t){for(const e in sa.constructors)sa.constructors[+e].forEach((e=>{if(e===t)throw new Nn("Duplicate callback constructor.")}))}static clear(){sa.constructors={}}static createCallbacks(t){const e=[];for(const n in sa.constructors){const r=+n;t>=r&&e.push(...sa.constructors[r])}return e.map((t=>new t))}}function oa(t,e,n,r,i,a,s,o,l){const u=new ra,h=[new na,...sa.createCallbacks(e)];null!=t&&h.push(...t),h.push(u);const c=new ea(h);return c.setParams({epochs:n,initialEpoch:r,samples:i,steps:a,batchSize:s,verbose:e,doValidation:o,metrics:l}),{callbackList:c,history:u}}function la(t,e={},n=!1){return Wn(t,u.serialization.SerializationMap.getMap().classNameMap,e,"layer",n)}function ua(t,e){return(0,u.tidy)((()=>{"float32"!==t.dtype&&(t=u.cast(t,"float32"));const n=u.sum(jr(t),e,!0),r=u.fill(n.shape,An()),i=u.sqrt(u.maximum(n,r));return u.div(t,i)}))}function ha(t,e){return(0,u.tidy)((()=>u.mean(jr(u.sub(e,t)),-1)))}function ca(t,e){return(0,u.tidy)((()=>u.mean(u.abs(u.sub(e,t)),-1)))}function da(t,e){return(0,u.tidy)((()=>{const n=u.sub(t,e),r=u.clipByValue(u.abs(t),An(),Number.MAX_VALUE),i=u.abs(u.div(n,r));return u.mul(100,u.mean(i,-1))}))}function fa(t,e,n=!1){return(0,u.tidy)((()=>{if(n)e=u.softmax(e);else{const t=u.sum(e,e.shape.length-1,!0);e=u.div(e,t)}return e=u.clipByValue(e,An(),1-An()),u.neg(u.sum(u.mul(u.cast(t,"float32"),u.log(e)),e.shape.length-1))}))}function pa(t,e,n=!1){return(0,u.tidy)((()=>{const r=u.cast(u.floor(function(t){const e=[Ar(t.shape)];return u.reshape(t,e)}(t)),"int32"),i=(e=u.clipByValue(e,An(),1-An())).shape;return fa(u.reshape(u.oneHot(r,i[i.length-1]),i),e,n)}))}function ma(t,e){return(0,u.tidy)((()=>{let n;return n=u.clipByValue(e,An(),1-An()),n=u.log(u.div(n,u.sub(1,n))),u.mean(function(t,e){if(!u.util.arraysEqual(t.shape,e.shape))throw new Nn(`logits and labels must have the same shape, but got shapes ${JSON.stringify(t.shape)} and ${JSON.stringify(e.shape)}`);return(0,u.tidy)((()=>{const n=u.relu(e),r=u.neg(u.abs(e));return u.add(u.sub(n,u.mul(e,t)),u.log1p(u.exp(r)))}))}(t,n),-1)}))}function ga(t,e){return(0,u.tidy)((()=>{const n=ua(t,-1),r=ua(e,-1),i=u.mul(n,r);return u.neg(u.sum(i,-1))}))}sa.constructors={};const ba={meanSquaredError:ha,meanAbsoluteError:ca,meanAbsolutePercentageError:da,meanSquaredLogarithmicError:function(t,e){return(0,u.tidy)((()=>{const n=u.clipByValue(e,An(),Number.MAX_VALUE),r=u.log(u.add(1,n)),i=u.clipByValue(t,An(),Number.MAX_VALUE),a=u.log(u.add(1,i));return u.mean(jr(u.sub(r,a)),-1)}))},squaredHinge:function(t,e){return(0,u.tidy)((()=>{const n=u.maximum(0,u.sub(1,u.mul(t,e)));return u.mean(jr(n),-1)}))},hinge:function(t,e){return(0,u.tidy)((()=>{const n=u.maximum(0,u.sub(1,u.mul(t,e)));return u.mean(n,-1)}))},categoricalHinge:function(t,e){return(0,u.tidy)((()=>{const n=u.sum(u.mul(t,e),-1),r=u.max(u.mul(u.sub(1,t),e),-1);return u.maximum(0,u.add(1,u.sub(r,n)))}))},logcosh:function(t,e){return(0,u.tidy)((()=>{const n=Math.log(2),r=u.sub(e,t),i=u.sub(u.add(r,u.softplus(u.mul(-2,r))),n);return u.mean(i,-1)}))},categoricalCrossentropy:fa,sparseCategoricalCrossentropy:pa,binaryCrossentropy:ma,kullbackLeiblerDivergence:function(t,e){return(0,u.tidy)((()=>{const n=u.clipByValue(t,An(),1),r=u.clipByValue(e,An(),1);return u.sum(u.mul(t,u.log(u.div(n,r))),-1)}))},poisson:function(t,e){return(0,u.tidy)((()=>{const n=u.log(u.add(An(),e));return u.mean(u.sub(e,u.mul(t,n)),-1)}))},cosineProximity:ga};function ya(t){if("string"==typeof t){if(t in ba)return ba[t];let e=`Unknown loss ${t}`;throw t.toLowerCase().includes("softmaxcrossentropy")&&(e=`Unknown loss ${t}. Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy`),new Nn(e)}return t}function va(t,e){return(0,u.tidy)((()=>{const n=u.mul(.5,u.onesLike(e)),r=Cr(u.greater(e,n),t.dtype);return u.mean(u.equal(t,r),-1)}))}function wa(t,e){return(0,u.tidy)((()=>Cr(u.equal(u.argMax(t,-1),u.argMax(e,-1)),"float32")))}function _a(t,e){return(0,u.tidy)((()=>u.cast(u.sum(u.logicalAnd(u.equal(t,1),u.equal(e,1))),"float32")))}function ka(t,e){return(0,u.tidy)((()=>{const n=_a(t,e),r=function(t,e){return(0,u.tidy)((()=>u.cast(u.sum(u.logicalAnd(u.equal(t,0),u.equal(e,1))),"float32")))}(t,e),i=u.add(n,r);return u.cast(u.where(u.greater(i,0),u.div(n,i),0),"float32")}))}function xa(t,e){return ma(t,e)}function Sa(t,e){return t.rank===e.rank&&(t=u.squeeze(t,[t.rank-1])),(e=u.argMax(e,-1)).dtype!==t.dtype&&(e=u.cast(e,t.dtype)),u.cast(u.equal(t,e),"float32")}const Ea=fa,Ia=pa,Aa={binaryAccuracy:va,categoricalAccuracy:wa,precision:ka,categoricalCrossentropy:Ea,sparseCategoricalCrossentropy:Ia,mse:ha,MSE:ha,mae:ca,MAE:ca,mape:da,MAPE:da,cosine:ga};function Ma(t){if("string"==typeof t&&t in Aa)return Aa[t];if("string"!=typeof t&&null!=t)return t;throw new Nn(`Unknown metric ${t}`)}function Ta(t){if(Dn(null!==t,`Unknown LossOrMetricFn ${t}`),"string"==typeof t)return t;{let e;for(const n of Object.keys(ba))if(ba[n]===t){e=n;break}if(void 0!==e)return e;for(const n of Object.keys(Aa))if(Aa[n]===t){e=n;break}return void 0!==e?e:t.name}}function Na(t,e,n=!1){if(null==t||"object"!=typeof t||Object.getPrototypeOf(t)!==Object.prototype||!Ca(t))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(n){const n=JSON.stringify(t);n.length>1048576&&console.warn(`User-defined metadata of model "${e}" is too large in size (length=${n.length} when serialized). It is not recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= 1048576.`)}}function Ca(t){if(null===t)return!0;if("object"==typeof t){if(Object.getPrototypeOf(t)===Object.prototype){const e=Object.keys(t);for(const n of e){if("string"!=typeof n)return!1;if(!Ca(t[n]))return!1}return!0}if(Array.isArray(t)){for(const e of t)if(!Ca(e))return!1;return!0}return!1}{const e=typeof t;return"string"===e||"number"===e||"boolean"===e}}function Ra(t,e,n=console.log){let r="";for(let n=0;n<t.length;++n)n>0&&(r=r.slice(0,r.length-1)+" "),r+=t[n],r=r.slice(0,e[n]),r+=" ".repeat(e[n]-r.length);n(r)}function Oa(t,e,n){let r;try{r=JSON.stringify(t.outputShape)}catch(t){r="multiple"}Ra([`${t.name} (${t.getClassName()})`,r,t.countParams().toString()],e,n)}function Da(t,e,n,r){let i;try{i=JSON.stringify(t.outputShape)}catch(t){i="multiple"}const a=[];for(const e of t.inboundNodes)if(!(null!=n&&n.length>0&&-1===n.indexOf(e)))for(let t=0;t<e.inboundLayers.length;++t){const n=e.inboundLayers[t].name,r=e.nodeIndices[t],i=e.tensorIndices[t];a.push(`${n}[${r}][${i}]`)}const s=t.name,o=t.getClassName(),l=0===a.length?"":a[0];Ra([`${s} (${o})`,i,t.countParams().toString(),l],e,r);for(let t=1;t<a.length;++t)Ra(["","","",a[t]],e,r)}function za(t,e,n){return("inboundNodes"===t||"outputLayers"===t||"inputLayers"===t)&&0===e&&"string"==typeof n}function Ba(t,e){if(null===t)return null;if("string"==typeof t)return Ln(t);if("number"==typeof t||"boolean"==typeof t)return t;if(t instanceof Array){const n=[],r=t.length;for(let i=0;i<r;++i){const r=t[i];za(e,i,r)?n.push(r):n.push(Ba(r,e))}return n}{const e={};for(const n of Object.keys(t)){const r=t[n];if("name"===n&&"string"==typeof r)e[n]=r;else{const t=Ln(n);e[t]=Ba(r,t)}}return e}}function Fa(t,e){if(null==t)return null;if("string"==typeof t)return Pn(t);if("number"==typeof t||"boolean"==typeof t)return t;if(t instanceof Array){const n=[],r=t.length;for(let i=0;i<r;++i){const r=t[i];za(e,i,r)?n.push(r):n.push(Fa(r,e))}return n}{const e={};for(const n of Object.keys(t)){const r=t[n];e[Pn(n)]="name"!==n&&"className"!==n||"string"!=typeof r?Fa(r,n):r}return e}}const Pa="3.12.0";class La{constructor(t){if(this.id2Value={},this.id2Mask={},this.name2Id={},t instanceof La)for(const e in t.id2Value)this.id2Value[e]=t.id2Value[e],e in t.id2Mask&&(this.id2Mask[e]=t.id2Mask[e]);else{if(null==t)return;for(const e of t)this.add(e.key,e.value)}}add(t,e,n){if(null!=this.id2Value[t.id])throw new Nn(`Duplicate key: name=${t.name}, id=${t.id}`);return this.id2Value[t.id]=function(t,e){if(null==t.dtype||t.dtype===e.dtype)return e;try{return(0,u.cast)(e,t.dtype)}catch(n){throw new Nn(`The dtype of the feed (${e.dtype}) can not be cast to the dtype of the key '${t.name}' (${t.dtype}).`)}}(t,e),this.name2Id[t.name]=t.id,null!=n&&(this.id2Mask[t.id]=n),this}addFeed(t){this.add(t.key,t.value)}hasKey(t){return null!=this.id2Value[t.id]}names(){return Object.keys(this.name2Id)}getValue(t){if(t instanceof Wi){if(null==this.id2Value[t.id])throw new Nn(`Nonexistent key: ${t.name}`);return this.id2Value[t.id]}{const e=this.name2Id[t];if(null==e)throw new Nn(`Feed dict has no SymbolicTensor name: ${t}`);return this.id2Value[e]}}getMask(t){if(t instanceof Wi){if(null==this.id2Value[t.id])throw new Nn(`Nonexistent key: ${t.name}`);return this.id2Mask[t.id]}{const e=this.name2Id[t];if(null==e)throw new Nn(`Feed dict has no SymbolicTensor name: ${t}`);return this.id2Mask[e]}}disposeMasks(){null!=this.id2Mask&&(0,u.dispose)(this.id2Mask)}}const $a={},Ua={};function ja(t,e,n,r){const i=null!=n&&n.training,a=Array.isArray(t),s=a?t:[t],o=s.map((t=>t.name)),l=[],h=e.names();for(const t of o)-1!==h.indexOf(t)?l.push(e.getValue(t)):l.push(null);null!=r&&(r.maxNumTensors=-1/0,r.minNumTensors=1/0);const c=o.join(",")+"|"+e.names().join(",");let d,f;if(null==$a[c]){const t=function(t,e){u.util.assert(null!=t&&t.length>0,(()=>"Expected at least one fetch, got none"));let n=[],r={};if(1===t.length){const i=Ga(t[0],e);n=i.sorted,r=i.recipientMap}else{const i=new Set;for(const a of t){const{sorted:t,recipientMap:s}=Ga(a,e);for(const e of t)i.has(e.name)||(n.push(e),i.add(e.name));for(const t in s)null==r[t]&&(r[t]=new Set),s[t].forEach((e=>r[t].add(e)))}}return{sorted:n,recipientCounts:Wa(r)}}(s,e);d=t.sorted,f=t.recipientCounts,$a[c]=d,Ua[c]=f}d=$a[c],f={},i||Object.assign(f,Ua[c]);const p=new La(e);for(let t=0;t<d.length;++t){if(null!=r){const t=(0,u.memory)().numTensors;t>r.maxNumTensors&&(r.maxNumTensors=t),t<r.minNumTensors&&(r.minNumTensors=t)}const a=d[t],s=a.sourceLayer;if(s instanceof Zi)continue;const h=[],c=[],m=[];let g=!1;for(const t of a.inputs){const n=p.getValue(t),r=p.getMask(t);h.push(n),c.push(r),null!=r&&(g=!0),i||(f[t.name]--,0!==f[t.name]||e.hasKey(t)||-1!==o.indexOf(t.name)||n.isDisposed||!0===t.sourceLayer.stateful||m.push(n))}g&&((n=n||{}).mask=c[0]);const b=Fn(s.apply(h,n));let y=null;s.supportsMasking&&(y=s.computeMask(h,c));const v=Ha(a),w=Array.isArray(v)?v:[v];for(let t=0;t<w.length;++t){p.hasKey(w[t])||p.add(w[t],b[t],Array.isArray(y)?y[0]:y);const e=o.indexOf(w[t].name);-1!==e&&(l[e]=b[t])}i||(0,u.dispose)(m)}return p.disposeMasks(),a?l:l[0]}function Wa(t){const e={};for(const n in t)e[n]=t[n].size;return e}function Ga(t,e){const n=new Set,r=[],i={};for(const t of e.names())n.add(t);const a=[],s=[];for(a.push(t);a.length>0;){const t=a[a.length-1];if(n.has(t.name)){a.pop();continue}const e=s[s.length-1]===a.length-1;if(0===t.inputs.length||e)a.pop(),r.push(t),n.add(t.name),e&&s.pop();else{s.push(a.length-1);for(const e of t.inputs)null==i[e.name]&&(i[e.name]=new Set),i[e.name].add(t.name),n.has(e.name)||a.push(e)}}return{sorted:r,recipientMap:i}}function Ha(t){let e;if(1===t.sourceLayer.inboundNodes.length)e=t.sourceLayer.output;else{let n=null;for(let e=0;e<t.sourceLayer.inboundNodes.length;++e)for(const r of t.sourceLayer.inboundNodes[e].outputTensors)if(r.id===t.id){n=e;break}e=t.sourceLayer.getOutputAt(n)}return e}class Va extends qi{constructor(t){if(super({}),this.containerNodes=new Set,this.name=t.name,null==this.name){const t=this.getClassName().toLowerCase();this.name=Oi(t)}if(this.supportsMasking=!1,this.trainable_=!0,Array.isArray(t.inputs)?this.inputs=t.inputs.slice():this.inputs=[t.inputs],Array.isArray(t.outputs)?this.outputs=t.outputs.slice():this.outputs=[t.outputs],Hn(this.inputs).length!==this.inputs.length)throw new Nn(`The list of inputs passed to the model is redundant. All inputs should only appear once. Found: ${this.inputs.map((t=>t.name))}`);Hn(this.outputs).length!==this.outputs.length&&console.warn(`The list of outputs passed to the model is redundant. All outputs should only appear once. Found: ${this.outputs.map((t=>t.name))}`),this.inputLayers=[],this.inputLayersNodeIndices=[],this.inputLayersTensorIndices=[],this.outputLayers=[],this.outputLayersNodeIndices=[],this.outputLayersTensorIndices=[],this.layers=[],this.internalContainerRefs=[];for(const t of this.outputs){const e=t.sourceLayer,n=t.nodeIndex,r=t.tensorIndex;this.outputLayers.push(e),this.outputLayersNodeIndices.push(n),this.outputLayersTensorIndices.push(r)}for(const t of this.inputs){const e=t.sourceLayer,n=t.nodeIndex,r=t.tensorIndex;Dn(0===n,"input layer has >1 nodes"),Dn(0===r,"input layer has >1 tensors"),this.inputLayers.push(e),this.inputLayersNodeIndices.push(n),this.inputLayersTensorIndices.push(r)}this.inputNames=[],this.outputNames=[],this.feedInputShapes=[],this.feedInputNames=[],this.feedOutputNames=[];for(let e=0;e<this.inputLayers.length;e++){const n=this.inputLayers[e];if(!(n instanceof Zi))throw new TypeError(`Input layers to a LayersModel must be InputLayer objects. Received inputs: ${t.inputs}. Input ${e} (0-based) originates from layer type ${n.getClassName()}.`);this.inputNames.push(n.name),this.feedInputShapes.push(n.batchInputShape),this.feedInputNames.push(n.name)}for(const t of this.outputLayers)this.outputNames.push(t.name);this.internalInputShapes=this.inputs.map((t=>t.shape)),this.internalOutputShapes=this.outputs.map((t=>t.shape));const e={},n={},r={},i={},a={},s=[],o=(t,e,n,r,i,l)=>{null!=r&&null!=i&&null!=l||(r=t.sourceLayer,i=t.nodeIndex,l=t.tensorIndex);const u=r.inboundNodes[i];if(-1!==n.indexOf(u))throw new Tn(`The tensor ${t.name} at layer "${r.name}" is part of a cycle.`);if(-1!==e.indexOf(u))return;this.containerNodes.add(Va.nodeKey(r,i)),r.id in a||(a[r.id]=Object.keys(a).length),-1===n.indexOf(u)&&n.push(u);const h=u.inboundLayers.length;for(let t=0;t<h;t++){const r=u.inputTensors[t],i=u.inboundLayers[t],a=u.nodeIndices[t],s=u.tensorIndices[t];o(r,e,n,i,a,s)}for(e.push(u);n.indexOf(u)>=0;)n.splice(n.indexOf(u),1);s.push(u)},l=[],u=[];for(const t of this.outputs)o(t,l,u);const h=s.slice().reverse();for(const t of h){n[t.id]=t,t.id in e||(e[t.id]=0);let a=e[t.id];const s=null==r[t.outboundLayer.id]?0:r[t.outboundLayer.id];a=Math.max(a,s),r[t.outboundLayer.id]=a,i[t.outboundLayer.id]=t.outboundLayer,e[t.id]=a;for(let r=0;r<t.inboundLayers.length;r++){const i=t.inboundLayers[r],s=t.nodeIndices[r],o=i.inboundNodes[s],l=null==e[o.id]?0:e[o.id];e[o.id]=Math.max(a+1,l),n[o.id]=o}}const c={};for(const t in e){const r=e[t];r in c||(c[r]=[]),c[r].push(n[t])}const d={};for(const t in r){const e=r[t];e in d||(d[e]=[]),d[e].push(i[t])}let f=Object.keys(d).map((t=>parseInt(t,10))).sort(Gn);this.layers=[];for(const t of f){const e=d[t];e.sort(((t,e)=>{const n=a[t.id],r=a[e.id];return n<r?-1:n>r?1:0}));for(const t of e)t instanceof Va&&this.internalContainerRefs.push(t),this.layers.push(t)}this.layersByDepth=d,f=Object.keys(c).map((t=>parseInt(t,10))).sort(Gn);const p=this.inputs.slice(),m=[];for(const t of f)for(const e of c[t]){const t=e.outboundLayer;if(null!=t){for(const n of e.inputTensors)if(-1===p.indexOf(n))throw new Tn(`Graph disconnected: cannot obtain value for tensor ${n} at layer "${t.name}". The following previous layers were accessed without issue: ${m}`);for(const t of e.outputTensors)p.push(t);m.push(t.name)}}this.nodesByDepth=c;const g=this.layers.map((t=>t.name));for(const t of g){const e=g.filter((e=>e===t)).length;if(1!==e)throw new Tn(`The name "${t}" is used ${e} times in the model. All layer names should be unique. Layer names: `+JSON.stringify(g))}this.outboundNodes=[],this.inboundNodes=[],new Hi({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:this.inputs.map((t=>null)),outputMasks:this.outputs.map((t=>null)),inputShapes:this.inputs.map((t=>t.shape)),outputShapes:this.outputs.map((t=>t.shape))}),this.built=!0,this._refCount=1}assertNotDisposed(){if(0===this._refCount)throw new Error(`Container '${this.name}' is already disposed.`)}dispose(){this.assertNotDisposed();const t={refCountAfterDispose:null,numDisposedVariables:0};if(0==--this._refCount){for(const e of this.layers)t.numDisposedVariables+=e.dispose().numDisposedVariables;for(const e of this.internalContainerRefs)t.numDisposedVariables+=e.dispose().numDisposedVariables}return t.refCountAfterDispose=this._refCount,t}get trainable(){return this.trainable_}set trainable(t){this.layers.forEach((e=>{e._trainableWeights.forEach((e=>e.trainable=t))})),this.trainable_=t}get trainableWeights(){if(this._trainableWeights.length>0)throw new Nn("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];let t=[];for(const e of this.layers)t=t.concat(e.trainableWeights);return t}get nonTrainableWeights(){const t=[];for(const e of this.layers)t.push(...e.nonTrainableWeights);if(!this.trainable){const e=[];for(const t of this.layers)e.push(...t.trainableWeights);return e.concat(t)}return t}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}loadWeights(t,e=!0){const n={};let r=0;for(const t of this.layers)for(const e of t.weights){if(null!=n[e.originalName])throw new Nn(`Duplicate weight name: ${e.originalName}`);n[e.originalName]=e,r++}const i=[];for(const r in t){let a=r;if(null==n[r]){const t=r.split("/");a=t.slice(0,-2).concat([t[t.length-1]]).join("/")}if(null!=n[a])i.push([n[a],t[r]]);else if(e)throw new Nn(`Provided weight data has no target variable: ${r}`);delete n[a]}if(e){const t=[];for(const e in n)t.push(e);if(t.length>0)throw new Nn(`${t.length} of ${r} weights are not set: ${t}`)}Ui(i)}updatedConfig(){const t=this.getConfig(),e={};return e.className=this.getClassName(),e.config=t,e.kerasVersion=`tfjs-layers ${Pa}`,e.backend="TensorFlow.js",e}toJSON(t,e=!0){const n=Fa(this.updatedConfig());return e?JSON.stringify(n):n}call(t,e){return(0,u.tidy)((()=>{t=Fn(t);const n=new La;for(let e=0;e<this.inputs.length;++e)n.add(this.inputs[e],t[e]);return ja(this.outputs,n,e)}))}computeMask(t,e){return(0,u.tidy)((()=>{let n;return t=Fn(t),n=null==e?On(null,t.length):Fn(e),this.runInternalGraph(t,n)[1]}))}computeOutputShape(t){const e=zi(t);if(e.length!==this.inputLayers.length)throw new Nn(`Invalid inputShape argument ${t}: model has ${this.inputLayers.length} tensor inputs.`);const n={};for(let t=0;t<e.length;t++){const r=this.inputLayers[t],i=e[t];n[r.name+"_0_0"]=i}const r=Object.keys(this.nodesByDepth).map((t=>parseInt(t,10))).sort(Gn);if(r.length>1)for(const t of r){const e=this.nodesByDepth[t];for(const t of e){const e=t.outboundLayer;if(-1!==this.inputLayers.map((t=>t.id)).indexOf(e.id))continue;const r=[];for(let e=0;e<t.inboundLayers.length;e++){const i=t.inboundLayers[e],a=t.nodeIndices[e],s=t.tensorIndices[e],o=n[`${i.name}_${a}_${s}`];r.push(o)}const i=zi(e.computeOutputShape(Bn(r))),a=e.inboundNodes.indexOf(t);for(let t=0;t<i.length;t++)n[`${e.name}_${a}_${t}`]=i[t]}}const i=[],a=[];for(let t=0;t<this.outputLayers.length;t++){const e=this.outputLayers[t],n=this.outputLayersNodeIndices[t],r=this.outputLayersTensorIndices[t],i=`${e.name}_${n}_${r}`;a.push(i)}for(let t=0;t<a.length;t++){const e=a[t];Dn(e in n),i.push(n[e])}return Bn(i)}runInternalGraph(t,e){null==e&&(e=On(null,t.length));const n={};for(let r=0;r<this.inputs.length;++r){const i=this.inputs[r],a=t[r],s=e[r];n[i.id]=[a,s]}const r=Object.keys(this.nodesByDepth).map((t=>parseInt(t,10))).sort(Gn);for(const t of r){const e=this.nodesByDepth[t];for(const t of e){const e=t.outboundLayer,r=t.inputTensors,i=t.outputTensors,a=new Array;for(const t of r)t.id in n&&a.push(n[t.id]);if(a.length===r.length){let r,s,o,l,u={};if(null!=t.callArgs&&(u=t.callArgs),1===a.length){const[t,n]=a[0];null==u.mask&&(u.mask=n),o=Fn(e.call(t,u)),l=Fn(e.computeMask(t,n)),r=[t],s=[n]}else r=a.map((t=>t[0])),s=a.map((t=>t[1])),null==u.mask&&(u.mask=s),o=Fn(e.call(r,u)),l=Fn(e.computeMask(r,s));if(e.activityRegularizer)throw new Cn("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(let t=0;t<i.length;++t){const e=i[t],r=o[t],a=l[t];n[e.id]=[r,a]}}}}const i=[],a=[],s=[];for(const t of this.outputs){Dn(t.id in n,`Could not compute output ${t.name} : ${t.id}`);const[e,r]=n[t.id];s.push(e.shape),i.push(e),a.push(r)}return[i,a,s]}buildNodeConversionMap(t){const e={};let n;for(const t of this.layers){n=t instanceof Va?1:0;for(let r=0;r<t.inboundNodes.length;r++){const i=Va.nodeKey(t,r);this.containerNodes.has(i)&&(e[i]=n,n+=1)}}return e}getLayer(t,e){if(null!=e){if(this.layers.length<=e)throw new Nn(`Was asked to retrieve layer at index ${e}, but model only has ${this.layers.length} layer(s).`);return this.layers[e]}if(null==t)throw new Nn("Provide either a layer name or layer index");for(const e of this.layers)if(e.name===t)return e;throw new Nn(`No such layer: ${t}`)}calculateLosses(){return(0,u.tidy)((()=>{const t=[];for(const e of this.layers)for(let n=0;n<e.inboundNodes.length;++n){const r=Va.nodeKey(e,n);this.containerNodes.has(r)&&t.push(...e.calculateLosses())}return t}))}getConfig(){const t={name:this.name},e=this.buildNodeConversionMap(this.layers),n=[];for(const t of this.layers){const r=t.getClassName(),i=t.getConfig(),a=[];for(let n=0;n<t.inboundNodes.length;n++){const r=t.inboundNodes[n],i=Va.nodeKey(t,n);let s={};if(this.containerNodes.has(i)){if(r.callArgs)try{JSON.stringify(r.callArgs),s=r.callArgs}catch(e){console.warn(`Layer ${t.name} was passed non-serializable keyword arguments: ${r.callArgs}. They will not be included in the serialized model (and thus will be missing at deserialization time).`),s={}}if(r.inboundLayers.length>0){const t=[];for(let n=0;n<r.inboundLayers.length;n++){const i=r.inboundLayers[n],a=r.nodeIndices[n],o=r.tensorIndices[n];let l=e[Va.nodeKey(i,a)];null==l&&(l=0),t.push([i.name,l,o,s])}a.push(t)}}}const s={};s.name=t.name,s.className=r,s.config=i,s.inboundNodes=a,n.push(s)}t.layers=n;const r=[];for(let t=0;t<this.inputLayers.length;t++){const n=this.inputLayers[t],i=this.inputLayersNodeIndices[t],a=Va.nodeKey(n,i);if(!this.containerNodes.has(a))continue;let s=e[a];null==s&&(s=0);const o=this.inputLayersTensorIndices[t];r.push([n.name,s,o])}t.inputLayers=r;const i=[];for(let t=0;t<this.outputLayers.length;t++){const n=this.outputLayers[t],r=this.outputLayersNodeIndices[t],a=Va.nodeKey(n,r);if(!this.containerNodes.has(a))continue;let s=e[a];null==s&&(s=0);const o=this.outputLayersTensorIndices[t];i.push([n.name,s,o])}return t.outputLayers=i,t}static fromConfig(t,e,n={},r=!1){const i={},a={};function s(t,e){t.name in a?a[t.name].push(e):a[t.name]=[e]}function o(t,e){const n=[];let r;for(const a of e){const o=a[0],l=a[1],u=a[2];if(r=null==a[3]?{}:a[3],!(o in i))return void s(t,e);const h=i[o];if(h.inboundNodes.length<=l)return void s(t,e);const c=h.inboundNodes[l];n.push(c.outputTensors[u])}n.length>0&&t.apply(Bn(n),r)}function l(t){const n=t.name,a=la(t,null!=e.customObjects?e.customObjects:{});a.setFastWeightInitDuringBuild(r),i[n]=a,t.inboundNodes.forEach((t=>{if(!(t instanceof Array))throw new Nn(`Corrupted configuration, expected array for nodeData: ${t}`);s(a,t)}))}const u=e.name,h=e.layers;for(const t of h)l(t);for(;!Vn(a);)for(const t of h){const e=i[t.name];if(e.name in a){const t=a[e.name];delete a[e.name];for(const n of t)o(e,n)}}const c=[],d=[],f=e.inputLayers;for(const t of f){const e=t[0],n=t[1],r=t[2];Dn(e in i);const a=i[e].inboundNodes[n].outputTensors;c.push(a[r])}const p=e.outputLayers;for(const t of p){const e=t[0],n=t[1],r=t[2];Dn(e in i);const a=i[e].inboundNodes[n].outputTensors;d.push(a[r])}return new t({inputs:c,outputs:d,name:u})}get stateful(){if(this._stateful)throw new Nn("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(const t of this.layers)if(t.stateful)return!0;return!1}resetStates(){(0,u.tidy)((()=>{this.layers.forEach((t=>{t.stateful&&t.resetStates()}))}))}}function qa(t,e){return function(t,e,n){const r=e.length;if(null==t||Array.isArray(t)&&0===t.length)return e.map((t=>null));if(1===r)return Array.isArray(t)&&1===t.length?t:"object"==typeof t&&e[0]in t?[t[e[0]]]:[t];if(Array.isArray(t)){if(t.length!==r)throw new Error(`Provided ${n} is an array of ${t.length} element(s), but the model has ${r} outputs. Make sure a set of weights is provided for each model output.`);return t}if("object"==typeof t&&Object.keys(t).length>0&&"object"==typeof t[Object.keys(t)[0]]){const n=[];return e.forEach((e=>{e in t?n.push(t[e]):n.push(null)})),n}throw new Error(`The model has multiple (${r}) outputs, so ${n} must be either an array with ${r} elements or an object with ${e} keys. Provided ${n} not understood: ${JSON.stringify(t)}`)}(t,e,"classWeight")}async function Ka(t,e,n,r){if(null!=e||null!=r)throw new Error("Support sampleWeight is not implemented yet");if(null!=n){const e=(0,u.tidy)((()=>{if(1===t.shape.length)return(0,u.clone)(t);if(2===t.shape.length){if(t.shape[1]>1){const e=1;return(0,u.argMax)(t,e)}if(1===t.shape[1])return(0,u.reshape)(t,[t.shape[0]]);throw new Error(`Encountered unexpected last-dimension size (${t.shape[1]}) during handling of class weights. The size is expected to be >= 1.`)}throw new Error(`Unexpected rank of target (y) tensor (${t.rank}) during handling of class weights. The rank is expected to be 1 or 2.`)})),r=Array.from(await e.data());(0,u.dispose)(e);const i=[];return r.forEach((t=>{if(null==n[t])throw new Error(`classWeight must contain all classes in the training data. The class ${t} exists in the data but not in classWeight`);i.push(n[t])})),(0,u.tensor1d)(i,"float32")}return null}function Za(t,e){return(0,u.mul)(t,e)}function Xa(t,e){let n,r;const i=e;n=i.xs,r=i.ys,u.util.assert(null!=n&&null!=r,(()=>`A Dataset iterator for fitDataset() is expected to generate objects of the form \`{xs: xVal, ys: yVal}\`, where the two values may be \`tf.Tensor\`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates ${e}`));const a=Ja("input",t.inputNames,n),s=Ja("output",t.outputNames,r),o=a[0].shape[0];u.util.assert(a.length===t.inputs.length,(()=>`LayersModel has ${t.inputs.length} inputs, but the dataset provides ${a.length} inputs.  (Expected input keys: ${JSON.stringify(t.inputNames)})`)),u.util.assert(s.length===t.outputs.length,(()=>`LayersModel has ${t.outputs.length} outputs, but the dataset provides ${s.length} outputs.  (Expected output keys: ${JSON.stringify(t.outputNames)})`));for(let e=0;e<a.length;e++)u.util.assert(a[e].shape[0]===o,(()=>`Batch size mismatch: input ${t.inputNames[e]} has ${a[e].shape[0]}; expected  ${o} based on input ${t.inputNames[0]}.`));for(let e=0;e<s.length;e++)u.util.assert(s[e].shape[0]===o,(()=>`Batch size mismatch: output ${t.outputNames[e]} has ${s[e].shape[0]}; expected  ${o} based on input ${t.inputNames[0]}.`));return{xs:a,ys:s}}function Ja(t,e,n){if(n instanceof u.Tensor)return[n];if(Array.isArray(n))return u.util.assert(n.length===e.length,(()=>`Received an array of ${n.length} Tensors, but expected ${e.length} to match the ${t} keys ${e}.`)),n;{const r=[];for(const i of e){if(null==n[i])throw new Nn(`The feature data generated by the dataset lacks the required ${t} key '${i}'.`);r.push(n[i])}return r}}function Ya(t){return"function"==typeof t.iterator}function Qa(t){u.util.assert(t>0&&Number.isInteger(t),(()=>`batchSize is required to be a positive integer, but got ${t}`))}function ts(t,e,n){return null==t?[null]:Array.isArray(t)?t.map((t=>Or(t,e,n-e))):Or(t,e,n-e)}function es(t,e){return u.tidy((()=>null==t?null:Array.isArray(t)?t.map((t=>es(t,e))):Ur(t,"int32"===e.dtype?e:u.cast(e,"int32"))))}function ns(t,e){const n=[];let r=0,i=null;for(;r<t;)i=r+e,i>=t&&(i=t),n.push([r,i]),r=i;return n}function rs(t){const e=[];t instanceof u.Tensor&&(t=[t]);for(let n=0;n<t.length;++n){const r=t[n];if(1===r.rank)e.push(Rr(r,1));else{if(0===r.rank)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");e.push(r)}}return e}function is(t,e){if(null==t)return;const n=[];if(e instanceof u.Tensor)n.push(e.id);else if(Array.isArray(e))e.forEach((t=>n.push(t.id)));else if(null!=e)for(const t in e){const r=e[t];n.push(r.id)}const r=[];if(t instanceof u.Tensor)-1===n.indexOf(t.id)&&r.push(t);else if(Array.isArray(t))t.forEach((t=>{-1===n.indexOf(t.id)&&r.push(t)}));else if(null!=t)for(const e in t){const i=t[e];-1===n.indexOf(i.id)&&r.push(i)}r.forEach((t=>{t.isDisposed||t.dispose()}))}function as(t){return Array.isArray(t)}function ss(t){return!function(t){return t instanceof u.Tensor}(t)&&!as(t)}function os(t,e,n,r=!0,i=""){if(null==e||0===e.length){if(null!=t){let e=!1;if(as(t)&&t.length>0)e=!0;else if(ss(t)){for(const n in t)if(t.hasOwnProperty(n)){e=!0;break}}else e=!0;if(e)throw new Nn(`Error when checking model ${i} expected no data, but got ${t}`)}return[]}if(null==t)return e.map((t=>null));let a;if(ss(t)){t=t,a=[];for(const n of e){if(null==t[n])throw new Nn(`No data provided for "${n}". Need data for each key in: ${e}`);a.push(t[n])}}else if(as(t)){if((t=t).length!==e.length)throw new Nn(`Error when checking model ${i}: the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see ${e.length} Tensor(s), but instead got the following list of Tensor(s): ${t}`);a=t}else{if(t=t,e.length>1)throw new Nn(`The model ${i} expects ${e.length} Tensor(s), but only received one Tensor. Found: Tensor with shape ${t.shape}`);a=[t]}if(a=rs(a),null!=n)for(let t=0;t<e.length;++t){if(null==n[t])continue;const s=a[t];if(s.shape.length!==n[t].length)throw new Nn(`Error when checking ${i}: expected ${e[t]} to have ${n[t].length} dimension(s). but got array with shape ${s.shape}`);for(let e=0;e<n[t].length;++e){if(0===e&&!r)continue;const a=s.shape[e],o=n[t][e];if(null!=o&&o>=0&&a!==o)throw new Nn(`${i} expected a batch of elements where each example has shape [${n[t].slice(1,n[t].length)}] (i.e.,tensor shape [*,${n[t].slice(1,n[t].length)}]) but the ${i} received an input with ${s.shape[0]} examples, each with shape [${s.shape.slice(1,s.shape.length)}] (tensor shape [${s.shape}])`)}}return a}function ls(t,e,n,r=!0,i=""){let a;if(Array.isArray(t)){if(t.length!==e.length)throw new Nn(`Error when checking model ${i}: the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see ${e.length} Tensor(s), but instead got ${t.length} Tensors(s).`);a=t}else{if(e.length>1)throw new Nn(`The model expects ${e.length} ${i} Tensors, but only received one Tensor. Found: array with shape ${JSON.stringify(t.shape)}.`);a=[t]}if(null!=n)for(let t=0;t<e.length;++t){if(null==n[t])continue;const s=a[t];if(s.shape.length!==n[t].length)throw new Nn(`Error when checking ${i}: expected ${e[t]} to have ${n[t].length} dimension(s), but got array with shape ${JSON.stringify(s.shape)}`);for(let a=0;a<n[t].length;++a){if(0===a&&!r)continue;const o=s.shape[a],l=n[t][a];if(null!=l&&l!==o)throw new Nn(`Error when checking ${i}: expected ${e[t]} to have shape ${JSON.stringify(n[t])} but got array with shape ${JSON.stringify(s.shape)}.`)}}}class us extends Va{constructor(t){super(t),this.isTraining=!1}summary(t,e,n=console.log){if(!this.built)throw new Nn("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");!function(t,e,n,r=console.log){const i=function(t){let e=!0;const n=[],r=[];for(const e in t.nodesByDepth)n.push(t.nodesByDepth[e]);for(const t of n){if(t.length>1||1===t.length&&t[0].inboundLayers.length>1){e=!1;break}r.push(...t)}if(e)for(const n of t.layers){let t=!1;for(const i of n.inboundNodes)if(-1!==r.indexOf(i)){if(t){e=!1;break}t=!0}if(!e)break}return e}(t),a=["Layer (type)","Output shape","Param #"];let s;if(i?(e=e||65,n=n||[.45,.85,1]):(e=e||98,n=n||[.33,.55,.67,1]),n[n.length-1]<=1&&(n=n.map((t=>Math.floor(e*t)))),!i){a.push("Receives inputs"),s=[];for(const e in t.nodesByDepth)s.push(...t.nodesByDepth[e])}r("_".repeat(e)),Ra(a,n,r),r("=".repeat(e));const o=t.layers;for(let t=0;t<o.length;++t)i?Oa(o[t],n,r):Da(o[t],n,s,r),r((t===o.length-1?"=":"_").repeat(e));t.checkTrainableWeightsConsistency();const l=function(t){let e;return e=null!=t.collectedTrainableWeights?Pi(t.collectedTrainableWeights):Pi(t.trainableWeights),e}(t),u=Pi(t.nonTrainableWeights);r(`Total params: ${l+u}`),r(`Trainable params: ${l}`),r(`Non-trainable params: ${u}`),r("_".repeat(e))}(this,t,e,n)}compile(t){if(null==t.loss&&(t.loss=[]),this.loss=t.loss,"string"==typeof t.optimizer)this.optimizer_=function(t){const e={Adagrad:()=>u.train.adagrad(.01),Adadelta:()=>u.train.adadelta(1,.95,An()),Adam:()=>u.train.adam(.001,.9,.999,An()),Adamax:()=>u.train.adamax(.002,.9,.999,An(),0),RMSProp:()=>u.train.rmsprop(.001,.9,0,An()),SGD:()=>u.train.sgd(.01)};if(e.adagrad=e.Adagrad,e.adadelta=e.Adadelta,e.adam=e.Adam,e.adamax=e.Adamax,e.rmsprop=e.RMSProp,e.sgd=e.SGD,t in e)return e[t]();throw new Nn(`Unknown Optimizer ${t}`)}(t.optimizer),this.isOptimizerOwned=!0;else{if(!(t.optimizer instanceof u.Optimizer))throw new Nn("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=t.optimizer,this.isOptimizerOwned=!1}let e=[];if(Array.isArray(t.loss)||"string"==typeof t.loss||"function"==typeof t.loss)if(Array.isArray(t.loss)){if(t.loss.length!==this.outputs.length)throw new Nn(`When passing an Array as loss, it should have one entry per model output. The model has ${this.outputs.length} output(s), but you passed loss=${t.loss}.`);const n=t.loss;e=n.map((t=>ya(t)))}else{const n=ya(t.loss);this.outputs.forEach((t=>{e.push(n)}))}else{t.loss=t.loss;for(const e in t.loss)if(-1===this.outputNames.indexOf(e))throw new Nn(`Unknown entry in loss dictionary: "${e}". Only expected the following keys: ${this.outputNames}`);for(const n of this.outputNames)null==t.loss[n]&&console.warn(`Output "${n}" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to ${n} during training`),e.push(ya(t.loss[n]))}this.lossFunctions=e,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(let t=0;t<this.outputs.length;++t){const e=this.internalOutputShapes[t],n=this.outputNames[t];this.feedOutputNames.push(n),this.feedOutputShapes.push(e),this.feedLossFns.push(this.lossFunctions[t])}const n=[];this.metrics=t.metrics,this.metricsNames=["loss"],this.metricsTensors=[],kr("loss",(()=>{for(let t=0;t<this.outputs.length;++t){if(-1!==n.indexOf(t))continue;const e=this.lossFunctions[t];this.outputs.length>1&&(this.metricsTensors.push([e,t]),this.metricsNames.push(this.outputNames[t]+"_loss"))}}));const r=function(t,e){if(null==t||Array.isArray(t)&&0===t.length)return e.map((t=>[]));let n;if("string"==typeof t||"function"==typeof t)n=[t];else{if(!Array.isArray(t)&&"object"!=typeof t)throw new TypeError(`Type of metrics argument not understood. Expected an string,function, Array, or Object, found: ${t}`);n=t}if(Array.isArray(n))return e.map((t=>n));{const t=[];for(const r of e){let e=n.hasOwnProperty(r)?n[r]:[];Array.isArray(e)||(e=[e]),t.push(e)}return t}}(t.metrics,this.outputNames),i=(t,e,n)=>{this.outputNames.length>1&&(e=this.outputNames[t]+"_"+e),this.metricsNames.push(e),this.metricsTensors.push([n,t])};kr("metric",(()=>{for(let t=0;t<this.outputs.length;++t)-1===n.indexOf(t)&&(e=>{let n,r,a;for(const s of e){if("string"==typeof s&&-1!==["accuracy","acc","crossentropy","ce"].indexOf(s)){const e=this.internalOutputShapes[t];let i;1===e[e.length-1]||this.lossFunctions[t]===ma?-1!==["accuracy","acc"].indexOf(s)?r=va:-1!==["crossentropy","ce"].indexOf(s)&&(r=xa):this.lossFunctions[t]===pa?-1!==["accuracy","acc"].indexOf(s)?r=Sa:-1!==["crossentropy","ce"].indexOf(s)&&(r=Ia):-1!==["accuracy","acc"].indexOf(s)?r=wa:-1!==["crossentropy","ce"].indexOf(s)&&(r=Ea),-1!==["accuracy","acc"].indexOf(s)?i="acc":-1!==["crossentropy","ce"].indexOf(s)&&(i="ce"),a=r,n=""+i}else{const t=Ma(s);a=t,n=""+Ta(s)}let e;kr(n,(()=>{e=a})),i(t,n,e)}})(r[t])})),this.collectedTrainableWeights=this.trainableWeights}checkTrainableWeightsConsistency(){null!=this.collectedTrainableWeights&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}evaluate(t,e,n={}){const r=null==n.batchSize?32:n.batchSize;Qa(r);const i=this.standardizeUserDataXY(t,e,!0,r);try{const a=i[0].concat(i[1]);this.makeTestFunction();const s=this.testFunction;return Bn(this.testLoop(s,a,r,n.verbose,n.steps))}finally{is(i[0],t),is(i[1],e)}}async evaluateDataset(t,e){return this.makeTestFunction(),async function(t,e,n){const r=null!=(n=n||{}).batches,i=t.testFunction;let a=[];if(n.verbose>0)throw new Cn("Verbose mode is not implemented yet.");u.util.assert(!r||n.batches>0&&Number.isInteger(n.batches),(()=>`Test loop expects \`batches\` to be a positive integer, but received ${JSON.stringify(n.batches)}`));const s="function"==typeof e.next?e:await e.iterator();let o=0,l=0;for(;!r||l<n.batches;){const e=await s.next();if(a=u.tidy((()=>{if(e.value){const{xs:n,ys:r}=Xa(t,e.value),s=n.concat(r),h=u.tidy((()=>i(s)));if(u.dispose(s),0===l)for(let t=0;t<h.length;++t)a.push((0,u.scalar)(0));const c=s[0].shape[0];for(let t=0;t<h.length;++t){const e=h[t],n=a[t];a[t]=u.tidy((()=>u.add(a[t],u.mul(c,e)))),l>0&&u.dispose(n)}u.dispose(h),o+=c,++l}return a})),e.done){r&&console.warn(`Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least \`batches\` batches (in this case, ${n.batches} batches). You may need to use the repeat() function when building your dataset.`);break}}for(let t=0;t<a.length;++t){const e=a[t];a[t]=u.div(a[t],o),u.dispose(e)}return Bn(a)}(this,t,e)}checkNumSamples(t,e,n,r="steps"){let i;if(null!=n){if(i=null,null!=e)throw new Nn(`If ${r} is set, batchSize must be null or undefined.Got batchSize = ${e}`)}else{if(null==t)throw new Nn(`Either the input data should have a defined shape, or ${r} shoud be specified.`);i=Array.isArray(t)?t[0].shape[0]:t.shape[0]}return i}execute(t,e){if(Array.isArray(e)&&0===e.length)throw new Nn("`outputs` is an empty Array, which is not allowed.");const n=Array.isArray(e),r=n?e:[e],i=this.retrieveSymbolicTensors(r),a=new La;if(t instanceof u.Tensor&&(t=[t]),Array.isArray(t)){if(t.length!==this.inputs.length)throw new Nn(`The number of inputs provided (${t.length}) does not match the number of inputs of this model (${this.inputs.length}).`);for(let e=0;e<this.inputs.length;++e)a.add(this.inputs[e],t[e])}else for(const e of this.inputs){const n=t[e.name];if(null==n)throw new Nn(`No value is provided for the model's input ${e.name}`);a.add(e,n)}const s=ja(i,a);return n?s:s[0]}retrieveSymbolicTensors(t){const e=On(null,t.length);let n=t.length;for(const r of this.layers){const i=Array.isArray(r.output)?r.output:[r.output],a=i.map((t=>t.name));for(let r=0;r<t.length;++r){const s=a.indexOf(t[r]);if(-1!==s&&(e[r]=i[s],n--),0===n)break}if(0===n)break}if(n>0){const n=[];throw e.forEach(((e,r)=>{null==e&&n.push(t[r])})),new Nn(`Cannot find SymbolicTensors for output name(s): ${JSON.stringify(n)}`)}return e}predictLoop(t,e=32,n=!1){return u.tidy((()=>{const r=this.checkNumSamples(t);if(n)throw new Cn("Verbose predictLoop() is not implemented yet.");const i=ns(r,e),a=this.outputs.map((t=>[]));for(let e=0;e<i.length;++e){const n=u.tidy((()=>{const n=i[e][0],r=i[e][1],a=ts(t,n,r),s=[];if(Array.isArray(a))for(let t=0;t<a.length;++t)s.push({key:this.inputs[t],value:a[t]});else s.push({key:this.inputs[0],value:a});const o=new La(s);return ja(this.outputs,o)}));n.forEach(((t,e)=>a[e].push(t)))}return Bn(a.map((t=>u.concat(t,0))))}))}predict(t,e={}){const n=rs(t);ls(n,this.inputNames,this.feedInputShapes,!1);try{const r=null==e.batchSize?32:e.batchSize;return Qa(r),this.predictLoop(n,r)}finally{is(n,t)}}predictOnBatch(t){ls(t,this.inputNames,this.feedInputShapes,!0);const e=(Array.isArray(t)?t[0]:t).shape[0];return this.predictLoop(t,e)}standardizeUserDataXY(t,e,n=!0,r){if(null==this.optimizer_)throw new Tn("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");const i=[];for(let t=0;t<this.feedOutputShapes.length;++t){const e=this.feedOutputShapes[t];this.feedLossFns[t]===pa?i.push(e.slice(0,e.length-1).concat([1])):i.push(e)}if(function(t,e,n){const r=Hn(t.map((t=>t.shape[0])));r.sort();const i=Hn(e.map((t=>t.shape[0])));if(i.sort(),r.length>1)throw new Nn(`All input Tensors (x) should have the same number of samples. Got array shapes: ${JSON.stringify(t.map((t=>t.shape)))}`);if(i.length>1)throw new Nn(`All target Tensors (y) should have the same number of samples. Got array shapes: ${JSON.stringify(e.map((t=>t.shape)))}`);if(r.length>0&&i.length>0&&!u.util.arraysEqual(r,i))throw new Nn(`Input Tensors should have the same number of samples as target Tensors. Found ${r[0]} input sample(s) and ${i[0]} target sample(s).`)}(t=os(t,this.feedInputNames,this.feedInputShapes,!1,"input"),e=os(e,this.feedOutputNames,i,!1,"target")),function(t,e,n){const r=[ha,ma,fa];for(let i=0;i<t.length;++i){const a=t[i],s=e[i],o=n[i];if(null!=s){if(s===fa&&1===a.shape[a.shape.length-1])throw new Nn(`You are passing a target array of shape ${a.shape} while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].`);if(-1!==r.indexOf(s)){const t=a.shape.slice(1),e=o.slice(1);for(let n=0;n<t.length;++n){const r=t[n],i=e[n];if(null!=i&&r!==i)throw new Nn(`A target Tensor with shape ${a.shape} was passed for an output of shape ${o}, while using a loss function that expects targets to have the same shape as the output.`)}}}}}(e,this.feedLossFns,this.feedOutputShapes),this.stateful&&null!=r&&r>0&&t[0].shape[0]%r!=0)throw new Nn(`In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size ${r}. Found: ${t[0].shape[0]} sample(s).`);return[t,e]}async standardizeUserData(t,e,n,r,i=!0,a){const[s,o]=this.standardizeUserDataXY(t,e,i,a);if(null!=n)throw new Error("sample weight is not supported yet.");let l=null;if(null!=r){const t=qa(r,this.outputNames);l=[];for(let e=0;e<t.length;++e)l.push(await Ka(o[e],null,t[e]))}return[s,o,l]}testLoop(t,e,n,r=0,i){return u.tidy((()=>{const a=this.checkNumSamples(e,n,i,"steps"),s=[];if(r>0)throw new Cn("Verbose mode is not implemented yet.");if(null!=i)throw new Cn("steps mode in testLoop() is not implemented yet");{const r=ns(a,n),i=(0,u.tensor1d)(Nr(0,a));for(let n=0;n<r.length;++n){const a=r[n][0],o=r[n][1],l=Or(i,a,o-a),h=es(e,l),c=t(h);if(0===n)for(let t=0;t<c.length;++t)s.push((0,u.scalar)(0));for(let t=0;t<c.length;++t){const e=c[t];s[t]=u.add(s[t],u.mul(o-a,e))}}for(let t=0;t<s.length;++t)s[t]=u.div(s[t],a)}return s}))}getDedupedMetricsNames(){const t=this.metricsNames,e=[];for(let n=0;n<t.length;++n){const r=t[n];let i=r;zn(t,r)>1&&(i+=`_${zn(t.slice(0,n),r)}`),e.push(i)}return e}makeTrainFunction(){return t=>{const e=[],n=t.slice(0,this.inputs.length),r=t.slice(this.inputs.length,this.inputs.length+this.outputs.length),i=t.slice(this.inputs.length+this.outputs.length,this.inputs.length+2*this.outputs.length),a=[],s=this.collectedTrainableWeights.map((t=>t.read())),o=this.optimizer_.minimize((()=>{const t=[];for(let e=0;e<this.inputs.length;++e)t.push({key:this.inputs[e],value:n[e]});const s=new La(t),o=ja(this.outputs,s,{training:!0});let l;for(let t=0;t<this.lossFunctions.length;++t){let n=(0,this.lossFunctions[t])(r[t],o[t]);null!=i[t]&&(n=Za(n,i[t]));const a=u.mean(n);e.push(a),l=0===t?n:u.add(l,n)}for(let t=0;t<this.metricsTensors.length;++t){let n;if(this.outputs.length>1&&t<this.outputs.length)n=e[t];else{const e=this.metricsTensors[t][0],i=this.metricsTensors[t][1];n=u.mean(e(r[i],o[i]))}u.keep(n),a.push(n)}return l=u.mean(l),this.calculateLosses().forEach((t=>{l=u.add(l,t)})),l}),!0,s);return[o].concat(a)}}makeTestFunction(){this.testFunction=t=>u.tidy((()=>{const e=[];let n;const r=t.slice(0,this.inputs.length),i=t.slice(this.inputs.length,this.inputs.length+this.outputs.length),a=[];for(let t=0;t<this.inputs.length;++t)a.push({key:this.inputs[t],value:r[t]});const s=new La(a),o=ja(this.outputs,s);for(let t=0;t<this.lossFunctions.length;++t){const r=this.lossFunctions[t],a=u.mean(r(i[t],o[t]));n=0===t?a:u.add(n,a),e.push(n)}for(let t=0;t<this.metricsTensors.length;++t){const n=this.metricsTensors[t][0],r=this.metricsTensors[t][1],a=u.mean(n(i[r],o[r]));e.push(a)}return e}))}async fit(t,e,n={}){return async function(t,e,n,r={}){if(t.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");let i,a,s,o,l,h,c;t.isTraining=!0;try{const d=null==r.batchSize?32:r.batchSize;Qa(d);const f=!1,p=await t.standardizeUserData(e,n,r.sampleWeight,r.classWeight,f,d);i=p[0],a=p[1],c=p[2];let m,g=!1;if(null!=r.validationData&&r.validationData.length>0){if(g=!0,2!==r.validationData.length)throw 3===r.validationData.length?new Cn("validationData including sample weights is not supported yet."):new Nn(`When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; ${r.validationData} is invalid.`);s=r.validationData[0],o=r.validationData[1];const e=!0,n=await t.standardizeUserData(s,o,null,null,e,d);l=n[0],h=n[1],m=l.concat(h)}else if(null!=r.validationSplit&&r.validationSplit>0&&r.validationSplit<1){g=!0;const t=Math.floor(i[0].shape[0]*(1-r.validationSplit)),e=i[0].shape[0];l=ts(i,t,e),i=ts(i,0,t),h=ts(a,t,e),a=ts(a,0,t),m=l.concat(h)}else null!=r.validationSteps&&(g=!0);const b=i.concat(a).concat(c);t.checkTrainableWeightsConsistency();const y=t.makeTrainFunction(),v=t.getDedupedMetricsNames();let w,_;g?(t.makeTestFunction(),w=t.testFunction,_=v.slice().concat(v.map((t=>"val_"+t)))):(w=null,m=[],_=v.slice());const k=aa(r.callbacks,r.yieldEvery),x=await async function(t,e,n,r,i,a,s,o,l,h,c,d,f,p,m){null==i&&(i=32),null==a&&(a=1),null==c&&(c=!0),null==f&&(f=0);let g=!1;null!=l&&null!=h&&(g=!0);const b=t.checkNumSamples(n,i,p,"steps_per_epoch");let y;null!=b&&(y=Nr(0,b)),null==s&&(s=1);const{callbackList:v,history:w}=oa(o,s,a,f,b,p,i,g,d);v.setModel(t),t.history=w,await v.onTrainBegin(),t.stopTraining_=!1;for(let s=f;s<a;++s){await v.onEpochBegin(s);const a={};{if("batch"===c)throw new Cn("batch shuffling is not implemneted yet");c&&u.util.shuffle(y);const s=(0,u.tensor1d)(y),o=ns(b,i);for(let c=0;c<o.length;++c){const d={};if(await v.onBatchBegin(c,d),u.tidy((()=>{const f=o[c][0],p=o[c][1],m=Or(s,f,p-f);d.batch=c,d.size=p-f;const b=es(n,m),y=e(b);for(let t=0;t<r.length;++t){const e=r[t],n=y[t];d[e]=n,u.keep(n)}if(c===o.length-1&&g){const e=t.testLoop(l,h,i);for(let t=0;t<r.length;++t){const n=r[t],i=e[t];u.keep(i),a["val_"+n]=i}}})),await v.onBatchEnd(c,d),Yi(d),t.stopTraining_)break}s.dispose()}if(await v.onEpochEnd(s,a),t.stopTraining_)break}return await v.onTrainEnd(),await t.history.syncData(),t.history}(t,y,b,v,d,r.epochs,r.verbose,k,w,m,r.shuffle,_,r.initialEpoch,null);return x}finally{t.isTraining=!1,is(i,e),is(a,n),is(l,s),is(h,o),null!=c&&u.dispose(c)}}(this,t,e,n)}async fitDataset(t,e){return async function(t,e,n){const r=null!=n.batchesPerEpoch;if(u.util.assert(null!=t.optimizer,(()=>"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig).")),u.util.assert(null!=n,(()=>"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call.")),u.util.assert(null!=n.epochs&&n.epochs>0&&Number.isInteger(n.epochs),(()=>`For fitDataset(), config.epochs is expected to be a positive integer, but got ${n.epochs}`)),u.util.assert(!r||n.batchesPerEpoch>0&&Number.isInteger(n.batchesPerEpoch),(()=>`For fitDataset(), config.batchesPerEpoch is expected to be a positive integer if specified, but got ${n.batchesPerEpoch}`)),u.util.assert(null==n.validationSplit,(()=>"`validationSplit` is not supported by `fitDataset()`. Use validationData instead.")),t.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");t.isTraining=!0;try{const i=null!=n.validationData;let a,s;if(i)if(Ya(n.validationData))u.util.assert(null==n.validationBatches||n.validationBatches>0&&Number.isInteger(n.validationBatches),(()=>`For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, but got ${n.validationBatches}`));else{const t=function(t){if(3===t.length)throw new Cn("Validation with sample weights is not implemented yet.");return{xs:t[0],ys:t[1]}}(n.validationData);a=t.xs,s=t.ys}const o=t.makeTrainFunction(),l=t.getDedupedMetricsNames();let h;h=i?l.slice().concat(l.map((t=>"val_"+t))):l.slice();const c=aa(n.callbacks,n.yieldEvery),d=null==n.verbose?1:n.verbose,{callbackList:f,history:p}=oa(c,d,n.epochs,null,null,function(t,e){let n=null;return null!=e.batchesPerEpoch?n=e.batchesPerEpoch:Number.isFinite(t.size)&&(n=t.size),n}(e,n),null,i,h);f.setModel(t),t.history=p,await f.onTrainBegin(),t.stopTraining_=!1;let m=null==n.initialEpoch?0:n.initialEpoch,g=await e.iterator();for(;m<n.epochs;){const h={};await f.onEpochBegin(m);let c=0,d=0;for(r||(g=await e.iterator());!r||c<n.batchesPerEpoch;){const e=await g.next();if(r&&e.done){console.warn(`You provided \`batchesPerEpoch\` as ${n.batchesPerEpoch}, but your dataset iterator ran out of data after ${c} batches; interrupting training. Make sure that your dataset can generate at least \`batchesPerEpoch * epochs\` batches (in this case, `+n.batchesPerEpoch*n.epochs+" batches). You may need to use the repeat() function when building your dataset.");break}if(null!=e.value){const{xs:r,ys:i}=Xa(t,e.value),a={};a.batch=d,a.size=r[0].shape[0],await f.onBatchBegin(d,a);const s=[];if(null!=n.classWeight){const e=qa(n.classWeight,t.outputNames);for(let t=0;t<e.length;++t)s.push(await Ka(i[t],null,e[t]))}const h=r.concat(i).concat(s),p=o(h);u.dispose(h);for(let t=0;t<l.length;++t){const e=l[t],n=p[t];a[e]=n,u.keep(n)}await f.onBatchEnd(d,a),Yi(a),d++,c++}if(r?c>=n.batchesPerEpoch:e.done){if(i){let e;e=Ya(n.validationData)?Fn(await t.evaluateDataset(n.validationData,{batches:n.validationBatches})):Fn(t.evaluate(a,s,{batchSize:null==n.validationBatchSize?32:n.validationBatchSize,verbose:0}));for(let n=0;n<t.metricsNames.length;++n)h[`val_${t.metricsNames[n]}`]=e[n]}break}if(t.stopTraining_)break}if(await f.onEpochEnd(m,h),m++,t.stopTraining_)break}return await f.onTrainEnd(),await t.history.syncData(),t.history}finally{t.isTraining=!1}}(this,t,e)}async trainOnBatch(t,e){const n=await this.standardizeUserData(t,e),r=n[0],i=n[1],a=this.makeTrainFunction()(r.concat(i)),s=[];for(const t of a){const e=await t.data();s.push(e[0])}return u.dispose(a),Bn(s)}getNamedWeights(t){const e=[],n=null!=t&&t.trainableOnly,r=n?this.trainableWeights:this.weights,i=this.getWeights(n);for(let t=0;t<r.length;++t)n&&!r[t].trainable||e.push({name:r[t].originalName,tensor:i[t]});return e}set stopTraining(t){this.stopTraining_=t}get stopTraining(){return this.stopTraining_}get optimizer(){return this.optimizer_}set optimizer(t){this.optimizer_!==t&&(this.optimizer_=t,this.isOptimizerOwned=!1)}dispose(){const t=super.dispose();if(0===t.refCountAfterDispose&&null!=this.optimizer&&this.isOptimizerOwned){const e=u.memory().numTensors;this.optimizer_.dispose(),t.numDisposedVariables+=e-u.memory().numTensors}return t}getLossIdentifiers(){let t;if("string"==typeof this.loss)t=Pn(this.loss);else if(Array.isArray(this.loss)){for(const t of this.loss)if("string"!=typeof t)throw new Error("Serialization of non-string loss is not supported.");t=this.loss.map((t=>Pn(t)))}else{const e=Object.keys(this.loss);t={};const n=this.loss;for(const r of e){if("string"!=typeof n[r])throw new Error("Serialization of non-string loss is not supported.");t[r]=Pn(n[r])}}return t}getMetricIdentifiers(){if("string"==typeof this.metrics||"function"==typeof this.metrics)return[Pn(Ta(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map((t=>Pn(Ta(t))));{const t={};for(const e in this.metrics)t[e]=Pn(Ta(this.metrics[e]));return t}}getTrainingConfig(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}loadTrainingConfig(t){if(null!=t.weighted_metrics)throw new Error("Loading weight_metrics is not supported yet.");if(null!=t.loss_weights)throw new Error("Loading loss_weights is not supported yet.");if(null!=t.sample_weight_mode)throw new Error("Loading sample_weight_mode is not supported yet.");const e=la(Ba(t.optimizer_config));let n,r;if("string"==typeof t.loss)n=Ln(t.loss);else if(Array.isArray(t.loss))n=t.loss.map((t=>Ln(t)));else if(null!=t.loss){n={};for(const e in t.loss)n[e]=Ln(t.loss[e])}if(Array.isArray(t.metrics))r=t.metrics.map((t=>Ln(t)));else if(null!=t.metrics){r={};for(const e in t.metrics)r[e]=Ln(t.metrics[e])}this.compile({loss:n,metrics:r,optimizer:e})}async save(t,e){if("string"==typeof t){const e=u.io.getSaveHandlers(t);if(0===e.length)throw new Nn(`Cannot find any save handlers for URL '${t}'`);if(e.length>1)throw new Nn(`Found more than one (${e.length}) save handlers for URL '${t}'`);t=e[0]}if(null==t.save)throw new Nn("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");const n=await u.io.encodeWeights(this.getNamedWeights(e)),r={modelTopology:this.toJSON(null,!1),format:"layers-model",generatedBy:`TensorFlow.js tfjs-layers v${Pa}`,convertedBy:null};if(null!=e&&e.includeOptimizer&&null!=this.optimizer){r.trainingConfig=this.getTrainingConfig();const t="optimizer",{data:e,specs:i}=await u.io.encodeWeights(await this.optimizer.getWeights(),t);n.specs.push(...i),n.data=u.io.concatenateArrayBuffers([n.data,e])}if(null!=this.userDefinedMetadata){const t=!0;Na(this.userDefinedMetadata,this.name,t),r.userDefinedMetadata=this.userDefinedMetadata}return r.weightData=n.data,r.weightSpecs=n.specs,t.save(r)}setUserDefinedMetadata(t){Na(t,this.name),this.userDefinedMetadata=t}getUserDefinedMetadata(){return this.userDefinedMetadata}}us.className="Model",u.serialization.registerClass(us);class hs extends us{}async function cs(t,e){"modelTopology"in t||(t={modelTopology:t});let n=(t=t).modelTopology;null!=n.model_config&&(n=n.model_config);const r=la(Ba(n),e);if(null!=t.weightsManifest){const e=await u.io.loadWeights(t.weightsManifest,t.pathPrefix,r.weights.map((t=>t.originalName))),n={};for(const t of r.weights)n[t.originalName]=e[t.originalName];r.loadWeights(n),(0,u.dispose)(e)}return r}hs.className="Functional",u.serialization.registerClass(hs);class ds extends us{constructor(t){if(super({inputs:[],outputs:[]}),t=t||{},this.trainable=!0,this.built=!1,this.name=null!=t.name?t.name:Oi("sequential_"),null!=t.layers)for(const e of t.layers)this.add(e)}checkShape(t){if(t.inboundNodes[0].outputTensors[0].shape.some((t=>t<0)))throw new Nn(`Negative dimension size caused by adding layer ${t.name} with input shape [${t.inboundNodes[0].inputTensors[0].shape}]`)}add(t){const e=t instanceof ds||t instanceof us;let n;if(e){if(n=t,1!==n.outputs.length)throw new Nn("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(1!==n.inputs.length)throw new Nn("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(0===this.outputs.length){if(0===t.inboundNodes.length){if(null==t.batchInputShape)throw new Nn("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");const e=Xi({batchShape:t.batchInputShape,dtype:t.dtype,name:t.name+"_input"});t.apply(e)}if(e)this.outputs=n.outputs,this.inputs=n.inputs;else{if(1!==t.inboundNodes.length)throw new Nn(`A layer added to a Sequential model must not already be connected somewhere else. LayersModel received layer ${t.name} which has ${t.inboundNodes.length} pre-existing inbound connections.`);if(1!==t.inboundNodes[0].outputTensors.length)throw new Nn("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(t),this.outputs=[t.inboundNodes[0].outputTensors[0]],this.inputs=Ki(this.outputs[0])}this.inboundNodes=[],new Hi({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:On(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map((t=>t.shape)),outputShapes:this.outputs[0].shape})}else{const e=t.apply(this.outputs[0]);if(Array.isArray(e))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(t),this.outputs=[e],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(t),this.built=!1}pop(){if(0===this.layers.length)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),0===this.layers.length)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{const t=this.layers.length-1;this.layers[t].outboundNodes=[],this.outputs=[this.layers[t].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}call(t,e){return null==this.model&&this.build(),this.model.call(t,e)}build(t){if(Fi(t),0===this.inputs.length||0===this.outputs.length)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new us({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}countParams(){return this.built||this.build(),super.countParams()}summary(t,e,n=console.log){this.built||this.build(),super.summary(t,e,n)}setWeights(t){null==this.model&&this.build(),this.model.setWeights(t)}evaluate(t,e,n={}){if(!this.built)throw new Tn("The model needs to be compiled before being used.");return this.model.evaluate(t,e,n)}async evaluateDataset(t,e){if(!this.built)throw new Tn("The model needs to be compiled before being used.");return this.model.evaluateDataset(t,e)}predict(t,e={}){return null==this.model&&this.build(),this.model.predict(t,e)}predictOnBatch(t){return null==this.model&&this.build(),this.model.predictOnBatch(t)}compile(t){this.build(),this.model.compile(t),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}get optimizer(){return null==this.model?void 0:this.model.optimizer}set optimizer(t){this.model.optimizer=t}async fit(t,e,n={}){if(!this.built)throw new Tn("The model needs to be compiled before being used.");return this.model.fit(t,e,n)}async fitDataset(t,e){if(!this.built)throw new Tn("The model needs to be compiled before being used.");return this.model.fitDataset(t,e)}async trainOnBatch(t,e){return this.model.trainOnBatch(t,e)}static fromConfig(t,e,n={},r=!1){let i,a={};if(e instanceof Array){if(null==e[0].className||"Merge"===e[0].className)throw new Nn("Legacy serialization format not supported yet.");i=e}else u.util.assert(null!=e.layers,(()=>"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field.")),i=e.layers,delete e.layers,a=e;const s=new t(a);if(!(s instanceof ds))throw new Cn(`Sequential.fromConfig called on non-Sequential input: ${s}`);for(const t of i){const e=la(t,void 0,r);r&&e.setFastWeightInitDuringBuild(!0),s.add(e)}return s}set stopTraining(t){if(null==this.model)throw new Nn("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=t}get stopTraining(){if(null==this.model)throw new Nn("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining}getConfig(){const t=[];for(const e of this.layers){const n={};n.className=e.getClassName(),n.config=e.getConfig(),t.push(n)}return{name:this.name,layers:t}}}function fs(t){return new us(t)}function ps(t){return new ds(t)}function ms(t,e){return null==e&&(e={}),async function(t,e){if(null==e&&(e={}),"string"==typeof t){const n=u.io.getLoadHandlers(t,e);if(0===n.length)n.push(u.io.browserHTTPRequest(t,e));else if(n.length>1)throw new Nn(`Found more than one (${n.length}) load handlers for URL '${t}'`);t=n[0]}return async function(t,e,n){if(null==n&&(n={}),null==t.load)throw new Nn("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");const r=await t.load();let i=r.modelTopology;null!=i.model_config&&(i=i.model_config);const a=null==n.strict||n.strict,s=null!=r.weightData&&null!=r.weightSpecs&&a,o=la(Ba(i),void 0,s),l=r.trainingConfig;if(null!=l&&o.loadTrainingConfig(l),null!=r.userDefinedMetadata&&o.setUserDefinedMetadata(r.userDefinedMetadata),null!=r.weightData){if(null==r.weightSpecs)throw new Nn("LayersModel artifacts contains weight data, but not weight specs. Therefore loading of weights cannot proceed.");const{modelWeights:t,optimizerWeights:e}=function(t,e){const n=u.io.decodeWeights(t,e),r={},i=[];return e.forEach((t=>{"optimizer"===t.group?i.push({name:t.name,tensor:n[t.name]}):r[t.name]=n[t.name]})),{modelWeights:r,optimizerWeights:i}}(r.weightData,r.weightSpecs);o.loadWeights(t,a),null!=o.optimizer&&e.length>0&&await o.optimizer.setWeights(e),(0,u.dispose)(t),(0,u.dispose)(e.map((t=>t.tensor)))}return o}(t,0,e)}(t,e)}function gs(t){return Xi(t)}function bs(t,e){sa.registerCallbackConstructor(t,e)}ds.className="Sequential",u.serialization.registerClass(ds);class ys extends u.serialization.Serializable{getConfig(){return{}}}class vs extends ys{apply(t,e=1){return function(t,e=1){if(1!==e)throw new Cn(`Support for alpha values other than 1 (${e}) is not implemented yet.`);return u.elu(t)}(t,e)}}vs.className="elu",u.serialization.registerClass(vs);class ws extends ys{apply(t){return u.selu(t)}}ws.className="selu",u.serialization.registerClass(ws);class _s extends ys{apply(t){return u.relu(t)}}_s.className="relu",u.serialization.registerClass(_s);class ks extends ys{apply(t){return(0,u.tidy)((()=>u.minimum(6,u.relu(t))))}}ks.className="relu6",u.serialization.registerClass(ks);class xs extends ys{apply(t){return t}}xs.className="linear",u.serialization.registerClass(xs);class Ss extends ys{apply(t){return u.sigmoid(t)}}Ss.className="sigmoid",u.serialization.registerClass(Ss);class Es extends ys{apply(t){return function(t){return(0,u.tidy)((()=>{const e=u.add(.5,u.mul(.2,t));return u.clipByValue(e,0,1)}))}(t)}}Es.className="hardSigmoid",u.serialization.registerClass(Es);class Is extends ys{apply(t){return u.softplus(t)}}Is.className="softplus",u.serialization.registerClass(Is);class As extends ys{apply(t){return function(t){return(0,u.tidy)((()=>u.div(t,u.add(u.abs(t),1))))}(t)}}As.className="softsign",u.serialization.registerClass(As);class Ms extends ys{apply(t){return u.tanh(t)}}Ms.className="tanh",u.serialization.registerClass(Ms);class Ts extends ys{apply(t,e=-1){return u.softmax(t,e)}}Ts.className="softmax",u.serialization.registerClass(Ts);class Ns extends ys{apply(t,e=-1){return u.logSoftmax(t,e)}}Ns.className="logSoftmax",u.serialization.registerClass(Ns);class Cs extends ys{apply(t,e=1){return(0,u.tidy)((()=>u.mul(u.sigmoid(u.mul(t,e)),t)))}}Cs.className="swish",u.serialization.registerClass(Cs);class Rs extends ys{apply(t){return(0,u.tidy)((()=>u.mul(t,u.tanh(u.softplus(t)))))}}function Os(t){return t.getClassName()}function Ds(t,e={}){return Wn(t,u.serialization.SerializationMap.getMap().classNameMap,e,"activation")}function zs(t){if(null==t){return Ds({className:"linear",config:{}})}if("string"==typeof t){const e={};return e.className=t,e.config={},Ds(e)}return t instanceof ys?t:Ds(t)}function Bs(t){if(null!=t&&"object"!=typeof t)throw new Error(`Argument to L1L2 regularizer's constructor is expected to be an object, but received: ${t}`)}Rs.className="mish",u.serialization.registerClass(Rs);class Fs extends u.serialization.Serializable{}class Ps extends Fs{constructor(t){super(),Bs(t),this.l1=null==t||null==t.l1?.01:t.l1,this.l2=null==t||null==t.l2?.01:t.l2,this.hasL1=0!==this.l1,this.hasL2=0!==this.l2}apply(t){return(0,u.tidy)((()=>{let e=(0,u.zeros)([1]);return this.hasL1&&(e=(0,u.add)(e,(0,u.sum)(u.mul(this.l1,(0,u.abs)(t))))),this.hasL2&&(e=(0,u.add)(e,(0,u.sum)(u.mul(this.l2,jr(t))))),u.reshape(e,[])}))}getConfig(){return{l1:this.l1,l2:this.l2}}static fromConfig(t,e){return new t({l1:e.l1,l2:e.l2})}}Ps.className="L1L2",u.serialization.registerClass(Ps);const Ls={l1l2:"L1L2"};function $s(t){return Un(t)}function Us(t,e={}){return Wn(t,u.serialization.SerializationMap.getMap().classNameMap,e,"regularizer")}function js(t){return null==t?null:"string"==typeof t?Us({className:t in Ls?Ls[t]:t,config:{}}):t instanceof Fs?t:Us(t)}class Ws extends qi{constructor(t){super(null==t?{}:t),this.supportsMasking=!0,null!=t&&(this.maxValue=t.maxValue)}call(t,e){t=Bi(t);let n=(0,u.relu)(t);return null!=this.maxValue&&(n=(0,u.clipByValue)(n,0,this.maxValue)),n}computeOutputShape(t){return t}getConfig(){const t={maxValue:this.maxValue},e=super.getConfig();return Object.assign(t,e),t}}Ws.className="ReLU",u.serialization.registerClass(Ws);class Gs extends qi{constructor(t){super(null==t?{}:t),this.DEFAULT_ALPHA=.3,null==t&&(t={}),this.alpha=null==t.alpha?this.DEFAULT_ALPHA:t.alpha}call(t,e){const n=Bi(t);return(0,u.leakyRelu)(n,this.alpha)}computeOutputShape(t){return t}getConfig(){const t={alpha:this.alpha},e=super.getConfig();return Object.assign(t,e),t}}Gs.className="LeakyReLU",u.serialization.registerClass(Gs);class Hs extends qi{constructor(t){if(super(null==t?{}:t),this.DEFAULT_ALPHA_INITIALIZER="zeros",null==t&&(t={}),this.supportsMasking=!0,this.alphaInitializer=pi(t.alphaInitializer||this.DEFAULT_ALPHA_INITIALIZER),this.alphaRegularizer=js(t.alphaRegularizer),this.alphaConstraint=or(t.alphaConstraint),null==t.sharedAxes)this.sharedAxes=null;else if(Array.isArray(t.sharedAxes))this.sharedAxes=t.sharedAxes;else{if("number"!=typeof t.sharedAxes)throw new Nn(`Expected sharedAxes to be a number or an array of numbers, but got ${t.sharedAxes}`);this.sharedAxes=[t.sharedAxes]}}build(t){const e=(t=Fi(t)).slice(1);if(null!=this.sharedAxes)for(const t of this.sharedAxes)e[t-1]=1;this.alpha=this.addWeight("alpha",e,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);const n={};if(null!=this.sharedAxes)for(let e=1;e<t.length;++e)n[e]=t[e];this.inputSpec=[new ji({ndim:t.length,axes:n})],this.built=!0}call(t,e){return t=Bi(t),(0,u.prelu)(t,this.alpha.read())}getConfig(){const t={alphaInitializer:fi(this.alphaInitializer),alphaRegularizer:$s(this.alphaRegularizer),alphaConstraint:ar(this.alphaConstraint),sharedAxes:this.sharedAxes},e=super.getConfig();return Object.assign(t,e),t}}Hs.className="PReLU",u.serialization.registerClass(Hs);class Vs extends qi{constructor(t){if(super(null==t?{}:t),this.DEFAULT_ALPHA=1,null==t&&(t={}),null!=t.alpha&&t.alpha!==this.DEFAULT_ALPHA)throw new Cn(`Non-default alpha value (${t.alpha}) is not supported by the ELU layer yet.`);this.alpha=null==t.alpha?this.DEFAULT_ALPHA:t.alpha}call(t,e){const n=Bi(t);return(0,u.elu)(n)}computeOutputShape(t){return t}getConfig(){const t={alpha:this.alpha},e=super.getConfig();return Object.assign(t,e),t}}Vs.className="ELU",u.serialization.registerClass(Vs);class qs extends qi{constructor(t){super(null==t?{}:t),this.DEFAULT_THETA=1,null==t&&(t={}),this.theta=null==t.theta?this.DEFAULT_THETA:t.theta}call(t,e){const n=Bi(t);return(0,u.mul)(n,(0,u.cast)((0,u.greater)(n,this.theta),"float32"))}computeOutputShape(t){return t}getConfig(){const t={theta:this.theta},e=super.getConfig();return Object.assign(t,e),t}}qs.className="ThresholdedReLU",u.serialization.registerClass(qs);class Ks extends qi{constructor(t){super(null==t?{}:t),this.DEFAULT_AXIS=1,null==t&&(t={}),this.softmax=(new Ts).apply,this.axis=null==t.axis?this.DEFAULT_AXIS:t.axis}call(t,e){const n=Bi(t);return this.softmax(n,this.axis)}computeOutputShape(t){return t}getConfig(){const t={axis:this.axis},e=super.getConfig();return Object.assign(t,e),t}}function Zs(t,e,n){if("number"==typeof t)return On(t,e);if(t.length!==e)throw new Nn(`The ${n} argument must be an integer or tuple of ${e} integers. Received: ${t.length} elements.`);for(let i=0;i<e;++i){const a=t[i];if((r=a)!==parseInt(r.toString(),10))throw new Nn(`The ${n} argument must be an integer or tuple of ${e} integers. Received: ${JSON.stringify(t)} including a non-integer number ${a}`)}return t;var r}function Xs(t,e,n,r,i=1){if(null==t)return t;let a;return a="same"===n?t:t-(e+(e-1)*(i-1))+1,Math.floor((a+r-1)/r)}function Js(t,e,n,r){if(null==t)return null;if("valid"===r)t=t*e+Tr([n-e,0]);else{if("same"!==r)throw new Nn(`Unsupport padding mode: ${r}.`);t*=e}return t}function Ys(t,e){return(0,u.tidy)((()=>(yr(e),"channelsFirst"===e?u.transpose(t,[0,2,3,1]):t)))}function Qs(t,e){return(0,u.tidy)((()=>(yr(e),"channelsFirst"===e?u.transpose(t,[0,2,3,4,1]):t)))}function to(t,e,n,r=[1,1],i="valid",a,s,o=null){return(0,u.tidy)((()=>{if(null==a&&(a="channelsLast"),yr(a),3!==t.rank&&4!==t.rank)throw new Nn(`conv2dWithBiasActivation expects input to be of rank 3 or 4, but received ${t.rank}.`);if(3!==e.rank&&4!==e.rank)throw new Nn(`conv2dWithBiasActivation expects kernel to be of rank 3 or 4, but received ${t.rank}.`);let l=Ys(t,a);if("causal"===i)throw new Cn("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return l=u.fused.conv2d({x:l,filter:e,strides:r,pad:"same"===i?"same":"valid",dilations:s,dataFormat:"NHWC",bias:n,activation:o}),"channelsFirst"===a&&(l=u.transpose(l,[0,3,1,2])),l}))}Ks.className="Softmax",u.serialization.registerClass(Ks);class eo extends qi{constructor(t,e){if(super(e),this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",eo.verifyArgs(e),this.rank=t,Zn(this.rank,"rank"),1!==this.rank&&2!==this.rank&&3!==this.rank)throw new Cn(`Convolution layer for rank other than 1, 2, or 3 (${this.rank}) is not implemented yet.`);if(this.kernelSize=Zs(e.kernelSize,t,"kernelSize"),this.strides=Zs(null==e.strides?1:e.strides,t,"strides"),this.padding=null==e.padding?"valid":e.padding,vr(this.padding),this.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,yr(this.dataFormat),this.activation=zs(e.activation),this.useBias=null==e.useBias||e.useBias,this.biasInitializer=pi(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.biasConstraint=or(e.biasConstraint),this.biasRegularizer=js(e.biasRegularizer),this.activityRegularizer=js(e.activityRegularizer),this.dilationRate=Zs(null==e.dilationRate?1:e.dilationRate,t,"dilationRate"),1===this.rank&&Array.isArray(this.dilationRate)&&1!==this.dilationRate.length)throw new Nn(`dilationRate must be a number or an array of a single number for 1D convolution, but received ${JSON.stringify(this.dilationRate)}`);if(2===this.rank){if("number"==typeof this.dilationRate)this.dilationRate=[this.dilationRate,this.dilationRate];else if(2!==this.dilationRate.length)throw new Nn(`dilationRate must be a number or array of two numbers for 2D convolution, but received ${JSON.stringify(this.dilationRate)}`)}else if(3===this.rank)if("number"==typeof this.dilationRate)this.dilationRate=[this.dilationRate,this.dilationRate,this.dilationRate];else if(3!==this.dilationRate.length)throw new Nn(`dilationRate must be a number or array of three numbers for 3D convolution, but received ${JSON.stringify(this.dilationRate)}`)}static verifyArgs(t){if(Dn("kernelSize"in t,"required key 'kernelSize' not in config"),"number"!=typeof t.kernelSize&&!Kn(t.kernelSize,"number",1,3))throw new Nn(`BaseConv expects config.kernelSize to be number or number[] with length 1, 2, or 3, but received ${JSON.stringify(t.kernelSize)}.`)}getConfig(){const t={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:Os(this.activation),useBias:this.useBias,biasInitializer:fi(this.biasInitializer),biasRegularizer:$s(this.biasRegularizer),activityRegularizer:$s(this.activityRegularizer),biasConstraint:ar(this.biasConstraint)},e=super.getConfig();return Object.assign(t,e),t}}class no extends eo{constructor(t,e){super(t,e),this.kernel=null,no.verifyArgs(e),this.filters=e.filters,Zn(this.filters,"filters"),this.kernelInitializer=pi(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.kernelConstraint=or(e.kernelConstraint),this.kernelRegularizer=js(e.kernelRegularizer)}build(t){t=Fi(t);const e="channelsFirst"===this.dataFormat?1:t.length-1;if(null==t[e])throw new Nn(`The channel dimension of the input should be defined. Found ${t[e]}`);const n=t[e],r=this.kernelSize.concat([n,this.filters]);this.kernel=this.addWeight("kernel",r,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:{[e]:n}}],this.built=!0}call(t,e){return(0,u.tidy)((()=>{let e;t=Bi(t);const n=null==this.bias?null:this.bias.read(),r=Jn(this.activation.getClassName());if(null!=r&&2===this.rank)e=to(t,this.kernel.read(),n,this.strides,this.padding,this.dataFormat,this.dilationRate,r);else{if(1===this.rank)e=function(t,e,n,r=1,i="valid",a,s=1){return(0,u.tidy)((()=>{if(null==a&&(a="channelsLast"),yr(a),3!==t.shape.length)throw new Nn(`The input of a conv1dWithBias operation should be 3, but is ${t.shape.length} instead.`);if(3!==e.shape.length)throw new Nn(`The kernel for a conv1dWithBias operation should be 3, but is ${e.shape.length} instead`);if(null!=n&&1!==n.shape.length)throw new Nn(`The bias for a conv1dWithBias operation should be 1, but is ${e.shape.length} instead`);if("channelsFirst"===a&&(t=u.transpose(t,[0,2,1])),"causal"===i)throw new Cn("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");let o=u.conv1d(t,e,r,"same"===i?"same":"valid","NWC",s);return null!=n&&(o=Gr(o,n)),o}))}(t,this.kernel.read(),n,this.strides[0],this.padding,this.dataFormat,this.dilationRate[0]);else if(2===this.rank)e=to(t,this.kernel.read(),n,this.strides,this.padding,this.dataFormat,this.dilationRate);else{if(3!==this.rank)throw new Cn("convolutions greater than 3D are not implemented yet.");e=function(t,e,n,r=[1,1,1],i="valid",a,s){return(0,u.tidy)((()=>{if(null==a&&(a="channelsLast"),yr(a),4!==t.rank&&5!==t.rank)throw new Nn(`conv3dWithBias expects input to be of rank 4 or 5, but received ${t.rank}.`);if(4!==e.rank&&5!==e.rank)throw new Nn(`conv3dWithBias expects kernel to be of rank 4 or 5, but received ${t.rank}.`);let o=Qs(t,a);if("causal"===i)throw new Cn("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return o=u.conv3d(o,e,r,"same"===i?"same":"valid","NDHWC",s),null!=n&&(o=Gr(o,n)),"channelsFirst"===a&&(o=u.transpose(o,[0,4,1,2,3])),o}))}(t,this.kernel.read(),n,this.strides,this.padding,this.dataFormat,this.dilationRate)}null!=this.activation&&(e=this.activation.apply(e))}return e}))}computeOutputShape(t){t=Fi(t);const e=[],n="channelsLast"===this.dataFormat?t.slice(1,t.length-1):t.slice(2);for(let t=0;t<n.length;++t){const r=Xs(n[t],this.kernelSize[t],this.padding,this.strides[t],"number"==typeof this.dilationRate?this.dilationRate:this.dilationRate[t]);e.push(r)}let r=[t[0]];return"channelsLast"===this.dataFormat?(r=r.concat(e),r.push(this.filters)):(r.push(this.filters),r=r.concat(e)),r}getConfig(){const t={filters:this.filters,kernelInitializer:fi(this.kernelInitializer),kernelRegularizer:$s(this.kernelRegularizer),kernelConstraint:ar(this.kernelConstraint)},e=super.getConfig();return Object.assign(t,e),t}static verifyArgs(t){if(!("filters"in t)||"number"!=typeof t.filters||t.filters<1)throw new Nn(`Convolution layer expected config.filters to be a 'number' > 0 but got ${JSON.stringify(t.filters)}`)}}class ro extends no{constructor(t){super(2,t),ro.verifyArgs(t)}getConfig(){const t=super.getConfig();return delete t.rank,t}static verifyArgs(t){if("number"!=typeof t.kernelSize&&!Kn(t.kernelSize,"number",1,2))throw new Nn(`Conv2D expects config.kernelSize to be number or number[] with length 1 or 2, but received ${JSON.stringify(t.kernelSize)}.`)}}ro.className="Conv2D",u.serialization.registerClass(ro);class io extends no{constructor(t){super(3,t),io.verifyArgs(t)}getConfig(){const t=super.getConfig();return delete t.rank,t}static verifyArgs(t){if("number"!=typeof t.kernelSize&&(!Array.isArray(t.kernelSize)||1!==t.kernelSize.length&&3!==t.kernelSize.length))throw new Nn(`Conv3D expects config.kernelSize to be number or [number, number, number], but received ${JSON.stringify(t.kernelSize)}.`)}}io.className="Conv3D",u.serialization.registerClass(io);class ao extends ro{constructor(t){if(super(t),this.inputSpec=[new ji({ndim:4})],"same"!==this.padding&&"valid"!==this.padding)throw new Nn(`Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(t){if(4!==(t=Fi(t)).length)throw new Nn("Input should have rank 4; Received input shape: "+JSON.stringify(t));const e="channelsFirst"===this.dataFormat?1:t.length-1;if(null==t[e])throw new Nn("The channel dimension of the inputs should be defined. Found `None`.");const n=t[e],r=this.kernelSize.concat([this.filters,n]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new ji({ndim:4,axes:{[e]:n}})],this.built=!0}call(t,e){return u.tidy((()=>{let e=Bi(t);if(4!==e.shape.length)throw new Nn(`Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${e.shape.length}`);const n=e.shape,r=n[0];let i,a;"channelsFirst"===this.dataFormat?(i=2,a=3):(i=1,a=2);const s=n[i],o=n[a],l=this.kernelSize[0],h=this.kernelSize[1],c=this.strides[0],d=this.strides[1],f=[r,Js(s,c,l,this.padding),Js(o,d,h,this.padding),this.filters];"channelsLast"!==this.dataFormat&&(e=u.transpose(e,[0,2,3,1]));let p=u.conv2dTranspose(e,this.kernel.read(),f,this.strides,this.padding);return"channelsLast"!==this.dataFormat&&(p=u.transpose(p,[0,3,1,2])),null!=this.bias&&(p=Gr(p,this.bias.read(),this.dataFormat)),null!=this.activation&&(p=this.activation.apply(p)),p}))}computeOutputShape(t){const e=(t=Fi(t)).slice();let n,r,i;"channelsFirst"===this.dataFormat?(n=1,r=2,i=3):(n=3,r=1,i=2);const a=this.kernelSize[0],s=this.kernelSize[1],o=this.strides[0],l=this.strides[1];return e[n]=this.filters,e[r]=Js(e[r],o,a,this.padding),e[i]=Js(e[i],l,s,this.padding),e}getConfig(){const t=super.getConfig();return delete t.dilationRate,t}}ao.className="Conv2DTranspose",u.serialization.registerClass(ao);class so extends io{constructor(t){if(super(t),this.inputSpec=[new ji({ndim:5})],"same"!==this.padding&&"valid"!==this.padding)throw new Nn(`Conv3DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(t){if(5!==(t=Fi(t)).length)throw new Nn("Input should have rank 5; Received input shape: "+JSON.stringify(t));const e="channelsFirst"===this.dataFormat?1:t.length-1;if(null==t[e])throw new Nn("The channel dimension of the inputs should be defined. Found `None`.");const n=t[e],r=this.kernelSize.concat([this.filters,n]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new ji({ndim:5,axes:{[e]:n}})],this.built=!0}call(t,e){return u.tidy((()=>{let e=Bi(t);if(5!==e.shape.length)throw new Nn(`Conv3DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${e.shape.length}`);const n=e.shape,r=n[0];let i,a,s;"channelsFirst"===this.dataFormat?(s=2,i=3,a=4):(s=1,i=2,a=3);const o=n[s],l=n[i],h=n[a],c=this.kernelSize[0],d=this.kernelSize[1],f=this.kernelSize[2],p=this.strides[0],m=this.strides[1],g=this.strides[2],b=[r,Js(o,p,c,this.padding),Js(l,m,d,this.padding),Js(h,g,f,this.padding),this.filters];"channelsLast"!==this.dataFormat&&(e=u.transpose(e,[0,2,3,4,1]));let y=u.conv3dTranspose(e,this.kernel.read(),b,this.strides,this.padding);return"channelsLast"!==this.dataFormat&&(y=u.transpose(y,[0,4,1,2,3])),null!==this.bias&&(y=Gr(y,this.bias.read(),this.dataFormat)),null!==this.activation&&(y=this.activation.apply(y)),y}))}computeOutputShape(t){const e=(t=Fi(t)).slice();let n,r,i,a;"channelsFirst"===this.dataFormat?(n=1,r=2,i=3,a=4):(n=4,r=1,i=2,a=3);const s=this.kernelSize[0],o=this.kernelSize[1],l=this.kernelSize[2],u=this.strides[0],h=this.strides[1],c=this.strides[2];return e[n]=this.filters,e[r]=Js(e[r],u,s,this.padding),e[i]=Js(e[i],h,o,this.padding),e[a]=Js(e[a],c,l,this.padding),e}getConfig(){const t=super.getConfig();return delete t.dilationRate,t}}so.className="Conv3DTranspose",u.serialization.registerClass(so);class oo extends no{constructor(t,e){if(super(t,e),this.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",this.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",this.depthwiseKernel=null,this.pointwiseKernel=null,null==e.filters)throw new Nn("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(null!=e.kernelInitializer||null!=e.kernelRegularizer||null!=e.kernelConstraint)throw new Nn("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(null!=e.padding&&"same"!==e.padding&&"valid"!==e.padding)throw new Nn(`SeparableConv${this.rank}D supports only padding modes: 'same' and 'valid', but received ${JSON.stringify(e.padding)}`);this.depthMultiplier=null==e.depthMultiplier?1:e.depthMultiplier,this.depthwiseInitializer=pi(e.depthwiseInitializer||this.DEFAULT_DEPTHWISE_INITIALIZER),this.depthwiseRegularizer=js(e.depthwiseRegularizer),this.depthwiseConstraint=or(e.depthwiseConstraint),this.pointwiseInitializer=pi(e.depthwiseInitializer||this.DEFAULT_POINTWISE_INITIALIZER),this.pointwiseRegularizer=js(e.pointwiseRegularizer),this.pointwiseConstraint=or(e.pointwiseConstraint)}build(t){if((t=Fi(t)).length<this.rank+2)throw new Nn(`Inputs to SeparableConv${this.rank}D should have rank ${this.rank+2}, but received input shape: ${JSON.stringify(t)}`);const e="channelsFirst"===this.dataFormat?1:t.length-1;if(null==t[e]||t[e]<0)throw new Nn(`The channel dimension of the inputs should be defined, but found ${JSON.stringify(t[e])}`);const n=t[e],r=this.kernelSize.concat([n,this.depthMultiplier]),i=[];for(let t=0;t<this.rank;++t)i.push(1);i.push(n*this.depthMultiplier,this.filters);const a=!0;this.depthwiseKernel=this.addWeight("depthwise_kernel",r,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,a,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",i,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,a,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,a,this.biasConstraint):this.bias=null,this.inputSpec=[new ji({ndim:this.rank+2,axes:{[e]:n}})],this.built=!0}call(t,e){return(0,u.tidy)((()=>{let e;if(t=Bi(t),1===this.rank)throw new Cn("1D separable convolution is not implemented yet.");return 2===this.rank&&("channelsFirst"===this.dataFormat&&(t=u.transpose(t,[0,2,3,1])),e=u.separableConv2d(t,this.depthwiseKernel.read(),this.pointwiseKernel.read(),this.strides,this.padding,this.dilationRate,"NHWC")),this.useBias&&(e=Gr(e,this.bias.read(),this.dataFormat)),null!=this.activation&&(e=this.activation.apply(e)),"channelsFirst"===this.dataFormat&&(e=u.transpose(e,[0,3,1,2])),e}))}getConfig(){const t=super.getConfig();return delete t.rank,delete t.kernelInitializer,delete t.kernelRegularizer,delete t.kernelConstraint,t.depthwiseInitializer=fi(this.depthwiseInitializer),t.pointwiseInitializer=fi(this.pointwiseInitializer),t.depthwiseRegularizer=$s(this.depthwiseRegularizer),t.pointwiseRegularizer=$s(this.pointwiseRegularizer),t.depthwiseConstraint=ar(this.depthwiseConstraint),t.pointwiseConstraint=ar(this.pointwiseConstraint),t}}oo.className="SeparableConv";class lo extends oo{constructor(t){super(2,t)}}lo.className="SeparableConv2D",u.serialization.registerClass(lo);class uo extends no{constructor(t){super(1,t),uo.verifyArgs(t),this.inputSpec=[{ndim:3}]}getConfig(){const t=super.getConfig();return delete t.rank,delete t.dataFormat,t}static verifyArgs(t){if("number"!=typeof t.kernelSize&&!Kn(t.kernelSize,"number",1,1))throw new Nn(`Conv1D expects config.kernelSize to be number or number[] with length 1, but received ${JSON.stringify(t.kernelSize)}.`)}}uo.className="Conv1D",u.serialization.registerClass(uo);class ho extends qi{constructor(t){super(t),"number"==typeof t.cropping?this.cropping=[[t.cropping,t.cropping],[t.cropping,t.cropping]]:"number"==typeof t.cropping[0]?this.cropping=[[t.cropping[0],t.cropping[0]],[t.cropping[1],t.cropping[1]]]:this.cropping=t.cropping,this.dataFormat=void 0===t.dataFormat?"channelsLast":t.dataFormat,this.inputSpec=[{ndim:4}]}computeOutputShape(t){return"channelsFirst"===this.dataFormat?[t[0],t[1],t[2]-this.cropping[0][0]-this.cropping[0][1],t[3]-this.cropping[1][0]-this.cropping[1][1]]:[t[0],t[1]-this.cropping[0][0]-this.cropping[0][1],t[2]-this.cropping[1][0]-this.cropping[1][1],t[3]]}call(t,e){return(0,u.tidy)((()=>{if(t=Bi(t),"channelsLast"===this.dataFormat){const e=zr(t,this.cropping[0][0],t.shape[1]-this.cropping[0][0]-this.cropping[0][1],2);return zr(e,this.cropping[1][0],t.shape[2]-this.cropping[1][1]-this.cropping[1][0],3)}{const e=zr(t,this.cropping[0][0],t.shape[2]-this.cropping[0][0]-this.cropping[0][1],3);return zr(e,this.cropping[1][0],t.shape[3]-this.cropping[1][1]-this.cropping[1][0],4)}}))}getConfig(){const t={cropping:this.cropping,dataFormat:this.dataFormat},e=super.getConfig();return Object.assign(t,e),t}}ho.className="Cropping2D",u.serialization.registerClass(ho);class co extends qi{constructor(t){var e;super(t),this.DEFAULT_SIZE=[2,2],this.inputSpec=[{ndim:4}],this.size=null==t.size?this.DEFAULT_SIZE:t.size,this.dataFormat=null==t.dataFormat?"channelsLast":t.dataFormat,yr(this.dataFormat),this.interpolation=null==t.interpolation?"nearest":t.interpolation,e=this.interpolation,qn(fr,"InterpolationFormat",e)}computeOutputShape(t){if("channelsFirst"===this.dataFormat){const e=null==t[2]?null:this.size[0]*t[2],n=null==t[3]?null:this.size[1]*t[3];return[t[0],t[1],e,n]}{const e=null==t[1]?null:this.size[0]*t[1],n=null==t[2]?null:this.size[1]*t[2];return[t[0],e,n,t[3]]}}call(t,e){return u.tidy((()=>{let e=Bi(t);const n=e.shape;if("channelsFirst"===this.dataFormat){e=u.transpose(e,[0,2,3,1]);const t=this.size[0]*n[2],r=this.size[1]*n[3],i="nearest"===this.interpolation?u.image.resizeNearestNeighbor(e,[t,r]):u.image.resizeBilinear(e,[t,r]);return u.transpose(i,[0,3,1,2])}{const t=this.size[0]*n[1],r=this.size[1]*n[2];return"nearest"===this.interpolation?u.image.resizeNearestNeighbor(e,[t,r]):u.image.resizeBilinear(e,[t,r])}}))}getConfig(){const t={size:this.size,dataFormat:this.dataFormat},e=super.getConfig();return Object.assign(t,e),t}}co.className="UpSampling2D",u.serialization.registerClass(co);class fo extends eo{constructor(t){super(2,t),this.depthwiseKernel=null,this.depthMultiplier=null==t.depthMultiplier?1:t.depthMultiplier,this.depthwiseInitializer=pi(t.depthwiseInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.depthwiseConstraint=or(t.depthwiseConstraint),this.depthwiseRegularizer=js(t.depthwiseRegularizer)}build(t){if((t=Fi(t)).length<4)throw new Nn(`Inputs to DepthwiseConv2D should have rank 4. Received input shape: ${JSON.stringify(t)}.`);const e="channelsFirst"===this.dataFormat?1:3;if(null==t[e]||t[e]<0)throw new Nn(`The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not (${t[e]}).`);const n=t[e],r=[this.kernelSize[0],this.kernelSize[1],n,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",r,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[n*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(t,e){return(0,u.tidy)((()=>{let e=function(t,e,n=[1,1],r="valid",i,a){return(0,u.tidy)((()=>{null==i&&(i="channelsLast"),yr(i);let s=Ys(t,i);if(4!==t.rank)throw new Nn(`Input for depthwiseConv2d is required to be 4-D, but is instead ${t.rank}-D`);if(4!==e.rank)throw new Nn(`depthwiseKernel is required to be 4-D, but is instead ${e.rank}-D`);return s=u.depthwiseConv2d(s,e,n,"same"===r?"same":"valid","NHWC",a),"channelsFirst"===i&&(s=u.transpose(s,[0,3,1,2])),s}))}(t=Bi(t),this.depthwiseKernel.read(),this.strides,this.padding,this.dataFormat,null);return this.useBias&&(e=Gr(e,this.bias.read(),this.dataFormat)),null!=this.activation&&(e=this.activation.apply(e)),e}))}computeOutputShape(t){t=Fi(t);const e="channelsFirst"===this.dataFormat?t[2]:t[1],n="channelsFirst"===this.dataFormat?t[3]:t[2],r="channelsFirst"===this.dataFormat?t[1]*this.depthMultiplier:t[3]*this.depthMultiplier,i=Xs(e,this.kernelSize[0],this.padding,this.strides[0]),a=Xs(n,this.kernelSize[1],this.padding,this.strides[1]);return"channelsFirst"===this.dataFormat?[t[0],r,i,a]:[t[0],i,a,r]}getConfig(){const t=super.getConfig();return t.depthMultiplier=this.depthMultiplier,t.depthwiseInitializer=fi(this.depthwiseInitializer),t.depthwiseRegularizer=$s(this.depthwiseRegularizer),t.depthwiseConstraint=ar(this.depthwiseRegularizer),t}}function po(t,e,n,r){if(Array.isArray(t)){if(null!=e||null!=n)throw new Nn("When inputs is an array, neither initialState or constants should be provided");null!=r&&(n=t.slice(t.length-r,t.length),t=t.slice(0,t.length-r)),t.length>1&&(e=t.slice(1,t.length)),t=t[0]}function i(t){return null==t||Array.isArray(t)?t:[t]}return{inputs:t,initialState:e=i(e),constants:n=i(n)}}function mo(t,e,n,r=!1,i,a,s=!1,o=!1){return u.tidy((()=>{const l=e.shape.length;if(l<3)throw new Nn(`Input should be at least 3D, but is ${l}D.`);const h=[1,0].concat(Nr(2,l));if(e=u.transpose(e,h),null!=a)throw new Cn("The rnn() functoin of the deeplearn.js backend does not support constants yet.");s&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),null!=i&&((i=u.cast(u.cast(i,"bool"),"float32")).rank===l-1&&(i=u.expandDims(i,-1)),i=u.transpose(i,h)),r&&(e=u.reverse(e,0),null!=i&&(i=u.reverse(i,0)));const c=[];let d,f=n;const p=e.shape[0],m=u.unstack(e);let g,b;null!=i&&(g=u.unstack(i));for(let e=0;e<p;++e){const n=m[e],r=u.tidy((()=>t(n,f)));if(null==i)d=r[0],f=r[1];else{const t=u.tidy((()=>{const t=g[e],n=u.sub(u.onesLike(t),t),i=u.add(u.mul(r[0],t),u.mul(f[0],n)),a=f.map(((e,i)=>u.add(u.mul(r[1][i],t),u.mul(e,n))));return{output:i,newStates:a}}));d=t.output,f=t.newStates}o&&c.push(d)}if(o){const t=1;b=u.stack(c,t)}return[d,b,f]}))}fo.className="DepthwiseConv2D",u.serialization.registerClass(fo);class go extends qi{constructor(t){let e;if(super(t),null==t.cell)throw new Nn("cell property is missing for the constructor of RNN.");if(e=Array.isArray(t.cell)?new So({cells:t.cell}):t.cell,null==e.stateSize)throw new Nn("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");this.cell=e,this.returnSequences=null!=t.returnSequences&&t.returnSequences,this.returnState=null!=t.returnState&&t.returnState,this.goBackwards=null!=t.goBackwards&&t.goBackwards,this._stateful=null!=t.stateful&&t.stateful,this.unroll=null!=t.unroll&&t.unroll,this.supportsMasking=!0,this.inputSpec=[new ji({ndim:3})],this.stateSpec=null,this.states_=null,this.numConstants=null,this.keptStates=[]}getStates(){return null==this.states_?Nr(0,Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1).map((t=>null)):this.states_}setStates(t){this.states_=t}computeOutputShape(t){Di(t)&&(t=t[0]),t=t;let e=this.cell.stateSize;Array.isArray(e)||(e=[e]);const n=e[0];let r;if(r=this.returnSequences?[t[0],t[1],n]:[t[0],n],this.returnState){const n=[];for(const r of e)n.push([t[0],r]);return[r].concat(n)}return r}computeMask(t,e){return u.tidy((()=>{Array.isArray(e)&&(e=e[0]);const t=this.returnSequences?e:null;if(this.returnState){const e=this.states.map((t=>null));return[t].concat(e)}return t}))}get states(){if(null==this.states_){const t=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,e=[];for(let n=0;n<t;++n)e.push(null);return e}return this.states_}set states(t){this.states_=t}build(t){if(null!=this.numConstants)throw new Cn("Constants support is not implemented in RNN yet.");Di(t)&&(t=t[0]),t=t;const e=this.stateful?t[0]:null,n=t.slice(2);this.inputSpec[0]=new ji({shape:[e,null,...n]});const r=[t[0]].concat(t.slice(2));let i;if(this.cell.build(r),i=Array.isArray(this.cell.stateSize)?this.cell.stateSize:[this.cell.stateSize],null!=this.stateSpec){if(!u.util.arraysEqual(this.stateSpec.map((t=>t.shape[t.shape.length-1])),i))throw new Nn(`An initialState was passed that is not compatible with cell.stateSize. Received stateSpec=${this.stateSpec}; However cell.stateSize is ${this.cell.stateSize}`)}else this.stateSpec=i.map((t=>new ji({shape:[null,t]})));this.stateful&&this.resetStates()}resetStates(t,e=!1){(0,u.tidy)((()=>{if(!this.stateful)throw new Mn("Cannot call resetStates() on an RNN Layer that is not stateful.");const n=this.inputSpec[0].shape[0];if(null==n)throw new Nn("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(null==this.states_)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map((t=>u.zeros([n,t]))):this.states_=[u.zeros([n,this.cell.stateSize])];else if(null==t)u.dispose(this.states_),null!=this.keptStates&&(u.dispose(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map((t=>u.zeros([n,t]))):this.states_[0]=u.zeros([n,this.cell.stateSize]);else{if(Array.isArray(t)||(t=[t]),t.length!==this.states_.length)throw new Nn(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${t.length} state value(s). Input received: ${t}`);!0===e?this.keptStates.push(this.states_.slice()):u.dispose(this.states_);for(let e=0;e<this.states_.length;++e){const r=t[e],i=Array.isArray(this.cell.stateSize)?this.cell.stateSize[e]:this.cell.stateSize,a=[n,i];if(!u.util.arraysEqual(r.shape,a))throw new Nn(`State ${e} is incompatible with layer ${this.name}: expected shape=${a}, received shape=${r.shape}`);this.states_[e]=r}}this.states_=this.states_.map((t=>u.keep(t.clone())))}))}apply(t,e){let n=null==e?null:e.initialState,r=null==e?null:e.constants;null==e&&(e={});const i=po(t,n,r,this.numConstants);t=i.inputs,n=i.initialState,r=i.constants;let a=[],s=[];if(null!=n){e.initialState=n,a=a.concat(n),this.stateSpec=[];for(const t of n)this.stateSpec.push(new ji({shape:t.shape}));s=s.concat(this.stateSpec)}if(null!=r&&(e.constants=r,a=a.concat(r),this.numConstants=r.length),a[0]instanceof Wi){const n=[t].concat(a),r=this.inputSpec.concat(s),i=this.inputSpec;this.inputSpec=r;const o=super.apply(n,e);return this.inputSpec=i,o}return super.apply(t,e)}call(t,e){return(0,u.tidy)((()=>{const n=null==e?null:e.mask,r=null==e?null:e.training;let i=null==e?null:e.initialState;t=Bi(t),null==i&&(i=this.stateful?this.states_:this.getInitialState(t));const a=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;if(i.length!==a)throw new Nn(`RNN Layer has ${a} state(s) but was passed ${i.length} initial state(s).`);this.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");const s={training:r},o=mo(((t,e)=>{const n=this.cell.call([t].concat(e),s);return[n[0],n.slice(1)]}),t,i,this.goBackwards,n,null,this.unroll,this.returnSequences),l=o[0],u=o[1],h=o[2];this.stateful&&this.resetStates(h,r);const c=this.returnSequences?u:l;return this.returnState?[c].concat(h):c}))}getInitialState(t){return(0,u.tidy)((()=>{let e=u.zeros(t.shape);return e=u.sum(e,[1,2]),e=Rr(e),Array.isArray(this.cell.stateSize)?this.cell.stateSize.map((t=>t>1?Pr(e,[1,t]):e)):this.cell.stateSize>1?[Pr(e,[1,this.cell.stateSize])]:[e]}))}get trainableWeights(){return this.trainable?this.cell.trainableWeights:[]}get nonTrainableWeights(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}setFastWeightInitDuringBuild(t){super.setFastWeightInitDuringBuild(t),null!=this.cell&&this.cell.setFastWeightInitDuringBuild(t)}getConfig(){const t=super.getConfig(),e={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};null!=this.numConstants&&(e.numConstants=this.numConstants);const n=this.cell.getConfig();return this.getClassName()===go.className&&(e.cell={className:this.cell.getClassName(),config:n}),Object.assign({},n,t,e)}static fromConfig(t,e,n={}){const r=la(e.cell,n);return new t(Object.assign(e,{cell:r}))}}go.className="RNN",u.serialization.registerClass(go);class bo extends qi{}class yo extends bo{constructor(t){super(t),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=t.units,Zn(this.units,"units"),this.activation=zs(null==t.activation?this.DEFAULT_ACTIVATION:t.activation),this.useBias=null==t.useBias||t.useBias,this.kernelInitializer=pi(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=pi(t.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=pi(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=js(t.kernelRegularizer),this.recurrentRegularizer=js(t.recurrentRegularizer),this.biasRegularizer=js(t.biasRegularizer),this.kernelConstraint=or(t.kernelConstraint),this.recurrentConstraint=or(t.recurrentConstraint),this.biasConstraint=or(t.biasConstraint),this.dropout=Mr([1,Tr([0,null==t.dropout?0:t.dropout])]),this.recurrentDropout=Mr([1,Tr([0,null==t.recurrentDropout?0:t.recurrentDropout])]),this.dropoutFunc=t.dropoutFunc,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(t){t=Fi(t),this.kernel=this.addWeight("kernel",[t[t.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(t,e){return(0,u.tidy)((()=>{if(2!==(t=t).length)throw new Nn(`SimpleRNNCell expects 2 input Tensors, got ${t.length}.`);let n=t[1];t=t[0];const r=null!=e.training&&e.training;let i;0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=Eo({ones:()=>u.onesLike(t),rate:this.dropout,training:r,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=Eo({ones:()=>u.onesLike(n),rate:this.recurrentDropout,training:r,dropoutFunc:this.dropoutFunc}));const a=this.dropoutMask,s=this.recurrentDropoutMask;i=$r(null!=a?u.mul(t,a):t,this.kernel.read()),null!=this.bias&&(i=Gr(i,this.bias.read())),null!=s&&(n=u.mul(n,s));let o=u.add(i,$r(n,this.recurrentKernel.read()));return null!=this.activation&&(o=this.activation.apply(o)),[o,o]}))}getConfig(){const t=super.getConfig(),e={units:this.units,activation:Os(this.activation),useBias:this.useBias,kernelInitializer:fi(this.kernelInitializer),recurrentInitializer:fi(this.recurrentInitializer),biasInitializer:fi(this.biasInitializer),kernelRegularizer:$s(this.kernelRegularizer),recurrentRegularizer:$s(this.recurrentRegularizer),biasRegularizer:$s(this.biasRegularizer),activityRegularizer:$s(this.activityRegularizer),kernelConstraint:ar(this.kernelConstraint),recurrentConstraint:ar(this.recurrentConstraint),biasConstraint:ar(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign({},t,e)}}yo.className="SimpleRNNCell",u.serialization.registerClass(yo);class vo extends go{constructor(t){t.cell=new yo(t),super(t)}call(t,e){return(0,u.tidy)((()=>{null!=this.cell.dropoutMask&&(u.dispose(this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(u.dispose(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const n=null==e?null:e.mask,r=null==e?null:e.training,i=null==e?null:e.initialState;return super.call(t,{mask:n,training:r,initialState:i})}))}static fromConfig(t,e){return new t(e)}}vo.className="SimpleRNN",u.serialization.registerClass(vo);class wo extends bo{constructor(t){if(super(t),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",t.resetAfter)throw new Nn("GRUCell does not support reset_after parameter set to true.");this.units=t.units,Zn(this.units,"units"),this.activation=zs(void 0===t.activation?this.DEFAULT_ACTIVATION:t.activation),this.recurrentActivation=zs(void 0===t.recurrentActivation?this.DEFAULT_RECURRENT_ACTIVATION:t.recurrentActivation),this.useBias=null==t.useBias||t.useBias,this.kernelInitializer=pi(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=pi(t.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=pi(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=js(t.kernelRegularizer),this.recurrentRegularizer=js(t.recurrentRegularizer),this.biasRegularizer=js(t.biasRegularizer),this.kernelConstraint=or(t.kernelConstraint),this.recurrentConstraint=or(t.recurrentConstraint),this.biasConstraint=or(t.biasConstraint),this.dropout=Mr([1,Tr([0,null==t.dropout?0:t.dropout])]),this.recurrentDropout=Mr([1,Tr([0,null==t.recurrentDropout?0:t.recurrentDropout])]),this.dropoutFunc=t.dropoutFunc,this.implementation=t.implementation,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(t){const e=(t=Fi(t))[t.length-1];this.kernel=this.addWeight("kernel",[e,3*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,3*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[3*this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(t,e){return(0,u.tidy)((()=>{if(2!==(t=t).length)throw new Nn(`GRUCell expects 2 input Tensors (inputs, h, c), got ${t.length}.`);const n=null!=e.training&&e.training;let r=t[1];t=t[0],0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=Eo({ones:()=>u.onesLike(t),rate:this.dropout,training:n,count:3,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=Eo({ones:()=>u.onesLike(r),rate:this.recurrentDropout,training:n,count:3,dropoutFunc:this.dropoutFunc}));const i=this.dropoutMask,a=this.recurrentDropoutMask;let s,o,l;0<this.dropout&&this.dropout<1&&(t=u.mul(t,i[0]));let h=$r(t,this.kernel.read());this.useBias&&(h=Gr(h,this.bias.read())),0<this.recurrentDropout&&this.recurrentDropout<1&&(r=u.mul(r,a[0]));const c=this.recurrentKernel.read(),[d,f]=u.split(c,[2*this.units,this.units],c.rank-1),p=$r(r,d),[m,g,b]=u.split(h,3,h.rank-1),[y,v]=u.split(p,2,p.rank-1);s=this.recurrentActivation.apply(u.add(m,y)),o=this.recurrentActivation.apply(u.add(g,v));const w=$r(u.mul(o,r),f);l=this.activation.apply(u.add(b,w));const _=u.add(u.mul(s,r),u.mul(u.add(1,u.neg(s)),l));return[_,_]}))}getConfig(){const t=super.getConfig(),e={units:this.units,activation:Os(this.activation),recurrentActivation:Os(this.recurrentActivation),useBias:this.useBias,kernelInitializer:fi(this.kernelInitializer),recurrentInitializer:fi(this.recurrentInitializer),biasInitializer:fi(this.biasInitializer),kernelRegularizer:$s(this.kernelRegularizer),recurrentRegularizer:$s(this.recurrentRegularizer),biasRegularizer:$s(this.biasRegularizer),activityRegularizer:$s(this.activityRegularizer),kernelConstraint:ar(this.kernelConstraint),recurrentConstraint:ar(this.recurrentConstraint),biasConstraint:ar(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign({},t,e)}}wo.className="GRUCell",u.serialization.registerClass(wo);class _o extends go{constructor(t){0===t.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),t.cell=new wo(t),super(t)}call(t,e){return(0,u.tidy)((()=>{null!=this.cell.dropoutMask&&(u.dispose(this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(u.dispose(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const n=null==e?null:e.mask,r=null==e?null:e.training,i=null==e?null:e.initialState;return super.call(t,{mask:n,training:r,initialState:i})}))}static fromConfig(t,e){return 0===e.implmentation&&(e.implementation=1),new t(e)}}_o.className="GRU",u.serialization.registerClass(_o);class ko extends bo{constructor(t){super(t),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=t.units,Zn(this.units,"units"),this.activation=zs(void 0===t.activation?this.DEFAULT_ACTIVATION:t.activation),this.recurrentActivation=zs(void 0===t.recurrentActivation?this.DEFAULT_RECURRENT_ACTIVATION:t.recurrentActivation),this.useBias=null==t.useBias||t.useBias,this.kernelInitializer=pi(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=pi(t.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=pi(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.unitForgetBias=t.unitForgetBias,this.kernelRegularizer=js(t.kernelRegularizer),this.recurrentRegularizer=js(t.recurrentRegularizer),this.biasRegularizer=js(t.biasRegularizer),this.kernelConstraint=or(t.kernelConstraint),this.recurrentConstraint=or(t.recurrentConstraint),this.biasConstraint=or(t.biasConstraint),this.dropout=Mr([1,Tr([0,null==t.dropout?0:t.dropout])]),this.recurrentDropout=Mr([1,Tr([0,null==t.recurrentDropout?0:t.recurrentDropout])]),this.dropoutFunc=t.dropoutFunc,this.implementation=t.implementation,this.stateSize=[this.units,this.units],this.dropoutMask=null,this.recurrentDropoutMask=null}build(t){var e;const n=(t=Fi(t))[t.length-1];let r;if(this.kernel=this.addWeight("kernel",[n,4*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,4*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){if(this.unitForgetBias){const t=this.biasInitializer,n=this.units;r=new((e=class extends Zr{apply(e,r){const i=t.apply([n]),a=(new Jr).apply([n]),s=t.apply([2*n]);return Fr(Fr(i,a),s)}}).className="CustomInit",e)}else r=this.biasInitializer;this.bias=this.addWeight("bias",[4*this.units],null,r,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}call(t,e){return(0,u.tidy)((()=>{const n=null!=e.training&&e.training;if(3!==(t=t).length)throw new Nn(`LSTMCell expects 3 input Tensors (inputs, h, c), got ${t.length}.`);let r=t[1];const i=t[2];t=t[0],0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=Eo({ones:()=>u.onesLike(t),rate:this.dropout,training:n,count:4,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=Eo({ones:()=>u.onesLike(r),rate:this.recurrentDropout,training:n,count:4,dropoutFunc:this.dropoutFunc}));const a=this.dropoutMask,s=this.recurrentDropoutMask;let o,l,h,c;0<this.dropout&&this.dropout<1&&(t=u.mul(t,a[0]));let d=$r(t,this.kernel.read());0<this.recurrentDropout&&this.recurrentDropout<1&&(r=u.mul(r,s[0])),d=u.add(d,$r(r,this.recurrentKernel.read())),this.useBias&&(d=Gr(d,this.bias.read()));const[f,p,m,g]=u.split(d,4,d.rank-1);o=this.recurrentActivation.apply(f),l=this.recurrentActivation.apply(p),h=u.add(u.mul(l,i),u.mul(o,this.activation.apply(m))),c=this.recurrentActivation.apply(g);const b=u.mul(c,this.activation.apply(h));return[b,b,h]}))}getConfig(){const t=super.getConfig(),e={units:this.units,activation:Os(this.activation),recurrentActivation:Os(this.recurrentActivation),useBias:this.useBias,kernelInitializer:fi(this.kernelInitializer),recurrentInitializer:fi(this.recurrentInitializer),biasInitializer:fi(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:$s(this.kernelRegularizer),recurrentRegularizer:$s(this.recurrentRegularizer),biasRegularizer:$s(this.biasRegularizer),activityRegularizer:$s(this.activityRegularizer),kernelConstraint:ar(this.kernelConstraint),recurrentConstraint:ar(this.recurrentConstraint),biasConstraint:ar(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign({},t,e)}}ko.className="LSTMCell",u.serialization.registerClass(ko);class xo extends go{constructor(t){0===t.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),t.cell=new ko(t),super(t)}call(t,e){return(0,u.tidy)((()=>{null!=this.cell.dropoutMask&&(u.dispose(this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(u.dispose(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const n=null==e?null:e.mask,r=null==e?null:e.training,i=null==e?null:e.initialState;return super.call(t,{mask:n,training:r,initialState:i})}))}static fromConfig(t,e){return 0===e.implmentation&&(e.implementation=1),new t(e)}}xo.className="LSTM",u.serialization.registerClass(xo);class So extends bo{constructor(t){super(t),this.cells=t.cells}get stateSize(){const t=[];for(const e of this.cells.slice().reverse())Array.isArray(e.stateSize)?t.push(...e.stateSize):t.push(e.stateSize);return t}call(t,e){return(0,u.tidy)((()=>{let n=(t=t).slice(1);const r=[];for(const t of this.cells.slice().reverse())Array.isArray(t.stateSize)?r.push(n.splice(0,t.stateSize.length)):r.push(n.splice(0,1));r.reverse();const i=[];let a;for(let s=0;s<this.cells.length;++s){const o=this.cells[s];n=r[s],a=0===s?[t[0]].concat(n):[a[0]].concat(n),a=o.call(a,e),i.push(a.slice(1))}n=[];for(const t of i.slice().reverse())n.push(...t);return[a[0]].concat(n)}))}build(t){let e;Di(t)&&(t=t[0]),t=t,this.cells.forEach(((n,r)=>{kr(`RNNCell_${r}`,(()=>{n.build(t),e=Array.isArray(n.stateSize)?n.stateSize[0]:n.stateSize,t=[t[0],e]}))})),this.built=!0}getConfig(){const t=super.getConfig(),e={cells:this.cells.map((t=>({className:t.getClassName(),config:t.getConfig()})))};return Object.assign({},t,e)}static fromConfig(t,e,n={}){const r=[];for(const t of e.cells)r.push(la(t,n));return new t({cells:r})}get trainableWeights(){if(!this.trainable)return[];const t=[];for(const e of this.cells)t.push(...e.trainableWeights);return t}get nonTrainableWeights(){const t=[];for(const e of this.cells)t.push(...e.nonTrainableWeights);if(!this.trainable){const e=[];for(const t of this.cells)e.push(...t.trainableWeights);return e.concat(t)}return t}getWeights(){const t=[];for(const e of this.cells)t.push(...e.weights);return $i(t)}setWeights(t){const e=[];for(const n of this.cells){const r=n.weights.length,i=t.splice(r);for(let t=0;t<n.weights.length;++t)e.push([n.weights[t],i[t]])}Ui(e)}}function Eo(t){const{ones:e,rate:n,training:r=!1,count:i=1,dropoutFunc:a}=t,s=()=>null!=a?a(e(),n):Hr(e(),n),o=()=>Vr(s,e,r);return!i||i<=1?u.keep(o().clone()):Array(i).fill(void 0).map(o).map((t=>u.keep(t.clone())))}So.className="StackedRNNCells",u.serialization.registerClass(So);class Io extends go{constructor(t){if(t.unroll)throw new Cn("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(t.cell))throw new Cn("It is not possible at the moment to stack convolutional cells.");super(t),this.inputSpec=[new ji({ndim:5})]}call(t,e){return u.tidy((()=>{if(null!=this.cell.dropoutMask&&(u.dispose(this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(u.dispose(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),e&&e.constants)throw new Nn("ConvRNN2D cell does not support constants");const n=null==e?null:e.mask,r=null==e?null:e.training,i=null==e?null:e.initialState;return super.call(t,{mask:n,training:r,initialState:i})}))}computeOutputShape(t){let e=this.computeSingleOutputShape(t);return this.returnSequences||(e=[e[0],...e.slice(2)]),this.returnState&&(e=[e,...Array(2).fill([t[0],...e.slice(-3)])]),e}getInitialState(t){return u.tidy((()=>{const{stateSize:e}=this.cell,n=t.shape,r=this.computeSingleOutputShape(n),i=[r[0],...r.slice(2)],a=u.zeros(i);return Array.isArray(e)?Array(e.length).fill(a):[a]}))}resetStates(t,e=!1){u.tidy((()=>{if(!this.stateful)throw new Mn("Cannot call resetStates() on an RNN Layer that is not stateful.");const n=this.inputSpec[0].shape,r=this.computeSingleOutputShape(n),i=[r[0],...r.slice(2)];if(null==n[0])throw new Nn("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(null==this.getStates())Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map((()=>u.zeros(i))):this.states_=[u.zeros(i)];else if(null==t)u.dispose(this.states_),null!=this.keptStates&&(u.dispose(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map((()=>u.zeros(i))):this.states_[0]=u.zeros(i);else{if(Array.isArray(t)||(t=[t]),t.length!==this.states_.length)throw new Nn(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${t.length} state value(s). Input received: ${t}`);e?this.keptStates.push(this.states_.slice()):u.dispose(this.states_);for(let e=0;e<this.states_.length;++e){const n=t[e],r=i;if(!u.util.arraysEqual(n.shape,r))throw new Nn(`State ${e} is incompatible with layer ${this.name}: expected shape=${r}, received shape=${n.shape}`);this.states_[e]=n}}this.states_=this.states_.map((t=>u.keep(t.clone())))}))}computeSingleOutputShape(t){const{dataFormat:e,filters:n,kernelSize:r,padding:i,strides:a,dilationRate:s}=this.cell,o="channelsFirst"===e,l=t[o?3:2],u=t[o?4:3],h=Xs(l,r[0],i,a[0],s[0]),c=Xs(u,r[1],i,a[1],s[1]);return[...t.slice(0,2),...o?[n,h,c]:[h,c,n]]}}Io.className="ConvRNN2D";class Ao extends ko{constructor(t){const{filters:e,kernelSize:n,strides:r,padding:i,dataFormat:a,dilationRate:s}=t;super(Object.assign({},t,{units:e})),this.filters=e,Zn(this.filters,"filters"),this.kernelSize=Zs(n,2,"kernelSize"),this.kernelSize.forEach((t=>Zn(t,"kernelSize"))),this.strides=Zs(r||1,2,"strides"),this.strides.forEach((t=>Zn(t,"strides"))),this.padding=i||"valid",vr(this.padding),this.dataFormat=a||"channelsLast",yr(this.dataFormat),this.dilationRate=Zs(s||1,2,"dilationRate"),this.dilationRate.forEach((t=>Zn(t,"dilationRate")))}build(t){var e;t=Fi(t);const n="channelsFirst"===this.dataFormat?1:t.length-1;if(null==t[n])throw new Nn(`The channel dimension of the input should be defined. Found ${t[n]}`);const r=t[n],i=this.kernelSize.concat([r,4*this.filters]);this.kernel=this.addWeight("kernel",i,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);const a=this.kernelSize.concat([this.filters,4*this.filters]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",a,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){let t;if(this.unitForgetBias){const n=this.biasInitializer,r=this.filters;t=new((e=class extends Zr{apply(t,e){return Br([n.apply([r]),u.ones([r]),n.apply([2*r])])}}).className="CustomInit",e)}else t=this.biasInitializer;this.bias=this.addWeight("bias",[4*this.filters],null,t,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}call(t,e){return u.tidy((()=>{if(3!==t.length)throw new Nn(`ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got ${t.length}.`);const n=e.training||!1,r=t[0],i=t[1],a=t[2];0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=Eo({ones:()=>u.onesLike(r),rate:this.dropout,training:n,count:4,dropoutFunc:this.dropoutFunc}));const s=this.dropoutMask,o=(t,e,n)=>e&&e[n]?u.mul(e[n],t):t;let l=o(r,s,0),h=o(r,s,1),c=o(r,s,2),d=o(r,s,3);0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=Eo({ones:()=>u.onesLike(i),rate:this.recurrentDropout,training:n,count:4,dropoutFunc:this.dropoutFunc}));const f=this.recurrentDropoutMask;let p=o(i,f,0),m=o(i,f,1),g=o(i,f,2),b=o(i,f,3);const[y,v,w,_]=u.split(this.kernel.read(),4,3),[k,x,S,E]=this.useBias?u.split(this.bias.read(),4):[null,null,null,null];l=this.inputConv(l,y,k,this.padding),h=this.inputConv(h,v,x,this.padding),c=this.inputConv(c,w,S,this.padding),d=this.inputConv(d,_,E,this.padding);const[I,A,M,T]=u.split(this.recurrentKernel.read(),4,3);p=this.recurrentConv(p,I),m=this.recurrentConv(m,A),g=this.recurrentConv(g,M),b=this.recurrentConv(b,T);const N=this.recurrentActivation.apply(u.add(l,p)),C=this.recurrentActivation.apply(u.add(h,m)),R=u.add(u.mul(C,a),u.mul(N,this.activation.apply(u.add(c,g)))),O=u.mul(this.recurrentActivation.apply(u.add(d,b)),this.activation.apply(R));return[O,O,R]}))}getConfig(){const t=super.getConfig(),{units:e}=t,n=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n}(t,["units"]),r={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign({},n,r)}inputConv(t,e,n,r){const i=u.conv2d(t,e,this.strides,r||"valid","channelsFirst"===this.dataFormat?"NCHW":"NHWC",this.dilationRate);return n?Gr(i,n,this.dataFormat):i}recurrentConv(t,e){return u.conv2d(t,e,1,"same","channelsFirst"===this.dataFormat?"NCHW":"NHWC")}}Ao.className="ConvLSTM2DCell",u.serialization.registerClass(Ao);class Mo extends Io{constructor(t){const e=new Ao(t);super(Object.assign({},t,{cell:e}))}static fromConfig(t,e){return new t(e)}}Mo.className="ConvLSTM2D",u.serialization.registerClass(Mo);class To extends qi{constructor(t){super(t),this.rate=Math.max(Math.min(t.rate,1),0),this.noiseShape=t.noiseShape,this.seed=t.seed,this.supportsMasking=!0}getNoiseShape(t){if(null==this.noiseShape)return this.noiseShape;const e=t.shape,n=[];for(let t=0;t<this.noiseShape.length;++t)n.push(null==this.noiseShape[t]?e[t]:this.noiseShape[t]);return n}call(t,e){return(0,u.tidy)((()=>{this.invokeCallHook(t,e);const n=Bi(t);if(0<this.rate&&this.rate<1){const t=null!=e.training&&e.training,r=this.getNoiseShape(n);return Vr((()=>Hr(n,this.rate,r,this.seed)),(()=>n),t)}return t}))}getConfig(){const t={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},e=super.getConfig();return Object.assign(t,e),t}dispose(){return super.dispose()}}To.className="Dropout",u.serialization.registerClass(To);class No extends To{constructor(t){super(t),this.inputSpec=[{ndim:3}]}getNoiseShape(t){const e=t.shape;return[e[0],1,e[2]]}}No.className="SpatialDropout1D",u.serialization.registerClass(No);class Co extends qi{constructor(t){if(super(t),this.activation=null,this.useBias=!0,this.kernel=null,this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",null==t.batchInputShape&&null==t.inputShape&&null!=t.inputDim){let e=null;null!=t.batchSize&&(e=t.batchSize),this.batchInputShape=[e,t.inputDim]}this.units=t.units,Zn(this.units,"units"),this.activation=zs(t.activation),null!=t.useBias&&(this.useBias=t.useBias),this.kernelInitializer=pi(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.biasInitializer=pi(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelConstraint=or(t.kernelConstraint),this.biasConstraint=or(t.biasConstraint),this.kernelRegularizer=js(t.kernelRegularizer),this.biasRegularizer=js(t.biasRegularizer),this.activityRegularizer=js(t.activityRegularizer),this.supportsMasking=!0,this.inputSpec=[{minNDim:2}]}build(t){const e=(t=Fi(t))[t.length-1];null==this.kernel&&(this.kernel=this.addWeight("kernel",[e,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:{[-1]:e}}],this.built=!0}computeOutputShape(t){const e=(t=Fi(t)).slice();return e[e.length-1]=this.units,e}call(t,e){return(0,u.tidy)((()=>{this.invokeCallHook(t,e);const n=Bi(t),r=Jn(this.activation.getClassName());let i;return null!=r?i=$r(n,this.kernel.read(),r,this.bias?this.bias.read():null):(i=$r(n,this.kernel.read()),null!=this.bias&&(i=Gr(i,this.bias.read())),null!=this.activation&&(i=this.activation.apply(i))),i}))}getConfig(){const t={units:this.units,activation:Os(this.activation),useBias:this.useBias,kernelInitializer:fi(this.kernelInitializer),biasInitializer:fi(this.biasInitializer),kernelRegularizer:$s(this.kernelRegularizer),biasRegularizer:$s(this.biasRegularizer),activityRegularizer:$s(this.activityRegularizer),kernelConstraint:ar(this.kernelConstraint),biasConstraint:ar(this.biasConstraint)},e=super.getConfig();return Object.assign(t,e),t}}Co.className="Dense",u.serialization.registerClass(Co);class Ro extends qi{constructor(t){super(t=t||{}),this.inputSpec=[{minNDim:3}],this.dataFormat=t.dataFormat}computeOutputShape(t){t=Fi(t);for(const e of t.slice(1))if(null==e)throw new Nn(`The shape of the input to "Flatten" is not fully defined (got ${t.slice(1)}). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.`);return[t[0],Ar(t,1)]}call(t,e){return(0,u.tidy)((()=>{this.invokeCallHook(t,e);let n=Bi(t);if("channelsFirst"===this.dataFormat&&n.rank>1){const t=[0];for(let e=2;e<n.rank;++e)t.push(e);t.push(1),n=(0,u.transpose)(n,t)}return function(t){if(t.rank<=1)throw new Nn(`batchFlatten requires a minimum rank of 2. Got rank: ${t.rank}.`);const e=[t.shape[0],Ar(t.shape,1)];return u.reshape(t,e)}(n)}))}getConfig(){const t={};null!=this.dataFormat&&(t.dataFormat=this.dataFormat);const e=super.getConfig();return Object.assign(t,e),t}}Ro.className="Flatten",u.serialization.registerClass(Ro);class Oo extends qi{constructor(t){super(t),this.supportsMasking=!0,this.activation=zs(t.activation)}call(t,e){return(0,u.tidy)((()=>{this.invokeCallHook(t,e);const n=Bi(t);return this.activation.apply(n)}))}getConfig(){const t={activation:Os(this.activation)},e=super.getConfig();return Object.assign(t,e),t}}Oo.className="Activation",u.serialization.registerClass(Oo);class Do extends qi{constructor(t){super(t),this.n=t.n,this.inputSpec=[{ndim:2}]}computeOutputShape(t){return[t[0],this.n,t[1]]}call(t,e){return(0,u.tidy)((()=>{return t=Bi(t),e=t,n=this.n,(0,u.tidy)((()=>{if(2!==e.shape.length)throw new Nn(`repeat() expects a rank-2 tensor, but received a rank-${e.shape.length} tensor.`);return Pr(Rr(e,1),[1,n,1])}));var e,n}))}getConfig(){const t={n:this.n},e=super.getConfig();return Object.assign(t,e),t}}Do.className="RepeatVector",u.serialization.registerClass(Do);class zo extends qi{constructor(t){super(t),this.targetShape=t.targetShape;for(let t=0;t<this.targetShape.length;++t)this.isUnknown(this.targetShape[t])&&(this.targetShape[t]=null)}isUnknown(t){return t<0||null==t}fixUnknownDimension(t,e){const n="Total size of new array must be unchanged.",r=e.slice();let i=1,a=null;for(let t=0;t<r.length;++t){const e=r[t];if(this.isUnknown(e)){if(null!==a)throw new Nn("Can only specifiy one unknown dimension.");a=t}else i*=e}const s=Ar(t);if(null!==a){if(0===i||s%i!=0)throw new Nn(n);r[a]=s/i}else if(s!==i)throw new Nn(n);return r}computeOutputShape(t){let e=!1;for(let n=0;n<t.length;++n)if(this.isUnknown(t[n])){e=!0;break}return e?t.slice(0,1).concat(this.targetShape):t.slice(0,1).concat(this.fixUnknownDimension(t.slice(1),this.targetShape))}call(t,e){return(0,u.tidy)((()=>{this.invokeCallHook(t,e);const n=Bi(t),r=n.shape,i=r.slice(0,1).concat(this.fixUnknownDimension(r.slice(1),this.targetShape));return(0,u.reshape)(n,i)}))}getConfig(){const t={targetShape:this.targetShape},e=super.getConfig();return Object.assign(t,e),t}}zo.className="Reshape",u.serialization.registerClass(zo);class Bo extends qi{constructor(t){if(super(t),null==t.dims)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(t.dims))throw new Error(`Permute constructor requires \`dims\` to be an Array, but received ${t.dims} instead.`);const e=Nr(1,t.dims.length+1);if(!u.util.arraysEqual(t.dims.slice().sort(),e))throw new Error("Invalid permutation `dims`: "+JSON.stringify(t.dims)+" `dims` must contain consecutive integers starting from 1.");this.dims=t.dims,this.dimsIncludingBatch=[0].concat(this.dims),this.inputSpec=[new ji({ndim:this.dims.length+1})]}computeOutputShape(t){const e=(t=Fi(t)).slice();return this.dims.forEach(((n,r)=>{e[r+1]=t[n]})),e}call(t,e){return(0,u.transpose)(Bi(t),this.dimsIncludingBatch)}getConfig(){const t={dims:this.dims},e=super.getConfig();return Object.assign(t,e),t}}Bo.className="Permute",u.serialization.registerClass(Bo);class Fo extends qi{constructor(t){super(null==t?{}:t),this.supportsMasking=!0,this.maskValue=null!=t?null==t.maskValue?0:t.maskValue:0}computeOutputShape(t){return t}getConfig(){const t=super.getConfig(),e={maskValue:this.maskValue};return Object.assign(e,t),e}computeMask(t,e){const n=Bi(t);return(0,u.any)((0,u.notEqual)(n,this.maskValue),-1)}call(t,e){return(0,u.tidy)((()=>{this.invokeCallHook(t,e);const n=Bi(t),r=(0,u.any)((0,u.notEqual)(n,this.maskValue),-1,!0);return(0,u.mul)(n,(0,u.cast)(r,n.dtype))}))}}Fo.className="Masking",u.serialization.registerClass(Fo);class Po extends qi{constructor(t){if(super(t),this.embeddings=null,this.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",null==t.batchInputShape&&null==t.inputShape){let e=null;null!=t.batchSize&&(e=t.batchSize),null==t.inputLength?this.batchInputShape=[e,null]:this.batchInputShape=[e].concat(Fn(t.inputLength))}this.inputDim=t.inputDim,Zn(this.inputDim,"inputDim"),this.outputDim=t.outputDim,Zn(this.outputDim,"outputDim"),this.embeddingsInitializer=pi(t.embeddingsInitializer||this.DEFAULT_EMBEDDINGS_INITIALIZER),this.embeddingsRegularizer=js(t.embeddingsRegularizer),this.activityRegularizer=js(t.activityRegularizer),this.embeddingsConstraint=or(t.embeddingsConstraint),this.maskZero=t.maskZero,this.supportsMasking=t.maskZero,this.inputLength=t.inputLength}build(t){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}warnOnIncompatibleInputShape(t){}computeMask(t,e){return(0,u.tidy)((()=>this.maskZero?(t=Bi(t),(0,u.notEqual)(t,(0,u.zerosLike)(t))):null))}computeOutputShape(t){if(t=Fi(t),null==this.inputLength)return[...t,this.outputDim];const e=Fn(this.inputLength);if(e.length!==t.length-1)throw new Nn(`"inputLength" is ${this.inputLength}, but received input shape has shape ${t}`);{let n=0;for(let r=0;r<e.length;++r){const i=e[r],a=t[r+1];if(null!=i&&null!=a&&i!==a)throw new Nn(`"inputLength" is ${this.inputLength}, but received input shape has shape ${t}`);null==i&&(e[n]=a),n++}}return[t[0],...e,this.outputDim]}call(t,e){return(0,u.tidy)((()=>{this.invokeCallHook(t,e);let n=Bi(t);"int32"!==n.dtype&&(n=Cr(n,"int32"));const r=Ur(this.embeddings.read(),(0,u.reshape)(n,[n.size]));return(0,u.reshape)(r,Fi(this.computeOutputShape(n.shape)))}))}getConfig(){const t={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:fi(this.embeddingsInitializer),embeddingsRegularizer:$s(this.embeddingsRegularizer),activityRegularizer:$s(this.activityRegularizer),embeddingsConstraint:ar(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},e=super.getConfig();return Object.assign(t,e),t}}Po.className="Embedding",u.serialization.registerClass(Po);class Lo extends qi{constructor(t){super(t||{}),this.supportsMasking=!0}mergeFunction(t){throw new Cn}computeElementwiseOpOutputShape(t,e){if(null==t||null==e)return null;if(t.length<e.length)return this.computeElementwiseOpOutputShape(e,t);if(0===e.length)return t;const n=t.slice(0,t.length-e.length);for(let r=0;r<e.length;++r){const i=t[t.length-e.length+r],a=e[r];if(null==i||null==a||i<0||a<0)n.push(null);else if(1===i)n.push(a);else if(1===a)n.push(i);else{if(i!==a)throw new Nn("Operands could not be broadcast together with shapes "+JSON.stringify(t)+" "+JSON.stringify(e));n.push(i)}}return n}build(t){if(Array.isArray(t)&&!Array.isArray(t[0])&&(t=[Fi(t)]),(t=t).length<2)throw new Nn(`A merge layer should be called on an Array of at least 2 inputs. Got ${t.length} input(s).`);let e=[];for(const n of t)null!=n&&null!==n[0]&&e.push(n[0]);if(e=Hn(e),e.length>1)throw new Nn(`Can not merge tensors with different batch sizes. Got tensors with shapes: ${JSON.stringify(t)}.`);let n=null==t[0]?null:t[0].slice(1);for(let e=1;e<t.length;++e){const r=null==t[e]?null:t[e].slice(1);n=this.computeElementwiseOpOutputShape(n,r)}const r=t.map((t=>t.length));-1===t.indexOf(null)&&1===Hn(r).length?this.reshapeRequired=!1:this.reshapeRequired=!0}call(t,e){return(0,u.tidy)((()=>{if(t=t,this.reshapeRequired){const e=[],n=t.map((t=>t.rank));if(-1===n.indexOf(null)){const r=Tr(n);for(let n of t){const t=n.rank;for(let e=0;e<r-t;++e)n=Rr(n,1);e.push(n)}return this.mergeFunction(e)}{let n=!1;for(const r of t){const t=r.rank;if(null==t){const t=r.shape,i=t[0],a=t.slice(1).concat([i]);let s=u.reshape(r,[i].concat(Ar(t.slice(1))));s=u.transpose(s,[1,0]),s=u.reshape(s,a),e.push(s),n=!0}else if(t>1){const i=Nr(1,t).concat([0]);e.push(u.transpose(r,i)),n=!0}else e.push(r)}let r=this.mergeFunction(e);const i=r.rank;if(n)if(null==i){const t=r.shape,e=t[t.length-1],n=[e].concat(t.slice(0,t.length-1));r=u.reshape(u.transpose(u.reshape(r,[-1,e]),[1,0]),n)}else if(i>1){const t=[i-1].concat(Nr(0,i-1));r=u.transpose(r,t)}return r}}return this.mergeFunction(t)}))}computeOutputShape(t){let e;e=null==(t=t)[0]?null:t[0].slice(1);for(let n=1;n<t.length;++n){const r=null==t[n]?null:t[n].slice(1);e=this.computeElementwiseOpOutputShape(e,r)}let n=[];for(const e of t)null!=e&&null!==e[0]&&n.push(e[0]);return n=Hn(n),e=1===n.length?n.concat(e):[null].concat(e),e}computeMask(t,e){return u.tidy((()=>{if(null==e)return null;if(!Array.isArray(e))throw new Nn("`mask` should be an Array");if(!Array.isArray(t))throw new Nn("`inputs` should be an Array");if(e.length!==t.length)throw new Nn(`The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths (${t.length} vs ${e.length})`);if(e.every((t=>null==t)))return null;let n=(e=e.map((t=>null==t?t:u.expandDims(t,0))))[0];for(let t=1;t<e.length-1;++t)n=u.logicalAnd(n,e[t]);return n}))}}class $o extends Lo{constructor(t){super(t)}mergeFunction(t){return(0,u.tidy)((()=>{let e=t[0].clone();for(let n=1;n<t.length;++n)e=u.add(e,t[n]);return e}))}}$o.className="Add",u.serialization.registerClass($o);class Uo extends Lo{constructor(t){super(t)}mergeFunction(t){return(0,u.tidy)((()=>{let e=t[0].clone();for(let n=1;n<t.length;++n)e=u.mul(e,t[n]);return e}))}}Uo.className="Multiply",u.serialization.registerClass(Uo);class jo extends Lo{constructor(t){super(t)}mergeFunction(t){return(0,u.tidy)((()=>{let e=t[0].clone();for(let n=1;n<t.length;++n)e=u.add(e,t[n]);return u.mul(1/t.length,e)}))}}jo.className="Average",u.serialization.registerClass(jo);class Wo extends Lo{constructor(t){super(t)}mergeFunction(t){return(0,u.tidy)((()=>{let e=t[0];for(let n=1;n<t.length;++n)e=u.maximum(e,t[n]);return e}))}}Wo.className="Maximum",u.serialization.registerClass(Wo);class Go extends Lo{constructor(t){super(t)}mergeFunction(t){return(0,u.tidy)((()=>{let e=t[0];for(let n=1;n<t.length;++n)e=u.minimum(e,t[n]);return e}))}}Go.className="Minimum",u.serialization.registerClass(Go);class Ho extends Lo{constructor(t){super(t),this.DEFAULT_AXIS=-1,null==t&&(t={}),this.axis=null==t.axis?this.DEFAULT_AXIS:t.axis,this.supportsMasking=!0,this.reshapeRequired=!1}build(t){if(!Array.isArray(t)||!Array.isArray(t[0])||1===t.length)throw new Nn("A `Concatenate` layer should be called on a list of at least 2 inputs");t=t;let e=!0;for(const n of t)if(null!=n){e=!1;break}if(e)return;const n=[];for(let e=0;e<t.length;++e){const r=t[e].slice();r.splice(this.axis,1);let i=!1;for(const t of n)if(u.util.arraysEqual(t,r)){i=!0;break}i||n.push(r)}if(n.length>1)throw new Nn("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(t))}mergeFunction(t){return(0,u.tidy)((()=>Br(t,this.axis)))}computeOutputShape(t){if(!Array.isArray(t)||!Array.isArray(t[0]))throw new Nn("A `Concatenate` layer should be called on a list of inputs.");const e=t,n=e[0].slice(),r=this.axis<0?n.length+this.axis:this.axis;for(const t of e.slice(1)){if(null==n[r]||null==t[r]){n[r]=null;break}n[r]+=t[r]}return n}computeMask(t,e){if(null==e)return null;if(!Array.isArray(e))throw new Nn("`mask` should be an array for Concatenate");if(!Array.isArray(t))throw new Nn("`inputs` should be an array for Concatenate");if(e.length!==t.length)throw new Nn(`Mismatch in the length of mask (${e.length}) and the legnth of inputs (${t.length})`);return u.tidy((()=>{let n=!0;if(e.forEach((t=>{null==t||(n=!1)})),n)return null;const r=[];for(let n=0;n<t.length;++n)null==e[n]?r.push(u.cast(u.onesLike(t[n]),"bool")):e[n].rank<t[n].rank?r.push(u.expandDims(e[n],-1)):r.push(e[n]);const i=u.concat(r,this.axis);return u.all(i,-1,!1)}))}getConfig(){const t={axis:this.axis},e=super.getConfig();return Object.assign(t,e),t}}function Vo(t,e){for(;t<0;)t+=e;return t}Ho.className="Concatenate",u.serialization.registerClass(Ho);class qo extends Lo{constructor(t){super(t),this.axes=t.axes,this.normalize=null!=t.normalize&&t.normalize,this.supportsMasking=!0,this.reshapeRequired=!1}build(t){u.util.assert(Array.isArray(t)&&2===t.length&&Array.isArray(t[0])&&Array.isArray(t[1]),(()=>"A `Dot` layer should be called on a list of exactly 2 inputs."));const e=t[0],n=t[1];if(e.length>3||n.length>3)throw new Cn("Dot layer does not support tensors of 4D or higher rank yet.");const r=this.interpretAxes(e,n);if(e[r[0]]!==n[r[1]])throw new Nn(`Dimension incompatibility: ${e[r[0]]} !== ${n[r[1]]}`)}mergeFunction(t){if(2!==t.length)throw new Nn(`A \`Dot\` layer must be called on exactly 2 inputs, but received ${t.length} input(s).`);let e,n=t[0],r=t[1];return e=Array.isArray(this.axes)?this.axes.map(((e,n)=>Vo(e,t[n].shape.length))):[Vo(this.axes,n.shape.length),Vo(this.axes,r.shape.length)],this.normalize&&(n=ua(n,e[0]),r=ua(r,e[1])),function(t,e,n){if(t.shape.length>3||e.shape.length>3)throw new Cn("batchDot is not implemented for tensors of 4D or higher rank yet");if(u.util.assert(t.shape.length>=2,(()=>`batchDot requires the rank of x to be >= 2, but got ${t.shape.length}`)),u.util.assert(t.shape.length>=2,(()=>`batchDot requires the rank of y to be >= 2, but got ${e.shape.length}`)),"number"==typeof n&&(n=[n,n]),"complex64"===t.dtype||"complex64"===e.dtype)throw new Cn("batchDot is not implemented for complex64-type Tensors yet.");const r=t.shape.length,i=e.shape.length;null==n&&(n=[r-1,i-2]);const a=n;return u.tidy((()=>{let n,s;if(r>i){n=r-i;const t=[];for(let e=0;e<n;++e)t.push(1);e=u.reshape(e,e.shape.concat(t))}else if(i>r){n=i-r;const e=[];for(let t=0;t<n;++t)e.push(1);t=u.reshape(t,t.shape.concat(e))}else n=0;if(2===t.shape.length&&2===e.shape.length)s=a[0]===a[1]?u.sum(u.mul(t,e),a[0]):u.sum(u.mul(u.transpose(t,[1,0]),e),a[1]);else{const n=a[0]!==t.shape.length-1,r=a[1]===e.shape.length-1;s=u.matMul(t,e,n,r)}if(n>0){let t;t=r>i?r+i-3:r-1;const e=[];for(let r=t;r<t+n;++r)e.push(r);s=u.squeeze(s,e)}return 1===s.shape.length&&(s=u.expandDims(s,1)),s}))}(n,r,e)}interpretAxes(t,e){let n;return n=Array.isArray(this.axes)?this.axes:[Vo(this.axes,t.length),Vo(this.axes,e.length)],n}computeOutputShape(t){u.util.assert(Array.isArray(t)&&2===t.length&&Array.isArray(t[0])&&Array.isArray(t[1]),(()=>"A `Dot` layer should be called on a list of exactly 2 inputs."));const e=t[0].slice(),n=t[1].slice();if(e.length>3||n.length>3)throw new Cn("Dot layer does not support tensors of 4D or higher rank yet.");const r=this.interpretAxes(e,n);e.splice(r[0],1),n.splice(r[1],1),n.splice(0,1);const i=e.concat(n);return 1===i.length&&i.push(1),i}computeMask(t,e){return null}getConfig(){const t={axes:this.axes,normalize:this.normalize},e=super.getConfig();return Object.assign(t,e),t}}qo.className="Dot",u.serialization.registerClass(qo);class Ko extends qi{constructor(t){super(t),this.supportsMasking=!0,this.stddev=t.stddev}computeOutputShape(t){return t}getConfig(){const t=super.getConfig(),e={stddev:this.stddev};return Object.assign(e,t),e}call(t,e){return(0,u.tidy)((()=>{this.invokeCallHook(t,e);const n=Bi(t);return Vr((()=>(0,u.add)(Lr(n.shape,0,this.stddev),n)),(()=>n),e.training||!1)}))}}Ko.className="GaussianNoise",u.serialization.registerClass(Ko);class Zo extends qi{constructor(t){super(t),this.supportsMasking=!0,this.rate=t.rate}computeOutputShape(t){return t}getConfig(){const t=super.getConfig(),e={rate:this.rate};return Object.assign(e,t),e}call(t,e){return(0,u.tidy)((()=>{this.invokeCallHook(t,e);const n=Bi(t);return this.rate>0&&this.rate<1?Vr((()=>{const t=Math.sqrt(this.rate/(1-this.rate));return(0,u.mul)(n,Lr(n.shape,1,t))}),(()=>n),e.training||!1):n}))}}Zo.className="GaussianDropout",u.serialization.registerClass(Zo);class Xo extends qi{constructor(t){super(t),this.supportsMasking=!0,this.rate=t.rate,this.noiseShape=t.noiseShape}_getNoiseShape(t){return this.noiseShape||Bi(t).shape}computeOutputShape(t){return t}getConfig(){const t=super.getConfig(),e={rate:this.rate};return Object.assign(e,t),e}call(t,e){return(0,u.tidy)((()=>{if(this.rate<1&&this.rate>0){const n=this._getNoiseShape(t),r=()=>{const e=Bi(t),r=-1.7580993408473766;let i=(0,u.greaterEqual)((0,u.randomUniform)(n),this.rate);i=Cr(i,"float32");const a=((1-this.rate)*(1+this.rate*r**2))**-.5,s=-a*r*this.rate,o=(0,u.add)((0,u.mul)(e,i),(0,u.mul)((0,u.add)(i,-1),r));return(0,u.add)((0,u.mul)(o,a),s)};return Vr(r,(()=>Bi(t)),e.training||!1)}return t}))}}function Jo(t,e,n,r,i,a=.001){let s;if(2===t.rank)s=u.batchNorm2d(t,e,n,r,i,a);else if(3===t.rank)s=u.batchNorm3d(t,e,n,r,i,a);else{if(4!==t.rank)throw new Cn(`batchNormalization is not implemented for array of rank ${t.rank} yet`);s=u.batchNorm4d(t,e,n,r,i,a)}return s}Xo.className="AlphaDropout",u.serialization.registerClass(Xo);class Yo extends qi{constructor(t){null==t&&(t={}),super(t),this.supportsMasking=!0,this.axis=null==t.axis?-1:t.axis,this.momentum=null==t.momentum?.99:t.momentum,this.epsilon=null==t.epsilon?.001:t.epsilon,this.center=null==t.center||t.center,this.scale=null==t.scale||t.scale,this.betaInitializer=pi(t.betaInitializer||"zeros"),this.gammaInitializer=pi(t.gammaInitializer||"ones"),this.movingMeanInitializer=pi(t.movingMeanInitializer||"zeros"),this.movingVarianceInitializer=pi(t.movingVarianceInitializer||"ones"),this.betaConstraint=or(t.betaConstraint),this.gammaConstraint=or(t.gammaConstraint),this.betaRegularizer=js(t.betaRegularizer),this.gammaRegularizer=js(t.gammaRegularizer)}build(t){t=Fi(t);const e=this.axis>=0?this.axis:this.axis+t.length,n=t[e];if(null==n)throw new Nn(`Axis ${e} of input tensor should have a defined dimension but the layer received an input with shape ${JSON.stringify(t)}.`);this.inputSpec=[new ji({ndim:t.length,axes:{[e]:n}})];const r=[n];this.scale&&(this.gamma=this.addWeight("gamma",r,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",r,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",r,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",r,null,this.movingVarianceInitializer,null,!1),this.built=!0}call(t,e){return(0,u.tidy)((()=>{const n=null!=e.training&&e.training,r=Bi(t),i=r.shape,a=i.length,s=Nr(0,a),o=this.axis>=0?this.axis:this.axis+a;s.splice(o,1);const l=On(1,a);l[o]=i[o];const h=s.slice();h.sort();const c=!u.util.arraysEqual(h,Nr(0,a).slice(0,a-1));if(!n)return(()=>{if(c){const t=(0,u.reshape)(this.movingMean.read(),l),e=(0,u.reshape)(this.movingVariance.read(),l),n=this.center?(0,u.reshape)(this.beta.read(),l):null,i=this.scale?(0,u.reshape)(this.gamma.read(),l):null;return Jo(r,t,e,n,i,this.epsilon)}return Jo(r,this.movingMean.read(),this.movingVariance.read(),null==this.beta?null:this.beta.read(),null==this.gamma?null:this.gamma.read(),this.epsilon)})();const[d,f,p]=function(t,e,n,r,i=.001){return u.util.arraysEqual(r.slice().sort(),Nr(0,t.rank-1))?function(t,e,n,r,i=.001){return(0,u.tidy)((()=>{const a=u.moments(t,r),s=a.mean,o=a.variance;return[Jo(t,s,o,n,e,i),s,o]}))}(t,e,n,r,i):function(t,e,n,r,i=.001){return(0,u.tidy)((()=>{const a=u.moments(t,r),s=a.mean,o=a.variance,l=[];for(const e of Nr(0,t.rank))-1!==r.indexOf(e)?l.push(1):l.push(t.shape[e]);const h=(0,u.reshape)(s,l),c=(0,u.reshape)(o,l),d=null==e?null:(0,u.reshape)(e,l),f=null==n?null:(0,u.reshape)(n,l);return[Jo(t,h,c,f,d,i),s,o]}))}(t,e,n,r,i)}(r,this.gamma.read(),this.beta.read(),s,this.epsilon),m=(t,e,n)=>{u.tidy((()=>{const r=1-n,i=t.read(),a=u.mul(u.sub(i,e),r);t.write(u.sub(i,a))}))};return(()=>{m(this.movingMean,f,this.momentum),m(this.movingVariance,p,this.momentum)})(),d}))}getConfig(){const t={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:fi(this.betaInitializer),gammaInitializer:fi(this.gammaInitializer),movingMeanInitializer:fi(this.movingMeanInitializer),movingVarianceInitializer:fi(this.movingVarianceInitializer),betaRegularizer:$s(this.betaRegularizer),gammaRegularizer:$s(this.gammaRegularizer),betaConstraint:ar(this.betaConstraint),gammaConstraint:ar(this.gammaConstraint)},e=super.getConfig();return Object.assign(t,e),t}}Yo.className="BatchNormalization",u.serialization.registerClass(Yo);class Qo extends qi{constructor(t){if(null==t&&(t={}),super(t),this.axis=null==t.axis?-1:t.axis,"number"==typeof this.axis){if(!Number.isInteger(this.axis))throw new Error(`Expected axis to be an integer, but received ${this.axis}`)}else{if(!Array.isArray(this.axis))throw new Error(`Expected axis to be an integer or an array of integers, but received ${JSON.stringify(this.axis)}`);for(const t of this.axis)if(!Number.isInteger(t))throw new Error(`Expected axis to be an array of integers, but received ${JSON.stringify(this.axis)}`)}this.epsilon=null==t.epsilon?.001:t.epsilon,this.center=null==t.center||t.center,this.scale=null==t.scale||t.scale,this.betaInitializer=pi(t.betaInitializer||"zeros"),this.gammaInitializer=pi(t.gammaInitializer||"ones"),this.betaRegularizer=js(t.betaRegularizer),this.gammaRegularizer=js(t.gammaRegularizer),this.supportsMasking=!0}build(t){const e=(t=Fi(t)).length;"number"==typeof this.axis&&(this.axis=[this.axis]);for(let t=0;t<this.axis.length;++t)this.axis[t]<0&&(this.axis[t]+=e);for(const t of this.axis)if(t<0||t>=e)throw new Error(`Invalid axis: ${t}`);if(this.axis.length!==Hn(this.axis).length)throw new Error(`Found duplicate axes in: ${this.axis}`);const n=this.axis.map((e=>t[e]));this.scale?this.gamma=this.addWeight("gamma",n,"float32",this.gammaInitializer,this.gammaRegularizer,!0):this.gamma=null,this.center?this.beta=this.addWeight("beta",n,"float32",this.betaInitializer,this.betaRegularizer,!0):this.beta=null,this.built=!0}call(t,e){const n=Bi(t),r=n.shape,i=r.length;return(0,u.tidy)((()=>{let{mean:t,variance:e}=(0,u.moments)(n,this.axis,!0);const a=On(1,i);for(const t of this.axis)a[t]=r[t];const s=t=>null!=t&&t.shape.length!==i?u.reshape(t,a):t;let o=s(this.gamma.read()),l=s(this.beta.read());const h=[],c=[];for(let t=0;t<i;++t)-1!==this.axis.indexOf(t)?(h.push(r[t]),c.push(1)):(h.push(1),c.push(r[t]));return t=u.tile(t,h),e=u.tile(e,h),o=u.tile(o,c),l=u.tile(l,c),Jo(n,t,e,l,o,this.epsilon)}))}getConfig(){const t={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:fi(this.betaInitializer),gammaInitializer:fi(this.gammaInitializer),betaRegularizer:$s(this.betaRegularizer),gammaRegularizer:$s(this.gammaRegularizer)},e=super.getConfig();return Object.assign(t,e),t}}Qo.className="LayerNormalization",u.serialization.registerClass(Qo);class tl extends qi{constructor(t){if(null==t&&(t={}),super(t),this.dataFormat=null==t.dataFormat?"channelsLast":t.dataFormat,null==t.padding)this.padding=[[1,1],[1,1]];else if("number"==typeof t.padding)this.padding=[[t.padding,t.padding],[t.padding,t.padding]];else{if(t.padding=t.padding,2!==t.padding.length)throw new Nn(`ZeroPadding2D expects padding to be a length-2 array, but received a length-${t.padding.length} array.`);let e,n;if("number"==typeof t.padding[0])e=[t.padding[0],t.padding[0]],n=[t.padding[1],t.padding[1]];else{if(t.padding=t.padding,2!==t.padding[0].length)throw new Nn(`ZeroPadding2D expects height padding to be a length-2 array, but received a length-${t.padding[0].length} array.`);if(e=t.padding[0],2!==t.padding[1].length)throw new Nn(`ZeroPadding2D expects width padding to be a length-2 array, but received a length-${t.padding[1].length} array.`);n=t.padding[1]}this.padding=[e,n]}this.inputSpec=[new ji({ndim:4})]}computeOutputShape(t){let e,n;return t=Fi(t),"channelsFirst"===this.dataFormat?(e=null!=t[2]&&t[2]>=0?t[2]+this.padding[0][0]+this.padding[0][1]:null,n=null!=t[3]&&t[3]>=0?t[3]+this.padding[1][0]+this.padding[1][1]:null,[t[0],t[1],e,n]):(e=null!=t[1]&&t[1]>=0?t[1]+this.padding[0][0]+this.padding[0][1]:null,n=null!=t[2]&&t[2]>=0?t[2]+this.padding[1][0]+this.padding[1][1]:null,[t[0],e,n,t[3]])}call(t,e){return(0,u.tidy)((()=>{return e=Bi(t),n=this.padding,r=this.dataFormat,(0,u.tidy)((()=>{if(4!==e.rank)throw new Nn(`temporalPadding expects input tensor to be 4-D, but received a ${e.rank}-D tensor.`);if(null==n&&(n=[[1,1],[1,1]]),2!==n.length||2!==n[0].length||2!==n[1].length)throw new Nn("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(null==r&&(r="channelsLast"),"channelsLast"!==r&&"channelsFirst"!==r)throw new Nn(`Unknown data format: ${r}. Supported data formats are 'channelsLast' and 'channelsFirst.`);let t;return t="channelsFirst"===r?[[0,0],[0,0],n[0],n[1]]:[[0,0],n[0],n[1],[0,0]],u.pad(e,t)}));var e,n,r}))}getConfig(){const t={padding:this.padding,dataFormat:this.dataFormat},e=super.getConfig();return Object.assign(t,e),t}}function el(t,e,n,r,i,a){return(0,u.tidy)((()=>{let s;yr(i),wr(a),vr(r),null==n&&(n=[1,1]),null==r&&(r="valid"),null==i&&(i="channelsLast"),null==a&&(a="max"),t=Ys(t,i);const o="same"===r?"same":"valid";return s="max"===a?u.maxPool(t,e,n,o):u.avgPool(t,e,n,o),"channelsFirst"===i&&(s=u.transpose(s,[0,3,1,2])),s}))}function nl(t,e,n,r,i,a){return(0,u.tidy)((()=>{let s;yr(i),wr(a),vr(r),null==n&&(n=[1,1,1]),null==r&&(r="valid"),null==i&&(i="channelsLast"),null==a&&(a="max"),t=Qs(t,i);const o="same"===r?"same":"valid";return s="max"===a?u.maxPool3d(t,e,n,o):u.avgPool3d(t,e,n,o),"channelsFirst"===i&&(s=u.transpose(s,[0,4,1,2,3])),s}))}tl.className="ZeroPadding2D",u.serialization.registerClass(tl);class rl extends qi{constructor(t){if(null==t.poolSize&&(t.poolSize=2),super(t),"number"==typeof t.poolSize)this.poolSize=[t.poolSize];else{if(!Array.isArray(t.poolSize)||1!==t.poolSize.length||"number"!=typeof t.poolSize[0])throw new Nn(`poolSize for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(t.poolSize)}`);this.poolSize=t.poolSize}if(Zn(this.poolSize,"poolSize"),null==t.strides)this.strides=this.poolSize;else if("number"==typeof t.strides)this.strides=[t.strides];else{if(!Array.isArray(t.strides)||1!==t.strides.length||"number"!=typeof t.strides[0])throw new Nn(`strides for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(t.strides)}`);this.strides=t.strides}Zn(this.strides,"strides"),this.padding=null==t.padding?"valid":t.padding,vr(this.padding),this.inputSpec=[new ji({ndim:3})]}computeOutputShape(t){const e=Xs((t=Fi(t))[1],this.poolSize[0],this.padding,this.strides[0]);return[t[0],e,t[2]]}call(t,e){return(0,u.tidy)((()=>{this.invokeCallHook(t,e),t=Rr(Bi(t),2);const n=this.poolingFunction(Bi(t),[this.poolSize[0],1],[this.strides[0],1],this.padding,"channelsLast");return u.squeeze(n,[2])}))}getConfig(){const t={poolSize:this.poolSize,padding:this.padding,strides:this.strides},e=super.getConfig();return Object.assign(t,e),t}}class il extends rl{constructor(t){super(t)}poolingFunction(t,e,n,r,i){return yr(i),vr(r),el(t,e,n,r,i,"max")}}il.className="MaxPooling1D",u.serialization.registerClass(il);class al extends rl{constructor(t){super(t)}poolingFunction(t,e,n,r,i){return yr(i),vr(r),el(t,e,n,r,i,"avg")}}al.className="AveragePooling1D",u.serialization.registerClass(al);class sl extends qi{constructor(t){if(null==t.poolSize&&(t.poolSize=[2,2]),super(t),this.poolSize=Array.isArray(t.poolSize)?t.poolSize:[t.poolSize,t.poolSize],null==t.strides)this.strides=this.poolSize;else if(Array.isArray(t.strides)){if(2!==t.strides.length)throw new Nn(`If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length ${t.strides.length}.`);this.strides=t.strides}else this.strides=[t.strides,t.strides];Zn(this.poolSize,"poolSize"),Zn(this.strides,"strides"),this.padding=null==t.padding?"valid":t.padding,this.dataFormat=null==t.dataFormat?"channelsLast":t.dataFormat,yr(this.dataFormat),vr(this.padding),this.inputSpec=[new ji({ndim:4})]}computeOutputShape(t){t=Fi(t);let e="channelsFirst"===this.dataFormat?t[2]:t[1],n="channelsFirst"===this.dataFormat?t[3]:t[2];return e=Xs(e,this.poolSize[0],this.padding,this.strides[0]),n=Xs(n,this.poolSize[1],this.padding,this.strides[1]),"channelsFirst"===this.dataFormat?[t[0],t[1],e,n]:[t[0],e,n,t[3]]}call(t,e){return(0,u.tidy)((()=>(this.invokeCallHook(t,e),this.poolingFunction(Bi(t),this.poolSize,this.strides,this.padding,this.dataFormat))))}getConfig(){const t={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},e=super.getConfig();return Object.assign(t,e),t}}class ol extends sl{constructor(t){super(t)}poolingFunction(t,e,n,r,i){return yr(i),vr(r),el(t,e,n,r,i,"max")}}ol.className="MaxPooling2D",u.serialization.registerClass(ol);class ll extends sl{constructor(t){super(t)}poolingFunction(t,e,n,r,i){return yr(i),vr(r),el(t,e,n,r,i,"avg")}}ll.className="AveragePooling2D",u.serialization.registerClass(ll);class ul extends qi{constructor(t){if(null==t.poolSize&&(t.poolSize=[2,2,2]),super(t),this.poolSize=Array.isArray(t.poolSize)?t.poolSize:[t.poolSize,t.poolSize,t.poolSize],null==t.strides)this.strides=this.poolSize;else if(Array.isArray(t.strides)){if(3!==t.strides.length)throw new Nn(`If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length ${t.strides.length}.`);this.strides=t.strides}else this.strides=[t.strides,t.strides,t.strides];Zn(this.poolSize,"poolSize"),Zn(this.strides,"strides"),this.padding=null==t.padding?"valid":t.padding,this.dataFormat=null==t.dataFormat?"channelsLast":t.dataFormat,yr(this.dataFormat),vr(this.padding),this.inputSpec=[new ji({ndim:5})]}computeOutputShape(t){t=Fi(t);let e="channelsFirst"===this.dataFormat?t[2]:t[1],n="channelsFirst"===this.dataFormat?t[3]:t[2],r="channelsFirst"===this.dataFormat?t[4]:t[3];return e=Xs(e,this.poolSize[0],this.padding,this.strides[0]),n=Xs(n,this.poolSize[1],this.padding,this.strides[1]),r=Xs(r,this.poolSize[2],this.padding,this.strides[2]),"channelsFirst"===this.dataFormat?[t[0],t[1],e,n,r]:[t[0],e,n,r,t[4]]}call(t,e){return(0,u.tidy)((()=>(this.invokeCallHook(t,e),this.poolingFunction(Bi(t),this.poolSize,this.strides,this.padding,this.dataFormat))))}getConfig(){const t={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},e=super.getConfig();return Object.assign(t,e),t}}class hl extends ul{constructor(t){super(t)}poolingFunction(t,e,n,r,i){return yr(i),vr(r),nl(t,e,n,r,i,"max")}}hl.className="MaxPooling3D",u.serialization.registerClass(hl);class cl extends ul{constructor(t){super(t)}poolingFunction(t,e,n,r,i){return yr(i),vr(r),nl(t,e,n,r,i,"avg")}}cl.className="AveragePooling3D",u.serialization.registerClass(cl);class dl extends qi{constructor(t){super(t),this.inputSpec=[new ji({ndim:3})]}computeOutputShape(t){return[t[0],t[2]]}call(t,e){throw new Cn}}class fl extends dl{constructor(t){super(t||{})}call(t,e){return(0,u.tidy)((()=>{const e=Bi(t);return u.mean(e,1)}))}}fl.className="GlobalAveragePooling1D",u.serialization.registerClass(fl);class pl extends dl{constructor(t){super(t||{})}call(t,e){return(0,u.tidy)((()=>{const e=Bi(t);return u.max(e,1)}))}}pl.className="GlobalMaxPooling1D",u.serialization.registerClass(pl);class ml extends qi{constructor(t){super(t),this.dataFormat=null==t.dataFormat?"channelsLast":t.dataFormat,yr(this.dataFormat),this.inputSpec=[new ji({ndim:4})]}computeOutputShape(t){return t=t,"channelsLast"===this.dataFormat?[t[0],t[3]]:[t[0],t[1]]}call(t,e){throw new Cn}getConfig(){const t={dataFormat:this.dataFormat},e=super.getConfig();return Object.assign(t,e),t}}class gl extends ml{call(t,e){return(0,u.tidy)((()=>{const e=Bi(t);return"channelsLast"===this.dataFormat?u.mean(e,[1,2]):u.mean(e,[2,3])}))}}gl.className="GlobalAveragePooling2D",u.serialization.registerClass(gl);class bl extends ml{call(t,e){return(0,u.tidy)((()=>{const e=Bi(t);return"channelsLast"===this.dataFormat?u.max(e,[1,2]):u.max(e,[2,3])}))}}bl.className="GlobalMaxPooling2D",u.serialization.registerClass(bl);class yl extends qi{constructor(t){super(t),this.layer=t.layer}build(t){this.built=!0}get trainable(){return null!=this.layer&&this.layer.trainable}set trainable(t){null!=this.layer&&(this.layer.trainable=t)}get trainableWeights(){return this.layer.trainableWeights}get nonTrainableWeights(){return this.layer.nonTrainableWeights}get updates(){return this.layer._updates}get losses(){return this.layer.losses}getWeights(){return this.layer.getWeights()}setWeights(t){this.layer.setWeights(t)}getConfig(){const t={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},e=super.getConfig();return Object.assign(t,e),t}setFastWeightInitDuringBuild(t){super.setFastWeightInitDuringBuild(t),null!=this.layer&&this.layer.setFastWeightInitDuringBuild(t)}static fromConfig(t,e,n={}){const r=la(e.layer,n);delete e.layer;const i={layer:r};return Object.assign(i,e),new t(i)}}class vl extends yl{constructor(t){super(t),this.supportsMasking=!0}build(t){if((t=Fi(t)).length<3)throw new Nn(`TimeDistributed layer expects an input shape >= 3D, but received input shape ${JSON.stringify(t)}`);this.inputSpec=[{shape:t}];const e=[t[0]].concat(t.slice(2));this.layer.built||(this.layer.build(e),this.layer.built=!0),super.build(t)}computeOutputShape(t){const e=[(t=Fi(t))[0]].concat(t.slice(2)),n=this.layer.computeOutputShape(e),r=t[1];return[n[0],r].concat(n.slice(1))}call(t,e){return(0,u.tidy)((()=>mo(((t,n)=>[Bi(this.layer.call(t,e)),[]]),t=Bi(t),[],!1,null,null,!1,!0)[1]))}}vl.className="TimeDistributed",u.serialization.registerClass(vl);class wl extends yl{constructor(t){super(t);const e=t.layer.getConfig(),n={};n.className=t.layer.getClassName(),n.config=e,this.forwardLayer=la(n),e.goBackwards=!0!==e.goBackwards;const r={};var i;if(r.className=t.layer.getClassName(),r.config=e,this.backwardLayer=la(r),this.forwardLayer.name="forward_"+this.forwardLayer.name,this.backwardLayer.name="backward_"+this.backwardLayer.name,this.mergeMode=void 0===t.mergeMode?"concat":t.mergeMode,i=this.mergeMode,qn(gr,"BidirectionalMergeMode",i),t.weights)throw new Cn("weights support is not implemented for Bidirectional layer yet.");this._stateful=t.layer.stateful,this.returnSequences=t.layer.returnSequences,this.returnState=t.layer.returnState,this.supportsMasking=!0,this._trainable=!0,this.inputSpec=t.layer.inputSpec,this.numConstants=null}get trainable(){return this._trainable}set trainable(t){this._trainable=t,null!=this.forwardLayer&&(this.forwardLayer.trainable=t),null!=this.backwardLayer&&(this.backwardLayer.trainable=t)}getWeights(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}setWeights(t){const e=t.length,n=Math.floor(e/2);this.forwardLayer.setWeights(t.slice(0,n)),this.backwardLayer.setWeights(t.slice(n))}computeOutputShape(t){let e,n,r,i=this.forwardLayer.computeOutputShape(t);return Array.isArray(i)&&Array.isArray(i[0])||(i=[i]),i=i,this.returnState?(r=i.slice(1),e=i[0]):e=i[0],e=e,"concat"===this.mergeMode?(e[e.length-1]*=2,n=[e]):n=null==this.mergeMode?[e,e.slice()]:[e],this.returnState?null==this.mergeMode?n.concat(r).concat(r.slice()):[e].concat(r).concat(r.slice()):Bn(n)}apply(t,e){let n=null==e?null:e.initialState,r=null==e?null:e.constants;null==e&&(e={});const i=po(t,n,r,this.numConstants);if(t=i.inputs,n=i.initialState,r=i.constants,Array.isArray(t)&&(n=t.slice(1),t=t[0]),(null==n||0===n.length)&&null==r)return super.apply(t,e);const a=[],s=[];if(null!=n){const t=n.length;if(t%2>0)throw new Nn("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");e.initialState=n,a.push(...n);const r=n.map((t=>new ji({shape:t.shape})));this.forwardLayer.stateSpec=r.slice(0,t/2),this.backwardLayer.stateSpec=r.slice(t/2),s.push(...r)}if(null!=r)throw new Cn("Support for constants in Bidirectional layers is not implemented yet.");const o=a[0]instanceof Wi;for(const t of a)if(t instanceof Wi!==o)throw new Nn("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(o){const n=[t].concat(a),r=this.inputSpec.concat(s),i=this.inputSpec;this.inputSpec=r;const o=super.apply(n,e);return this.inputSpec=i,o}return super.apply(t,e)}call(t,e){return(0,u.tidy)((()=>{const n=e.initialState;let r,i,a,s;if(null==n)r=this.forwardLayer.call(t,e),i=this.backwardLayer.call(t,e);else{const a=n.slice(0,n.length/2),s=n.slice(n.length/2);r=this.forwardLayer.call(t,Object.assign(e,{initialState:a})),i=this.backwardLayer.call(t,Object.assign(e,{initialState:s}))}return this.returnState&&(Array.isArray(r)&&(a=r.slice(1).concat(i.slice(1))),r=r[0],i=i[0]),this.returnSequences&&(i=u.reverse(i,1)),"concat"===this.mergeMode?s=Br([r,i]):"sum"===this.mergeMode?s=u.add(r,i):"ave"===this.mergeMode?s=u.mul(.5,u.add(r,i)):"mul"===this.mergeMode?s=u.mul(r,i):null==this.mergeMode&&(s=[r,i]),this.returnState?null==this.mergeMode?s.concat(a):[s].concat(a):s}))}resetStates(t){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}build(t){kr(this.forwardLayer.name,(()=>{this.forwardLayer.build(t)})),kr(this.backwardLayer.name,(()=>{this.backwardLayer.build(t)})),this.built=!0}computeMask(t,e){let n;if(Array.isArray(e)&&(e=e[0]),n=this.returnSequences?null==this.mergeMode?[e,e]:e:null==this.mergeMode?[null,null]:null,this.returnState){const t=this.forwardLayer.states.map((t=>null));return Array.isArray(n)?n.concat(t).concat(t):[n].concat(t).concat(t)}return n}get trainableWeights(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}get nonTrainableWeights(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}setFastWeightInitDuringBuild(t){super.setFastWeightInitDuringBuild(t),null!=this.forwardLayer&&this.forwardLayer.setFastWeightInitDuringBuild(t),null!=this.backwardLayer&&this.backwardLayer.setFastWeightInitDuringBuild(t)}getConfig(){const t={mergeMode:this.mergeMode},e=super.getConfig();return Object.assign(t,e),t}static fromConfig(t,e){const n=la(e.layer);if(delete e.layer,null!=e.numConstants)throw new Cn("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");const r=e;return r.layer=n,new t(r)}}function _l(t){return new Zi(t)}function kl(t){return new Vs(t)}function xl(t){return new Ws(t)}function Sl(t){return new Gs(t)}function El(t){return new Hs(t)}function Il(t){return new Ks(t)}function Al(t){return new qs(t)}function Ml(t){return new uo(t)}function Tl(t){return new ro(t)}function Nl(t){return new ao(t)}function Cl(t){return new io(t)}function Rl(t){return new so(t)}function Ol(t){return new lo(t)}function Dl(t){return new ho(t)}function zl(t){return new co(t)}function Bl(t){return new fo(t)}function Fl(t){return new Oo(t)}function Pl(t){return new Co(t)}function Ll(t){return new To(t)}function $l(t){return new No(t)}function Ul(t){return new Ro(t)}function jl(t){return new Do(t)}function Wl(t){return new zo(t)}function Gl(t){return new Bo(t)}function Hl(t){return new Po(t)}function Vl(t){return new $o(t)}function ql(t){return new jo(t)}function Kl(t){return new Ho(t)}function Zl(t){return new Wo(t)}function Xl(t){return new Go(t)}function Jl(t){return new Uo(t)}function Yl(t){return new qo(t)}function Ql(t){return new Yo(t)}function tu(t){return new Qo(t)}function eu(t){return new tl(t)}function nu(t){return new al(t)}function ru(t){return nu(t)}function iu(t){return nu(t)}function au(t){return new ll(t)}function su(t){return au(t)}function ou(t){return au(t)}function lu(t){return new cl(t)}function uu(t){return lu(t)}function hu(t){return lu(t)}function cu(t){return new fl(t)}function du(t){return new gl(t)}function fu(t){return new pl(t)}function pu(t){return new bl(t)}function mu(t){return new il(t)}function gu(t){return new ol(t)}function bu(t){return new hl(t)}function yu(t){return new _o(t)}function vu(t){return new wo(t)}function wu(t){return new xo(t)}function _u(t){return new ko(t)}function ku(t){return new vo(t)}function xu(t){return new yo(t)}function Su(t){return new Mo(t)}function Eu(t){return new Ao(t)}function Iu(t){return new go(t)}function Au(t){return new So(t)}function Mu(t){return new wl(t)}function Tu(t){return new vl(t)}wl.className="Bidirectional",u.serialization.registerClass(wl);const Nu=fu,Cu=pu,Ru=mu,Ou=gu;function Du(t){return new Ko(t)}function zu(t){return new Zo(t)}function Bu(t){return new Xo(t)}function Fu(t){return new Fo(t)}function Pu(t,e){return va(t,e)}function Lu(t,e){return xa(t,e)}function $u(t,e){return Sa(t,e)}function Uu(t,e){return wa(t,e)}function ju(t,e){return Ea(t,e)}function Wu(t,e){return ka(t,e)}function Gu(t,e){return function(t,e){return(0,u.tidy)((()=>{const n=_a(t,e),r=function(t,e){return(0,u.tidy)((()=>u.cast(u.sum(u.logicalAnd(u.equal(t,1),u.equal(e,0))),"float32")))}(t,e),i=u.add(n,r);return u.cast(u.where(u.greater(i,0),u.div(n,i),0),"float32")}))}(t,e)}function Hu(t,e){return ga(t,e)}function Vu(t,e){return ca(t,e)}function qu(t,e){return da(t,e)}function Ku(t,e){return da(t,e)}function Zu(t,e){return da(t,e)}function Xu(t,e){return ha(t,e)}function Ju(t,e){return ha(t,e)}function Yu(t,e){return ha(t,e)}function Qu(t){return new Ps(t)}function th(t){return Bs(e=t),new Ps({l1:null!=e?e.l1:null,l2:0});var e}function eh(t){return Bs(e=t),new Ps({l2:null!=e?e.l2:null,l1:0});var e}class nh extends ta{constructor(){super(...arguments),this.model=null}setModel(t){if(!(t instanceof us))throw new Error("model must be a LayersModel, not some other Container");this.model=t}}function rh(t,e){return t<e}function ih(t,e){return t>e}class ah extends nh{constructor(t){if(super(),null==t&&(t={}),t.restoreBestWeights)throw new Cn("restoreBestWeights = True is not implemented in EarlyStopping yet.");this.monitor=t.monitor||"val_loss",this.minDelta=Math.abs(t.minDelta||0),this.patience=t.patience||0,this.verbose=t.verbose||0,this.mode=t.mode||"auto",this.baseline=t.baseline,-1===["auto","min","max"].indexOf(this.mode)&&(console.warn(`EarlyStopping mode '${this.mode}' is invalid. Falling back to mode 'auto'.`),this.mode="auto"),"min"===this.mode?this.monitorFunc=rh:"max"===this.mode||-1!==this.monitor.indexOf("acc")?this.monitorFunc=ih:this.monitorFunc=rh,this.monitorFunc===rh&&(this.minDelta*=-1)}async onTrainBegin(t){this.wait=0,this.stoppedEpoch=0,null!=this.baseline?this.best=this.baseline:this.best=this.monitorFunc===rh?1/0:-1/0}async onEpochEnd(t,e){await Ji(e);const n=this.getMonitorValue(e);null!=n&&(this.monitorFunc(n-this.minDelta,this.best)?(this.best=n,this.wait=0):(this.wait++,this.wait>=this.patience&&(this.stoppedEpoch=t,this.model.stopTraining=!0)))}async onTrainEnd(t){this.stoppedEpoch>0&&this.verbose&&console.log(`Epoch ${this.stoppedEpoch}: early stopping.`)}getMonitorValue(t){null==t&&(t={});const e=t[this.monitor];return null==e&&console.warn(`Metric for EarlyStopping ${this.monitor} is not available. Available metrics are: ${Object.keys(t)}`),e}}const sh={earlyStopping:function(t){return new ah(t)}}},8083:(t,e,n)=>{var r=n(9383);function i(t,e){var n=new r(t,e);return function(t){return n.convert(t)}}i.BIN="01",i.OCT="01234567",i.DEC="0123456789",i.HEX="0123456789abcdef",t.exports=i},9383:t=>{"use strict";function e(t,e){if(!(t&&e&&t.length&&e.length))throw new Error("Bad alphabet");this.srcAlphabet=t,this.dstAlphabet=e}e.prototype.convert=function(t){var e,n,r,i={},a=this.srcAlphabet.length,s=this.dstAlphabet.length,o=t.length,l="string"==typeof t?"":[];if(!this.isValid(t))throw new Error('Number "'+t+'" contains of non-alphabetic digits ('+this.srcAlphabet+")");if(this.srcAlphabet===this.dstAlphabet)return t;for(e=0;e<o;e++)i[e]=this.srcAlphabet.indexOf(t[e]);do{for(n=0,r=0,e=0;e<o;e++)(n=n*a+i[e])>=s?(i[r++]=parseInt(n/s,10),n%=s):r>0&&(i[r++]=0);o=r,l=this.dstAlphabet.slice(n,n+1).concat(l)}while(0!==r);return l},e.prototype.isValid=function(t){for(var e=0;e<t.length;++e)if(-1===this.srcAlphabet.indexOf(t[e]))return!1;return!0},t.exports=e},6188:(t,e,n)=>{"use strict";var r=n(4126);function i(t,e){if(t===e)return 0;for(var n=t.length,r=e.length,i=0,a=Math.min(n,r);i<a;++i)if(t[i]!==e[i]){n=t[i],r=e[i];break}return n<r?-1:r<n?1:0}function a(t){return n.g.Buffer&&"function"==typeof n.g.Buffer.isBuffer?n.g.Buffer.isBuffer(t):!(null==t||!t._isBuffer)}var s=n(7072),o=Object.prototype.hasOwnProperty,l=Array.prototype.slice,u="foo"===function(){}.name;function h(t){return Object.prototype.toString.call(t)}function c(t){return!a(t)&&"function"==typeof n.g.ArrayBuffer&&("function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(t):!!t&&(t instanceof DataView||!!(t.buffer&&t.buffer instanceof ArrayBuffer)))}var d=t.exports=y,f=/\s*function\s+([^\(\s]*)\s*/;function p(t){if(s.isFunction(t)){if(u)return t.name;var e=t.toString().match(f);return e&&e[1]}}function m(t,e){return"string"==typeof t?t.length<e?t:t.slice(0,e):t}function g(t){if(u||!s.isFunction(t))return s.inspect(t);var e=p(t);return"[Function"+(e?": "+e:"")+"]"}function b(t,e,n,r,i){throw new d.AssertionError({message:n,actual:t,expected:e,operator:r,stackStartFunction:i})}function y(t,e){t||b(t,!0,e,"==",d.ok)}function v(t,e,n,r){if(t===e)return!0;if(a(t)&&a(e))return 0===i(t,e);if(s.isDate(t)&&s.isDate(e))return t.getTime()===e.getTime();if(s.isRegExp(t)&&s.isRegExp(e))return t.source===e.source&&t.global===e.global&&t.multiline===e.multiline&&t.lastIndex===e.lastIndex&&t.ignoreCase===e.ignoreCase;if(null!==t&&"object"==typeof t||null!==e&&"object"==typeof e){if(c(t)&&c(e)&&h(t)===h(e)&&!(t instanceof Float32Array||t instanceof Float64Array))return 0===i(new Uint8Array(t.buffer),new Uint8Array(e.buffer));if(a(t)!==a(e))return!1;var o=(r=r||{actual:[],expected:[]}).actual.indexOf(t);return-1!==o&&o===r.expected.indexOf(e)||(r.actual.push(t),r.expected.push(e),function(t,e,n,r){if(null==t||null==e)return!1;if(s.isPrimitive(t)||s.isPrimitive(e))return t===e;if(n&&Object.getPrototypeOf(t)!==Object.getPrototypeOf(e))return!1;var i=w(t),a=w(e);if(i&&!a||!i&&a)return!1;if(i)return v(t=l.call(t),e=l.call(e),n);var o,u,h=x(t),c=x(e);if(h.length!==c.length)return!1;for(h.sort(),c.sort(),u=h.length-1;u>=0;u--)if(h[u]!==c[u])return!1;for(u=h.length-1;u>=0;u--)if(!v(t[o=h[u]],e[o],n,r))return!1;return!0}(t,e,n,r))}return n?t===e:t==e}function w(t){return"[object Arguments]"==Object.prototype.toString.call(t)}function _(t,e){if(!t||!e)return!1;if("[object RegExp]"==Object.prototype.toString.call(e))return e.test(t);try{if(t instanceof e)return!0}catch(t){}return!Error.isPrototypeOf(e)&&!0===e.call({},t)}function k(t,e,n,r){var i;if("function"!=typeof e)throw new TypeError('"block" argument must be a function');"string"==typeof n&&(r=n,n=null),i=function(t){var e;try{t()}catch(t){e=t}return e}(e),r=(n&&n.name?" ("+n.name+").":".")+(r?" "+r:"."),t&&!i&&b(i,n,"Missing expected exception"+r);var a="string"==typeof r,o=!t&&i&&!n;if((!t&&s.isError(i)&&a&&_(i,n)||o)&&b(i,n,"Got unwanted exception"+r),t&&i&&n&&!_(i,n)||!t&&i)throw i}d.AssertionError=function(t){this.name="AssertionError",this.actual=t.actual,this.expected=t.expected,this.operator=t.operator,t.message?(this.message=t.message,this.generatedMessage=!1):(this.message=function(t){return m(g(t.actual),128)+" "+t.operator+" "+m(g(t.expected),128)}(this),this.generatedMessage=!0);var e=t.stackStartFunction||b;if(Error.captureStackTrace)Error.captureStackTrace(this,e);else{var n=new Error;if(n.stack){var r=n.stack,i=p(e),a=r.indexOf("\n"+i);if(a>=0){var s=r.indexOf("\n",a+1);r=r.substring(s+1)}this.stack=r}}},s.inherits(d.AssertionError,Error),d.fail=b,d.ok=y,d.equal=function(t,e,n){t!=e&&b(t,e,n,"==",d.equal)},d.notEqual=function(t,e,n){t==e&&b(t,e,n,"!=",d.notEqual)},d.deepEqual=function(t,e,n){v(t,e,!1)||b(t,e,n,"deepEqual",d.deepEqual)},d.deepStrictEqual=function(t,e,n){v(t,e,!0)||b(t,e,n,"deepStrictEqual",d.deepStrictEqual)},d.notDeepEqual=function(t,e,n){v(t,e,!1)&&b(t,e,n,"notDeepEqual",d.notDeepEqual)},d.notDeepStrictEqual=function t(e,n,r){v(e,n,!0)&&b(e,n,r,"notDeepStrictEqual",t)},d.strictEqual=function(t,e,n){t!==e&&b(t,e,n,"===",d.strictEqual)},d.notStrictEqual=function(t,e,n){t===e&&b(t,e,n,"!==",d.notStrictEqual)},d.throws=function(t,e,n){k(!0,t,e,n)},d.doesNotThrow=function(t,e,n){k(!1,t,e,n)},d.ifError=function(t){if(t)throw t},d.strict=r((function t(e,n){e||b(e,!0,n,"==",t)}),d,{equal:d.strictEqual,deepEqual:d.deepStrictEqual,notEqual:d.notStrictEqual,notDeepEqual:d.notDeepStrictEqual}),d.strict.strict=d.strict;var x=Object.keys||function(t){var e=[];for(var n in t)o.call(t,n)&&e.push(n);return e}},6251:(t,e)=>{"use strict";e.byteLength=function(t){var e=l(t),n=e[0],r=e[1];return 3*(n+r)/4-r},e.toByteArray=function(t){var e,n,a=l(t),s=a[0],o=a[1],u=new i(function(t,e,n){return 3*(e+n)/4-n}(0,s,o)),h=0,c=o>0?s-4:s;for(n=0;n<c;n+=4)e=r[t.charCodeAt(n)]<<18|r[t.charCodeAt(n+1)]<<12|r[t.charCodeAt(n+2)]<<6|r[t.charCodeAt(n+3)],u[h++]=e>>16&255,u[h++]=e>>8&255,u[h++]=255&e;return 2===o&&(e=r[t.charCodeAt(n)]<<2|r[t.charCodeAt(n+1)]>>4,u[h++]=255&e),1===o&&(e=r[t.charCodeAt(n)]<<10|r[t.charCodeAt(n+1)]<<4|r[t.charCodeAt(n+2)]>>2,u[h++]=e>>8&255,u[h++]=255&e),u},e.fromByteArray=function(t){for(var e,r=t.length,i=r%3,a=[],s=16383,o=0,l=r-i;o<l;o+=s)a.push(u(t,o,o+s>l?l:o+s));return 1===i?(e=t[r-1],a.push(n[e>>2]+n[e<<4&63]+"==")):2===i&&(e=(t[r-2]<<8)+t[r-1],a.push(n[e>>10]+n[e>>4&63]+n[e<<2&63]+"=")),a.join("")};for(var n=[],r=[],i="undefined"!=typeof Uint8Array?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,o=a.length;s<o;++s)n[s]=a[s],r[a.charCodeAt(s)]=s;function l(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");return-1===n&&(n=e),[n,n===e?0:4-n%4]}function u(t,e,r){for(var i,a,s=[],o=e;o<r;o+=3)i=(t[o]<<16&16711680)+(t[o+1]<<8&65280)+(255&t[o+2]),s.push(n[(a=i)>>18&63]+n[a>>12&63]+n[a>>6&63]+n[63&a]);return s.join("")}r["-".charCodeAt(0)]=62,r["_".charCodeAt(0)]=63},7695:(t,e,n)=>{var r=n(8723),i=n(9929);t.exports={encode:r,decode:i}},9929:(t,e,n)=>{var r=n(9208).Buffer;function i(t,e){if(this.pos=0,this.buffer=t,this.is_with_alpha=!!e,this.bottom_up=!0,this.flag=this.buffer.toString("utf-8",0,this.pos+=2),"BM"!=this.flag)throw new Error("Invalid BMP File");this.parseHeader(),this.parseRGBA()}i.prototype.parseHeader=function(){if(this.fileSize=this.buffer.readUInt32LE(this.pos),this.pos+=4,this.reserved=this.buffer.readUInt32LE(this.pos),this.pos+=4,this.offset=this.buffer.readUInt32LE(this.pos),this.pos+=4,this.headerSize=this.buffer.readUInt32LE(this.pos),this.pos+=4,this.width=this.buffer.readUInt32LE(this.pos),this.pos+=4,this.height=this.buffer.readInt32LE(this.pos),this.pos+=4,this.planes=this.buffer.readUInt16LE(this.pos),this.pos+=2,this.bitPP=this.buffer.readUInt16LE(this.pos),this.pos+=2,this.compress=this.buffer.readUInt32LE(this.pos),this.pos+=4,this.rawSize=this.buffer.readUInt32LE(this.pos),this.pos+=4,this.hr=this.buffer.readUInt32LE(this.pos),this.pos+=4,this.vr=this.buffer.readUInt32LE(this.pos),this.pos+=4,this.colors=this.buffer.readUInt32LE(this.pos),this.pos+=4,this.importantColors=this.buffer.readUInt32LE(this.pos),this.pos+=4,16===this.bitPP&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var t=0===this.colors?1<<this.bitPP:this.colors;this.palette=new Array(t);for(var e=0;e<t;e++){var n=this.buffer.readUInt8(this.pos++),r=this.buffer.readUInt8(this.pos++),i=this.buffer.readUInt8(this.pos++),a=this.buffer.readUInt8(this.pos++);this.palette[e]={red:i,green:r,blue:n,quad:a}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},i.prototype.parseRGBA=function(){var t="bit"+this.bitPP,e=this.width*this.height*4;this.data=new r(e),this[t]()},i.prototype.bit1=function(){var t=Math.ceil(this.width/8),e=t%4,n=this.height>=0?this.height-1:-this.height;for(n=this.height-1;n>=0;n--){for(var r=this.bottom_up?n:this.height-1-n,i=0;i<t;i++)for(var a=this.buffer.readUInt8(this.pos++),s=r*this.width*4+8*i*4,o=0;o<8&&8*i+o<this.width;o++){var l=this.palette[a>>7-o&1];this.data[s+4*o]=0,this.data[s+4*o+1]=l.blue,this.data[s+4*o+2]=l.green,this.data[s+4*o+3]=l.red}0!=e&&(this.pos+=4-e)}},i.prototype.bit4=function(){if(2==this.compress){this.data.fill(255);for(var t=0,e=this.bottom_up?this.height-1:0,n=!1;t<this.data.length;){var r=this.buffer.readUInt8(this.pos++),i=this.buffer.readUInt8(this.pos++);if(0==r){if(0==i){this.bottom_up?e--:e++,t=e*this.width*4,n=!1;continue}if(1==i)break;if(2==i){var a=this.buffer.readUInt8(this.pos++),s=this.buffer.readUInt8(this.pos++);this.bottom_up?e-=s:e+=s,t+=s*this.width*4+4*a}else{for(var o=this.buffer.readUInt8(this.pos++),l=0;l<i;l++)n?u.call(this,15&o):u.call(this,(240&o)>>4),1&l&&l+1<i&&(o=this.buffer.readUInt8(this.pos++)),n=!n;1==(i+1>>1&1)&&this.pos++}}else for(l=0;l<r;l++)n?u.call(this,15&i):u.call(this,(240&i)>>4),n=!n}function u(e){var n=this.palette[e];this.data[t]=0,this.data[t+1]=n.blue,this.data[t+2]=n.green,this.data[t+3]=n.red,t+=4}}else{var h=Math.ceil(this.width/2),c=h%4;for(s=this.height-1;s>=0;s--){var d=this.bottom_up?s:this.height-1-s;for(a=0;a<h;a++){i=this.buffer.readUInt8(this.pos++),t=d*this.width*4+2*a*4;var f=i>>4,p=15&i,m=this.palette[f];if(this.data[t]=0,this.data[t+1]=m.blue,this.data[t+2]=m.green,this.data[t+3]=m.red,2*a+1>=this.width)break;m=this.palette[p],this.data[t+4]=0,this.data[t+4+1]=m.blue,this.data[t+4+2]=m.green,this.data[t+4+3]=m.red}0!=c&&(this.pos+=4-c)}}},i.prototype.bit8=function(){if(1==this.compress){this.data.fill(255);for(var t=0,e=this.bottom_up?this.height-1:0;t<this.data.length;){var n=this.buffer.readUInt8(this.pos++),r=this.buffer.readUInt8(this.pos++);if(0==n){if(0==r){this.bottom_up?e--:e++,t=e*this.width*4;continue}if(1==r)break;if(2==r){var i=this.buffer.readUInt8(this.pos++),a=this.buffer.readUInt8(this.pos++);this.bottom_up?e-=a:e+=a,t+=a*this.width*4+4*i}else{for(var s=0;s<r;s++){var o=this.buffer.readUInt8(this.pos++);l.call(this,o)}!0&r&&this.pos++}}else for(s=0;s<n;s++)l.call(this,r)}function l(e){var n=this.palette[e];this.data[t]=0,this.data[t+1]=n.blue,this.data[t+2]=n.green,this.data[t+3]=n.red,t+=4}}else{var u=this.width%4;for(a=this.height-1;a>=0;a--){var h=this.bottom_up?a:this.height-1-a;for(i=0;i<this.width;i++)if(r=this.buffer.readUInt8(this.pos++),t=h*this.width*4+4*i,r<this.palette.length){var c=this.palette[r];this.data[t]=0,this.data[t+1]=c.blue,this.data[t+2]=c.green,this.data[t+3]=c.red}else this.data[t]=0,this.data[t+1]=255,this.data[t+2]=255,this.data[t+3]=255;0!=u&&(this.pos+=4-u)}}},i.prototype.bit15=function(){for(var t=this.width%3,e=parseInt("11111",2),n=this.height-1;n>=0;n--){for(var r=this.bottom_up?n:this.height-1-n,i=0;i<this.width;i++){var a=this.buffer.readUInt16LE(this.pos);this.pos+=2;var s=(a&e)/e*255|0,o=(a>>5&e)/e*255|0,l=(a>>10&e)/e*255|0,u=a>>15?255:0,h=r*this.width*4+4*i;this.data[h]=u,this.data[h+1]=s,this.data[h+2]=o,this.data[h+3]=l}this.pos+=t}},i.prototype.bit16=function(){var t=this.width%2*2;this.maskRed=31744,this.maskGreen=992,this.maskBlue=31,this.mask0=0,3==this.compress&&(this.maskRed=this.buffer.readUInt32LE(this.pos),this.pos+=4,this.maskGreen=this.buffer.readUInt32LE(this.pos),this.pos+=4,this.maskBlue=this.buffer.readUInt32LE(this.pos),this.pos+=4,this.mask0=this.buffer.readUInt32LE(this.pos),this.pos+=4);for(var e=[0,0,0],n=0;n<16;n++)this.maskRed>>n&1&&e[0]++,this.maskGreen>>n&1&&e[1]++,this.maskBlue>>n&1&&e[2]++;e[1]+=e[0],e[2]+=e[1],e[0]=8-e[0],e[1]-=8,e[2]-=8;for(var r=this.height-1;r>=0;r--){for(var i=this.bottom_up?r:this.height-1-r,a=0;a<this.width;a++){var s=this.buffer.readUInt16LE(this.pos);this.pos+=2;var o=(s&this.maskBlue)<<e[0],l=(s&this.maskGreen)>>e[1],u=(s&this.maskRed)>>e[2],h=i*this.width*4+4*a;this.data[h]=0,this.data[h+1]=o,this.data[h+2]=l,this.data[h+3]=u}this.pos+=t}},i.prototype.bit24=function(){for(var t=this.height-1;t>=0;t--){for(var e=this.bottom_up?t:this.height-1-t,n=0;n<this.width;n++){var r=this.buffer.readUInt8(this.pos++),i=this.buffer.readUInt8(this.pos++),a=this.buffer.readUInt8(this.pos++),s=e*this.width*4+4*n;this.data[s]=0,this.data[s+1]=r,this.data[s+2]=i,this.data[s+3]=a}this.pos+=this.width%4}},i.prototype.bit32=function(){if(3==this.compress){this.maskRed=this.buffer.readUInt32LE(this.pos),this.pos+=4,this.maskGreen=this.buffer.readUInt32LE(this.pos),this.pos+=4,this.maskBlue=this.buffer.readUInt32LE(this.pos),this.pos+=4,this.mask0=this.buffer.readUInt32LE(this.pos),this.pos+=4;for(var t=this.height-1;t>=0;t--)for(var e=this.bottom_up?t:this.height-1-t,n=0;n<this.width;n++){var r=this.buffer.readUInt8(this.pos++),i=this.buffer.readUInt8(this.pos++),a=this.buffer.readUInt8(this.pos++),s=this.buffer.readUInt8(this.pos++),o=e*this.width*4+4*n;this.data[o]=r,this.data[o+1]=i,this.data[o+2]=a,this.data[o+3]=s}}else for(t=this.height-1;t>=0;t--)for(e=this.bottom_up?t:this.height-1-t,n=0;n<this.width;n++)i=this.buffer.readUInt8(this.pos++),a=this.buffer.readUInt8(this.pos++),s=this.buffer.readUInt8(this.pos++),r=this.buffer.readUInt8(this.pos++),o=e*this.width*4+4*n,this.data[o]=r,this.data[o+1]=i,this.data[o+2]=a,this.data[o+3]=s},i.prototype.getData=function(){return this.data},t.exports=function(t){return new i(t)}},8723:(t,e,n)=>{var r=n(9208).Buffer;function i(t){this.buffer=t.data,this.width=t.width,this.height=t.height,this.extraBytes=this.width%4,this.rgbSize=this.height*(3*this.width+this.extraBytes),this.headerInfoSize=40,this.data=[],this.flag="BM",this.reserved=0,this.offset=54,this.fileSize=this.rgbSize+this.offset,this.planes=1,this.bitPP=24,this.compress=0,this.hr=0,this.vr=0,this.colors=0,this.importantColors=0}i.prototype.encode=function(){var t=new r(this.offset+this.rgbSize);this.pos=0,t.write(this.flag,this.pos,2),this.pos+=2,t.writeUInt32LE(this.fileSize,this.pos),this.pos+=4,t.writeUInt32LE(this.reserved,this.pos),this.pos+=4,t.writeUInt32LE(this.offset,this.pos),this.pos+=4,t.writeUInt32LE(this.headerInfoSize,this.pos),this.pos+=4,t.writeUInt32LE(this.width,this.pos),this.pos+=4,t.writeInt32LE(-this.height,this.pos),this.pos+=4,t.writeUInt16LE(this.planes,this.pos),this.pos+=2,t.writeUInt16LE(this.bitPP,this.pos),this.pos+=2,t.writeUInt32LE(this.compress,this.pos),this.pos+=4,t.writeUInt32LE(this.rgbSize,this.pos),this.pos+=4,t.writeUInt32LE(this.hr,this.pos),this.pos+=4,t.writeUInt32LE(this.vr,this.pos),this.pos+=4,t.writeUInt32LE(this.colors,this.pos),this.pos+=4,t.writeUInt32LE(this.importantColors,this.pos),this.pos+=4;for(var e=0,n=3*this.width+this.extraBytes,i=0;i<this.height;i++){for(var a=0;a<this.width;a++){var s=this.pos+i*n+3*a;e++,t[s]=this.buffer[e++],t[s+1]=this.buffer[e++],t[s+2]=this.buffer[e++]}if(this.extraBytes>0){var o=this.pos+i*n+3*this.width;t.fill(0,o,o+this.extraBytes)}}return t},t.exports=function(t,e){return void 0===e&&(e=100),{data:new i(t).encode(),width:t.width,height:t.height}}},4359:(t,e,n)=>{"use strict";var r=n(9208).Buffer,i=n(7671),a=n(6188),s=n(2716),o=n(7930),l=n(3775),u=n(1537);for(var h in u)e[h]=u[h];function c(t){if("number"!=typeof t||t<e.DEFLATE||t>e.UNZIP)throw new TypeError("Bad argument");this.dictionary=null,this.err=0,this.flush=0,this.init_done=!1,this.level=0,this.memLevel=0,this.mode=t,this.strategy=0,this.windowBits=0,this.write_in_progress=!1,this.pending_close=!1,this.gzip_id_bytes_read=0}e.NONE=0,e.DEFLATE=1,e.INFLATE=2,e.GZIP=3,e.GUNZIP=4,e.DEFLATERAW=5,e.INFLATERAW=6,e.UNZIP=7,c.prototype.close=function(){this.write_in_progress?this.pending_close=!0:(this.pending_close=!1,a(this.init_done,"close before init"),a(this.mode<=e.UNZIP),this.mode===e.DEFLATE||this.mode===e.GZIP||this.mode===e.DEFLATERAW?o.deflateEnd(this.strm):this.mode!==e.INFLATE&&this.mode!==e.GUNZIP&&this.mode!==e.INFLATERAW&&this.mode!==e.UNZIP||l.inflateEnd(this.strm),this.mode=e.NONE,this.dictionary=null)},c.prototype.write=function(t,e,n,r,i,a,s){return this._write(!0,t,e,n,r,i,a,s)},c.prototype.writeSync=function(t,e,n,r,i,a,s){return this._write(!1,t,e,n,r,i,a,s)},c.prototype._write=function(t,n,s,o,l,u,h,c){if(a.equal(arguments.length,8),a(this.init_done,"write before init"),a(this.mode!==e.NONE,"already finalized"),a.equal(!1,this.write_in_progress,"write already in progress"),a.equal(!1,this.pending_close,"close is pending"),this.write_in_progress=!0,a.equal(!1,void 0===n,"must provide flush value"),this.write_in_progress=!0,n!==e.Z_NO_FLUSH&&n!==e.Z_PARTIAL_FLUSH&&n!==e.Z_SYNC_FLUSH&&n!==e.Z_FULL_FLUSH&&n!==e.Z_FINISH&&n!==e.Z_BLOCK)throw new Error("Invalid flush value");if(null==s&&(s=r.alloc(0),l=0,o=0),this.strm.avail_in=l,this.strm.input=s,this.strm.next_in=o,this.strm.avail_out=c,this.strm.output=u,this.strm.next_out=h,this.flush=n,!t)return this._process(),this._checkError()?this._afterSync():void 0;var d=this;return i.nextTick((function(){d._process(),d._after()})),this},c.prototype._afterSync=function(){var t=this.strm.avail_out,e=this.strm.avail_in;return this.write_in_progress=!1,[e,t]},c.prototype._process=function(){var t=null;switch(this.mode){case e.DEFLATE:case e.GZIP:case e.DEFLATERAW:this.err=o.deflate(this.strm,this.flush);break;case e.UNZIP:switch(this.strm.avail_in>0&&(t=this.strm.next_in),this.gzip_id_bytes_read){case 0:if(null===t)break;if(31!==this.strm.input[t]){this.mode=e.INFLATE;break}if(this.gzip_id_bytes_read=1,t++,1===this.strm.avail_in)break;case 1:if(null===t)break;139===this.strm.input[t]?(this.gzip_id_bytes_read=2,this.mode=e.GUNZIP):this.mode=e.INFLATE;break;default:throw new Error("invalid number of gzip magic number bytes read")}case e.INFLATE:case e.GUNZIP:case e.INFLATERAW:for(this.err=l.inflate(this.strm,this.flush),this.err===e.Z_NEED_DICT&&this.dictionary&&(this.err=l.inflateSetDictionary(this.strm,this.dictionary),this.err===e.Z_OK?this.err=l.inflate(this.strm,this.flush):this.err===e.Z_DATA_ERROR&&(this.err=e.Z_NEED_DICT));this.strm.avail_in>0&&this.mode===e.GUNZIP&&this.err===e.Z_STREAM_END&&0!==this.strm.next_in[0];)this.reset(),this.err=l.inflate(this.strm,this.flush);break;default:throw new Error("Unknown mode "+this.mode)}},c.prototype._checkError=function(){switch(this.err){case e.Z_OK:case e.Z_BUF_ERROR:if(0!==this.strm.avail_out&&this.flush===e.Z_FINISH)return this._error("unexpected end of file"),!1;break;case e.Z_STREAM_END:break;case e.Z_NEED_DICT:return null==this.dictionary?this._error("Missing dictionary"):this._error("Bad dictionary"),!1;default:return this._error("Zlib error"),!1}return!0},c.prototype._after=function(){if(this._checkError()){var t=this.strm.avail_out,e=this.strm.avail_in;this.write_in_progress=!1,this.callback(e,t),this.pending_close&&this.close()}},c.prototype._error=function(t){this.strm.msg&&(t=this.strm.msg),this.onerror(t,this.err),this.write_in_progress=!1,this.pending_close&&this.close()},c.prototype.init=function(t,n,r,i,s){a(4===arguments.length||5===arguments.length,"init(windowBits, level, memLevel, strategy, [dictionary])"),a(t>=8&&t<=15,"invalid windowBits"),a(n>=-1&&n<=9,"invalid compression level"),a(r>=1&&r<=9,"invalid memlevel"),a(i===e.Z_FILTERED||i===e.Z_HUFFMAN_ONLY||i===e.Z_RLE||i===e.Z_FIXED||i===e.Z_DEFAULT_STRATEGY,"invalid strategy"),this._init(n,t,r,i,s),this._setDictionary()},c.prototype.params=function(){throw new Error("deflateParams Not supported")},c.prototype.reset=function(){this._reset(),this._setDictionary()},c.prototype._init=function(t,n,r,i,a){switch(this.level=t,this.windowBits=n,this.memLevel=r,this.strategy=i,this.flush=e.Z_NO_FLUSH,this.err=e.Z_OK,this.mode!==e.GZIP&&this.mode!==e.GUNZIP||(this.windowBits+=16),this.mode===e.UNZIP&&(this.windowBits+=32),this.mode!==e.DEFLATERAW&&this.mode!==e.INFLATERAW||(this.windowBits=-1*this.windowBits),this.strm=new s,this.mode){case e.DEFLATE:case e.GZIP:case e.DEFLATERAW:this.err=o.deflateInit2(this.strm,this.level,e.Z_DEFLATED,this.windowBits,this.memLevel,this.strategy);break;case e.INFLATE:case e.GUNZIP:case e.INFLATERAW:case e.UNZIP:this.err=l.inflateInit2(this.strm,this.windowBits);break;default:throw new Error("Unknown mode "+this.mode)}this.err!==e.Z_OK&&this._error("Init error"),this.dictionary=a,this.write_in_progress=!1,this.init_done=!0},c.prototype._setDictionary=function(){if(null!=this.dictionary){switch(this.err=e.Z_OK,this.mode){case e.DEFLATE:case e.DEFLATERAW:this.err=o.deflateSetDictionary(this.strm,this.dictionary)}this.err!==e.Z_OK&&this._error("Failed to set dictionary")}},c.prototype._reset=function(){switch(this.err=e.Z_OK,this.mode){case e.DEFLATE:case e.DEFLATERAW:case e.GZIP:this.err=o.deflateReset(this.strm);break;case e.INFLATE:case e.INFLATERAW:case e.GUNZIP:this.err=l.inflateReset(this.strm)}this.err!==e.Z_OK&&this._error("Failed to reset stream")},e.Zlib=c},6189:(t,e,n)=>{"use strict";var r=n(7671),i=n(9208).Buffer,a=n(4663).Transform,s=n(4359),o=n(9953),l=n(6188).ok,u=n(9208).kMaxLength,h="Cannot create final Buffer. It would be larger than 0x"+u.toString(16)+" bytes";s.Z_MIN_WINDOWBITS=8,s.Z_MAX_WINDOWBITS=15,s.Z_DEFAULT_WINDOWBITS=15,s.Z_MIN_CHUNK=64,s.Z_MAX_CHUNK=1/0,s.Z_DEFAULT_CHUNK=16384,s.Z_MIN_MEMLEVEL=1,s.Z_MAX_MEMLEVEL=9,s.Z_DEFAULT_MEMLEVEL=8,s.Z_MIN_LEVEL=-1,s.Z_MAX_LEVEL=9,s.Z_DEFAULT_LEVEL=s.Z_DEFAULT_COMPRESSION;for(var c=Object.keys(s),d=0;d<c.length;d++){var f=c[d];f.match(/^Z/)&&Object.defineProperty(e,f,{enumerable:!0,value:s[f],writable:!1})}for(var p={Z_OK:s.Z_OK,Z_STREAM_END:s.Z_STREAM_END,Z_NEED_DICT:s.Z_NEED_DICT,Z_ERRNO:s.Z_ERRNO,Z_STREAM_ERROR:s.Z_STREAM_ERROR,Z_DATA_ERROR:s.Z_DATA_ERROR,Z_MEM_ERROR:s.Z_MEM_ERROR,Z_BUF_ERROR:s.Z_BUF_ERROR,Z_VERSION_ERROR:s.Z_VERSION_ERROR},m=Object.keys(p),g=0;g<m.length;g++){var b=m[g];p[p[b]]=b}function y(t,e,n){var r=[],a=0;function s(){for(var e;null!==(e=t.read());)r.push(e),a+=e.length;t.once("readable",s)}function o(){var e,s=null;a>=u?s=new RangeError(h):e=i.concat(r,a),r=[],t.close(),n(s,e)}t.on("error",(function(e){t.removeListener("end",o),t.removeListener("readable",s),n(e)})),t.on("end",o),t.end(e),s()}function v(t,e){if("string"==typeof e&&(e=i.from(e)),!i.isBuffer(e))throw new TypeError("Not a string or buffer");var n=t._finishFlushFlag;return t._processChunk(e,n)}function w(t){if(!(this instanceof w))return new w(t);M.call(this,t,s.DEFLATE)}function _(t){if(!(this instanceof _))return new _(t);M.call(this,t,s.INFLATE)}function k(t){if(!(this instanceof k))return new k(t);M.call(this,t,s.GZIP)}function x(t){if(!(this instanceof x))return new x(t);M.call(this,t,s.GUNZIP)}function S(t){if(!(this instanceof S))return new S(t);M.call(this,t,s.DEFLATERAW)}function E(t){if(!(this instanceof E))return new E(t);M.call(this,t,s.INFLATERAW)}function I(t){if(!(this instanceof I))return new I(t);M.call(this,t,s.UNZIP)}function A(t){return t===s.Z_NO_FLUSH||t===s.Z_PARTIAL_FLUSH||t===s.Z_SYNC_FLUSH||t===s.Z_FULL_FLUSH||t===s.Z_FINISH||t===s.Z_BLOCK}function M(t,n){var r=this;if(this._opts=t=t||{},this._chunkSize=t.chunkSize||e.Z_DEFAULT_CHUNK,a.call(this,t),t.flush&&!A(t.flush))throw new Error("Invalid flush flag: "+t.flush);if(t.finishFlush&&!A(t.finishFlush))throw new Error("Invalid flush flag: "+t.finishFlush);if(this._flushFlag=t.flush||s.Z_NO_FLUSH,this._finishFlushFlag=void 0!==t.finishFlush?t.finishFlush:s.Z_FINISH,t.chunkSize&&(t.chunkSize<e.Z_MIN_CHUNK||t.chunkSize>e.Z_MAX_CHUNK))throw new Error("Invalid chunk size: "+t.chunkSize);if(t.windowBits&&(t.windowBits<e.Z_MIN_WINDOWBITS||t.windowBits>e.Z_MAX_WINDOWBITS))throw new Error("Invalid windowBits: "+t.windowBits);if(t.level&&(t.level<e.Z_MIN_LEVEL||t.level>e.Z_MAX_LEVEL))throw new Error("Invalid compression level: "+t.level);if(t.memLevel&&(t.memLevel<e.Z_MIN_MEMLEVEL||t.memLevel>e.Z_MAX_MEMLEVEL))throw new Error("Invalid memLevel: "+t.memLevel);if(t.strategy&&t.strategy!=e.Z_FILTERED&&t.strategy!=e.Z_HUFFMAN_ONLY&&t.strategy!=e.Z_RLE&&t.strategy!=e.Z_FIXED&&t.strategy!=e.Z_DEFAULT_STRATEGY)throw new Error("Invalid strategy: "+t.strategy);if(t.dictionary&&!i.isBuffer(t.dictionary))throw new Error("Invalid dictionary: it should be a Buffer instance");this._handle=new s.Zlib(n);var o=this;this._hadError=!1,this._handle.onerror=function(t,n){T(o),o._hadError=!0;var r=new Error(t);r.errno=n,r.code=e.codes[n],o.emit("error",r)};var l=e.Z_DEFAULT_COMPRESSION;"number"==typeof t.level&&(l=t.level);var u=e.Z_DEFAULT_STRATEGY;"number"==typeof t.strategy&&(u=t.strategy),this._handle.init(t.windowBits||e.Z_DEFAULT_WINDOWBITS,l,t.memLevel||e.Z_DEFAULT_MEMLEVEL,u,t.dictionary),this._buffer=i.allocUnsafe(this._chunkSize),this._offset=0,this._level=l,this._strategy=u,this.once("end",this.close),Object.defineProperty(this,"_closed",{get:function(){return!r._handle},configurable:!0,enumerable:!0})}function T(t,e){e&&r.nextTick(e),t._handle&&(t._handle.close(),t._handle=null)}function N(t){t.emit("close")}Object.defineProperty(e,"codes",{enumerable:!0,value:Object.freeze(p),writable:!1}),e.Deflate=w,e.Inflate=_,e.Gzip=k,e.Gunzip=x,e.DeflateRaw=S,e.InflateRaw=E,e.Unzip=I,e.createDeflate=function(t){return new w(t)},e.createInflate=function(t){return new _(t)},e.createDeflateRaw=function(t){return new S(t)},e.createInflateRaw=function(t){return new E(t)},e.createGzip=function(t){return new k(t)},e.createGunzip=function(t){return new x(t)},e.createUnzip=function(t){return new I(t)},e.deflate=function(t,e,n){return"function"==typeof e&&(n=e,e={}),y(new w(e),t,n)},e.deflateSync=function(t,e){return v(new w(e),t)},e.gzip=function(t,e,n){return"function"==typeof e&&(n=e,e={}),y(new k(e),t,n)},e.gzipSync=function(t,e){return v(new k(e),t)},e.deflateRaw=function(t,e,n){return"function"==typeof e&&(n=e,e={}),y(new S(e),t,n)},e.deflateRawSync=function(t,e){return v(new S(e),t)},e.unzip=function(t,e,n){return"function"==typeof e&&(n=e,e={}),y(new I(e),t,n)},e.unzipSync=function(t,e){return v(new I(e),t)},e.inflate=function(t,e,n){return"function"==typeof e&&(n=e,e={}),y(new _(e),t,n)},e.inflateSync=function(t,e){return v(new _(e),t)},e.gunzip=function(t,e,n){return"function"==typeof e&&(n=e,e={}),y(new x(e),t,n)},e.gunzipSync=function(t,e){return v(new x(e),t)},e.inflateRaw=function(t,e,n){return"function"==typeof e&&(n=e,e={}),y(new E(e),t,n)},e.inflateRawSync=function(t,e){return v(new E(e),t)},o.inherits(M,a),M.prototype.params=function(t,n,i){if(t<e.Z_MIN_LEVEL||t>e.Z_MAX_LEVEL)throw new RangeError("Invalid compression level: "+t);if(n!=e.Z_FILTERED&&n!=e.Z_HUFFMAN_ONLY&&n!=e.Z_RLE&&n!=e.Z_FIXED&&n!=e.Z_DEFAULT_STRATEGY)throw new TypeError("Invalid strategy: "+n);if(this._level!==t||this._strategy!==n){var a=this;this.flush(s.Z_SYNC_FLUSH,(function(){l(a._handle,"zlib binding closed"),a._handle.params(t,n),a._hadError||(a._level=t,a._strategy=n,i&&i())}))}else r.nextTick(i)},M.prototype.reset=function(){return l(this._handle,"zlib binding closed"),this._handle.reset()},M.prototype._flush=function(t){this._transform(i.alloc(0),"",t)},M.prototype.flush=function(t,e){var n=this,a=this._writableState;("function"==typeof t||void 0===t&&!e)&&(e=t,t=s.Z_FULL_FLUSH),a.ended?e&&r.nextTick(e):a.ending?e&&this.once("end",e):a.needDrain?e&&this.once("drain",(function(){return n.flush(t,e)})):(this._flushFlag=t,this.write(i.alloc(0),"",e))},M.prototype.close=function(t){T(this,t),r.nextTick(N,this)},M.prototype._transform=function(t,e,n){var r,a=this._writableState,o=(a.ending||a.ended)&&(!t||a.length===t.length);return null===t||i.isBuffer(t)?this._handle?(o?r=this._finishFlushFlag:(r=this._flushFlag,t.length>=a.length&&(this._flushFlag=this._opts.flush||s.Z_NO_FLUSH)),void this._processChunk(t,r,n)):n(new Error("zlib binding closed")):n(new Error("invalid input"))},M.prototype._processChunk=function(t,e,n){var r=t&&t.length,a=this._chunkSize-this._offset,s=0,o=this,c="function"==typeof n;if(!c){var d,f=[],p=0;this.on("error",(function(t){d=t})),l(this._handle,"zlib binding closed");do{var m=this._handle.writeSync(e,t,s,r,this._buffer,this._offset,a)}while(!this._hadError&&y(m[0],m[1]));if(this._hadError)throw d;if(p>=u)throw T(this),new RangeError(h);var g=i.concat(f,p);return T(this),g}l(this._handle,"zlib binding closed");var b=this._handle.write(e,t,s,r,this._buffer,this._offset,a);function y(u,h){if(this&&(this.buffer=null,this.callback=null),!o._hadError){var d=a-h;if(l(d>=0,"have should not go down"),d>0){var m=o._buffer.slice(o._offset,o._offset+d);o._offset+=d,c?o.push(m):(f.push(m),p+=m.length)}if((0===h||o._offset>=o._chunkSize)&&(a=o._chunkSize,o._offset=0,o._buffer=i.allocUnsafe(o._chunkSize)),0===h){if(s+=r-u,r=u,!c)return!0;var g=o._handle.write(e,t,s,r,o._buffer,o._offset,o._chunkSize);return g.callback=y,void(g.buffer=t)}if(!c)return!1;n()}}b.buffer=t,b.callback=y},o.inherits(w,M),o.inherits(_,M),o.inherits(k,M),o.inherits(x,M),o.inherits(S,M),o.inherits(E,M),o.inherits(I,M)},5298:(t,e,n)=>{var r=n(9208).Buffer;t.exports=function(t,e){if(r.isBuffer(t)&&r.isBuffer(e)){if("function"==typeof t.equals)return t.equals(e);if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}}},9208:(t,e,n)=>{"use strict";var r=n(6251),i=n(7467),a="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;e.Buffer=l,e.SlowBuffer=function(t){return+t!=t&&(t=0),l.alloc(+t)},e.INSPECT_MAX_BYTES=50;var s=2147483647;function o(t){if(t>s)throw new RangeError('The value "'+t+'" is invalid for option "size"');var e=new Uint8Array(t);return Object.setPrototypeOf(e,l.prototype),e}function l(t,e,n){if("number"==typeof t){if("string"==typeof e)throw new TypeError('The "string" argument must be of type string. Received type number');return c(t)}return u(t,e,n)}function u(t,e,n){if("string"==typeof t)return function(t,e){if("string"==typeof e&&""!==e||(e="utf8"),!l.isEncoding(e))throw new TypeError("Unknown encoding: "+e);var n=0|m(t,e),r=o(n),i=r.write(t,e);return i!==n&&(r=r.slice(0,i)),r}(t,e);if(ArrayBuffer.isView(t))return function(t){if(U(t,Uint8Array)){var e=new Uint8Array(t);return f(e.buffer,e.byteOffset,e.byteLength)}return d(t)}(t);if(null==t)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);if(U(t,ArrayBuffer)||t&&U(t.buffer,ArrayBuffer))return f(t,e,n);if("undefined"!=typeof SharedArrayBuffer&&(U(t,SharedArrayBuffer)||t&&U(t.buffer,SharedArrayBuffer)))return f(t,e,n);if("number"==typeof t)throw new TypeError('The "value" argument must not be of type number. Received type number');var r=t.valueOf&&t.valueOf();if(null!=r&&r!==t)return l.from(r,e,n);var i=function(t){if(l.isBuffer(t)){var e=0|p(t.length),n=o(e);return 0===n.length||t.copy(n,0,0,e),n}return void 0!==t.length?"number"!=typeof t.length||j(t.length)?o(0):d(t):"Buffer"===t.type&&Array.isArray(t.data)?d(t.data):void 0}(t);if(i)return i;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof t[Symbol.toPrimitive])return l.from(t[Symbol.toPrimitive]("string"),e,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}function h(t){if("number"!=typeof t)throw new TypeError('"size" argument must be of type number');if(t<0)throw new RangeError('The value "'+t+'" is invalid for option "size"')}function c(t){return h(t),o(t<0?0:0|p(t))}function d(t){for(var e=t.length<0?0:0|p(t.length),n=o(e),r=0;r<e;r+=1)n[r]=255&t[r];return n}function f(t,e,n){if(e<0||t.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(t.byteLength<e+(n||0))throw new RangeError('"length" is outside of buffer bounds');var r;return r=void 0===e&&void 0===n?new Uint8Array(t):void 0===n?new Uint8Array(t,e):new Uint8Array(t,e,n),Object.setPrototypeOf(r,l.prototype),r}function p(t){if(t>=s)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s.toString(16)+" bytes");return 0|t}function m(t,e){if(l.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||U(t,ArrayBuffer))return t.byteLength;if("string"!=typeof t)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof t);var n=t.length,r=arguments.length>2&&!0===arguments[2];if(!r&&0===n)return 0;for(var i=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return P(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return L(t).length;default:if(i)return r?-1:P(t).length;e=(""+e).toLowerCase(),i=!0}}function g(t,e,n){var r=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return N(this,e,n);case"utf8":case"utf-8":return I(this,e,n);case"ascii":return M(this,e,n);case"latin1":case"binary":return T(this,e,n);case"base64":return E(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return C(this,e,n);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}}function b(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function y(t,e,n,r,i){if(0===t.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),j(n=+n)&&(n=i?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(i)return-1;n=t.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof e&&(e=l.from(e,r)),l.isBuffer(e))return 0===e.length?-1:v(t,e,n,r,i);if("number"==typeof e)return e&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):v(t,[e],n,r,i);throw new TypeError("val must be string, number or Buffer")}function v(t,e,n,r,i){var a,s=1,o=t.length,l=e.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(t.length<2||e.length<2)return-1;s=2,o/=2,l/=2,n/=2}function u(t,e){return 1===s?t[e]:t.readUInt16BE(e*s)}if(i){var h=-1;for(a=n;a<o;a++)if(u(t,a)===u(e,-1===h?0:a-h)){if(-1===h&&(h=a),a-h+1===l)return h*s}else-1!==h&&(a-=a-h),h=-1}else for(n+l>o&&(n=o-l),a=n;a>=0;a--){for(var c=!0,d=0;d<l;d++)if(u(t,a+d)!==u(e,d)){c=!1;break}if(c)return a}return-1}function w(t,e,n,r){n=Number(n)||0;var i=t.length-n;r?(r=Number(r))>i&&(r=i):r=i;var a=e.length;r>a/2&&(r=a/2);for(var s=0;s<r;++s){var o=parseInt(e.substr(2*s,2),16);if(j(o))return s;t[n+s]=o}return s}function _(t,e,n,r){return $(P(e,t.length-n),t,n,r)}function k(t,e,n,r){return $(function(t){for(var e=[],n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}(e),t,n,r)}function x(t,e,n,r){return $(L(e),t,n,r)}function S(t,e,n,r){return $(function(t,e){for(var n,r,i,a=[],s=0;s<t.length&&!((e-=2)<0);++s)r=(n=t.charCodeAt(s))>>8,i=n%256,a.push(i),a.push(r);return a}(e,t.length-n),t,n,r)}function E(t,e,n){return 0===e&&n===t.length?r.fromByteArray(t):r.fromByteArray(t.slice(e,n))}function I(t,e,n){n=Math.min(t.length,n);for(var r=[],i=e;i<n;){var a,s,o,l,u=t[i],h=null,c=u>239?4:u>223?3:u>191?2:1;if(i+c<=n)switch(c){case 1:u<128&&(h=u);break;case 2:128==(192&(a=t[i+1]))&&(l=(31&u)<<6|63&a)>127&&(h=l);break;case 3:a=t[i+1],s=t[i+2],128==(192&a)&&128==(192&s)&&(l=(15&u)<<12|(63&a)<<6|63&s)>2047&&(l<55296||l>57343)&&(h=l);break;case 4:a=t[i+1],s=t[i+2],o=t[i+3],128==(192&a)&&128==(192&s)&&128==(192&o)&&(l=(15&u)<<18|(63&a)<<12|(63&s)<<6|63&o)>65535&&l<1114112&&(h=l)}null===h?(h=65533,c=1):h>65535&&(h-=65536,r.push(h>>>10&1023|55296),h=56320|1023&h),r.push(h),i+=c}return function(t){var e=t.length;if(e<=A)return String.fromCharCode.apply(String,t);for(var n="",r=0;r<e;)n+=String.fromCharCode.apply(String,t.slice(r,r+=A));return n}(r)}e.kMaxLength=s,l.TYPED_ARRAY_SUPPORT=function(){try{var t=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(t,e),42===t.foo()}catch(t){return!1}}(),l.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(l.prototype,"parent",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.buffer}}),Object.defineProperty(l.prototype,"offset",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.byteOffset}}),l.poolSize=8192,l.from=function(t,e,n){return u(t,e,n)},Object.setPrototypeOf(l.prototype,Uint8Array.prototype),Object.setPrototypeOf(l,Uint8Array),l.alloc=function(t,e,n){return function(t,e,n){return h(t),t<=0?o(t):void 0!==e?"string"==typeof n?o(t).fill(e,n):o(t).fill(e):o(t)}(t,e,n)},l.allocUnsafe=function(t){return c(t)},l.allocUnsafeSlow=function(t){return c(t)},l.isBuffer=function(t){return null!=t&&!0===t._isBuffer&&t!==l.prototype},l.compare=function(t,e){if(U(t,Uint8Array)&&(t=l.from(t,t.offset,t.byteLength)),U(e,Uint8Array)&&(e=l.from(e,e.offset,e.byteLength)),!l.isBuffer(t)||!l.isBuffer(e))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(t===e)return 0;for(var n=t.length,r=e.length,i=0,a=Math.min(n,r);i<a;++i)if(t[i]!==e[i]){n=t[i],r=e[i];break}return n<r?-1:r<n?1:0},l.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(t,e){if(!Array.isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return l.alloc(0);var n;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;var r=l.allocUnsafe(e),i=0;for(n=0;n<t.length;++n){var a=t[n];if(U(a,Uint8Array))i+a.length>r.length?l.from(a).copy(r,i):Uint8Array.prototype.set.call(r,a,i);else{if(!l.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(r,i)}i+=a.length}return r},l.byteLength=m,l.prototype._isBuffer=!0,l.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)b(this,e,e+1);return this},l.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)b(this,e,e+3),b(this,e+1,e+2);return this},l.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)b(this,e,e+7),b(this,e+1,e+6),b(this,e+2,e+5),b(this,e+3,e+4);return this},l.prototype.toString=function(){var t=this.length;return 0===t?"":0===arguments.length?I(this,0,t):g.apply(this,arguments)},l.prototype.toLocaleString=l.prototype.toString,l.prototype.equals=function(t){if(!l.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===l.compare(this,t)},l.prototype.inspect=function(){var t="",n=e.INSPECT_MAX_BYTES;return t=this.toString("hex",0,n).replace(/(.{2})/g,"$1 ").trim(),this.length>n&&(t+=" ... "),"<Buffer "+t+">"},a&&(l.prototype[a]=l.prototype.inspect),l.prototype.compare=function(t,e,n,r,i){if(U(t,Uint8Array)&&(t=l.from(t,t.offset,t.byteLength)),!l.isBuffer(t))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof t);if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),e<0||n>t.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&e>=n)return 0;if(r>=i)return-1;if(e>=n)return 1;if(this===t)return 0;for(var a=(i>>>=0)-(r>>>=0),s=(n>>>=0)-(e>>>=0),o=Math.min(a,s),u=this.slice(r,i),h=t.slice(e,n),c=0;c<o;++c)if(u[c]!==h[c]){a=u[c],s=h[c];break}return a<s?-1:s<a?1:0},l.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},l.prototype.indexOf=function(t,e,n){return y(this,t,e,n,!0)},l.prototype.lastIndexOf=function(t,e,n){return y(this,t,e,n,!1)},l.prototype.write=function(t,e,n,r){if(void 0===e)r="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)r=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e>>>=0,isFinite(n)?(n>>>=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-e;if((void 0===n||n>i)&&(n=i),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var a=!1;;)switch(r){case"hex":return w(this,t,e,n);case"utf8":case"utf-8":return _(this,t,e,n);case"ascii":case"latin1":case"binary":return k(this,t,e,n);case"base64":return x(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return S(this,t,e,n);default:if(a)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),a=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var A=4096;function M(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(127&t[i]);return r}function T(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(t[i]);return r}function N(t,e,n){var r=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>r)&&(n=r);for(var i="",a=e;a<n;++a)i+=W[t[a]];return i}function C(t,e,n){for(var r=t.slice(e,n),i="",a=0;a<r.length-1;a+=2)i+=String.fromCharCode(r[a]+256*r[a+1]);return i}function R(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function O(t,e,n,r,i,a){if(!l.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<a)throw new RangeError('"value" argument is out of bounds');if(n+r>t.length)throw new RangeError("Index out of range")}function D(t,e,n,r,i,a){if(n+r>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function z(t,e,n,r,a){return e=+e,n>>>=0,a||D(t,0,n,4),i.write(t,e,n,r,23,4),n+4}function B(t,e,n,r,a){return e=+e,n>>>=0,a||D(t,0,n,8),i.write(t,e,n,r,52,8),n+8}l.prototype.slice=function(t,e){var n=this.length;(t=~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),(e=void 0===e?n:~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),e<t&&(e=t);var r=this.subarray(t,e);return Object.setPrototypeOf(r,l.prototype),r},l.prototype.readUintLE=l.prototype.readUIntLE=function(t,e,n){t>>>=0,e>>>=0,n||R(t,e,this.length);for(var r=this[t],i=1,a=0;++a<e&&(i*=256);)r+=this[t+a]*i;return r},l.prototype.readUintBE=l.prototype.readUIntBE=function(t,e,n){t>>>=0,e>>>=0,n||R(t,e,this.length);for(var r=this[t+--e],i=1;e>0&&(i*=256);)r+=this[t+--e]*i;return r},l.prototype.readUint8=l.prototype.readUInt8=function(t,e){return t>>>=0,e||R(t,1,this.length),this[t]},l.prototype.readUint16LE=l.prototype.readUInt16LE=function(t,e){return t>>>=0,e||R(t,2,this.length),this[t]|this[t+1]<<8},l.prototype.readUint16BE=l.prototype.readUInt16BE=function(t,e){return t>>>=0,e||R(t,2,this.length),this[t]<<8|this[t+1]},l.prototype.readUint32LE=l.prototype.readUInt32LE=function(t,e){return t>>>=0,e||R(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},l.prototype.readUint32BE=l.prototype.readUInt32BE=function(t,e){return t>>>=0,e||R(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},l.prototype.readIntLE=function(t,e,n){t>>>=0,e>>>=0,n||R(t,e,this.length);for(var r=this[t],i=1,a=0;++a<e&&(i*=256);)r+=this[t+a]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*e)),r},l.prototype.readIntBE=function(t,e,n){t>>>=0,e>>>=0,n||R(t,e,this.length);for(var r=e,i=1,a=this[t+--r];r>0&&(i*=256);)a+=this[t+--r]*i;return a>=(i*=128)&&(a-=Math.pow(2,8*e)),a},l.prototype.readInt8=function(t,e){return t>>>=0,e||R(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},l.prototype.readInt16LE=function(t,e){t>>>=0,e||R(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt16BE=function(t,e){t>>>=0,e||R(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt32LE=function(t,e){return t>>>=0,e||R(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},l.prototype.readInt32BE=function(t,e){return t>>>=0,e||R(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},l.prototype.readFloatLE=function(t,e){return t>>>=0,e||R(t,4,this.length),i.read(this,t,!0,23,4)},l.prototype.readFloatBE=function(t,e){return t>>>=0,e||R(t,4,this.length),i.read(this,t,!1,23,4)},l.prototype.readDoubleLE=function(t,e){return t>>>=0,e||R(t,8,this.length),i.read(this,t,!0,52,8)},l.prototype.readDoubleBE=function(t,e){return t>>>=0,e||R(t,8,this.length),i.read(this,t,!1,52,8)},l.prototype.writeUintLE=l.prototype.writeUIntLE=function(t,e,n,r){t=+t,e>>>=0,n>>>=0,r||O(this,t,e,n,Math.pow(2,8*n)-1,0);var i=1,a=0;for(this[e]=255&t;++a<n&&(i*=256);)this[e+a]=t/i&255;return e+n},l.prototype.writeUintBE=l.prototype.writeUIntBE=function(t,e,n,r){t=+t,e>>>=0,n>>>=0,r||O(this,t,e,n,Math.pow(2,8*n)-1,0);var i=n-1,a=1;for(this[e+i]=255&t;--i>=0&&(a*=256);)this[e+i]=t/a&255;return e+n},l.prototype.writeUint8=l.prototype.writeUInt8=function(t,e,n){return t=+t,e>>>=0,n||O(this,t,e,1,255,0),this[e]=255&t,e+1},l.prototype.writeUint16LE=l.prototype.writeUInt16LE=function(t,e,n){return t=+t,e>>>=0,n||O(this,t,e,2,65535,0),this[e]=255&t,this[e+1]=t>>>8,e+2},l.prototype.writeUint16BE=l.prototype.writeUInt16BE=function(t,e,n){return t=+t,e>>>=0,n||O(this,t,e,2,65535,0),this[e]=t>>>8,this[e+1]=255&t,e+2},l.prototype.writeUint32LE=l.prototype.writeUInt32LE=function(t,e,n){return t=+t,e>>>=0,n||O(this,t,e,4,4294967295,0),this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t,e+4},l.prototype.writeUint32BE=l.prototype.writeUInt32BE=function(t,e,n){return t=+t,e>>>=0,n||O(this,t,e,4,4294967295,0),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},l.prototype.writeIntLE=function(t,e,n,r){if(t=+t,e>>>=0,!r){var i=Math.pow(2,8*n-1);O(this,t,e,n,i-1,-i)}var a=0,s=1,o=0;for(this[e]=255&t;++a<n&&(s*=256);)t<0&&0===o&&0!==this[e+a-1]&&(o=1),this[e+a]=(t/s>>0)-o&255;return e+n},l.prototype.writeIntBE=function(t,e,n,r){if(t=+t,e>>>=0,!r){var i=Math.pow(2,8*n-1);O(this,t,e,n,i-1,-i)}var a=n-1,s=1,o=0;for(this[e+a]=255&t;--a>=0&&(s*=256);)t<0&&0===o&&0!==this[e+a+1]&&(o=1),this[e+a]=(t/s>>0)-o&255;return e+n},l.prototype.writeInt8=function(t,e,n){return t=+t,e>>>=0,n||O(this,t,e,1,127,-128),t<0&&(t=255+t+1),this[e]=255&t,e+1},l.prototype.writeInt16LE=function(t,e,n){return t=+t,e>>>=0,n||O(this,t,e,2,32767,-32768),this[e]=255&t,this[e+1]=t>>>8,e+2},l.prototype.writeInt16BE=function(t,e,n){return t=+t,e>>>=0,n||O(this,t,e,2,32767,-32768),this[e]=t>>>8,this[e+1]=255&t,e+2},l.prototype.writeInt32LE=function(t,e,n){return t=+t,e>>>=0,n||O(this,t,e,4,2147483647,-2147483648),this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24,e+4},l.prototype.writeInt32BE=function(t,e,n){return t=+t,e>>>=0,n||O(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},l.prototype.writeFloatLE=function(t,e,n){return z(this,t,e,!0,n)},l.prototype.writeFloatBE=function(t,e,n){return z(this,t,e,!1,n)},l.prototype.writeDoubleLE=function(t,e,n){return B(this,t,e,!0,n)},l.prototype.writeDoubleBE=function(t,e,n){return B(this,t,e,!1,n)},l.prototype.copy=function(t,e,n,r){if(!l.isBuffer(t))throw new TypeError("argument should be a Buffer");if(n||(n=0),r||0===r||(r=this.length),e>=t.length&&(e=t.length),e||(e=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n);var i=r-n;return this===t&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(e,n,r):Uint8Array.prototype.set.call(t,this.subarray(n,r),e),i},l.prototype.fill=function(t,e,n,r){if("string"==typeof t){if("string"==typeof e?(r=e,e=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!l.isEncoding(r))throw new TypeError("Unknown encoding: "+r);if(1===t.length){var i=t.charCodeAt(0);("utf8"===r&&i<128||"latin1"===r)&&(t=i)}}else"number"==typeof t?t&=255:"boolean"==typeof t&&(t=Number(t));if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;var a;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"==typeof t)for(a=e;a<n;++a)this[a]=t;else{var s=l.isBuffer(t)?t:l.from(t,r),o=s.length;if(0===o)throw new TypeError('The value "'+t+'" is invalid for argument "value"');for(a=0;a<n-e;++a)this[a+e]=s[a%o]}return this};var F=/[^+/0-9A-Za-z-_]/g;function P(t,e){var n;e=e||1/0;for(var r=t.length,i=null,a=[],s=0;s<r;++s){if((n=t.charCodeAt(s))>55295&&n<57344){if(!i){if(n>56319){(e-=3)>-1&&a.push(239,191,189);continue}if(s+1===r){(e-=3)>-1&&a.push(239,191,189);continue}i=n;continue}if(n<56320){(e-=3)>-1&&a.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(e-=3)>-1&&a.push(239,191,189);if(i=null,n<128){if((e-=1)<0)break;a.push(n)}else if(n<2048){if((e-=2)<0)break;a.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;a.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;a.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return a}function L(t){return r.toByteArray(function(t){if((t=(t=t.split("=")[0]).trim().replace(F,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function $(t,e,n,r){for(var i=0;i<r&&!(i+n>=e.length||i>=t.length);++i)e[i+n]=t[i];return i}function U(t,e){return t instanceof e||null!=t&&null!=t.constructor&&null!=t.constructor.name&&t.constructor.name===e.name}function j(t){return t!=t}var W=function(){for(var t="0123456789abcdef",e=new Array(256),n=0;n<16;++n)for(var r=16*n,i=0;i<16;++i)e[r+i]=t[n]+t[i];return e}()},8708:t=>{t.exports={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",208:"Already Reported",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",308:"Permanent Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Payload Too Large",414:"URI Too Long",415:"Unsupported Media Type",416:"Range Not Satisfiable",417:"Expectation Failed",418:"I'm a teapot",421:"Misdirected Request",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",425:"Unordered Collection",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",431:"Request Header Fields Too Large",451:"Unavailable For Legal Reasons",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",508:"Loop Detected",509:"Bandwidth Limit Exceeded",510:"Not Extended",511:"Network Authentication Required"}},7801:(t,e,n)=>{function r(t){return Object.prototype.toString.call(t)}e.isArray=function(t){return Array.isArray?Array.isArray(t):"[object Array]"===r(t)},e.isBoolean=function(t){return"boolean"==typeof t},e.isNull=function(t){return null===t},e.isNullOrUndefined=function(t){return null==t},e.isNumber=function(t){return"number"==typeof t},e.isString=function(t){return"string"==typeof t},e.isSymbol=function(t){return"symbol"==typeof t},e.isUndefined=function(t){return void 0===t},e.isRegExp=function(t){return"[object RegExp]"===r(t)},e.isObject=function(t){return"object"==typeof t&&null!==t},e.isDate=function(t){return"[object Date]"===r(t)},e.isError=function(t){return"[object Error]"===r(t)||t instanceof Error},e.isFunction=function(t){return"function"==typeof t},e.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t},e.isBuffer=n(9208).Buffer.isBuffer},6204:t=>{"use strict";var e,n="object"==typeof Reflect?Reflect:null,r=n&&"function"==typeof n.apply?n.apply:function(t,e,n){return Function.prototype.apply.call(t,e,n)};e=n&&"function"==typeof n.ownKeys?n.ownKeys:Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:function(t){return Object.getOwnPropertyNames(t)};var i=Number.isNaN||function(t){return t!=t};function a(){a.init.call(this)}t.exports=a,t.exports.once=function(t,e){return new Promise((function(n,r){function i(n){t.removeListener(e,a),r(n)}function a(){"function"==typeof t.removeListener&&t.removeListener("error",i),n([].slice.call(arguments))}m(t,e,a,{once:!0}),"error"!==e&&function(t,e,n){"function"==typeof t.on&&m(t,"error",e,{once:!0})}(t,i)}))},a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var s=10;function o(t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}function l(t){return void 0===t._maxListeners?a.defaultMaxListeners:t._maxListeners}function u(t,e,n,r){var i,a,s,u;if(o(n),void 0===(a=t._events)?(a=t._events=Object.create(null),t._eventsCount=0):(void 0!==a.newListener&&(t.emit("newListener",e,n.listener?n.listener:n),a=t._events),s=a[e]),void 0===s)s=a[e]=n,++t._eventsCount;else if("function"==typeof s?s=a[e]=r?[n,s]:[s,n]:r?s.unshift(n):s.push(n),(i=l(t))>0&&s.length>i&&!s.warned){s.warned=!0;var h=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");h.name="MaxListenersExceededWarning",h.emitter=t,h.type=e,h.count=s.length,u=h,console&&console.warn&&console.warn(u)}return t}function h(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function c(t,e,n){var r={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},i=h.bind(r);return i.listener=n,r.wrapFn=i,i}function d(t,e,n){var r=t._events;if(void 0===r)return[];var i=r[e];return void 0===i?[]:"function"==typeof i?n?[i.listener||i]:[i]:n?function(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}(i):p(i,i.length)}function f(t){var e=this._events;if(void 0!==e){var n=e[t];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function p(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t[r];return n}function m(t,e,n,r){if("function"==typeof t.on)r.once?t.once(e,n):t.on(e,n);else{if("function"!=typeof t.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t);t.addEventListener(e,(function i(a){r.once&&t.removeEventListener(e,i),n(a)}))}}Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return s},set:function(t){if("number"!=typeof t||t<0||i(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");s=t}}),a.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||i(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this},a.prototype.getMaxListeners=function(){return l(this)},a.prototype.emit=function(t){for(var e=[],n=1;n<arguments.length;n++)e.push(arguments[n]);var i="error"===t,a=this._events;if(void 0!==a)i=i&&void 0===a.error;else if(!i)return!1;if(i){var s;if(e.length>0&&(s=e[0]),s instanceof Error)throw s;var o=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw o.context=s,o}var l=a[t];if(void 0===l)return!1;if("function"==typeof l)r(l,this,e);else{var u=l.length,h=p(l,u);for(n=0;n<u;++n)r(h[n],this,e)}return!0},a.prototype.addListener=function(t,e){return u(this,t,e,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(t,e){return u(this,t,e,!0)},a.prototype.once=function(t,e){return o(e),this.on(t,c(this,t,e)),this},a.prototype.prependOnceListener=function(t,e){return o(e),this.prependListener(t,c(this,t,e)),this},a.prototype.removeListener=function(t,e){var n,r,i,a,s;if(o(e),void 0===(r=this._events))return this;if(void 0===(n=r[t]))return this;if(n===e||n.listener===e)0==--this._eventsCount?this._events=Object.create(null):(delete r[t],r.removeListener&&this.emit("removeListener",t,n.listener||e));else if("function"!=typeof n){for(i=-1,a=n.length-1;a>=0;a--)if(n[a]===e||n[a].listener===e){s=n[a].listener,i=a;break}if(i<0)return this;0===i?n.shift():function(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}(n,i),1===n.length&&(r[t]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",t,s||e)}return this},a.prototype.off=a.prototype.removeListener,a.prototype.removeAllListeners=function(t){var e,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[t]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[t]),this;if(0===arguments.length){var i,a=Object.keys(n);for(r=0;r<a.length;++r)"removeListener"!==(i=a[r])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(e=n[t]))this.removeListener(t,e);else if(void 0!==e)for(r=e.length-1;r>=0;r--)this.removeListener(t,e[r]);return this},a.prototype.listeners=function(t){return d(this,t,!0)},a.prototype.rawListeners=function(t){return d(this,t,!1)},a.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):f.call(t,e)},a.prototype.listenerCount=f,a.prototype.eventNames=function(){return this._eventsCount>0?e(this._events):[]}},9771:(t,e,n)=>{var r=n(8652);t.exports={create:function(t,e){if(t instanceof(e=e||(0,eval)("this")).ArrayBuffer){var i=n(3247);return new r(new i(t,0,t.byteLength,!0,e))}var a=n(3638);return new r(new a(t,0,t.length,!0))}}},3638:t=>{function e(t,e,n,r){this.buffer=t,this.offset=e||0,n="number"==typeof n?n:t.length,this.endPosition=this.offset+n,this.setBigEndian(r)}e.prototype={setBigEndian:function(t){this.bigEndian=!!t},nextUInt8:function(){var t=this.buffer.readUInt8(this.offset);return this.offset+=1,t},nextInt8:function(){var t=this.buffer.readInt8(this.offset);return this.offset+=1,t},nextUInt16:function(){var t=this.bigEndian?this.buffer.readUInt16BE(this.offset):this.buffer.readUInt16LE(this.offset);return this.offset+=2,t},nextUInt32:function(){var t=this.bigEndian?this.buffer.readUInt32BE(this.offset):this.buffer.readUInt32LE(this.offset);return this.offset+=4,t},nextInt16:function(){var t=this.bigEndian?this.buffer.readInt16BE(this.offset):this.buffer.readInt16LE(this.offset);return this.offset+=2,t},nextInt32:function(){var t=this.bigEndian?this.buffer.readInt32BE(this.offset):this.buffer.readInt32LE(this.offset);return this.offset+=4,t},nextFloat:function(){var t=this.bigEndian?this.buffer.readFloatBE(this.offset):this.buffer.readFloatLE(this.offset);return this.offset+=4,t},nextDouble:function(){var t=this.bigEndian?this.buffer.readDoubleBE(this.offset):this.buffer.readDoubleLE(this.offset);return this.offset+=8,t},nextBuffer:function(t){var e=this.buffer.slice(this.offset,this.offset+t);return this.offset+=t,e},remainingLength:function(){return this.endPosition-this.offset},nextString:function(t){var e=this.buffer.toString("utf8",this.offset,this.offset+t);return this.offset+=t,e},mark:function(){var t=this;return{openWithOffset:function(n){return n=(n||0)+this.offset,new e(t.buffer,n,t.endPosition-n,t.bigEndian)},offset:this.offset}},offsetFrom:function(t){return this.offset-t.offset},skip:function(t){this.offset+=t},branch:function(t,n){return n="number"==typeof n?n:this.endPosition-(this.offset+t),new e(this.buffer,this.offset+t,n,this.bigEndian)}},t.exports=e},9292:t=>{function e(t){return parseInt(t,10)}function n(t,n){t=t.map(e),n=n.map(e);var r=t[0],i=t[1]-1,a=t[2],s=n[0],o=n[1],l=n[2];return Date.UTC(r,i,a,s,o,l,0)/1e3}function r(t){var r=t.substr(0,10).split("-"),i=t.substr(11,8).split(":"),a=t.substr(19,6).split(":").map(e),s=3600*a[0]+60*a[1],o=n(r,i);if("number"==typeof(o-=s)&&!isNaN(o))return o}function i(t){var e=t.split(" "),r=n(e[0].split(":"),e[1].split(":"));if("number"==typeof r&&!isNaN(r))return r}t.exports={parseDateWithSpecFormat:i,parseDateWithTimezoneFormat:r,parseExifDate:function(t){var e=19===t.length&&":"===t.charAt(4);return 25===t.length&&"T"===t.charAt(10)?r(t):e?i(t):void 0}}},3247:t=>{function e(t,e,n,r,i,a){this.global=i,e=e||0,n=n||t.byteLength-e,this.arrayBuffer=t.slice(e,e+n),this.view=new i.DataView(this.arrayBuffer,0,this.arrayBuffer.byteLength),this.setBigEndian(r),this.offset=0,this.parentOffset=(a||0)+e}e.prototype={setBigEndian:function(t){this.littleEndian=!t},nextUInt8:function(){var t=this.view.getUint8(this.offset);return this.offset+=1,t},nextInt8:function(){var t=this.view.getInt8(this.offset);return this.offset+=1,t},nextUInt16:function(){var t=this.view.getUint16(this.offset,this.littleEndian);return this.offset+=2,t},nextUInt32:function(){var t=this.view.getUint32(this.offset,this.littleEndian);return this.offset+=4,t},nextInt16:function(){var t=this.view.getInt16(this.offset,this.littleEndian);return this.offset+=2,t},nextInt32:function(){var t=this.view.getInt32(this.offset,this.littleEndian);return this.offset+=4,t},nextFloat:function(){var t=this.view.getFloat32(this.offset,this.littleEndian);return this.offset+=4,t},nextDouble:function(){var t=this.view.getFloat64(this.offset,this.littleEndian);return this.offset+=8,t},nextBuffer:function(t){var e=this.arrayBuffer.slice(this.offset,this.offset+t);return this.offset+=t,e},remainingLength:function(){return this.arrayBuffer.byteLength-this.offset},nextString:function(t){var e=this.arrayBuffer.slice(this.offset,this.offset+t);return e=String.fromCharCode.apply(null,new this.global.Uint8Array(e)),this.offset+=t,e},mark:function(){var t=this;return{openWithOffset:function(n){return n=(n||0)+this.offset,new e(t.arrayBuffer,n,t.arrayBuffer.byteLength-n,!t.littleEndian,t.global,t.parentOffset)},offset:this.offset,getParentOffset:function(){return t.parentOffset}}},offsetFrom:function(t){return this.parentOffset+this.offset-(t.offset+t.getParentOffset())},skip:function(t){this.offset+=t},branch:function(t,n){return n="number"==typeof n?n:this.arrayBuffer.byteLength-(this.offset+t),new e(this.arrayBuffer,this.offset+t,n,!this.littleEndian,this.global,this.parentOffset)}},t.exports=e},1240:t=>{t.exports={exif:{1:"InteropIndex",2:"InteropVersion",11:"ProcessingSoftware",254:"SubfileType",255:"OldSubfileType",256:"ImageWidth",257:"ImageHeight",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",263:"Thresholding",264:"CellWidth",265:"CellLength",266:"FillOrder",269:"DocumentName",270:"ImageDescription",271:"Make",272:"Model",273:"StripOffsets",274:"Orientation",277:"SamplesPerPixel",278:"RowsPerStrip",279:"StripByteCounts",280:"MinSampleValue",281:"MaxSampleValue",282:"XResolution",283:"YResolution",284:"PlanarConfiguration",285:"PageName",286:"XPosition",287:"YPosition",288:"FreeOffsets",289:"FreeByteCounts",290:"GrayResponseUnit",291:"GrayResponseCurve",292:"T4Options",293:"T6Options",296:"ResolutionUnit",297:"PageNumber",300:"ColorResponseUnit",301:"TransferFunction",305:"Software",306:"ModifyDate",315:"Artist",316:"HostComputer",317:"Predictor",318:"WhitePoint",319:"PrimaryChromaticities",320:"ColorMap",321:"HalftoneHints",322:"TileWidth",323:"TileLength",324:"TileOffsets",325:"TileByteCounts",326:"BadFaxLines",327:"CleanFaxData",328:"ConsecutiveBadFaxLines",330:"SubIFD",332:"InkSet",333:"InkNames",334:"NumberofInks",336:"DotRange",337:"TargetPrinter",338:"ExtraSamples",339:"SampleFormat",340:"SMinSampleValue",341:"SMaxSampleValue",342:"TransferRange",343:"ClipPath",344:"XClipPathUnits",345:"YClipPathUnits",346:"Indexed",347:"JPEGTables",351:"OPIProxy",400:"GlobalParametersIFD",401:"ProfileType",402:"FaxProfile",403:"CodingMethods",404:"VersionYear",405:"ModeNumber",433:"Decode",434:"DefaultImageColor",435:"T82Options",437:"JPEGTables",512:"JPEGProc",513:"ThumbnailOffset",514:"ThumbnailLength",515:"JPEGRestartInterval",517:"JPEGLosslessPredictors",518:"JPEGPointTransforms",519:"JPEGQTables",520:"JPEGDCTables",521:"JPEGACTables",529:"YCbCrCoefficients",530:"YCbCrSubSampling",531:"YCbCrPositioning",532:"ReferenceBlackWhite",559:"StripRowCounts",700:"ApplicationNotes",999:"USPTOMiscellaneous",4096:"RelatedImageFileFormat",4097:"RelatedImageWidth",4098:"RelatedImageHeight",18246:"Rating",18247:"XP_DIP_XML",18248:"StitchInfo",18249:"RatingPercent",32781:"ImageID",32931:"WangTag1",32932:"WangAnnotation",32933:"WangTag3",32934:"WangTag4",32995:"Matteing",32996:"DataType",32997:"ImageDepth",32998:"TileDepth",33405:"Model2",33421:"CFARepeatPatternDim",33422:"CFAPattern2",33423:"BatteryLevel",33424:"KodakIFD",33432:"Copyright",33434:"ExposureTime",33437:"FNumber",33445:"MDFileTag",33446:"MDScalePixel",33447:"MDColorTable",33448:"MDLabName",33449:"MDSampleInfo",33450:"MDPrepDate",33451:"MDPrepTime",33452:"MDFileUnits",33550:"PixelScale",33589:"AdventScale",33590:"AdventRevision",33628:"UIC1Tag",33629:"UIC2Tag",33630:"UIC3Tag",33631:"UIC4Tag",33723:"IPTC-NAA",33918:"IntergraphPacketData",33919:"IntergraphFlagRegisters",33920:"IntergraphMatrix",33921:"INGRReserved",33922:"ModelTiePoint",34016:"Site",34017:"ColorSequence",34018:"IT8Header",34019:"RasterPadding",34020:"BitsPerRunLength",34021:"BitsPerExtendedRunLength",34022:"ColorTable",34023:"ImageColorIndicator",34024:"BackgroundColorIndicator",34025:"ImageColorValue",34026:"BackgroundColorValue",34027:"PixelIntensityRange",34028:"TransparencyIndicator",34029:"ColorCharacterization",34030:"HCUsage",34031:"TrapIndicator",34032:"CMYKEquivalent",34118:"SEMInfo",34152:"AFCP_IPTC",34232:"PixelMagicJBIGOptions",34264:"ModelTransform",34306:"WB_GRGBLevels",34310:"LeafData",34377:"PhotoshopSettings",34665:"ExifOffset",34675:"ICC_Profile",34687:"TIFF_FXExtensions",34688:"MultiProfiles",34689:"SharedData",34690:"T88Options",34732:"ImageLayer",34735:"GeoTiffDirectory",34736:"GeoTiffDoubleParams",34737:"GeoTiffAsciiParams",34850:"ExposureProgram",34852:"SpectralSensitivity",34853:"GPSInfo",34855:"ISO",34856:"Opto-ElectricConvFactor",34857:"Interlace",34858:"TimeZoneOffset",34859:"SelfTimerMode",34864:"SensitivityType",34865:"StandardOutputSensitivity",34866:"RecommendedExposureIndex",34867:"ISOSpeed",34868:"ISOSpeedLatitudeyyy",34869:"ISOSpeedLatitudezzz",34908:"FaxRecvParams",34909:"FaxSubAddress",34910:"FaxRecvTime",34954:"LeafSubIFD",36864:"ExifVersion",36867:"DateTimeOriginal",36868:"CreateDate",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureCompensation",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37386:"FocalLength",37387:"FlashEnergy",37388:"SpatialFrequencyResponse",37389:"Noise",37390:"FocalPlaneXResolution",37391:"FocalPlaneYResolution",37392:"FocalPlaneResolutionUnit",37393:"ImageNumber",37394:"SecurityClassification",37395:"ImageHistory",37396:"SubjectArea",37397:"ExposureIndex",37398:"TIFF-EPStandardID",37399:"SensingMethod",37434:"CIP3DataFile",37435:"CIP3Sheet",37436:"CIP3Side",37439:"StoNits",37500:"MakerNote",37510:"UserComment",37520:"SubSecTime",37521:"SubSecTimeOriginal",37522:"SubSecTimeDigitized",37679:"MSDocumentText",37680:"MSPropertySetStorage",37681:"MSDocumentTextPosition",37724:"ImageSourceData",40091:"XPTitle",40092:"XPComment",40093:"XPAuthor",40094:"XPKeywords",40095:"XPSubject",40960:"FlashpixVersion",40961:"ColorSpace",40962:"ExifImageWidth",40963:"ExifImageHeight",40964:"RelatedSoundFile",40965:"InteropOffset",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41485:"Noise",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41489:"ImageNumber",41490:"SecurityClassification",41491:"ImageHistory",41492:"SubjectLocation",41493:"ExposureIndex",41494:"TIFF-EPStandardID",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRatio",41989:"FocalLengthIn35mmFormat",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",42016:"ImageUniqueID",42032:"OwnerName",42033:"SerialNumber",42034:"LensInfo",42035:"LensMake",42036:"LensModel",42037:"LensSerialNumber",42112:"GDALMetadata",42113:"GDALNoData",42240:"Gamma",44992:"ExpandSoftware",44993:"ExpandLens",44994:"ExpandFilm",44995:"ExpandFilterLens",44996:"ExpandScanner",44997:"ExpandFlashLamp",48129:"PixelFormat",48130:"Transformation",48131:"Uncompressed",48132:"ImageType",48256:"ImageWidth",48257:"ImageHeight",48258:"WidthResolution",48259:"HeightResolution",48320:"ImageOffset",48321:"ImageByteCount",48322:"AlphaOffset",48323:"AlphaByteCount",48324:"ImageDataDiscard",48325:"AlphaDataDiscard",50215:"OceScanjobDesc",50216:"OceApplicationSelector",50217:"OceIDNumber",50218:"OceImageLogic",50255:"Annotations",50341:"PrintIM",50560:"USPTOOriginalContentType",50706:"DNGVersion",50707:"DNGBackwardVersion",50708:"UniqueCameraModel",50709:"LocalizedCameraModel",50710:"CFAPlaneColor",50711:"CFALayout",50712:"LinearizationTable",50713:"BlackLevelRepeatDim",50714:"BlackLevel",50715:"BlackLevelDeltaH",50716:"BlackLevelDeltaV",50717:"WhiteLevel",50718:"DefaultScale",50719:"DefaultCropOrigin",50720:"DefaultCropSize",50721:"ColorMatrix1",50722:"ColorMatrix2",50723:"CameraCalibration1",50724:"CameraCalibration2",50725:"ReductionMatrix1",50726:"ReductionMatrix2",50727:"AnalogBalance",50728:"AsShotNeutral",50729:"AsShotWhiteXY",50730:"BaselineExposure",50731:"BaselineNoise",50732:"BaselineSharpness",50733:"BayerGreenSplit",50734:"LinearResponseLimit",50735:"CameraSerialNumber",50736:"DNGLensInfo",50737:"ChromaBlurRadius",50738:"AntiAliasStrength",50739:"ShadowScale",50740:"DNGPrivateData",50741:"MakerNoteSafety",50752:"RawImageSegmentation",50778:"CalibrationIlluminant1",50779:"CalibrationIlluminant2",50780:"BestQualityScale",50781:"RawDataUniqueID",50784:"AliasLayerMetadata",50827:"OriginalRawFileName",50828:"OriginalRawFileData",50829:"ActiveArea",50830:"MaskedAreas",50831:"AsShotICCProfile",50832:"AsShotPreProfileMatrix",50833:"CurrentICCProfile",50834:"CurrentPreProfileMatrix",50879:"ColorimetricReference",50898:"PanasonicTitle",50899:"PanasonicTitle2",50931:"CameraCalibrationSig",50932:"ProfileCalibrationSig",50933:"ProfileIFD",50934:"AsShotProfileName",50935:"NoiseReductionApplied",50936:"ProfileName",50937:"ProfileHueSatMapDims",50938:"ProfileHueSatMapData1",50939:"ProfileHueSatMapData2",50940:"ProfileToneCurve",50941:"ProfileEmbedPolicy",50942:"ProfileCopyright",50964:"ForwardMatrix1",50965:"ForwardMatrix2",50966:"PreviewApplicationName",50967:"PreviewApplicationVersion",50968:"PreviewSettingsName",50969:"PreviewSettingsDigest",50970:"PreviewColorSpace",50971:"PreviewDateTime",50972:"RawImageDigest",50973:"OriginalRawFileDigest",50974:"SubTileBlockSize",50975:"RowInterleaveFactor",50981:"ProfileLookTableDims",50982:"ProfileLookTableData",51008:"OpcodeList1",51009:"OpcodeList2",51022:"OpcodeList3",51041:"NoiseProfile",51043:"TimeCodes",51044:"FrameRate",51058:"TStop",51081:"ReelName",51089:"OriginalDefaultFinalSize",51090:"OriginalBestQualitySize",51091:"OriginalDefaultCropSize",51105:"CameraLabel",51107:"ProfileHueSatMapEncoding",51108:"ProfileLookTableEncoding",51109:"BaselineExposureOffset",51110:"DefaultBlackRender",51111:"NewRawImageDigest",51112:"RawToPreviewGain",51125:"DefaultUserCrop",59932:"Padding",59933:"OffsetSchema",65e3:"OwnerName",65001:"SerialNumber",65002:"Lens",65024:"KDC_IFD",65100:"RawFile",65101:"Converter",65102:"WhiteBalance",65105:"Exposure",65106:"Shadows",65107:"Brightness",65108:"Contrast",65109:"Saturation",65110:"Sharpness",65111:"Smoothness",65112:"MoireFilter"},gps:{0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential",31:"GPSHPositioningError"}}},9924:t=>{function e(t,e){switch(t){case 1:return e.nextUInt8();case 3:case 8:return e.nextUInt16();case 4:case 9:return e.nextUInt32();case 5:return[e.nextUInt32(),e.nextUInt32()];case 6:return e.nextInt8();case 10:return[e.nextInt32(),e.nextInt32()];case 11:return e.nextFloat();case 12:return e.nextDouble();default:throw new Error("Invalid format while decoding: "+t)}}function n(t,n){var r,i,a=n.nextUInt16(),s=n.nextUInt16(),o=function(t){switch(t){case 1:case 2:case 6:case 7:return 1;case 3:case 8:return 2;case 4:case 9:case 11:return 4;case 5:case 10:case 12:return 8;default:return 0}}(s),l=n.nextUInt32(),u=o*l;if(u>4&&(n=t.openWithOffset(n.nextUInt32())),2===s){var h=(r=n.nextString(l)).indexOf("\0");-1!==h&&(r=r.substr(0,h))}else if(7===s)r=n.nextBuffer(l);else if(0!==s)for(r=[],i=0;i<l;++i)r.push(e(s,n));return u<4&&n.skip(4-u),[a,r,s]}function r(t,e,r){var i,a,s=e.nextUInt16();for(a=0;a<s;++a)r((i=n(t,e))[0],i[1],i[2])}t.exports={IFD0:1,IFD1:2,GPSIFD:3,SubIFD:4,InteropIFD:5,parseTags:function(t,e){var n,i,a,s;try{n=function(t){if("Exif\0\0"!==t.nextString(6))throw new Error("Invalid EXIF header");var e=t.mark(),n=t.nextUInt16();if(18761===n)t.setBigEndian(!1);else{if(19789!==n)throw new Error("Invalid TIFF header");t.setBigEndian(!0)}if(42!==t.nextUInt16())throw new Error("Invalid TIFF data");return e}(t)}catch(t){return!1}var o=n.openWithOffset(t.nextUInt32()),l=this.IFD0;r(n,o,(function(t,n,r){switch(t){case 34853:a=n[0];break;case 34665:i=n[0];break;default:e(l,t,n,r)}}));var u=o.nextUInt32();if(0!==u){var h=n.openWithOffset(u);r(n,h,e.bind(null,this.IFD1))}if(a){var c=n.openWithOffset(a);r(n,c,e.bind(null,this.GPSIFD))}if(i){var d=n.openWithOffset(i),f=this.InteropIFD;r(n,d,(function(t,n,r){40965===t?s=n[0]:e(f,t,n,r)}))}if(s){var p=n.openWithOffset(s);r(n,p,e.bind(null,this.InteropIFD))}return!0}}},8889:t=>{t.exports={parseSections:function(t,e){var n,r;for(t.setBigEndian(!0);t.remainingLength()>0&&218!==r;){if(255!==t.nextUInt8())throw new Error("Invalid JPEG section offset");n=(r=t.nextUInt8())>=208&&r<=217||218===r?0:t.nextUInt16()-2,e(r,t.branch(0,n)),t.skip(n)}},getSizeFromSOFSection:function(t){return t.skip(1),{height:t.nextUInt16(),width:t.nextUInt16()}},getSectionName:function(t){var e,n;switch(t){case 216:e="SOI";break;case 196:e="DHT";break;case 219:e="DQT";break;case 221:e="DRI";break;case 218:e="SOS";break;case 254:e="COM";break;case 217:e="EOI";break;default:t>=224&&t<=239?(e="APP",n=t-224):t>=192&&t<=207&&196!==t&&200!==t&&204!==t?(e="SOF",n=t-192):t>=208&&t<=215&&(e="RST",n=t-208)}var r={name:e};return"number"==typeof n&&(r.index=n),r}}},8652:(t,e,n)=>{var r=n(8889),i=n(9924),a=n(47);function s(t,e,n,r,i,a,s){this.startMarker=t,this.tags=e,this.imageSize=n,this.thumbnailOffset=r,this.thumbnailLength=i,this.thumbnailType=a,this.app1Offset=s}function o(t){this.stream=t,this.flags={readBinaryTags:!1,resolveTagNames:!0,simplifyValues:!0,imageSize:!0,hidePointers:!0,returnTags:!0}}s.prototype={hasThumbnail:function(t){return!(!this.thumbnailOffset||!this.thumbnailLength||"string"==typeof t&&("image/jpeg"===t.toLowerCase().trim()?6!==this.thumbnailType:"image/tiff"!==t.toLowerCase().trim()||1!==this.thumbnailType))},getThumbnailOffset:function(){return this.app1Offset+6+this.thumbnailOffset},getThumbnailLength:function(){return this.thumbnailLength},getThumbnailBuffer:function(){return this._getThumbnailStream().nextBuffer(this.thumbnailLength)},_getThumbnailStream:function(){return this.startMarker.openWithOffset(this.getThumbnailOffset())},getImageSize:function(){return this.imageSize},getThumbnailSize:function(){var t,e=this._getThumbnailStream();return r.parseSections(e,(function(e,n){"SOF"===r.getSectionName(e).name&&(t=r.getSizeFromSOFSection(n))})),t}},o.prototype={enableBinaryFields:function(t){return this.flags.readBinaryTags=!!t,this},enablePointers:function(t){return this.flags.hidePointers=!t,this},enableTagNames:function(t){return this.flags.resolveTagNames=!!t,this},enableImageSize:function(t){return this.flags.imageSize=!!t,this},enableReturnTags:function(t){return this.flags.returnTags=!!t,this},enableSimpleValues:function(t){return this.flags.simplifyValues=!!t,this},parse:function(){var t,e,o,l,u,h,c,d,f,p=this.stream.mark(),m=p.openWithOffset(0),g=this.flags;return g.resolveTagNames&&(c=n(1240)),g.resolveTagNames?(t={},d=function(e){return t[e.name]},f=function(e,n){t[e.name]=n}):(t=[],d=function(e){var n;for(n=0;n<t.length;++n)if(t[n].type===e.type&&t[n].section===e.section)return t.value},f=function(e,n){var r;for(r=0;r<t.length;++r)if(t[r].type===e.type&&t[r].section===e.section)return void(t.value=n)}),r.parseSections(m,(function(n,s){var d=s.offsetFrom(p);225===n?i.parseTags(s,(function(e,n,r,s){if(g.readBinaryTags||7!==s){if(513===n){if(o=r[0],g.hidePointers)return}else if(514===n){if(l=r[0],g.hidePointers)return}else if(259===n&&(u=r[0],g.hidePointers))return;if(g.returnTags)if(g.simplifyValues&&(r=a.simplifyValue(r,s)),g.resolveTagNames){var h=(e===i.GPSIFD?c.gps:c.exif)[n];h||(h=c.exif[n]),t.hasOwnProperty(h)||(t[h]=r)}else t.push({section:e,type:n,value:r})}}))&&(h=d):g.imageSize&&"SOF"===r.getSectionName(n).name&&(e=r.getSizeFromSOFSection(s))})),g.simplifyValues&&(a.castDegreeValues(d,f),a.castDateValues(d,f)),new s(p,t,e,o,l,u,h)}},t.exports=o},47:(t,e,n)=>{var r=n(9924),i=n(9292),a=[{section:r.GPSIFD,type:2,name:"GPSLatitude",refType:1,refName:"GPSLatitudeRef",posVal:"N"},{section:r.GPSIFD,type:4,name:"GPSLongitude",refType:3,refName:"GPSLongitudeRef",posVal:"E"}],s=[{section:r.SubIFD,type:306,name:"ModifyDate"},{section:r.SubIFD,type:36867,name:"DateTimeOriginal"},{section:r.SubIFD,type:36868,name:"CreateDate"},{section:r.SubIFD,type:306,name:"ModifyDate"}];t.exports={castDegreeValues:function(t,e){a.forEach((function(n){var r=t(n);if(r){var i=t({section:n.section,type:n.refType,name:n.refName})===n.posVal?1:-1,a=(r[0]+r[1]/60+r[2]/3600)*i;e(n,a)}}))},castDateValues:function(t,e){s.forEach((function(n){var r=t(n);if(r){var a=i.parseExifDate(r);void 0!==a&&e(n,a)}}))},simplifyValue:function(t,e){return Array.isArray(t)&&1===(t=t.map((function(t){return 10===e||5===e?t[0]/t[1]:t}))).length&&(t=t[0]),t}}},9544:t=>{"use strict";const e=t=>[...t].map((t=>t.charCodeAt(0))),n=e("META-INF/mozilla.rsa"),r=e("[Content_Types].xml"),i=e("_rels/.rels");t.exports=t=>{const a=t instanceof Uint8Array?t:new Uint8Array(t);if(!(a&&a.length>1))return null;const s=(t,e)=>{e=Object.assign({offset:0},e);for(let n=0;n<t.length;n++)if(e.mask){if(t[n]!==(e.mask[n]&a[n+e.offset]))return!1}else if(t[n]!==a[n+e.offset])return!1;return!0},o=(t,n)=>s(e(t),n);if(s([255,216,255]))return{ext:"jpg",mime:"image/jpeg"};if(s([137,80,78,71,13,10,26,10]))return{ext:"png",mime:"image/png"};if(s([71,73,70]))return{ext:"gif",mime:"image/gif"};if(s([87,69,66,80],{offset:8}))return{ext:"webp",mime:"image/webp"};if(s([70,76,73,70]))return{ext:"flif",mime:"image/flif"};if((s([73,73,42,0])||s([77,77,0,42]))&&s([67,82],{offset:8}))return{ext:"cr2",mime:"image/x-canon-cr2"};if(s([73,73,42,0])||s([77,77,0,42]))return{ext:"tif",mime:"image/tiff"};if(s([66,77]))return{ext:"bmp",mime:"image/bmp"};if(s([73,73,188]))return{ext:"jxr",mime:"image/vnd.ms-photo"};if(s([56,66,80,83]))return{ext:"psd",mime:"image/vnd.adobe.photoshop"};if(s([80,75,3,4])){if(s([109,105,109,101,116,121,112,101,97,112,112,108,105,99,97,116,105,111,110,47,101,112,117,98,43,122,105,112],{offset:30}))return{ext:"epub",mime:"application/epub+zip"};if(s(n,{offset:30}))return{ext:"xpi",mime:"application/x-xpinstall"};if(o("mimetypeapplication/vnd.oasis.opendocument.text",{offset:30}))return{ext:"odt",mime:"application/vnd.oasis.opendocument.text"};if(o("mimetypeapplication/vnd.oasis.opendocument.spreadsheet",{offset:30}))return{ext:"ods",mime:"application/vnd.oasis.opendocument.spreadsheet"};if(o("mimetypeapplication/vnd.oasis.opendocument.presentation",{offset:30}))return{ext:"odp",mime:"application/vnd.oasis.opendocument.presentation"};const t=(t,e=0)=>t.findIndex(((t,n,r)=>n>=e&&80===r[n]&&75===r[n+1]&&3===r[n+2]&&4===r[n+3]));let e=0,l=!1,u=null;do{const n=e+30;if(l||(l=s(r,{offset:n})||s(i,{offset:n})),u||(o("word/",{offset:n})?u={ext:"docx",mime:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"}:o("ppt/",{offset:n})?u={ext:"pptx",mime:"application/vnd.openxmlformats-officedocument.presentationml.presentation"}:o("xl/",{offset:n})&&(u={ext:"xlsx",mime:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"})),l&&u)return u;e=t(a,n)}while(e>=0);if(u)return u}if(s([80,75])&&(3===a[2]||5===a[2]||7===a[2])&&(4===a[3]||6===a[3]||8===a[3]))return{ext:"zip",mime:"application/zip"};if(s([117,115,116,97,114],{offset:257}))return{ext:"tar",mime:"application/x-tar"};if(s([82,97,114,33,26,7])&&(0===a[6]||1===a[6]))return{ext:"rar",mime:"application/x-rar-compressed"};if(s([31,139,8]))return{ext:"gz",mime:"application/gzip"};if(s([66,90,104]))return{ext:"bz2",mime:"application/x-bzip2"};if(s([55,122,188,175,39,28]))return{ext:"7z",mime:"application/x-7z-compressed"};if(s([120,1]))return{ext:"dmg",mime:"application/x-apple-diskimage"};if(s([51,103,112,53])||s([0,0,0])&&s([102,116,121,112],{offset:4})&&(s([109,112,52,49],{offset:8})||s([109,112,52,50],{offset:8})||s([105,115,111,109],{offset:8})||s([105,115,111,50],{offset:8})||s([109,109,112,52],{offset:8})||s([77,52,86],{offset:8})||s([100,97,115,104],{offset:8})))return{ext:"mp4",mime:"video/mp4"};if(s([77,84,104,100]))return{ext:"mid",mime:"audio/midi"};if(s([26,69,223,163])){const t=a.subarray(4,4100),e=t.findIndex(((t,e,n)=>66===n[e]&&130===n[e+1]));if(-1!==e){const n=e+3,r=e=>[...e].every(((e,r)=>t[n+r]===e.charCodeAt(0)));if(r("matroska"))return{ext:"mkv",mime:"video/x-matroska"};if(r("webm"))return{ext:"webm",mime:"video/webm"}}}if(s([0,0,0,20,102,116,121,112,113,116,32,32])||s([102,114,101,101],{offset:4})||s([102,116,121,112,113,116,32,32],{offset:4})||s([109,100,97,116],{offset:4})||s([119,105,100,101],{offset:4}))return{ext:"mov",mime:"video/quicktime"};if(s([82,73,70,70])){if(s([65,86,73],{offset:8}))return{ext:"avi",mime:"video/vnd.avi"};if(s([87,65,86,69],{offset:8}))return{ext:"wav",mime:"audio/vnd.wave"};if(s([81,76,67,77],{offset:8}))return{ext:"qcp",mime:"audio/qcelp"}}if(s([48,38,178,117,142,102,207,17,166,217]))return{ext:"wmv",mime:"video/x-ms-wmv"};if(s([0,0,1,186])||s([0,0,1,179]))return{ext:"mpg",mime:"video/mpeg"};if(s([102,116,121,112,51,103],{offset:4}))return{ext:"3gp",mime:"video/3gpp"};for(let t=0;t<2&&t<a.length-16;t++){if(s([73,68,51],{offset:t})||s([255,226],{offset:t,mask:[255,226]}))return{ext:"mp3",mime:"audio/mpeg"};if(s([255,228],{offset:t,mask:[255,228]}))return{ext:"mp2",mime:"audio/mpeg"};if(s([255,248],{offset:t,mask:[255,252]}))return{ext:"mp2",mime:"audio/mpeg"};if(s([255,240],{offset:t,mask:[255,252]}))return{ext:"mp4",mime:"audio/mpeg"}}if(s([102,116,121,112,77,52,65],{offset:4})||s([77,52,65,32]))return{ext:"m4a",mime:"audio/mp4"};if(s([79,112,117,115,72,101,97,100],{offset:28}))return{ext:"opus",mime:"audio/opus"};if(s([79,103,103,83]))return s([128,116,104,101,111,114,97],{offset:28})?{ext:"ogv",mime:"video/ogg"}:s([1,118,105,100,101,111,0],{offset:28})?{ext:"ogm",mime:"video/ogg"}:s([127,70,76,65,67],{offset:28})?{ext:"oga",mime:"audio/ogg"}:s([83,112,101,101,120,32,32],{offset:28})?{ext:"spx",mime:"audio/ogg"}:s([1,118,111,114,98,105,115],{offset:28})?{ext:"ogg",mime:"audio/ogg"}:{ext:"ogx",mime:"application/ogg"};if(s([102,76,97,67]))return{ext:"flac",mime:"audio/x-flac"};if(s([77,65,67,32]))return{ext:"ape",mime:"audio/ape"};if(s([119,118,112,107]))return{ext:"wv",mime:"audio/wavpack"};if(s([35,33,65,77,82,10]))return{ext:"amr",mime:"audio/amr"};if(s([37,80,68,70]))return{ext:"pdf",mime:"application/pdf"};if(s([77,90]))return{ext:"exe",mime:"application/x-msdownload"};if((67===a[0]||70===a[0])&&s([87,83],{offset:1}))return{ext:"swf",mime:"application/x-shockwave-flash"};if(s([123,92,114,116,102]))return{ext:"rtf",mime:"application/rtf"};if(s([0,97,115,109]))return{ext:"wasm",mime:"application/wasm"};if(s([119,79,70,70])&&(s([0,1,0,0],{offset:4})||s([79,84,84,79],{offset:4})))return{ext:"woff",mime:"font/woff"};if(s([119,79,70,50])&&(s([0,1,0,0],{offset:4})||s([79,84,84,79],{offset:4})))return{ext:"woff2",mime:"font/woff2"};if(s([76,80],{offset:34})&&(s([0,0,1],{offset:8})||s([1,0,2],{offset:8})||s([2,0,2],{offset:8})))return{ext:"eot",mime:"application/vnd.ms-fontobject"};if(s([0,1,0,0,0]))return{ext:"ttf",mime:"font/ttf"};if(s([79,84,84,79,0]))return{ext:"otf",mime:"font/otf"};if(s([0,0,1,0]))return{ext:"ico",mime:"image/x-icon"};if(s([0,0,2,0]))return{ext:"cur",mime:"image/x-icon"};if(s([70,76,86,1]))return{ext:"flv",mime:"video/x-flv"};if(s([37,33]))return{ext:"ps",mime:"application/postscript"};if(s([253,55,122,88,90,0]))return{ext:"xz",mime:"application/x-xz"};if(s([83,81,76,105]))return{ext:"sqlite",mime:"application/x-sqlite3"};if(s([78,69,83,26]))return{ext:"nes",mime:"application/x-nintendo-nes-rom"};if(s([67,114,50,52]))return{ext:"crx",mime:"application/x-google-chrome-extension"};if(s([77,83,67,70])||s([73,83,99,40]))return{ext:"cab",mime:"application/vnd.ms-cab-compressed"};if(s([33,60,97,114,99,104,62,10,100,101,98,105,97,110,45,98,105,110,97,114,121]))return{ext:"deb",mime:"application/x-deb"};if(s([33,60,97,114,99,104,62]))return{ext:"ar",mime:"application/x-unix-archive"};if(s([237,171,238,219]))return{ext:"rpm",mime:"application/x-rpm"};if(s([31,160])||s([31,157]))return{ext:"Z",mime:"application/x-compress"};if(s([76,90,73,80]))return{ext:"lz",mime:"application/x-lzip"};if(s([208,207,17,224,161,177,26,225]))return{ext:"msi",mime:"application/x-msi"};if(s([6,14,43,52,2,5,1,1,13,1,2,1,1,2]))return{ext:"mxf",mime:"application/mxf"};if(s([71],{offset:4})&&(s([71],{offset:192})||s([71],{offset:196})))return{ext:"mts",mime:"video/mp2t"};if(s([66,76,69,78,68,69,82]))return{ext:"blend",mime:"application/x-blender"};if(s([66,80,71,251]))return{ext:"bpg",mime:"image/bpg"};if(s([0,0,0,12,106,80,32,32,13,10,135,10])){if(s([106,112,50,32],{offset:20}))return{ext:"jp2",mime:"image/jp2"};if(s([106,112,120,32],{offset:20}))return{ext:"jpx",mime:"image/jpx"};if(s([106,112,109,32],{offset:20}))return{ext:"jpm",mime:"image/jpm"};if(s([109,106,112,50],{offset:20}))return{ext:"mj2",mime:"image/mj2"}}if(s([70,79,82,77,0]))return{ext:"aif",mime:"audio/aiff"};if(o("<?xml "))return{ext:"xml",mime:"application/xml"};if(s([66,79,79,75,77,79,66,73],{offset:60}))return{ext:"mobi",mime:"application/x-mobipocket-ebook"};if(s([102,116,121,112],{offset:4})){if(s([109,105,102,49],{offset:8}))return{ext:"heic",mime:"image/heif"};if(s([109,115,102,49],{offset:8}))return{ext:"heic",mime:"image/heif-sequence"};if(s([104,101,105,99],{offset:8})||s([104,101,105,120],{offset:8}))return{ext:"heic",mime:"image/heic"};if(s([104,101,118,99],{offset:8})||s([104,101,118,120],{offset:8}))return{ext:"heic",mime:"image/heic-sequence"}}return s([171,75,84,88,32,49,49,187,13,10,26,10])?{ext:"ktx",mime:"image/ktx"}:null}},8847:(t,e,n)=>{"use strict";var r=n(9208).Buffer;class i{constructor(...t){if(0===t.length)throw new Error("constructor requires parameters");const e=t[0];if(null!==e&&"object"==typeof e)if(e instanceof i){const t=e.bitmap;this.bitmap={width:t.width,height:t.height,data:new r(t.width*t.height*4)},t.data.copy(this.bitmap.data)}else{if(!(e.width&&e.height&&e.data))throw new Error("unrecognized constructor parameters");this.bitmap=e}else{if("number"!=typeof e||"number"!=typeof t[1])throw new Error("unrecognized constructor parameters");{const n=e,i=t[1],a=t[2];this.bitmap={width:n,height:i},r.isBuffer(a)?this.bitmap.data=a:(this.bitmap.data=new r(n*i*4),"number"==typeof a&&this.fillRGBA(a))}}}blit(t,e,n,r,i,a,s){if(r+a>this.bitmap.width)throw new Error("copy exceeds width of source bitmap");if(e+a>t.bitmap.width)throw new Error("copy exceeds width of target bitmap");if(i+s>this.bitmap.height)throw new Error("copy exceeds height of source bitmap");if(n+s>t.bitmap.height)throw new Erro("copy exceeds height of target bitmap");const o=this.bitmap.data,l=t.bitmap.data,u=4*this.bitmap.width,h=4*t.bitmap.width,c=4*a;let d=i*u+4*r,f=n*h+4*e;for(;--s>=0;)o.copy(l,f,d,d+c),d+=u,f+=h;return this}fillRGBA(t){const e=this.bitmap.data,n=4*this.bitmap.height;let r=0;for(;r<n;)e.writeUInt32BE(t,r),r+=4;for(;r<e.length;)e.copy(e,r,0,n),r+=n;return this}getRGBA(t,e){const n=4*(e*this.bitmap.width+t);return this.bitmap.data.readUInt32BE(n)}getRGBASet(){const t=new Set,e=this.bitmap.data;for(let n=0;n<e.length;n+=4)t.add(e.readUInt32BE(n,!0));return t}greyscale(){const t=this.bitmap.data;return this.scan(0,0,this.bitmap.width,this.bitmap.height,((e,n,r)=>{const i=Math.round(.299*t[r]+.587*t[r+1]+.114*t[r+2]);t[r]=i,t[r+1]=i,t[r+2]=i})),this}reframe(t,e,n,r,a){const s=t<0?0:t,o=e<0?0:e,l=n+s>this.bitmap.width?this.bitmap.width-s:n,u=r+o>this.bitmap.height?this.bitmap.height-o:r,h=t<0?-t:0,c=e<0?-e:0;let d;if(void 0===a){if(s!==t||o!=e||l!==n||u!==r)throw new GifError("fillRGBA required for this reframing");d=new i(n,r)}else d=new i(n,r,a);return this.blit(d,h,c,s,o,l,u),this.bitmap=d.bitmap,this}scale(t){if(1===t)return;if(!Number.isInteger(t)||t<1)throw new Error("the scale must be an integer >= 1");const e=this.bitmap.width,n=this.bitmap.height,i=e*t*4,a=this.bitmap.data,s=new r(n*i*t);let o,l=0,u=0;for(let r=0;r<n;++r){o=u;for(let n=0;n<e;++n){const e=a.readUInt32BE(l,!0);for(let n=0;n<t;++n)s.writeUInt32BE(e,u),u+=4;l+=4}for(let e=1;e<t;++e)s.copy(s,u,o,u),u+=i,o+=i}return this.bitmap={width:e*t,height:n*t,data:s},this}scanAllCoords(t){const e=this.bitmap.width,n=this.bitmap.data.length;let r=0,i=0;for(let a=0;a<n;a+=4)t(r,i,a),++r===e&&(r=0,++i)}scanAllIndexes(t){const e=this.bitmap.data.length;for(let n=0;n<e;n+=4)t(n)}}t.exports=i},4881:(t,e)=>{"use strict";class n{constructor(t,e,n){this.width=n.width,this.height=n.height,this.loops=n.loops,this.usesTransparency=n.usesTransparency,this.colorScope=n.colorScope,this.frames=e,this.buffer=t}}n.GlobalColorsPreferred=0,n.GlobalColorsOnly=1,n.LocalColorsOnly=2;class r extends Error{constructor(t){super(t),t instanceof Error&&(this.stack="Gif"+t.stack)}}e.Gif=n,e.GifError=r},3433:(t,e,n)=>{"use strict";var r=n(7671),i=n(9208).Buffer;const a=n(8233),{Gif:s,GifError:o}=n(4881);let l;r.nextTick((()=>{l=n(7895)}));const{GifFrame:u}=n(8830);function h(t,e){const n=t.indexOf(e);return-1===n?null:n}function c(t,e){for(var n,r=0,i=t.length-1;r<=i;)if(t[n=Math.floor((r+i)/2)]>e)i=n-1;else{if(!(t[n]<e))return n;r=n+1}return null}function d(t){const e=t.colors;t.usesTransparency&&e.push(0);const n=e.length;let r=2;for(;n>r;)r<<=1;e.length=r,e.fill(0,n)}function f(t,e){let n=t.bitmap.width*t.bitmap.height;return n=Math.ceil(n*e/8),n+=Math.ceil(n/255),100+n+768}function p(t){let e=t.indexCount,n=0;for(--e;e;)++n,e>>=1;return n>0?n:1}function m(t,e,n,r,a){if(n.interlaced)throw new o("writing interlaced GIFs is not supported");const s=function(t,e,n){const r=n.colors,a=r.length<=8?h:c,s=e.bitmap.data,l=new i(s.length/4);let u=r.length,d=0,f=0;for(;d<s.length;){if(0!==s[d+3]){const t=s.readUInt32BE(d,!0)>>8&16777215;l[f]=a(r,t)}else l[f]=u;d+=4,++f}if(n.usesTransparency){if(256===u)throw new o(`Frame ${t} already has 256 colorsand so can't use transparency`)}else u=null;return{buffer:l,transparentIndex:u}}(e,n,r),l={delay:n.delayCentisecs,disposal:n.disposalMethod,transparent:s.transparentIndex};a&&(d(r),l.palette=r.colors);try{let e,r=t.getOutputBuffer(),a=t.getOutputBufferPosition(),o=!0;for(;o;)if(e=t.addFrame(n.xOffset,n.yOffset,n.bitmap.width,n.bitmap.height,s.buffer,l),o=!1,e>=r.length-1){const e=new i(1.5*r.length);r.copy(e),t.setOutputBuffer(e),t.setOutputBufferPosition(a),r=e,o=!0}return r}catch(t){throw new o(t)}}e.GifCodec=class{constructor(t={}){this._transparentRGB=null,"number"==typeof t.transparentRGB&&0!==t.transparentRGB&&(this._transparentRGBA=256*t.transparentRGB),this._testInitialBufferSize=0}decodeGif(t){try{let e;try{e=new a.GifReader(t)}catch(t){throw new o(t)}const n=e.numFrames(),r=[],i={width:e.width,height:e.height,loops:e.loopCount(),usesTransparency:!1};for(let t=0;t<n;++t){const n=this._decodeFrame(e,t,i.usesTransparency);r.push(n.frame),n.usesTransparency&&(i.usesTransparency=!0)}return Promise.resolve(new s(t,r,i))}catch(t){return Promise.reject(t)}}encodeGif(t,e={}){try{if(null===t||0===t.length)throw new o("there are no frames");const n=l.getMaxDimensions(t);return(e=Object.assign({},e)).width=n.maxWidth,e.height=n.maxHeight,e.loops=e.loops||0,e.colorScope=e.colorScope||s.GlobalColorsPreferred,Promise.resolve(this._encodeGif(t,e))}catch(t){return Promise.reject(t)}}_decodeFrame(t,e,n){let r,a;try{if(r=t.frameInfo(e),a=new i(t.width*t.height*4),t.decodeAndBlitFrameRGBA(e,a),r.width!==t.width||r.height!==t.height){if(r.y&&(a=a.slice(r.y*t.width*4)),t.width>r.width)for(let e=0;e<r.height;++e)a.copy(a,e*r.width*4,4*(r.x+e*t.width),4*(r.x+e*t.width)+4*r.width);a=a.slice(0,r.width*r.height*4)}}catch(t){throw new o(t)}let s=!1;if(null===this._transparentRGBA){if(!n)for(let t=3;t<a.length;t+=4)0===a[t]&&(s=!0,t=a.length)}else for(let t=3;t<a.length;t+=4)0===a[t]&&(a.writeUInt32BE(this._transparentRGBA,t-3),s=!0);return{frame:new u(r.width,r.height,a,{xOffset:r.x,yOffset:r.y,disposalMethod:r.disposal,interlaced:r.interlaced,delayCentisecs:r.delay}),usesTransparency:s}}_encodeGif(t,e){let n;if(e.colorScope===s.LocalColorsOnly)n=l.getColorInfo(t,0);else if(n=l.getColorInfo(t,256),!n.colors){if(e.colorScope===s.GlobalColorsOnly)throw new o("Too many color indexes for global color table");e.colorScope=s.LocalColorsOnly}e.usesTransparency=n.usesTransparency;const r=n.palettes;return e.colorScope===s.LocalColorsOnly?function(t,e,n,r){const l={loop:e.loops};let u,h=new i(2e3);try{u=new a.GifWriter(h,e.width,e.height,l)}catch(t){throw new o(t)}for(let e=0;e<t.length;++e)h=m(u,e,t[e],r[e],!0);return new s(h.slice(0,u.end()),t,e)}(t,e,0,r):function(t,e,n,r){const l={colors:r.colors.slice(),usesTransparency:r.usesTransparency};d(l);const u={palette:l.colors,loop:e.loops};let h,c=new i(2e3);try{h=new a.GifWriter(c,e.width,e.height,u)}catch(t){throw new o(t)}for(let e=0;e<t.length;++e)c=m(h,e,t[e],r,!1);return new s(c.slice(0,h.end()),t,e)}(t,e,0,n)}_getSizeEstimateGlobal(t,e){if(this._testInitialBufferSize>0)return this._testInitialBufferSize;let n=968;const r=p(t);return e.forEach((t=>{n+=f(t,r)})),n}_getSizeEstimateLocal(t,e){if(this._testInitialBufferSize>0)return this._testInitialBufferSize;let n=200;for(let r=0;r<e.length;++r){const i=p(t[r]);n+=f(e[r],i)}return n}}},8830:(t,e,n)=>{"use strict";const r=n(8847),{GifError:i}=n(4881);class a extends r{constructor(...t){if(super(...t),t[0]instanceof a){const e=t[0];this.xOffset=e.xOffset,this.yOffset=e.yOffset,this.disposalMethod=e.disposalMethod,this.delayCentisecs=e.delayCentisecs,this.interlaced=e.interlaced}else{const e=t[t.length-1];let n={};"object"!=typeof e||e instanceof r||(n=e),this.xOffset=n.xOffset||0,this.yOffset=n.yOffset||0,this.disposalMethod=void 0!==n.disposalMethod?n.disposalMethod:a.DisposeToBackgroundColor,this.delayCentisecs=n.delayCentisecs||8,this.interlaced=n.interlaced||!1}}getPalette(){const t=new Set,e=this.bitmap.data;let n=0,r=!1;for(;n<e.length;){if(0===e[n+3])r=!0;else{const r=e.readUInt32BE(n,!0)>>8&16777215;t.add(r)}n+=4}const i=new Array(t.size),a=t.values();for(n=0;n<i.length;++n)i[n]=a.next().value;i.sort(((t,e)=>t-e));let s=i.length;return r&&++s,{colors:i,usesTransparency:r,indexCount:s}}}a.DisposeToAnything=0,a.DisposeNothing=1,a.DisposeToBackgroundColor=2,a.DisposeToPrevious=3,e.GifFrame=a},7895:(t,e,n)=>{"use strict";var r=n(9208).Buffer;const i=n(9361),a=n(7420),s=n(8847),{GifFrame:o}=n(8830),{GifError:l}=n(4881),{GifCodec:u}=n(3433),h=[".jpg",".jpeg",".png",".bmp"],c=new u;function d(t,e,n,r,i){const s=Array.isArray(t)?t:[t];if(i){if(["FloydSteinberg","FalseFloydSteinberg","Stucki","Atkinson","Jarvis","Burkes","Sierra","TwoSierra","SierraLite"].indexOf(i.ditherAlgorithm)<0)throw new Error(`Invalid ditherAlgorithm '${i.ditherAlgorithm}'`);void 0===i.serpentine&&(i.serpentine=!0),void 0===i.minimumColorDistanceToDither&&(i.minimumColorDistanceToDither=0),void 0===i.calculateErrorLikeGIMP&&(i.calculateErrorLikeGIMP=!1)}const o=new a.distance.Euclidean,l=new a.palette[e](o,n,r);let u;u=i?new a.image.ErrorDiffusionArray(o,a.image.ErrorDiffusionArrayKernel[i.ditherAlgorithm],i.serpentine,i.minimumColorDistanceToDither,i.calculateErrorLikeGIMP):new a.image.NearestColor(o);const h=[];s.forEach((t=>{const e=t.bitmap.data,n=new ArrayBuffer(e.length),r=new Uint32Array(n);for(let t=0,n=0;t<e.length;t+=4,++n)r[n]=e.readUInt32LE(t,!0);const i=a.utils.PointContainer.fromUint32Array(r,t.bitmap.width,t.bitmap.height);l.sample(i),h.push(i)}));const c=l.quantize();for(let t=0;t<s.length;++t){const e=s[t].bitmap.data,n=u.quantize(h[t],c).toUint32Array();for(let t=0,r=0;t<e.length;t+=4,++r)e.writeUInt32LE(n[r],t)}}e.cloneFrames=function(t){let e=[];return t.forEach((t=>{e.push(new o(t))})),e},e.getColorInfo=function(t,e){let n=!1;const r=[];for(let e=0;e<t.length;++e){let i=t[e].getPalette();if(i.usesTransparency&&(n=!0),i.indexCount>256)throw new l(`Frame ${e} uses more than 256 color indexes`);r.push(i)}if(0===e)return{usesTransparency:n,palettes:r};const i=new Set;r.forEach((t=>{t.colors.forEach((t=>{i.add(t)}))}));let a=i.size;if(n&&++a,e&&a>e)return{usesTransparency:n,palettes:r};const s=new Array(i.size),o=i.values();for(let t=0;t<s.length;++t)s[t]=o.next().value;return s.sort(((t,e)=>t-e)),{colors:s,indexCount:a,usesTransparency:n,palettes:r}},e.copyAsJimp=function(t,n){return e.shareAsJimp(t,new s(n))},e.getMaxDimensions=function(t){let e=0,n=0;return t.forEach((t=>{const r=t.xOffset+t.bitmap.width;r>e&&(e=r);const i=t.yOffset+t.bitmap.height;i>n&&(n=i)})),{maxWidth:e,maxHeight:n}},e.quantizeDekker=function(t,e,n){d(t,"NeuQuantFloat",e=e||256,0,n)},e.quantizeSorokin=function(t,e,n,r){let i;switch(e=e||256,n=n||"min-pop"){case"min-pop":i=2;break;case"top-pop":i=1;break;default:throw new Error(`Invalid quantizeSorokin histogram '${n}'`)}d(t,"RGBQuant",e,i,r)},e.quantizeWu=function(t,e,n,r){if(e=e||256,(n=n||5)<1||n>8)throw new Error("Invalid quantization quality");d(t,"WuQuant",e,n,r)},e.read=function(t,e){return e=e||c,r.isBuffer(t)?e.decodeGif(t):(n=t,new Promise(((t,e)=>{i.readFile(n,((n,r)=>n?e(n):t(r)))}))).then((t=>e.decodeGif(t)));var n},e.shareAsJimp=function(t,e){const n=new t(e.bitmap.width,e.bitmap.height,0);return n.bitmap.data=e.bitmap.data,n},e.write=function(t,e,n,r){r=r||c;const a=t.match(/\.[a-zA-Z]+$/);if(null!==a&&h.includes(a[0].toLowerCase()))throw new Error(`GIF '${t}' has an unexpected suffix`);return r.encodeGif(e,n).then((e=>function(t,e){return new Promise(((n,r)=>{i.writeFile(t,e,(t=>t?r(t):n()))}))}(t,e.buffer).then((()=>e))))}},1150:(t,e,n)=>{"use strict";const r=n(8847),{Gif:i,GifError:a}=n(4881),{GifCodec:s}=n(3433),{GifFrame:o}=n(8830),l=n(7895);t.exports={BitmapImage:r,Gif:i,GifCodec:s,GifFrame:o,GifUtil:l,GifError:a}},288:(t,e,n)=>{var r;r="undefined"!=typeof window?window:void 0!==n.g?n.g:"undefined"!=typeof self?self:{},t.exports=r},7500:(t,e,n)=>{var r=n(6824),i=n(1892),a=t.exports;for(var s in r)r.hasOwnProperty(s)&&(a[s]=r[s]);function o(t){if("string"==typeof t&&(t=i.parse(t)),t.protocol||(t.protocol="https:"),"https:"!==t.protocol)throw new Error('Protocol "'+t.protocol+'" not supported. Expected "https:"');return t}a.request=function(t,e){return t=o(t),r.request.call(this,t,e)},a.get=function(t,e){return t=o(t),r.get.call(this,t,e)}},7467:(t,e)=>{e.read=function(t,e,n,r,i){var a,s,o=8*i-r-1,l=(1<<o)-1,u=l>>1,h=-7,c=n?i-1:0,d=n?-1:1,f=t[e+c];for(c+=d,a=f&(1<<-h)-1,f>>=-h,h+=o;h>0;a=256*a+t[e+c],c+=d,h-=8);for(s=a&(1<<-h)-1,a>>=-h,h+=r;h>0;s=256*s+t[e+c],c+=d,h-=8);if(0===a)a=1-u;else{if(a===l)return s?NaN:1/0*(f?-1:1);s+=Math.pow(2,r),a-=u}return(f?-1:1)*s*Math.pow(2,a-r)},e.write=function(t,e,n,r,i,a){var s,o,l,u=8*a-i-1,h=(1<<u)-1,c=h>>1,d=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,f=r?0:a-1,p=r?1:-1,m=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(o=isNaN(e)?1:0,s=h):(s=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-s))<1&&(s--,l*=2),(e+=s+c>=1?d/l:d*Math.pow(2,1-c))*l>=2&&(s++,l/=2),s+c>=h?(o=0,s=h):s+c>=1?(o=(e*l-1)*Math.pow(2,i),s+=c):(o=e*Math.pow(2,c-1)*Math.pow(2,i),s=0));i>=8;t[n+f]=255&o,f+=p,o/=256,i-=8);for(s=s<<i|o,u+=i;u>0;t[n+f]=255&s,f+=p,s/=256,u-=8);t[n+f-p]|=128*m}},7420:function(t){var e;e=function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={exports:{},id:r,loaded:!1};return t[r].call(i.exports,i,i.exports,n),i.loaded=!0,i.exports}return n.m=t,n.c=e,n.p="",n(0)}([function(t,e,n){"use strict";var r=n(1);e.constants=r;var i=n(3);e.conversion=i;var a=n(12);e.distance=a;var s=n(20);e.palette=s;var o=n(30);e.image=o;var l=n(35);e.quality=l;var u=n(37);e.utils=u},function(t,e,n){"use strict";var r=n(2);e.bt709=r},function(t,e){"use strict";var n,r,i;!function(t){t[t.RED=.2126]="RED",t[t.GREEN=.7152]="GREEN",t[t.BLUE=.0722]="BLUE",t[t.WHITE=1]="WHITE"}(n||(n={})),e.Y=n,function(t){t[t.RED=.64]="RED",t[t.GREEN=.3]="GREEN",t[t.BLUE=.15]="BLUE",t[t.WHITE=.3127]="WHITE"}(r||(r={})),e.x=r,function(t){t[t.RED=.33]="RED",t[t.GREEN=.6]="GREEN",t[t.BLUE=.06]="BLUE",t[t.WHITE=.329]="WHITE"}(i||(i={})),e.y=i},function(t,e,n){"use strict";var r=n(4);e.rgb2xyz=r.rgb2xyz;var i=n(5);e.rgb2hsl=i.rgb2hsl;var a=n(7);e.rgb2lab=a.rgb2lab;var s=n(9);e.lab2xyz=s.lab2xyz;var o=n(10);e.lab2rgb=o.lab2rgb;var l=n(8);e.xyz2lab=l.xyz2lab;var u=n(11);e.xyz2rgb=u.xyz2rgb},function(t,e){"use strict";function n(t){return t>.04045?Math.pow((t+.055)/1.055,2.4):t/12.92}e.rgb2xyz=function(t,e,r){return{x:.4124*(t=n(t/255))+.3576*(e=n(e/255))+.1805*(r=n(r/255)),y:.2126*t+.7152*e+.0722*r,z:.0193*t+.1192*e+.9505*r}}},function(t,e,n){"use strict";var r=n(6);e.rgb2hsl=function(t,e,n){var i=r.min3(t,e,n),a=r.max3(t,e,n),s=a-i,o=(i+a)/510,l=0;o>0&&o<1&&(l=s/(o<.5?a+i:510-a-i));var u=0;return s>0&&(u=a===t?(e-n)/s:a===e?2+(n-t)/s:4+(t-e)/s,(u*=60)<0&&(u+=360)),{h:u,s:l,l:o}}},function(t,e){"use strict";e.degrees2radians=function(t){return t*(Math.PI/180)},e.max3=function(t,e,n){var r=t;return r<e&&(r=e),r<n&&(r=n),r},e.min3=function(t,e,n){var r=t;return r>e&&(r=e),r>n&&(r=n),r},e.intInRange=function(t,e,n){return t>n&&(t=n),t<e&&(t=e),0|t},e.inRange0to255Rounded=function(t){return(t=Math.round(t))>255?t=255:t<0&&(t=0),t},e.inRange0to255=function(t){return t>255?t=255:t<0&&(t=0),t},e.stableSort=function(t,e){var n,r=typeof t[0];if("number"===r||"string"===r){for(var i=Object.create(null),a=0,s=t.length;a<s;a++){var o=t[a];i[o]||0===i[o]||(i[o]=a)}n=t.sort((function(t,n){return e(t,n)||i[t]-i[n]}))}else{var l=t.slice(0);n=t.sort((function(t,n){return e(t,n)||l.indexOf(t)-l.indexOf(n)}))}return n}},function(t,e,n){"use strict";var r=n(4),i=n(8);e.rgb2lab=function(t,e,n){var a=r.rgb2xyz(t,e,n);return i.xyz2lab(a.x,a.y,a.z)}},function(t,e){"use strict";function n(t){return t>.008856?Math.pow(t,1/3):7.787*t+16/116}e.xyz2lab=function(t,e,r){if(t=n(t/.95047),e=n(e/1),r=n(r/1.08883),116*e-16<0)throw new Error("xxx");return{L:Math.max(0,116*e-16),a:500*(t-e),b:200*(e-r)}}},function(t,e){"use strict";function n(t){return t>.206893034?Math.pow(t,3):(t-16/116)/7.787}e.lab2xyz=function(t,e,r){var i=(t+16)/116,a=i-r/200;return{x:.95047*n(e/500+i),y:1*n(i),z:1.08883*n(a)}}},function(t,e,n){"use strict";var r=n(9),i=n(11);e.lab2rgb=function(t,e,n){var a=r.lab2xyz(t,e,n);return i.xyz2rgb(a.x,a.y,a.z)}},function(t,e,n){"use strict";var r=n(6);function i(t){return t>.0031308?1.055*Math.pow(t,1/2.4)-.055:12.92*t}e.xyz2rgb=function(t,e,n){var a=i(3.2406*t+-1.5372*e+-.4986*n),s=i(-.9689*t+1.8758*e+.0415*n),o=i(.0557*t+-.204*e+1.057*n);return{r:r.inRange0to255Rounded(255*a),g:r.inRange0to255Rounded(255*s),b:r.inRange0to255Rounded(255*o)}}},function(t,e,n){"use strict";var r=n(13);e.AbstractDistanceCalculator=r.AbstractDistanceCalculator;var i=n(14);e.CIE94Textiles=i.CIE94Textiles,e.CIE94GraphicArts=i.CIE94GraphicArts;var a=n(15);e.CIEDE2000=a.CIEDE2000;var s=n(16);e.CMETRIC=s.CMETRIC;var o=n(17);e.AbstractEuclidean=o.AbstractEuclidean,e.Euclidean=o.Euclidean,e.EuclideanRgbQuantWOAlpha=o.EuclideanRgbQuantWOAlpha,e.EuclideanRgbQuantWithAlpha=o.EuclideanRgbQuantWithAlpha;var l=n(18);e.AbstractManhattan=l.AbstractManhattan,e.Manhattan=l.Manhattan,e.ManhattanSRGB=l.ManhattanSRGB,e.ManhattanNommyde=l.ManhattanNommyde;var u=n(19);e.PNGQUANT=u.PNGQUANT},function(t,e){"use strict";var n=function(){function t(){this._setDefaults(),this.setWhitePoint(255,255,255,255)}return t.prototype.setWhitePoint=function(t,e,n,r){this._whitePoint={r:t>0?255/t:0,g:e>0?255/e:0,b:n>0?255/n:0,a:r>0?255/r:0},this._maxDistance=this.calculateRaw(t,e,n,r,0,0,0,0)},t.prototype.calculateNormalized=function(t,e){return this.calculateRaw(t.r,t.g,t.b,t.a,e.r,e.g,e.b,e.a)/this._maxDistance},t.prototype._setDefaults=function(){},t}();e.AbstractDistanceCalculator=n},function(t,e,n){"use strict";var r=this&&this.__extends||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},i=n(13),a=n(7),s=n(6),o=function(t){function e(){t.apply(this,arguments)}return r(e,t),e.prototype.calculateRaw=function(t,e,n,r,i,o,l,u){var h=a.rgb2lab(s.inRange0to255(t*this._whitePoint.r),s.inRange0to255(e*this._whitePoint.g),s.inRange0to255(n*this._whitePoint.b)),c=a.rgb2lab(s.inRange0to255(i*this._whitePoint.r),s.inRange0to255(o*this._whitePoint.g),s.inRange0to255(l*this._whitePoint.b)),d=h.L-c.L,f=h.a-c.a,p=h.b-c.b,m=Math.sqrt(h.a*h.a+h.b*h.b),g=m-Math.sqrt(c.a*c.a+c.b*c.b),b=f*f+p*p-g*g;b=b<0?0:Math.sqrt(b);var y=(u-r)*this._whitePoint.a*this._kA;return Math.sqrt(Math.pow(d/this._Kl,2)+Math.pow(g/(1+this._K1*m),2)+Math.pow(b/(1+this._K2*m),2)+Math.pow(y,2))},e}(i.AbstractDistanceCalculator);e.AbstractCIE94=o;var l=function(t){function e(){t.apply(this,arguments)}return r(e,t),e.prototype._setDefaults=function(){this._Kl=2,this._K1=.048,this._K2=.014,this._kA=12.5/255},e}(o);e.CIE94Textiles=l;var u=function(t){function e(){t.apply(this,arguments)}return r(e,t),e.prototype._setDefaults=function(){this._Kl=1,this._K1=.045,this._K2=.015,this._kA=25/255},e}(o);e.CIE94GraphicArts=u},function(t,e,n){"use strict";var r=this&&this.__extends||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},i=n(13),a=n(7),s=n(6),o=function(t){function e(){t.apply(this,arguments)}return r(e,t),e.prototype.calculateRaw=function(t,n,r,i,o,l,u,h){var c=a.rgb2lab(s.inRange0to255(t*this._whitePoint.r),s.inRange0to255(n*this._whitePoint.g),s.inRange0to255(r*this._whitePoint.b)),d=a.rgb2lab(s.inRange0to255(o*this._whitePoint.r),s.inRange0to255(l*this._whitePoint.g),s.inRange0to255(u*this._whitePoint.b)),f=(h-i)*this._whitePoint.a*e._kA,p=this.calculateRawInLab(c,d);return Math.sqrt(p+f*f)},e.prototype.calculateRawInLab=function(t,n){var r=t.L,i=t.a,a=t.b,s=n.L,o=n.a,l=n.b,u=Math.sqrt(i*i+a*a),h=Math.sqrt(o*o+l*l),c=Math.pow((u+h)/2,7),d=.5*(1-Math.sqrt(c/(c+e._pow25to7))),f=(1+d)*i,p=(1+d)*o,m=Math.sqrt(f*f+a*a),g=Math.sqrt(p*p+l*l),b=m*g,y=e._calculatehp(a,f),v=e._calculatehp(l,p),w=Math.abs(y-v),_=s-r,k=g-m,x=e._calculate_dHp(b,w,v,y),S=e._calculate_ahp(b,w,y,v),E=e._calculateT(S),I=(m+g)/2,A=Math.pow((r+s)/2-50,2),M=1+.015*A/Math.sqrt(20+A),T=1+.045*I,N=1+.015*E*I,C=e._calculateRT(S,I),R=_/M,O=k/T,D=x/N;return Math.pow(R,2)+Math.pow(O,2)+Math.pow(D,2)+C*O*D},e._calculatehp=function(t,n){var r=Math.atan2(t,n);return r>=0?r:r+e._deg360InRad},e._calculateRT=function(t,n){var r=Math.pow(n,7),i=2*Math.sqrt(r/(r+e._pow25to7)),a=e._deg30InRad*Math.exp(-Math.pow((t-e._deg275InRad)/e._deg25InRad,2));return-Math.sin(2*a)*i},e._calculateT=function(t){return 1-.17*Math.cos(t-e._deg30InRad)+.24*Math.cos(2*t)+.32*Math.cos(3*t+e._deg6InRad)-.2*Math.cos(4*t-e._deg63InRad)},e._calculate_ahp=function(t,n,r,i){var a=r+i;return 0==t?a:n<=e._deg180InRad?a/2:a<e._deg360InRad?(a+e._deg360InRad)/2:(a-e._deg360InRad)/2},e._calculate_dHp=function(t,n,r,i){var a;return a=0==t?0:n<=e._deg180InRad?r-i:r<=i?r-i+e._deg360InRad:r-i-e._deg360InRad,2*Math.sqrt(t)*Math.sin(a/2)},e._kA=25/255,e._pow25to7=Math.pow(25,7),e._deg360InRad=s.degrees2radians(360),e._deg180InRad=s.degrees2radians(180),e._deg30InRad=s.degrees2radians(30),e._deg6InRad=s.degrees2radians(6),e._deg63InRad=s.degrees2radians(63),e._deg275InRad=s.degrees2radians(275),e._deg25InRad=s.degrees2radians(25),e}(i.AbstractDistanceCalculator);e.CIEDE2000=o},function(t,e,n){"use strict";var r=this&&this.__extends||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},i=function(t){function e(){t.apply(this,arguments)}return r(e,t),e.prototype.calculateRaw=function(t,e,n,r,i,a,s,o){var l=(t+i)/2*this._whitePoint.r,u=(t-i)*this._whitePoint.r,h=(e-a)*this._whitePoint.g,c=(n-s)*this._whitePoint.b,d=((512+l)*u*u>>8)+4*h*h+((767-l)*c*c>>8),f=(o-r)*this._whitePoint.a;return Math.sqrt(d+f*f)},e}(n(13).AbstractDistanceCalculator);e.CMETRIC=i},function(t,e,n){"use strict";var r=this&&this.__extends||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},i=n(13),a=n(2),s=function(t){function e(){t.apply(this,arguments)}return r(e,t),e.prototype.calculateRaw=function(t,e,n,r,i,a,s,o){var l=i-t,u=a-e,h=s-n,c=o-r;return Math.sqrt(this._kR*l*l+this._kG*u*u+this._kB*h*h+this._kA*c*c)},e}(i.AbstractDistanceCalculator);e.AbstractEuclidean=s;var o=function(t){function e(){t.apply(this,arguments)}return r(e,t),e.prototype._setDefaults=function(){this._kR=1,this._kG=1,this._kB=1,this._kA=1},e}(s);e.Euclidean=o;var l=function(t){function e(){t.apply(this,arguments)}return r(e,t),e.prototype._setDefaults=function(){this._kR=a.Y.RED,this._kG=a.Y.GREEN,this._kB=a.Y.BLUE,this._kA=1},e}(s);e.EuclideanRgbQuantWithAlpha=l;var u=function(t){function e(){t.apply(this,arguments)}return r(e,t),e.prototype._setDefaults=function(){this._kR=a.Y.RED,this._kG=a.Y.GREEN,this._kB=a.Y.BLUE,this._kA=0},e}(s);e.EuclideanRgbQuantWOAlpha=u},function(t,e,n){"use strict";var r=this&&this.__extends||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},i=n(13),a=n(2),s=function(t){function e(){t.apply(this,arguments)}return r(e,t),e.prototype.calculateRaw=function(t,e,n,r,i,a,s,o){var l=i-t,u=a-e,h=s-n,c=o-r;return l<0&&(l=0-l),u<0&&(u=0-u),h<0&&(h=0-h),c<0&&(c=0-c),this._kR*l+this._kG*u+this._kB*h+this._kA*c},e}(i.AbstractDistanceCalculator);e.AbstractManhattan=s;var o=function(t){function e(){t.apply(this,arguments)}return r(e,t),e.prototype._setDefaults=function(){this._kR=1,this._kG=1,this._kB=1,this._kA=1},e}(s);e.Manhattan=o;var l=function(t){function e(){t.apply(this,arguments)}return r(e,t),e.prototype._setDefaults=function(){this._kR=.4984,this._kG=.8625,this._kB=.2979,this._kA=1},e}(s);e.ManhattanNommyde=l;var u=function(t){function e(){t.apply(this,arguments)}return r(e,t),e.prototype._setDefaults=function(){this._kR=a.Y.RED,this._kG=a.Y.GREEN,this._kB=a.Y.BLUE,this._kA=1},e}(s);e.ManhattanSRGB=u},function(t,e,n){"use strict";var r=this&&this.__extends||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},i=function(t){function e(){t.apply(this,arguments)}return r(e,t),e.prototype.calculateRaw=function(t,e,n,r,i,a,s,o){var l=(o-r)*this._whitePoint.a;return this._colordifference_ch(t*this._whitePoint.r,i*this._whitePoint.r,l)+this._colordifference_ch(e*this._whitePoint.g,a*this._whitePoint.g,l)+this._colordifference_ch(n*this._whitePoint.b,s*this._whitePoint.b,l)},e.prototype._colordifference_ch=function(t,e,n){var r=t-e,i=r+n;return r*r+i*i},e}(n(13).AbstractDistanceCalculator);e.PNGQUANT=i},function(t,e,n){"use strict";var r=n(21);e.NeuQuant=r.NeuQuant;var i=n(25);e.NeuQuantFloat=i.NeuQuantFloat;var a=n(26);e.RGBQuant=a.RGBQuant;var s=n(27);e.ColorHistogram=s.ColorHistogram;var o=n(29);e.WuQuant=o.WuQuant,e.WuColorCube=o.WuColorCube},function(t,e,n){"use strict";var r=n(22),i=n(24),a=function(){function t(t){this.r=this.g=this.b=this.a=t}return t.prototype.toPoint=function(){return i.Point.createByRGBA(this.r>>3,this.g>>3,this.b>>3,this.a>>3)},t.prototype.subtract=function(t,e,n,r){this.r-=0|t,this.g-=0|e,this.b-=0|n,this.a-=0|r},t}(),s=function(){function t(t,e){void 0===e&&(e=256),this._distance=t,this._pointArray=[],this._sampleFactor=1,this._networkSize=e,this._distance.setWhitePoint(2040,2040,2040,2040)}return t.prototype.sample=function(t){this._pointArray=this._pointArray.concat(t.getPointArray())},t.prototype.quantize=function(){return this._init(),this._learn(),this._buildPalette()},t.prototype._init=function(){this._freq=[],this._bias=[],this._radPower=[],this._network=[];for(var e=0;e<this._networkSize;e++)this._network[e]=new a((e<<11)/this._networkSize|0),this._freq[e]=t._initialBias/this._networkSize|0,this._bias[e]=0},t.prototype._learn=function(){var e=this._sampleFactor,n=this._pointArray.length;n<t._minpicturebytes&&(e=1);var r,i=30+(e-1)/3|0,a=n/e|0,s=a/t._nCycles|0,o=t._initAlpha,l=(this._networkSize>>3)*t._radiusBias,u=l>>t._radiusBiasShift;u<=1&&(u=0);for(var h=0;h<u;h++)this._radPower[h]=o*((u*u-h*h)*t._radBias/(u*u))>>>0;r=n<t._minpicturebytes?1:n%t._prime1!=0?t._prime1:n%t._prime2!=0?t._prime2:n%t._prime3!=0?t._prime3:t._prime4,h=0;for(var c=0;h<a;){var d=this._pointArray[c],f=d.b<<3,p=d.g<<3,m=d.r<<3,g=d.a<<3,b=this._contest(f,p,m,g);if(this._alterSingle(o,b,f,p,m,g),0!==u&&this._alterNeighbour(u,b,f,p,m,g),(c+=r)>=n&&(c-=n),0===s&&(s=1),++h%s==0){o-=o/i|0,(u=(l-=l/t._radiusDecrease|0)>>t._radiusBiasShift)<=1&&(u=0);for(var y=0;y<u;y++)this._radPower[y]=o*((u*u-y*y)*t._radBias/(u*u))>>>0}}},t.prototype._buildPalette=function(){var t=new r.Palette;return this._network.forEach((function(e){t.add(e.toPoint())})),t.sort(),t},t.prototype._alterNeighbour=function(e,n,r,i,a,s){var o=n-e;o<-1&&(o=-1);var l=n+e;l>this._networkSize&&(l=this._networkSize);for(var u=n+1,h=n-1,c=1;u<l||h>o;){var d,f=this._radPower[c++]/t._alphaRadBias;u<l&&(d=this._network[u++]).subtract(f*(d.r-a),f*(d.g-i),f*(d.b-r),f*(d.a-s)),h>o&&(d=this._network[h--]).subtract(f*(d.r-a),f*(d.g-i),f*(d.b-r),f*(d.a-s))}},t.prototype._alterSingle=function(e,n,r,i,a,s){e/=t._initAlpha;var o=this._network[n];o.subtract(e*(o.r-a),e*(o.g-i),e*(o.b-r),e*(o.a-s))},t.prototype._contest=function(e,n,r,i){for(var a=~(1<<31),s=a,o=-1,l=o,u=0;u<this._networkSize;u++){var h=this._network[u],c=8160*this._distance.calculateNormalized(h,{r,g:n,b:e,a:i})|0;c<a&&(a=c,o=u);var d=c-(this._bias[u]>>t._initialBiasShift-3);d<s&&(s=d,l=u);var f=this._freq[u]>>t._betaShift;this._freq[u]-=f,this._bias[u]+=f<<t._gammaShift}return this._freq[o]+=t._beta,this._bias[o]-=t._betaGamma,l},t._prime1=499,t._prime2=491,t._prime3=487,t._prime4=503,t._minpicturebytes=t._prime4,t._nCycles=100,t._initialBiasShift=16,t._initialBias=1<<t._initialBiasShift,t._gammaShift=10,t._betaShift=10,t._beta=t._initialBias>>t._betaShift,t._betaGamma=t._initialBias<<t._gammaShift-t._betaShift,t._radiusBiasShift=6,t._radiusBias=1<<t._radiusBiasShift,t._radiusDecrease=30,t._alphaBiasShift=10,t._initAlpha=1<<t._alphaBiasShift,t._radBiasShift=8,t._radBias=1<<t._radBiasShift,t._alphaRadBiasShift=t._alphaBiasShift+t._radBiasShift,t._alphaRadBias=1<<t._alphaRadBiasShift,t}();e.NeuQuant=s},function(t,e,n){"use strict";var r=n(23),i=n(5);function a(t,e){for(var n=360/e,r=1,i=n-n/2;r<e;r++,i+=n)if(t>=i&&t<i+n)return r;return 0}e.hueGroup=a;var s=function(){function t(){this._pointArray=[],this._i32idx={},this._pointContainer=new r.PointContainer,this._pointContainer.setHeight(1),this._pointArray=this._pointContainer.getPointArray()}return t.prototype.add=function(t){this._pointArray.push(t),this._pointContainer.setWidth(this._pointArray.length)},t.prototype.has=function(t){for(var e=this._pointArray.length-1;e>=0;e--)if(t.uint32===this._pointArray[e].uint32)return!0;return!1},t.prototype.getNearestColor=function(t,e){return this._pointArray[0|this.getNearestIndex(t,e)]},t.prototype.getPointContainer=function(){return this._pointContainer},t.prototype._nearestPointFromCache=function(t){return"number"==typeof this._i32idx[t]?this._i32idx[t]:-1},t.prototype.getNearestIndex=function(t,e){var n=this._nearestPointFromCache(""+e.uint32);if(n>=0)return n;var r=Number.MAX_VALUE;n=0;for(var i=0,a=this._pointArray.length;i<a;i++){var s=this._pointArray[i],o=t.calculateRaw(e.r,e.g,e.b,e.a,s.r,s.g,s.b,s.a);o<r&&(r=o,n=i)}return this._i32idx[e.uint32]=n,n},t.prototype.sort=function(){this._i32idx={},this._pointArray.sort((function(t,e){var n=i.rgb2hsl(t.r,t.g,t.b),r=i.rgb2hsl(e.r,e.g,e.b),s=t.r===t.g&&t.g===t.b?0:1+a(n.h,10),o=(e.r===e.g&&e.g===e.b?0:1+a(r.h,10))-s;if(o)return-o;var l=t.getLuminosity(!0),u=e.getLuminosity(!0);if(u-l!=0)return u-l;var h=(100*r.s|0)-(100*n.s|0);return h?-h:0}))},t}();e.Palette=s},function(t,e,n){"use strict";var r=n(24),i=function(){function t(){this._width=0,this._height=0,this._pointArray=[]}return t.prototype.getWidth=function(){return this._width},t.prototype.getHeight=function(){return this._height},t.prototype.setWidth=function(t){this._width=t},t.prototype.setHeight=function(t){this._height=t},t.prototype.getPointArray=function(){return this._pointArray},t.prototype.clone=function(){var e=new t;e._width=this._width,e._height=this._height;for(var n=0,i=this._pointArray.length;n<i;n++)e._pointArray[n]=r.Point.createByUint32(0|this._pointArray[n].uint32);return e},t.prototype.toUint32Array=function(){for(var t=this._pointArray.length,e=new Uint32Array(t),n=0;n<t;n++)e[n]=this._pointArray[n].uint32;return e},t.prototype.toUint8Array=function(){return new Uint8Array(this.toUint32Array().buffer)},t.fromHTMLImageElement=function(e){var n=e.naturalWidth,r=e.naturalHeight,i=document.createElement("canvas");return i.width=n,i.height=r,i.getContext("2d").drawImage(e,0,0,n,r,0,0,n,r),t.fromHTMLCanvasElement(i)},t.fromHTMLCanvasElement=function(e){var n=e.width,r=e.height,i=e.getContext("2d").getImageData(0,0,n,r);return t.fromImageData(i)},t.fromNodeCanvas=function(e){return t.fromHTMLCanvasElement(e)},t.fromImageData=function(e){var n=e.width,r=e.height;return t.fromCanvasPixelArray(e.data,n,r)},t.fromArray=function(e,n,r){var i=new Uint8Array(e);return t.fromUint8Array(i,n,r)},t.fromCanvasPixelArray=function(e,n,r){return t.fromArray(e,n,r)},t.fromUint8Array=function(e,n,r){return t.fromUint32Array(new Uint32Array(e.buffer),n,r)},t.fromUint32Array=function(e,n,i){var a=new t;a._width=n,a._height=i;for(var s=0,o=e.length;s<o;s++)a._pointArray[s]=r.Point.createByUint32(0|e[s]);return a},t}();e.PointContainer=i},function(t,e,n){"use strict";var r=n(2),i=function(){function t(){this.uint32=-1>>>0,this.r=this.g=this.b=this.a=0,this.rgba=new Array(4),this.rgba[0]=0,this.rgba[1]=0,this.rgba[2]=0,this.rgba[3]=0}return t.createByQuadruplet=function(e){var n=new t;return n.r=0|e[0],n.g=0|e[1],n.b=0|e[2],n.a=0|e[3],n._loadUINT32(),n._loadQuadruplet(),n},t.createByRGBA=function(e,n,r,i){var a=new t;return a.r=0|e,a.g=0|n,a.b=0|r,a.a=0|i,a._loadUINT32(),a._loadQuadruplet(),a},t.createByUint32=function(e){var n=new t;return n.uint32=e>>>0,n._loadRGBA(),n._loadQuadruplet(),n},t.prototype.from=function(t){this.r=t.r,this.g=t.g,this.b=t.b,this.a=t.a,this.uint32=t.uint32,this.rgba[0]=t.r,this.rgba[1]=t.g,this.rgba[2]=t.b,this.rgba[3]=t.a},t.prototype.getLuminosity=function(t){var e=this.r,n=this.g,i=this.b;return t&&(e=Math.min(255,255-this.a+this.a*e/255),n=Math.min(255,255-this.a+this.a*n/255),i=Math.min(255,255-this.a+this.a*i/255)),e*r.Y.RED+n*r.Y.GREEN+i*r.Y.BLUE},t.prototype._loadUINT32=function(){this.uint32=(this.a<<24|this.b<<16|this.g<<8|this.r)>>>0},t.prototype._loadRGBA=function(){this.r=255&this.uint32,this.g=this.uint32>>>8&255,this.b=this.uint32>>>16&255,this.a=this.uint32>>>24&255},t.prototype._loadQuadruplet=function(){this.rgba[0]=this.r,this.rgba[1]=this.g,this.rgba[2]=this.b,this.rgba[3]=this.a},t}();e.Point=i},function(t,e,n){"use strict";var r=n(22),i=n(24),a=function(){function t(t){this.r=this.g=this.b=this.a=t}return t.prototype.toPoint=function(){return i.Point.createByRGBA(this.r>>3,this.g>>3,this.b>>3,this.a>>3)},t.prototype.subtract=function(t,e,n,r){this.r-=t,this.g-=e,this.b-=n,this.a-=r},t}(),s=function(){function t(t,e){void 0===e&&(e=256),this._distance=t,this._pointArray=[],this._sampleFactor=1,this._networkSize=e,this._distance.setWhitePoint(2040,2040,2040,2040)}return t.prototype.sample=function(t){this._pointArray=this._pointArray.concat(t.getPointArray())},t.prototype.quantize=function(){return this._init(),this._learn(),this._buildPalette()},t.prototype._init=function(){this._freq=[],this._bias=[],this._radPower=[],this._network=[];for(var e=0;e<this._networkSize;e++)this._network[e]=new a((e<<11)/this._networkSize),this._freq[e]=t._initialBias/this._networkSize,this._bias[e]=0},t.prototype._learn=function(){var e=this._sampleFactor,n=this._pointArray.length;n<t._minpicturebytes&&(e=1);var r,i=30+(e-1)/3,a=n/e,s=a/t._nCycles|0,o=t._initAlpha,l=(this._networkSize>>3)*t._radiusBias,u=l>>t._radiusBiasShift;u<=1&&(u=0);for(var h=0;h<u;h++)this._radPower[h]=o*((u*u-h*h)*t._radBias/(u*u));r=n<t._minpicturebytes?1:n%t._prime1!=0?t._prime1:n%t._prime2!=0?t._prime2:n%t._prime3!=0?t._prime3:t._prime4,h=0;for(var c=0;h<a;){var d=this._pointArray[c],f=d.b<<3,p=d.g<<3,m=d.r<<3,g=d.a<<3,b=this._contest(f,p,m,g);if(this._alterSingle(o,b,f,p,m,g),0!=u&&this._alterNeighbour(u,b,f,p,m,g),(c+=r)>=n&&(c-=n),0==s&&(s=1),++h%s==0){o-=o/i,(u=(l-=l/t._radiusDecrease)>>t._radiusBiasShift)<=1&&(u=0);for(var y=0;y<u;y++)this._radPower[y]=o*((u*u-y*y)*t._radBias/(u*u))}}},t.prototype._buildPalette=function(){var t=new r.Palette;return this._network.forEach((function(e){t.add(e.toPoint())})),t.sort(),t},t.prototype._alterNeighbour=function(e,n,r,i,a,s){var o=n-e;o<-1&&(o=-1);var l=n+e;l>this._networkSize&&(l=this._networkSize);for(var u=n+1,h=n-1,c=1;u<l||h>o;){var d,f=this._radPower[c++]/t._alphaRadBias;u<l&&(d=this._network[u++]).subtract(f*(d.r-a),f*(d.g-i),f*(d.b-r),f*(d.a-s)),h>o&&(d=this._network[h--]).subtract(f*(d.r-a),f*(d.g-i),f*(d.b-r),f*(d.a-s))}},t.prototype._alterSingle=function(e,n,r,i,a,s){e/=t._initAlpha;var o=this._network[n];o.subtract(e*(o.r-a),e*(o.g-i),e*(o.b-r),e*(o.a-s))},t.prototype._contest=function(e,n,r,i){for(var a=~(1<<31),s=a,o=-1,l=o,u=0;u<this._networkSize;u++){var h=this._network[u],c=8160*this._distance.calculateNormalized(h,{r,g:n,b:e,a:i});c<a&&(a=c,o=u);var d=c-(this._bias[u]>>t._initialBiasShift-3);d<s&&(s=d,l=u);var f=this._freq[u]>>t._betaShift;this._freq[u]-=f,this._bias[u]+=f<<t._gammaShift}return this._freq[o]+=t._beta,this._bias[o]-=t._betaGamma,l},t._prime1=499,t._prime2=491,t._prime3=487,t._prime4=503,t._minpicturebytes=t._prime4,t._nCycles=100,t._initialBiasShift=16,t._initialBias=1<<t._initialBiasShift,t._gammaShift=10,t._betaShift=10,t._beta=t._initialBias>>t._betaShift,t._betaGamma=t._initialBias<<t._gammaShift-t._betaShift,t._radiusBiasShift=6,t._radiusBias=1<<t._radiusBiasShift,t._radiusDecrease=30,t._alphaBiasShift=10,t._initAlpha=1<<t._alphaBiasShift,t._radBiasShift=8,t._radBias=1<<t._radBiasShift,t._alphaRadBiasShift=t._alphaBiasShift+t._radBiasShift,t._alphaRadBias=1<<t._alphaRadBiasShift,t}();e.NeuQuantFloat=s},function(t,e,n){"use strict";var r=n(22),i=n(24),a=n(27),s=n(6),o=function(t,e,n){this.index=t,this.color=e,this.distance=n},l=function(){function t(t,e,n){void 0===e&&(e=256),void 0===n&&(n=2),this._distance=t,this._colors=e,this._histogram=new a.ColorHistogram(n,e),this._initialDistance=.01,this._distanceIncrement=.005}return t.prototype.sample=function(t){this._histogram.sample(t)},t.prototype.quantize=function(){var t=this._histogram.getImportanceSortedColorsIDXI32();if(0===t.length)throw new Error("No colors in image");var e=this._buildPalette(t);return e.sort(),e},t.prototype._buildPalette=function(t){for(var e=new r.Palette,n=e.getPointContainer().getPointArray(),a=new Array(t.length),l=0;l<t.length;l++)n.push(i.Point.createByUint32(t[l])),a[l]=1;for(var u=n.length,h=[],c=u,d=this._initialDistance;c>this._colors;){for(h.length=0,l=0;l<u;l++)if(0!==a[l])for(var f=n[l],p=l+1;p<u;p++)if(0!==a[p]){var m=n[p],g=this._distance.calculateNormalized(f,m);g<d&&(h.push(new o(p,m,g)),a[p]=0,c--)}d+=c>3*this._colors?this._initialDistance:this._distanceIncrement}if(c<this._colors){s.stableSort(h,(function(t,e){return e.distance-t.distance}));for(var b=0;c<this._colors&&b<h.length;)a[h[b].index]=1,c++,b++}for(var y=n.length,v=y-1;v>=0;v--)0===a[v]&&(v!==y-1&&(n[v]=n[y-1]),--y);return n.length=y,e},t}();e.RGBQuant=l},function(t,e,n){"use strict";var r=n(28),i=n(6),a=function(){function t(e,n){this._method=e,this._minHueCols=n<<2,this._initColors=n<<2,this._hueStats=new r.HueStatistics(t._hueGroups,this._minHueCols),this._histogram=Object.create(null)}return t.prototype.sample=function(t){switch(this._method){case 1:this._colorStats1D(t);break;case 2:this._colorStats2D(t)}},t.prototype.getImportanceSortedColorsIDXI32=function(){var t,e=this,n=i.stableSort(Object.keys(this._histogram),(function(t,n){return e._histogram[n]-e._histogram[t]}));if(0===n.length)return[];switch(this._method){case 1:var r=Math.min(n.length,this._initColors),a=n[r-1],s=this._histogram[a];t=n.slice(0,r);for(var o=r,l=n.length;o<l&&this._histogram[n[o]]==s;)t.push(n[o++]);this._hueStats.injectIntoArray(t);break;case 2:t=n;break;default:throw new Error("Incorrect method")}return t.map((function(t){return+t}))},t.prototype._colorStats1D=function(t){for(var e=this._histogram,n=t.getPointArray(),r=n.length,i=0;i<r;i++){var a=n[i].uint32;this._hueStats.check(a),a in e?e[a]++:e[a]=1}},t.prototype._colorStats2D=function(e){var n=this,r=e.getWidth(),i=e.getHeight(),a=e.getPointArray(),s=t._boxSize[0],o=t._boxSize[1],l=s*o,u=this._makeBoxes(r,i,s,o),h=this._histogram;u.forEach((function(e){var i=Math.round(e.w*e.h/l)*t._boxPixels;i<2&&(i=2);var s={};n._iterateBox(e,r,(function(t){var e=a[t].uint32;n._hueStats.check(e),e in h?h[e]++:e in s?++s[e]>=i&&(h[e]=s[e]):s[e]=1}))})),this._hueStats.injectIntoDictionary(h)},t.prototype._iterateBox=function(t,e,n){var r=t,i=r.y*e+r.x,a=(r.y+r.h-1)*e+(r.x+r.w-1),s=e-r.w+1,o=0,l=i;do{n.call(this,l),l+=++o%r.w==0?s:1}while(l<=a)},t.prototype._makeBoxes=function(t,e,n,r){for(var i=t%n,a=e%r,s=t-i,o=e-a,l=[],u=0;u<e;u+=r)for(var h=0;h<t;h+=n)l.push({x:h,y:u,w:h==s?i:n,h:u==o?a:r});return l},t._boxSize=[64,64],t._boxPixels=2,t._hueGroups=10,t}();e.ColorHistogram=a},function(t,e,n){"use strict";var r=n(5),i=n(22),a=function(){this.num=0,this.cols=[]},s=function(){function t(t,e){this._numGroups=t,this._minCols=e,this._stats=[];for(var n=0;n<=t;n++)this._stats[n]=new a;this._groupsFull=0}return t.prototype.check=function(t){this._groupsFull==this._numGroups+1&&(this.check=function(){});var e=255&t,n=t>>>8&255,a=t>>>16&255,s=e==n&&n==a?0:1+i.hueGroup(r.rgb2hsl(e,n,a).h,this._numGroups),o=this._stats[s],l=this._minCols;o.num++,o.num>l||(o.num==l&&this._groupsFull++,o.num<=l&&this._stats[s].cols.push(t))},t.prototype.injectIntoDictionary=function(t){for(var e=0;e<=this._numGroups;e++)this._stats[e].num<=this._minCols&&this._stats[e].cols.forEach((function(e){t[e]?t[e]++:t[e]=1}))},t.prototype.injectIntoArray=function(t){for(var e=0;e<=this._numGroups;e++)this._stats[e].num<=this._minCols&&this._stats[e].cols.forEach((function(e){-1==t.indexOf(e)&&t.push(e)}))},t}();e.HueStatistics=s},function(t,e,n){"use strict";var r=n(22),i=n(24);function a(t){for(var e=[],n=0;n<t;n++)e[n]=0;return e}function s(t,e,n,r){for(var i=new Array(t),a=0;a<t;a++){i[a]=new Array(e);for(var s=0;s<e;s++){i[a][s]=new Array(n);for(var o=0;o<n;o++){i[a][s][o]=new Array(r);for(var l=0;l<r;l++)i[a][s][o][l]=0}}}return i}function o(t,e,n){for(var r=new Array(t),i=0;i<t;i++){r[i]=new Array(e);for(var a=0;a<e;a++){r[i][a]=new Array(n);for(var s=0;s<n;s++)r[i][a][s]=0}}return r}function l(t,e,n,r,i){for(var a=0;a<e;a++){t[a]=[];for(var s=0;s<n;s++){t[a][s]=[];for(var o=0;o<r;o++)t[a][s][o]=i}}}function u(t,e,n){for(var r=0;r<e;r++)t[r]=n}var h=function(){};e.WuColorCube=h;var c=function(){function t(t,e,n){void 0===e&&(e=256),void 0===n&&(n=5),this._distance=t,this._setQuality(n),this._initialize(e)}return t.prototype.sample=function(t){for(var e=t.getPointArray(),n=0,r=e.length;n<r;n++)this._addColor(e[n]);this._pixels=this._pixels.concat(e)},t.prototype.quantize=function(){this._preparePalette();for(var t=new r.Palette,e=0;e<this._colors;e++)if(this._sums[e]>0){var n=this._sums[e],a=this._reds[e]/n,s=this._greens[e]/n,o=this._blues[e]/n,l=this._alphas[e]/n,u=i.Point.createByRGBA(0|a,0|s,0|o,0|l);t.add(u)}return t.sort(),t},t.prototype._preparePalette=function(){this._calculateMoments();for(var e=0,n=a(this._colors),r=1;r<this._colors;++r){this._cut(this._cubes[e],this._cubes[r])?(n[e]=this._cubes[e].volume>1?this._calculateVariance(this._cubes[e]):0,n[r]=this._cubes[r].volume>1?this._calculateVariance(this._cubes[r]):0):(n[e]=0,r--),e=0;for(var i=n[0],s=1;s<=r;++s)n[s]>i&&(i=n[s],e=s);if(i<=0){this._colors=r+1;break}}for(var o=[],l=[],u=[],h=[],c=0;c<this._colors;++c){var d=t._volume(this._cubes[c],this._weights);d>0?(o[c]=t._volume(this._cubes[c],this._momentsRed)/d|0,l[c]=t._volume(this._cubes[c],this._momentsGreen)/d|0,u[c]=t._volume(this._cubes[c],this._momentsBlue)/d|0,h[c]=t._volume(this._cubes[c],this._momentsAlpha)/d|0):(o[c]=0,l[c]=0,u[c]=0,h[c]=0)}this._reds=a(this._colors+1),this._greens=a(this._colors+1),this._blues=a(this._colors+1),this._alphas=a(this._colors+1),this._sums=a(this._colors+1),s=0;for(var f=this._pixels.length;s<f;s++){for(var p=this._pixels[s],m=-1,g=Number.MAX_VALUE,b=0;b<this._colors;b++){var y=o[b],v=l[b],w=u[b],_=h[b],k=this._distance.calculateRaw(y,v,w,_,p.r,p.g,p.b,p.a);k<g&&(g=k,m=b)}this._reds[m]+=p.r,this._greens[m]+=p.g,this._blues[m]+=p.b,this._alphas[m]+=p.a,this._sums[m]++}},t.prototype._addColor=function(t){var e=8-this._significantBitsPerChannel,n=1+(t.r>>e),r=1+(t.g>>e),i=1+(t.b>>e),a=1+(t.a>>e);this._weights[a][n][r][i]++,this._momentsRed[a][n][r][i]+=t.r,this._momentsGreen[a][n][r][i]+=t.g,this._momentsBlue[a][n][r][i]+=t.b,this._momentsAlpha[a][n][r][i]+=t.a,this._moments[a][n][r][i]+=this._table[t.r]+this._table[t.g]+this._table[t.b]+this._table[t.a]},t.prototype._calculateMoments=function(){for(var t=[],e=[],n=[],r=[],i=[],a=[],s=o(this._sideSize,this._sideSize,this._sideSize),h=o(this._sideSize,this._sideSize,this._sideSize),c=o(this._sideSize,this._sideSize,this._sideSize),d=o(this._sideSize,this._sideSize,this._sideSize),f=o(this._sideSize,this._sideSize,this._sideSize),p=o(this._sideSize,this._sideSize,this._sideSize),m=1;m<=this._alphaMaxSideIndex;++m){l(s,this._sideSize,this._sideSize,this._sideSize,0),l(h,this._sideSize,this._sideSize,this._sideSize,0),l(c,this._sideSize,this._sideSize,this._sideSize,0),l(d,this._sideSize,this._sideSize,this._sideSize,0),l(f,this._sideSize,this._sideSize,this._sideSize,0),l(p,this._sideSize,this._sideSize,this._sideSize,0);for(var g=1;g<=this._maxSideIndex;++g){u(t,this._sideSize,0),u(e,this._sideSize,0),u(n,this._sideSize,0),u(r,this._sideSize,0),u(i,this._sideSize,0),u(a,this._sideSize,0);for(var b=1;b<=this._maxSideIndex;++b)for(var y=0,v=0,w=0,_=0,k=0,x=0,S=1;S<=this._maxSideIndex;++S)y+=this._weights[m][g][b][S],v+=this._momentsRed[m][g][b][S],w+=this._momentsGreen[m][g][b][S],_+=this._momentsBlue[m][g][b][S],k+=this._momentsAlpha[m][g][b][S],x+=this._moments[m][g][b][S],t[S]+=y,e[S]+=v,n[S]+=w,r[S]+=_,i[S]+=k,a[S]+=x,s[g][b][S]=s[g-1][b][S]+t[S],h[g][b][S]=h[g-1][b][S]+e[S],c[g][b][S]=c[g-1][b][S]+n[S],d[g][b][S]=d[g-1][b][S]+r[S],f[g][b][S]=f[g-1][b][S]+i[S],p[g][b][S]=p[g-1][b][S]+a[S],this._weights[m][g][b][S]=this._weights[m-1][g][b][S]+s[g][b][S],this._momentsRed[m][g][b][S]=this._momentsRed[m-1][g][b][S]+h[g][b][S],this._momentsGreen[m][g][b][S]=this._momentsGreen[m-1][g][b][S]+c[g][b][S],this._momentsBlue[m][g][b][S]=this._momentsBlue[m-1][g][b][S]+d[g][b][S],this._momentsAlpha[m][g][b][S]=this._momentsAlpha[m-1][g][b][S]+f[g][b][S],this._moments[m][g][b][S]=this._moments[m-1][g][b][S]+p[g][b][S]}}},t._volumeFloat=function(t,e){return e[t.alphaMaximum][t.redMaximum][t.greenMaximum][t.blueMaximum]-e[t.alphaMaximum][t.redMaximum][t.greenMinimum][t.blueMaximum]-e[t.alphaMaximum][t.redMinimum][t.greenMaximum][t.blueMaximum]+e[t.alphaMaximum][t.redMinimum][t.greenMinimum][t.blueMaximum]-e[t.alphaMinimum][t.redMaximum][t.greenMaximum][t.blueMaximum]+e[t.alphaMinimum][t.redMaximum][t.greenMinimum][t.blueMaximum]+e[t.alphaMinimum][t.redMinimum][t.greenMaximum][t.blueMaximum]-e[t.alphaMinimum][t.redMinimum][t.greenMinimum][t.blueMaximum]-(e[t.alphaMaximum][t.redMaximum][t.greenMaximum][t.blueMinimum]-e[t.alphaMinimum][t.redMaximum][t.greenMaximum][t.blueMinimum]-e[t.alphaMaximum][t.redMaximum][t.greenMinimum][t.blueMinimum]+e[t.alphaMinimum][t.redMaximum][t.greenMinimum][t.blueMinimum]-e[t.alphaMaximum][t.redMinimum][t.greenMaximum][t.blueMinimum]+e[t.alphaMinimum][t.redMinimum][t.greenMaximum][t.blueMinimum]+e[t.alphaMaximum][t.redMinimum][t.greenMinimum][t.blueMinimum]-e[t.alphaMinimum][t.redMinimum][t.greenMinimum][t.blueMinimum])},t._volume=function(e,n){return 0|t._volumeFloat(e,n)},t._top=function(e,n,r,i){var a;switch(n){case t.alpha:a=i[r][e.redMaximum][e.greenMaximum][e.blueMaximum]-i[r][e.redMaximum][e.greenMinimum][e.blueMaximum]-i[r][e.redMinimum][e.greenMaximum][e.blueMaximum]+i[r][e.redMinimum][e.greenMinimum][e.blueMaximum]-(i[r][e.redMaximum][e.greenMaximum][e.blueMinimum]-i[r][e.redMaximum][e.greenMinimum][e.blueMinimum]-i[r][e.redMinimum][e.greenMaximum][e.blueMinimum]+i[r][e.redMinimum][e.greenMinimum][e.blueMinimum]);break;case t.red:a=i[e.alphaMaximum][r][e.greenMaximum][e.blueMaximum]-i[e.alphaMaximum][r][e.greenMinimum][e.blueMaximum]-i[e.alphaMinimum][r][e.greenMaximum][e.blueMaximum]+i[e.alphaMinimum][r][e.greenMinimum][e.blueMaximum]-(i[e.alphaMaximum][r][e.greenMaximum][e.blueMinimum]-i[e.alphaMaximum][r][e.greenMinimum][e.blueMinimum]-i[e.alphaMinimum][r][e.greenMaximum][e.blueMinimum]+i[e.alphaMinimum][r][e.greenMinimum][e.blueMinimum]);break;case t.green:a=i[e.alphaMaximum][e.redMaximum][r][e.blueMaximum]-i[e.alphaMaximum][e.redMinimum][r][e.blueMaximum]-i[e.alphaMinimum][e.redMaximum][r][e.blueMaximum]+i[e.alphaMinimum][e.redMinimum][r][e.blueMaximum]-(i[e.alphaMaximum][e.redMaximum][r][e.blueMinimum]-i[e.alphaMaximum][e.redMinimum][r][e.blueMinimum]-i[e.alphaMinimum][e.redMaximum][r][e.blueMinimum]+i[e.alphaMinimum][e.redMinimum][r][e.blueMinimum]);break;case t.blue:a=i[e.alphaMaximum][e.redMaximum][e.greenMaximum][r]-i[e.alphaMaximum][e.redMaximum][e.greenMinimum][r]-i[e.alphaMaximum][e.redMinimum][e.greenMaximum][r]+i[e.alphaMaximum][e.redMinimum][e.greenMinimum][r]-(i[e.alphaMinimum][e.redMaximum][e.greenMaximum][r]-i[e.alphaMinimum][e.redMaximum][e.greenMinimum][r]-i[e.alphaMinimum][e.redMinimum][e.greenMaximum][r]+i[e.alphaMinimum][e.redMinimum][e.greenMinimum][r]);break;default:throw new Error("impossible")}return 0|a},t._bottom=function(e,n,r){switch(n){case t.alpha:return-r[e.alphaMinimum][e.redMaximum][e.greenMaximum][e.blueMaximum]+r[e.alphaMinimum][e.redMaximum][e.greenMinimum][e.blueMaximum]+r[e.alphaMinimum][e.redMinimum][e.greenMaximum][e.blueMaximum]-r[e.alphaMinimum][e.redMinimum][e.greenMinimum][e.blueMaximum]-(-r[e.alphaMinimum][e.redMaximum][e.greenMaximum][e.blueMinimum]+r[e.alphaMinimum][e.redMaximum][e.greenMinimum][e.blueMinimum]+r[e.alphaMinimum][e.redMinimum][e.greenMaximum][e.blueMinimum]-r[e.alphaMinimum][e.redMinimum][e.greenMinimum][e.blueMinimum]);case t.red:return-r[e.alphaMaximum][e.redMinimum][e.greenMaximum][e.blueMaximum]+r[e.alphaMaximum][e.redMinimum][e.greenMinimum][e.blueMaximum]+r[e.alphaMinimum][e.redMinimum][e.greenMaximum][e.blueMaximum]-r[e.alphaMinimum][e.redMinimum][e.greenMinimum][e.blueMaximum]-(-r[e.alphaMaximum][e.redMinimum][e.greenMaximum][e.blueMinimum]+r[e.alphaMaximum][e.redMinimum][e.greenMinimum][e.blueMinimum]+r[e.alphaMinimum][e.redMinimum][e.greenMaximum][e.blueMinimum]-r[e.alphaMinimum][e.redMinimum][e.greenMinimum][e.blueMinimum]);case t.green:return-r[e.alphaMaximum][e.redMaximum][e.greenMinimum][e.blueMaximum]+r[e.alphaMaximum][e.redMinimum][e.greenMinimum][e.blueMaximum]+r[e.alphaMinimum][e.redMaximum][e.greenMinimum][e.blueMaximum]-r[e.alphaMinimum][e.redMinimum][e.greenMinimum][e.blueMaximum]-(-r[e.alphaMaximum][e.redMaximum][e.greenMinimum][e.blueMinimum]+r[e.alphaMaximum][e.redMinimum][e.greenMinimum][e.blueMinimum]+r[e.alphaMinimum][e.redMaximum][e.greenMinimum][e.blueMinimum]-r[e.alphaMinimum][e.redMinimum][e.greenMinimum][e.blueMinimum]);case t.blue:return-r[e.alphaMaximum][e.redMaximum][e.greenMaximum][e.blueMinimum]+r[e.alphaMaximum][e.redMaximum][e.greenMinimum][e.blueMinimum]+r[e.alphaMaximum][e.redMinimum][e.greenMaximum][e.blueMinimum]-r[e.alphaMaximum][e.redMinimum][e.greenMinimum][e.blueMinimum]-(-r[e.alphaMinimum][e.redMaximum][e.greenMaximum][e.blueMinimum]+r[e.alphaMinimum][e.redMaximum][e.greenMinimum][e.blueMinimum]+r[e.alphaMinimum][e.redMinimum][e.greenMaximum][e.blueMinimum]-r[e.alphaMinimum][e.redMinimum][e.greenMinimum][e.blueMinimum]);default:return 0}},t.prototype._calculateVariance=function(e){var n=t._volume(e,this._momentsRed),r=t._volume(e,this._momentsGreen),i=t._volume(e,this._momentsBlue),a=t._volume(e,this._momentsAlpha);return t._volumeFloat(e,this._moments)-(n*n+r*r+i*i+a*a)/t._volume(e,this._weights)},t.prototype._maximize=function(e,n,r,i,a,s,o,l,u){for(var h=0|t._bottom(e,n,this._momentsRed),c=0|t._bottom(e,n,this._momentsGreen),d=0|t._bottom(e,n,this._momentsBlue),f=0|t._bottom(e,n,this._momentsAlpha),p=0|t._bottom(e,n,this._weights),m=0,g=-1,b=r;b<i;++b){var y=h+t._top(e,n,b,this._momentsRed),v=c+t._top(e,n,b,this._momentsGreen),w=d+t._top(e,n,b,this._momentsBlue),_=f+t._top(e,n,b,this._momentsAlpha),k=p+t._top(e,n,b,this._weights);if(0!=k){var x=y*y+v*v+w*w+_*_,S=x/k;y=a-y,v=s-v,w=o-w,_=l-_,0!=(k=u-k)&&(S+=(x=y*y+v*v+w*w+_*_)/k)>m&&(m=S,g=b)}}return{max:m,position:g}},t.prototype._cut=function(e,n){var r,i=t._volume(e,this._momentsRed),a=t._volume(e,this._momentsGreen),s=t._volume(e,this._momentsBlue),o=t._volume(e,this._momentsAlpha),l=t._volume(e,this._weights),u=this._maximize(e,t.red,e.redMinimum+1,e.redMaximum,i,a,s,o,l),h=this._maximize(e,t.green,e.greenMinimum+1,e.greenMaximum,i,a,s,o,l),c=this._maximize(e,t.blue,e.blueMinimum+1,e.blueMaximum,i,a,s,o,l),d=this._maximize(e,t.alpha,e.alphaMinimum+1,e.alphaMaximum,i,a,s,o,l);if(d.max>=u.max&&d.max>=h.max&&d.max>=c.max){if(r=t.alpha,d.position<0)return!1}else r=u.max>=d.max&&u.max>=h.max&&u.max>=c.max?t.red:h.max>=d.max&&h.max>=u.max&&h.max>=c.max?t.green:t.blue;switch(n.redMaximum=e.redMaximum,n.greenMaximum=e.greenMaximum,n.blueMaximum=e.blueMaximum,n.alphaMaximum=e.alphaMaximum,r){case t.red:n.redMinimum=e.redMaximum=u.position,n.greenMinimum=e.greenMinimum,n.blueMinimum=e.blueMinimum,n.alphaMinimum=e.alphaMinimum;break;case t.green:n.greenMinimum=e.greenMaximum=h.position,n.redMinimum=e.redMinimum,n.blueMinimum=e.blueMinimum,n.alphaMinimum=e.alphaMinimum;break;case t.blue:n.blueMinimum=e.blueMaximum=c.position,n.redMinimum=e.redMinimum,n.greenMinimum=e.greenMinimum,n.alphaMinimum=e.alphaMinimum;break;case t.alpha:n.alphaMinimum=e.alphaMaximum=d.position,n.blueMinimum=e.blueMinimum,n.redMinimum=e.redMinimum,n.greenMinimum=e.greenMinimum}return e.volume=(e.redMaximum-e.redMinimum)*(e.greenMaximum-e.greenMinimum)*(e.blueMaximum-e.blueMinimum)*(e.alphaMaximum-e.alphaMinimum),n.volume=(n.redMaximum-n.redMinimum)*(n.greenMaximum-n.greenMinimum)*(n.blueMaximum-n.blueMinimum)*(n.alphaMaximum-n.alphaMinimum),!0},t.prototype._initialize=function(t){this._colors=t,this._cubes=[];for(var e=0;e<t;e++)this._cubes[e]=new h;this._cubes[0].redMinimum=0,this._cubes[0].greenMinimum=0,this._cubes[0].blueMinimum=0,this._cubes[0].alphaMinimum=0,this._cubes[0].redMaximum=this._maxSideIndex,this._cubes[0].greenMaximum=this._maxSideIndex,this._cubes[0].blueMaximum=this._maxSideIndex,this._cubes[0].alphaMaximum=this._alphaMaxSideIndex,this._weights=s(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._momentsRed=s(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._momentsGreen=s(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._momentsBlue=s(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._momentsAlpha=s(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._moments=s(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._table=[];for(var n=0;n<256;++n)this._table[n]=n*n;this._pixels=[]},t.prototype._setQuality=function(t){void 0===t&&(t=5),this._significantBitsPerChannel=t,this._maxSideIndex=1<<this._significantBitsPerChannel,this._alphaMaxSideIndex=this._maxSideIndex,this._sideSize=this._maxSideIndex+1,this._alphaSideSize=this._alphaMaxSideIndex+1},t.alpha=3,t.red=2,t.green=1,t.blue=0,t}();e.WuQuant=c},function(t,e,n){"use strict";var r=n(31);e.NearestColor=r.NearestColor;var i=n(32);e.ErrorDiffusionArray=i.ErrorDiffusionArray,e.ErrorDiffusionArrayKernel=i.ErrorDiffusionArrayKernel;var a=n(33);e.ErrorDiffusionRiemersma=a.ErrorDiffusionRiemersma},function(t,e){"use strict";var n=function(){function t(t){this._distance=t}return t.prototype.quantize=function(t,e){for(var n=t.getPointArray(),r=t.getWidth(),i=t.getHeight(),a=0;a<i;a++)for(var s=0,o=a*r;s<r;s++,o++){var l=n[o];l.from(e.getNearestColor(this._distance,l))}return t},t}();e.NearestColor=n},function(t,e,n){"use strict";var r=n(24),i=n(6);!function(t){t[t.FloydSteinberg=0]="FloydSteinberg",t[t.FalseFloydSteinberg=1]="FalseFloydSteinberg",t[t.Stucki=2]="Stucki",t[t.Atkinson=3]="Atkinson",t[t.Jarvis=4]="Jarvis",t[t.Burkes=5]="Burkes",t[t.Sierra=6]="Sierra",t[t.TwoSierra=7]="TwoSierra",t[t.SierraLite=8]="SierraLite"}(e.ErrorDiffusionArrayKernel||(e.ErrorDiffusionArrayKernel={}));var a=e.ErrorDiffusionArrayKernel,s=function(){function t(t,e,n,r,i){void 0===n&&(n=!0),void 0===r&&(r=0),void 0===i&&(i=!1),this._setKernel(e),this._distance=t,this._minColorDistance=r,this._serpentine=n,this._calculateErrorLikeGIMP=i}return t.prototype.quantize=function(t,e){for(var n=t.getPointArray(),a=new r.Point,s=t.getWidth(),o=t.getHeight(),l=[],u=1,h=1,c=0;c<this._kernel.length;c++){var d=this._kernel[c][2]+1;h<d&&(h=d)}for(c=0;c<h;c++)this._fillErrorLine(l[c]=[],s);for(var f=0;f<o;f++){this._serpentine&&(u*=-1);var p=f*s,m=1==u?0:s-1,g=1==u?s:-1;this._fillErrorLine(l[0],s),l.push(l.shift());for(var b=l[0],y=m,v=p+m;y!==g;y+=u,v+=u){var w=n[v],_=b[y];a.from(w);var k=r.Point.createByRGBA(i.inRange0to255Rounded(w.r+_[0]),i.inRange0to255Rounded(w.g+_[1]),i.inRange0to255Rounded(w.b+_[2]),i.inRange0to255Rounded(w.a+_[3])),x=e.getNearestColor(this._distance,k);if(w.from(x),!(this._minColorDistance&&this._distance.calculateNormalized(w,x)<this._minColorDistance)){var S=void 0,E=void 0,I=void 0,A=void 0;this._calculateErrorLikeGIMP?(S=k.r-x.r,E=k.g-x.g,I=k.b-x.b,A=k.a-x.a):(S=a.r-x.r,E=a.g-x.g,I=a.b-x.b,A=a.a-x.a);var M=1==u?0:this._kernel.length-1,T=1==u?this._kernel.length:-1;for(c=M;c!==T;c+=u){var N=this._kernel[c][1]*u,C=this._kernel[c][2];if(N+y>=0&&N+y<s&&C+f>=0&&C+f<o){var R=this._kernel[c][0],O=l[C][N+y];O[0]=O[0]+S*R,O[1]=O[1]+E*R,O[2]=O[2]+I*R,O[3]=O[3]+A*R}}}}}return t},t.prototype._fillErrorLine=function(t,e){t.length>e&&(t.length=e);for(var n=t.length,r=0;r<n;r++){var i=t[r];i[0]=i[1]=i[2]=i[3]=0}for(r=n;r<e;r++)t[r]=[0,0,0,0]},t.prototype._setKernel=function(t){switch(t){case a.FloydSteinberg:this._kernel=[[7/16,1,0],[3/16,-1,1],[5/16,0,1],[1/16,1,1]];break;case a.FalseFloydSteinberg:this._kernel=[[3/8,1,0],[3/8,0,1],[2/8,1,1]];break;case a.Stucki:this._kernel=[[8/42,1,0],[4/42,2,0],[2/42,-2,1],[4/42,-1,1],[8/42,0,1],[4/42,1,1],[2/42,2,1],[1/42,-2,2],[2/42,-1,2],[4/42,0,2],[2/42,1,2],[1/42,2,2]];break;case a.Atkinson:this._kernel=[[1/8,1,0],[1/8,2,0],[1/8,-1,1],[1/8,0,1],[1/8,1,1],[1/8,0,2]];break;case a.Jarvis:this._kernel=[[7/48,1,0],[5/48,2,0],[3/48,-2,1],[5/48,-1,1],[7/48,0,1],[5/48,1,1],[3/48,2,1],[1/48,-2,2],[3/48,-1,2],[5/48,0,2],[3/48,1,2],[1/48,2,2]];break;case a.Burkes:this._kernel=[[.25,1,0],[4/32,2,0],[2/32,-2,1],[4/32,-1,1],[.25,0,1],[4/32,1,1],[2/32,2,1]];break;case a.Sierra:this._kernel=[[5/32,1,0],[3/32,2,0],[2/32,-2,1],[4/32,-1,1],[5/32,0,1],[4/32,1,1],[2/32,2,1],[2/32,-1,2],[3/32,0,2],[2/32,1,2]];break;case a.TwoSierra:this._kernel=[[.25,1,0],[3/16,2,0],[1/16,-2,1],[2/16,-1,1],[3/16,0,1],[2/16,1,1],[1/16,2,1]];break;case a.SierraLite:this._kernel=[[.5,1,0],[1/4,-1,1],[1/4,0,1]];break;default:throw new Error("ErrorDiffusionArray: unknown kernel = "+t)}},t}();e.ErrorDiffusionArray=s},function(t,e,n){"use strict";var r=n(34),i=n(24),a=n(6),s=function(){function t(t,e,n){void 0===e&&(e=16),void 0===n&&(n=1),this._distance=t,this._errorPropagation=n,this._errorQueueSize=e,this._max=this._errorQueueSize,this._createWeights()}return t.prototype.quantize=function(t,e){for(var n=this,s=new r.HilbertCurveBase,o=t.getPointArray(),l=t.getWidth(),u=t.getHeight(),h=[],c=0,d=0;d<this._errorQueueSize;d++)h[d]={r:0,g:0,b:0,a:0};return s.walk(l,u,(function(t,r){for(var s=o[t+r*l],u=s.r,d=s.g,f=s.b,p=s.a,m=0;m<n._errorQueueSize;m++){var g=n._weights[m],b=h[(m+c)%n._errorQueueSize];u+=b.r*g,d+=b.g*g,f+=b.b*g,p+=b.a*g}var y=i.Point.createByRGBA(a.inRange0to255Rounded(u),a.inRange0to255Rounded(d),a.inRange0to255Rounded(f),a.inRange0to255Rounded(p)),v=e.getNearestColor(n._distance,y),w=((c=(c+1)%n._errorQueueSize)+n._errorQueueSize-1)%n._errorQueueSize;h[w].r=s.r-v.r,h[w].g=s.g-v.g,h[w].b=s.b-v.b,h[w].a=s.a-v.a,s.from(v)})),t},t.prototype._createWeights=function(){this._weights=[];for(var t=Math.exp(Math.log(this._max)/(this._errorQueueSize-1)),e=0,n=1;e<this._errorQueueSize;e++)this._weights[e]=(n+.5|0)/this._max*this._errorPropagation,n*=t},t}();e.ErrorDiffusionRiemersma=s},function(t,e){"use strict";var n;!function(t){t[t.NONE=0]="NONE",t[t.UP=1]="UP",t[t.LEFT=2]="LEFT",t[t.RIGHT=3]="RIGHT",t[t.DOWN=4]="DOWN"}(n||(n={}));var r=function(){function t(){}return t.prototype.walk=function(t,e,r){this._x=0,this._y=0,this._d=0,this._width=t,this._height=e,this._callback=r;var i=Math.max(t,e);this._level=Math.log(i)/Math.log(2)+1|0,this._walkHilbert(n.UP),this._visit(n.NONE)},t.prototype._walkHilbert=function(t){if(!(this._level<1)){switch(this._level--,t){case n.LEFT:this._walkHilbert(n.UP),this._visit(n.RIGHT),this._walkHilbert(n.LEFT),this._visit(n.DOWN),this._walkHilbert(n.LEFT),this._visit(n.LEFT),this._walkHilbert(n.DOWN);break;case n.RIGHT:this._walkHilbert(n.DOWN),this._visit(n.LEFT),this._walkHilbert(n.RIGHT),this._visit(n.UP),this._walkHilbert(n.RIGHT),this._visit(n.RIGHT),this._walkHilbert(n.UP);break;case n.UP:this._walkHilbert(n.LEFT),this._visit(n.DOWN),this._walkHilbert(n.UP),this._visit(n.RIGHT),this._walkHilbert(n.UP),this._visit(n.UP),this._walkHilbert(n.RIGHT);break;case n.DOWN:this._walkHilbert(n.RIGHT),this._visit(n.UP),this._walkHilbert(n.DOWN),this._visit(n.LEFT),this._walkHilbert(n.DOWN),this._visit(n.DOWN),this._walkHilbert(n.LEFT)}this._level++}},t.prototype._visit=function(t){switch(this._x>=0&&this._x<this._width&&this._y>=0&&this._y<this._height&&(this._callback(this._x,this._y,this._d),this._d++),t){case n.LEFT:this._x--;break;case n.RIGHT:this._x++;break;case n.UP:this._y--;break;case n.DOWN:this._y++}},t}();e.HilbertCurveBase=r},function(t,e,n){"use strict";var r=n(36);e.SSIM=r.SSIM},function(t,e,n){"use strict";var r=n(2),i=function(){function t(){}return t.prototype.compare=function(t,e){if(t.getHeight()!==e.getHeight()||t.getWidth()!==e.getWidth())throw new Error("Images have different sizes!");var n=Math.pow(.01*255,2),r=Math.pow(.03*255,2),i=0,a=0;return this._iterate(t,e,(function(t,e,s,o){for(var l=0,u=0,h=0,c=0;c<t.length;c++)u+=Math.pow(t[c]-s,2),h+=Math.pow(e[c]-o,2),l+=(t[c]-s)*(e[c]-o);var d=t.length-1;u/=d,h/=d;var f=(2*s*o+n)*(2*(l/=d)+r),p=(Math.pow(s,2)+Math.pow(o,2)+n)*(u+h+r);a+=f/p,i++})),a/i},t.prototype._iterate=function(t,e,n){for(var r=t.getWidth(),i=t.getHeight(),a=0;a<i;a+=8)for(var s=0;s<r;s+=8){var o=Math.min(8,r-s),l=Math.min(8,i-a),u=this._calculateLumaValuesForWindow(t,s,a,o,l),h=this._calculateLumaValuesForWindow(e,s,a,o,l);n(u,h,this._calculateAverageLuma(u),this._calculateAverageLuma(h))}},t.prototype._calculateLumaValuesForWindow=function(t,e,n,i,a){for(var s=t.getPointArray(),o=[],l=0,u=n;u<n+a;u++)for(var h=u*t.getWidth(),c=e;c<e+i;c++){var d=s[h+c];o[l]=d.r*r.Y.RED+d.g*r.Y.GREEN+d.b*r.Y.BLUE,l++}return o},t.prototype._calculateAverageLuma=function(t){for(var e=0,n=0;n<t.length;n++)e+=t[n];return e/t.length},t}();e.SSIM=i},function(t,e,n){"use strict";var r=n(6);e.arithmetic=r;var i=n(28);e.HueStatistics=i.HueStatistics;var a=n(22);e.Palette=a.Palette;var s=n(24);e.Point=s.Point;var o=n(23);e.PointContainer=o.PointContainer}])},t.exports=e()},1193:t=>{"function"==typeof Object.create?t.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},1104:t=>{"function"==typeof Object.create?t.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},4603:t=>{"function"==typeof Object.create?t.exports=function(t,e){e&&(t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:t.exports=function(t,e){if(e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}}},189:t=>{t.exports=function(t){if(!t)return!1;var n=e.call(t);return"[object Function]"===n||"function"==typeof t&&"[object RegExp]"!==n||"undefined"!=typeof window&&(t===window.setTimeout||t===window.alert||t===window.confirm||t===window.prompt)};var e=Object.prototype.toString},9100:t=>{var e={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==e.call(t)}},8159:(t,e,n)=>{"use strict";var r=n(3852);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=r(n(5683)),a=r(n(6291)),s=r(n(1414)),o=(0,i.default)({types:[a.default],plugins:[s.default]});e.default=o},6786:(t,e,n)=>{var r=n(8283),i=n(4507);t.exports={encode:r,decode:i}},4507:(t,e,n)=>{var r=n(9208).Buffer,i=function(){"use strict";var t=new Int32Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]),e=4017,n=799,r=3406,i=2276,a=1567,s=3784,o=5793,l=2896;function u(){}function h(t,e){for(var n,r,i=0,a=[],s=16;s>0&&!t[s-1];)s--;a.push({children:[],index:0});var o,l=a[0];for(n=0;n<s;n++){for(r=0;r<t[n];r++){for((l=a.pop()).children[l.index]=e[i];l.index>0;){if(0===a.length)throw new Error("Could not recreate Huffman Table");l=a.pop()}for(l.index++,a.push(l);a.length<=n;)a.push(o={children:[],index:0}),l.children[l.index]=o.children,l=o;i++}n+1<s&&(a.push(o={children:[],index:0}),l.children[l.index]=o.children,l=o)}return a[0].children}function c(e,n,r,i,a,s,o,l,u,h){r.precision,r.samplesPerLine,r.scanLines;var c=r.mcusPerLine,d=r.progressive,f=(r.maxH,r.maxV,n),p=0,m=0;function g(){if(m>0)return m--,p>>m&1;if(255==(p=e[n++])){var t=e[n++];if(t)throw new Error("unexpected marker: "+(p<<8|t).toString(16))}return m=7,p>>>7}function b(t){for(var e,n=t;null!==(e=g());){if("number"==typeof(n=n[e]))return n;if("object"!=typeof n)throw new Error("invalid huffman sequence")}return null}function y(t){for(var e=0;t>0;){var n=g();if(null===n)return;e=e<<1|n,t--}return e}function v(t){var e=y(t);return e>=1<<t-1?e:e+(-1<<t)+1}var w,_=0,k=0;function x(t,e,n,r,i){var a=n%c,s=(n/c|0)*t.v+r,o=a*t.h+i;void 0===t.blocks[s]&&h.tolerantDecoding||e(t,t.blocks[s][o])}function S(t,e,n){var r=n/t.blocksPerLine|0,i=n%t.blocksPerLine;void 0===t.blocks[r]&&h.tolerantDecoding||e(t,t.blocks[r][i])}var E,I,A,M,T,N,C=i.length;N=d?0===s?0===l?function(t,e){var n=b(t.huffmanTableDC),r=0===n?0:v(n)<<u;e[0]=t.pred+=r}:function(t,e){e[0]|=g()<<u}:0===l?function(e,n){if(_>0)_--;else for(var r=s,i=o;r<=i;){var a=b(e.huffmanTableAC),l=15&a,h=a>>4;if(0!==l)n[t[r+=h]]=v(l)*(1<<u),r++;else{if(h<15){_=y(h)+(1<<h)-1;break}r+=16}}}:function(e,n){for(var r=s,i=o,a=0;r<=i;){var l=t[r],h=n[l]<0?-1:1;switch(k){case 0:var c=b(e.huffmanTableAC),d=15&c;if(a=c>>4,0===d)a<15?(_=y(a)+(1<<a),k=4):(a=16,k=1);else{if(1!==d)throw new Error("invalid ACn encoding");w=v(d),k=a?2:3}continue;case 1:case 2:n[l]?n[l]+=(g()<<u)*h:0==--a&&(k=2==k?3:0);break;case 3:n[l]?n[l]+=(g()<<u)*h:(n[l]=w<<u,k=0);break;case 4:n[l]&&(n[l]+=(g()<<u)*h)}r++}4===k&&0==--_&&(k=0)}:function(e,n){var r=b(e.huffmanTableDC),i=0===r?0:v(r);n[0]=e.pred+=i;for(var a=1;a<64;){var s=b(e.huffmanTableAC),o=15&s,l=s>>4;if(0!==o)n[t[a+=l]]=v(o),a++;else{if(l<15)break;a+=16}}};var R,O,D,z,B=0;for(O=1==C?i[0].blocksPerLine*i[0].blocksPerColumn:c*r.mcusPerColumn,a||(a=O);B<O;){for(I=0;I<C;I++)i[I].pred=0;if(_=0,1==C)for(E=i[0],T=0;T<a;T++)S(E,N,B),B++;else for(T=0;T<a;T++){for(I=0;I<C;I++)for(D=(E=i[I]).h,z=E.v,A=0;A<z;A++)for(M=0;M<D;M++)x(E,N,B,A,M);if(++B===O)break}if(B===O)do{if(255===e[n]&&0!==e[n+1])break;n+=1}while(n<e.length-2);if(m=0,(R=e[n]<<8|e[n+1])<65280)throw new Error("marker was not found");if(!(R>=65488&&R<=65495))break;n+=2}return n-f}function d(t,u){var h,c,d=[],f=u.blocksPerLine,p=u.blocksPerColumn,m=f<<3,b=new Int32Array(64),y=new Uint8Array(64);function v(t,h,c){var d,f,p,m,g,b,y,v,w,_,k=u.quantizationTable,x=c;for(_=0;_<64;_++)x[_]=t[_]*k[_];for(_=0;_<8;++_){var S=8*_;0!=x[1+S]||0!=x[2+S]||0!=x[3+S]||0!=x[4+S]||0!=x[5+S]||0!=x[6+S]||0!=x[7+S]?(d=o*x[0+S]+128>>8,f=o*x[4+S]+128>>8,p=x[2+S],m=x[6+S],g=l*(x[1+S]-x[7+S])+128>>8,v=l*(x[1+S]+x[7+S])+128>>8,b=x[3+S]<<4,y=x[5+S]<<4,w=d-f+1>>1,d=d+f+1>>1,f=w,w=p*s+m*a+128>>8,p=p*a-m*s+128>>8,m=w,w=g-y+1>>1,g=g+y+1>>1,y=w,w=v+b+1>>1,b=v-b+1>>1,v=w,w=d-m+1>>1,d=d+m+1>>1,m=w,w=f-p+1>>1,f=f+p+1>>1,p=w,w=g*i+v*r+2048>>12,g=g*r-v*i+2048>>12,v=w,w=b*n+y*e+2048>>12,b=b*e-y*n+2048>>12,y=w,x[0+S]=d+v,x[7+S]=d-v,x[1+S]=f+y,x[6+S]=f-y,x[2+S]=p+b,x[5+S]=p-b,x[3+S]=m+g,x[4+S]=m-g):(w=o*x[0+S]+512>>10,x[0+S]=w,x[1+S]=w,x[2+S]=w,x[3+S]=w,x[4+S]=w,x[5+S]=w,x[6+S]=w,x[7+S]=w)}for(_=0;_<8;++_){var E=_;0!=x[8+E]||0!=x[16+E]||0!=x[24+E]||0!=x[32+E]||0!=x[40+E]||0!=x[48+E]||0!=x[56+E]?(d=o*x[0+E]+2048>>12,f=o*x[32+E]+2048>>12,p=x[16+E],m=x[48+E],g=l*(x[8+E]-x[56+E])+2048>>12,v=l*(x[8+E]+x[56+E])+2048>>12,b=x[24+E],y=x[40+E],w=d-f+1>>1,d=d+f+1>>1,f=w,w=p*s+m*a+2048>>12,p=p*a-m*s+2048>>12,m=w,w=g-y+1>>1,g=g+y+1>>1,y=w,w=v+b+1>>1,b=v-b+1>>1,v=w,w=d-m+1>>1,d=d+m+1>>1,m=w,w=f-p+1>>1,f=f+p+1>>1,p=w,w=g*i+v*r+2048>>12,g=g*r-v*i+2048>>12,v=w,w=b*n+y*e+2048>>12,b=b*e-y*n+2048>>12,y=w,x[0+E]=d+v,x[56+E]=d-v,x[8+E]=f+y,x[48+E]=f-y,x[16+E]=p+b,x[40+E]=p-b,x[24+E]=m+g,x[32+E]=m-g):(w=o*c[_+0]+8192>>14,x[0+E]=w,x[8+E]=w,x[16+E]=w,x[24+E]=w,x[32+E]=w,x[40+E]=w,x[48+E]=w,x[56+E]=w)}for(_=0;_<64;++_){var I=128+(x[_]+8>>4);h[_]=I<0?0:I>255?255:I}}g(m*p*8);for(var w=0;w<p;w++){var _=w<<3;for(h=0;h<8;h++)d.push(new Uint8Array(m));for(var k=0;k<f;k++){v(u.blocks[w][k],y,b);var x=0,S=k<<3;for(c=0;c<8;c++){var E=d[_+c];for(h=0;h<8;h++)E[S+h]=y[x++]}}}return d}function f(t){return t<0?0:t>255?255:t}u.prototype={load:function(t){var e=new XMLHttpRequest;e.open("GET",t,!0),e.responseType="arraybuffer",e.onload=function(){var t=new Uint8Array(e.response||e.mozResponseArrayBuffer);this.parse(t),this.onload&&this.onload()}.bind(this),e.send(null)},parse:function(e){var n=1e3*this.opts.maxResolutionInMP*1e3,r=0;function i(){var t=e[r]<<8|e[r+1];return r+=2,t}function a(t){var e,n,r=0,i=0;for(n in t.components)t.components.hasOwnProperty(n)&&(r<(e=t.components[n]).h&&(r=e.h),i<e.v&&(i=e.v));var a=Math.ceil(t.samplesPerLine/8/r),s=Math.ceil(t.scanLines/8/i);for(n in t.components)if(t.components.hasOwnProperty(n)){e=t.components[n];var o=Math.ceil(Math.ceil(t.samplesPerLine/8)*e.h/r),l=Math.ceil(Math.ceil(t.scanLines/8)*e.v/i),u=a*e.h,h=s*e.v,c=[];g(h*u*256);for(var d=0;d<h;d++){for(var f=[],p=0;p<u;p++)f.push(new Int32Array(64));c.push(f)}e.blocksPerLine=o,e.blocksPerColumn=l,e.blocks=c}t.maxH=r,t.maxV=i,t.mcusPerLine=a,t.mcusPerColumn=s}e.length;var s,o,l,u,f=null,p=null,m=[],b=[],y=[],v=[],w=i();if(this.comments=[],65496!=w)throw new Error("SOI not found");for(w=i();65497!=w;){switch(w){case 65280:break;case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:var _=(l=void 0,u=void 0,l=i(),u=e.subarray(r,r+l-2),r+=u.length,u);if(65534===w){var k=String.fromCharCode.apply(null,_);this.comments.push(k)}65504===w&&74===_[0]&&70===_[1]&&73===_[2]&&70===_[3]&&0===_[4]&&(f={version:{major:_[5],minor:_[6]},densityUnits:_[7],xDensity:_[8]<<8|_[9],yDensity:_[10]<<8|_[11],thumbWidth:_[12],thumbHeight:_[13],thumbData:_.subarray(14,14+3*_[12]*_[13])}),65505===w&&69===_[0]&&120===_[1]&&105===_[2]&&102===_[3]&&0===_[4]&&(this.exifBuffer=_.subarray(5,_.length)),65518===w&&65===_[0]&&100===_[1]&&111===_[2]&&98===_[3]&&101===_[4]&&0===_[5]&&(p={version:_[6],flags0:_[7]<<8|_[8],flags1:_[9]<<8|_[10],transformCode:_[11]});break;case 65499:for(var x=i()+r-2;r<x;){var S=e[r++];g(256);var E=new Int32Array(64);if(S>>4==0)for(q=0;q<64;q++)E[t[q]]=e[r++];else{if(S>>4!=1)throw new Error("DQT: invalid table spec");for(q=0;q<64;q++)E[t[q]]=i()}m[15&S]=E}break;case 65472:case 65473:case 65474:i(),(s={}).extended=65473===w,s.progressive=65474===w,s.precision=e[r++],s.scanLines=i(),s.samplesPerLine=i(),s.components={},s.componentsOrder=[];var I=s.scanLines*s.samplesPerLine;if(I>n){var A=Math.ceil((I-n)/1e6);throw new Error(`maxResolutionInMP limit exceeded by ${A}MP`)}var M,T=e[r++];for(H=0;H<T;H++){M=e[r];var N=e[r+1]>>4,C=15&e[r+1],R=e[r+2];s.componentsOrder.push(M),s.components[M]={h:N,v:C,quantizationIdx:R},r+=3}a(s),b.push(s);break;case 65476:var O=i();for(H=2;H<O;){var D=e[r++],z=new Uint8Array(16),B=0;for(q=0;q<16;q++,r++)B+=z[q]=e[r];g(16+B);var F=new Uint8Array(B);for(q=0;q<B;q++,r++)F[q]=e[r];H+=17+B,(D>>4==0?v:y)[15&D]=h(z,F)}break;case 65501:i(),o=i();break;case 65500:i(),i();break;case 65498:i();var P=e[r++],L=[];for(H=0;H<P;H++){K=s.components[e[r++]];var $=e[r++];K.huffmanTableDC=v[$>>4],K.huffmanTableAC=y[15&$],L.push(K)}var U=e[r++],j=e[r++],W=e[r++],G=c(e,r,s,L,o,U,j,W>>4,15&W,this.opts);r+=G;break;case 65535:255!==e[r]&&r--;break;default:if(255==e[r-3]&&e[r-2]>=192&&e[r-2]<=254){r-=3;break}throw new Error("unknown JPEG marker "+w.toString(16))}w=i()}if(1!=b.length)throw new Error("only single frame JPEGs supported");for(var H=0;H<b.length;H++){var V=b[H].components;for(var q in V)V[q].quantizationTable=m[V[q].quantizationIdx],delete V[q].quantizationIdx}for(this.width=s.samplesPerLine,this.height=s.scanLines,this.jfif=f,this.adobe=p,this.components=[],H=0;H<s.componentsOrder.length;H++){var K=s.components[s.componentsOrder[H]];this.components.push({lines:d(0,K),scaleX:K.h/s.maxH,scaleY:K.v/s.maxV})}},getData:function(t,e){var n,r,i,a,s,o,l,u,h,c,d,p,m,b,y,v,w,_,k,x,S,E=this.width/t,I=this.height/e,A=0,M=t*e*this.components.length;g(M);var T=new Uint8Array(M);switch(this.components.length){case 1:for(n=this.components[0],c=0;c<e;c++)for(s=n.lines[0|c*n.scaleY*I],h=0;h<t;h++)d=s[0|h*n.scaleX*E],T[A++]=d;break;case 2:for(n=this.components[0],r=this.components[1],c=0;c<e;c++)for(s=n.lines[0|c*n.scaleY*I],o=r.lines[0|c*r.scaleY*I],h=0;h<t;h++)d=s[0|h*n.scaleX*E],T[A++]=d,d=o[0|h*r.scaleX*E],T[A++]=d;break;case 3:for(S=!0,this.adobe&&this.adobe.transformCode?S=!0:void 0!==this.opts.colorTransform&&(S=!!this.opts.colorTransform),n=this.components[0],r=this.components[1],i=this.components[2],c=0;c<e;c++)for(s=n.lines[0|c*n.scaleY*I],o=r.lines[0|c*r.scaleY*I],l=i.lines[0|c*i.scaleY*I],h=0;h<t;h++)S?(d=s[0|h*n.scaleX*E],p=o[0|h*r.scaleX*E],_=f(d+1.402*((m=l[0|h*i.scaleX*E])-128)),k=f(d-.3441363*(p-128)-.71413636*(m-128)),x=f(d+1.772*(p-128))):(_=s[0|h*n.scaleX*E],k=o[0|h*r.scaleX*E],x=l[0|h*i.scaleX*E]),T[A++]=_,T[A++]=k,T[A++]=x;break;case 4:if(!this.adobe)throw new Error("Unsupported color mode (4 components)");for(S=!1,this.adobe&&this.adobe.transformCode?S=!0:void 0!==this.opts.colorTransform&&(S=!!this.opts.colorTransform),n=this.components[0],r=this.components[1],i=this.components[2],a=this.components[3],c=0;c<e;c++)for(s=n.lines[0|c*n.scaleY*I],o=r.lines[0|c*r.scaleY*I],l=i.lines[0|c*i.scaleY*I],u=a.lines[0|c*a.scaleY*I],h=0;h<t;h++)S?(d=s[0|h*n.scaleX*E],p=o[0|h*r.scaleX*E],m=l[0|h*i.scaleX*E],b=u[0|h*a.scaleX*E],y=255-f(d+1.402*(m-128)),v=255-f(d-.3441363*(p-128)-.71413636*(m-128)),w=255-f(d+1.772*(p-128))):(y=s[0|h*n.scaleX*E],v=o[0|h*r.scaleX*E],w=l[0|h*i.scaleX*E],b=u[0|h*a.scaleX*E]),T[A++]=255-y,T[A++]=255-v,T[A++]=255-w,T[A++]=255-b;break;default:throw new Error("Unsupported color mode")}return T},copyToImageData:function(t,e){var n,r,i,a,s,o,l,u,h,c=t.width,d=t.height,p=t.data,m=this.getData(c,d),g=0,b=0;switch(this.components.length){case 1:for(r=0;r<d;r++)for(n=0;n<c;n++)i=m[g++],p[b++]=i,p[b++]=i,p[b++]=i,e&&(p[b++]=255);break;case 3:for(r=0;r<d;r++)for(n=0;n<c;n++)l=m[g++],u=m[g++],h=m[g++],p[b++]=l,p[b++]=u,p[b++]=h,e&&(p[b++]=255);break;case 4:for(r=0;r<d;r++)for(n=0;n<c;n++)s=m[g++],o=m[g++],i=m[g++],l=255-f(s*(1-(a=m[g++])/255)+a),u=255-f(o*(1-a/255)+a),h=255-f(i*(1-a/255)+a),p[b++]=l,p[b++]=u,p[b++]=h,e&&(p[b++]=255);break;default:throw new Error("Unsupported color mode")}}};var p=0,m=0;function g(t=0){var e=p+t;if(e>m){var n=Math.ceil((e-m)/1024/1024);throw new Error(`maxMemoryUsageInMB limit exceeded by at least ${n}MB`)}p=e}return u.resetMaxMemoryUsage=function(t){p=0,m=t},u.getBytesAllocated=function(){return p},u.requestMemoryAllocation=g,u}();t.exports=function(t,e={}){var n={colorTransform:void 0,useTArray:!1,formatAsRGBA:!0,tolerantDecoding:!0,maxResolutionInMP:100,maxMemoryUsageInMB:512,...e},a=new Uint8Array(t),s=new i;s.opts=n,i.resetMaxMemoryUsage(1024*n.maxMemoryUsageInMB*1024),s.parse(a);var o=n.formatAsRGBA?4:3,l=s.width*s.height*o;try{i.requestMemoryAllocation(l);var u={width:s.width,height:s.height,exifBuffer:s.exifBuffer,data:n.useTArray?new Uint8Array(l):r.alloc(l)};s.comments.length>0&&(u.comments=s.comments)}catch(t){throw t instanceof RangeError?new Error("Could not allocate enough memory for the image. Required: "+l):t}return s.copyToImageData(u,n.formatAsRGBA),u}},8283:(t,e,n)=>{var r=n(9208).Buffer;function i(t){Math.round;var e,n,i,a,s,o=Math.floor,l=new Array(64),u=new Array(64),h=new Array(64),c=new Array(64),d=new Array(65535),f=new Array(65535),p=new Array(64),m=new Array(64),g=[],b=0,y=7,v=new Array(64),w=new Array(64),_=new Array(64),k=new Array(256),x=new Array(2048),S=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],E=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],I=[0,1,2,3,4,5,6,7,8,9,10,11],A=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],M=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],T=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],N=[0,1,2,3,4,5,6,7,8,9,10,11],C=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],R=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function O(t,e){for(var n=0,r=0,i=new Array,a=1;a<=16;a++){for(var s=1;s<=t[a];s++)i[e[r]]=[],i[e[r]][0]=n,i[e[r]][1]=a,r++,n++;n*=2}return i}function D(t){for(var e=t[0],n=t[1]-1;n>=0;)e&1<<n&&(b|=1<<y),n--,--y<0&&(255==b?(z(255),z(0)):z(b),y=7,b=0)}function z(t){g.push(t)}function B(t){z(t>>8&255),z(255&t)}function F(t,e,n,r,i){for(var a,s=i[0],o=i[240],l=function(t,e){var n,r,i,a,s,o,l,u,h,c,d=0;for(h=0;h<8;++h){n=t[d],r=t[d+1],i=t[d+2],a=t[d+3],s=t[d+4],o=t[d+5],l=t[d+6];var f=n+(u=t[d+7]),m=n-u,g=r+l,b=r-l,y=i+o,v=i-o,w=a+s,_=a-s,k=f+w,x=f-w,S=g+y,E=g-y;t[d]=k+S,t[d+4]=k-S;var I=.707106781*(E+x);t[d+2]=x+I,t[d+6]=x-I;var A=.382683433*((k=_+v)-(E=b+m)),M=.5411961*k+A,T=1.306562965*E+A,N=.707106781*(S=v+b),C=m+N,R=m-N;t[d+5]=R+M,t[d+3]=R-M,t[d+1]=C+T,t[d+7]=C-T,d+=8}for(d=0,h=0;h<8;++h){n=t[d],r=t[d+8],i=t[d+16],a=t[d+24],s=t[d+32],o=t[d+40],l=t[d+48];var O=n+(u=t[d+56]),D=n-u,z=r+l,B=r-l,F=i+o,P=i-o,L=a+s,$=a-s,U=O+L,j=O-L,W=z+F,G=z-F;t[d]=U+W,t[d+32]=U-W;var H=.707106781*(G+j);t[d+16]=j+H,t[d+48]=j-H;var V=.382683433*((U=$+P)-(G=B+D)),q=.5411961*U+V,K=1.306562965*G+V,Z=.707106781*(W=P+B),X=D+Z,J=D-Z;t[d+40]=J+q,t[d+24]=J-q,t[d+8]=X+K,t[d+56]=X-K,d++}for(h=0;h<64;++h)c=t[h]*e[h],p[h]=c>0?c+.5|0:c-.5|0;return p}(t,e),u=0;u<64;++u)m[S[u]]=l[u];var h=m[0]-n;n=m[0],0==h?D(r[0]):(D(r[f[a=32767+h]]),D(d[a]));for(var c=63;c>0&&0==m[c];c--);if(0==c)return D(s),n;for(var g,b=1;b<=c;){for(var y=b;0==m[b]&&b<=c;++b);var v=b-y;if(v>=16){g=v>>4;for(var w=1;w<=g;++w)D(o);v&=15}a=32767+m[b],D(i[(v<<4)+f[a]]),D(d[a]),b++}return 63!=c&&D(s),n}function P(t){t<=0&&(t=1),t>100&&(t=100),s!=t&&(function(t){for(var e=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],n=0;n<64;n++){var r=o((e[n]*t+50)/100);r<1?r=1:r>255&&(r=255),l[S[n]]=r}for(var i=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],a=0;a<64;a++){var s=o((i[a]*t+50)/100);s<1?s=1:s>255&&(s=255),u[S[a]]=s}for(var d=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],f=0,p=0;p<8;p++)for(var m=0;m<8;m++)h[f]=1/(l[S[f]]*d[p]*d[m]*8),c[f]=1/(u[S[f]]*d[p]*d[m]*8),f++}(t<50?Math.floor(5e3/t):Math.floor(200-2*t)),s=t)}this.encode=function(t,s){(new Date).getTime(),s&&P(s),g=new Array,b=0,y=7,B(65496),B(65504),B(16),z(74),z(70),z(73),z(70),z(0),z(1),z(1),z(0),B(1),B(1),z(0),z(0),function(t){if(t){B(65505),69===t[0]&&120===t[1]&&105===t[2]&&102===t[3]?B(t.length+2):(B(t.length+5+2),z(69),z(120),z(105),z(102),z(0));for(var e=0;e<t.length;e++)z(t[e])}}(t.exifBuffer),function(){B(65499),B(132),z(0);for(var t=0;t<64;t++)z(l[t]);z(1);for(var e=0;e<64;e++)z(u[e])}(),function(t,e){B(65472),B(17),z(8),B(e),B(t),z(3),z(1),z(17),z(0),z(2),z(17),z(1),z(3),z(17),z(1)}(t.width,t.height),function(){B(65476),B(418),z(0);for(var t=0;t<16;t++)z(E[t+1]);for(var e=0;e<=11;e++)z(I[e]);z(16);for(var n=0;n<16;n++)z(A[n+1]);for(var r=0;r<=161;r++)z(M[r]);z(1);for(var i=0;i<16;i++)z(T[i+1]);for(var a=0;a<=11;a++)z(N[a]);z(17);for(var s=0;s<16;s++)z(C[s+1]);for(var o=0;o<=161;o++)z(R[o])}(),B(65498),B(12),z(3),z(1),z(0),z(2),z(17),z(3),z(17),z(0),z(63),z(0);var o=0,d=0,f=0;b=0,y=7,this.encode.displayName="_encode_";for(var p,m,k,S,O,L,$,U,j,W=t.data,G=t.width,H=t.height,V=4*G,q=0;q<H;){for(p=0;p<V;){for(L=O=V*q+p,$=-1,U=0,j=0;j<64;j++)L=O+(U=j>>3)*V+($=4*(7&j)),q+U>=H&&(L-=V*(q+1+U-H)),p+$>=V&&(L-=p+$-V+4),m=W[L++],k=W[L++],S=W[L++],v[j]=(x[m]+x[k+256>>0]+x[S+512>>0]>>16)-128,w[j]=(x[m+768>>0]+x[k+1024>>0]+x[S+1280>>0]>>16)-128,_[j]=(x[m+1280>>0]+x[k+1536>>0]+x[S+1792>>0]>>16)-128;o=F(v,h,o,e,i),d=F(w,c,d,n,a),f=F(_,c,f,n,a),p+=32}q+=8}if(y>=0){var K=[];K[1]=y+1,K[0]=(1<<y+1)-1,D(K)}return B(65497),r.from(g)},(new Date).getTime(),t||(t=50),function(){for(var t=String.fromCharCode,e=0;e<256;e++)k[e]=t(e)}(),e=O(E,I),n=O(T,N),i=O(A,M),a=O(C,R),function(){for(var t=1,e=2,n=1;n<=15;n++){for(var r=t;r<e;r++)f[32767+r]=n,d[32767+r]=[],d[32767+r][1]=n,d[32767+r][0]=r;for(var i=-(e-1);i<=-t;i++)f[32767+i]=n,d[32767+i]=[],d[32767+i][1]=n,d[32767+i][0]=e-1+i;t<<=1,e<<=1}}(),function(){for(var t=0;t<256;t++)x[t]=19595*t,x[t+256>>0]=38470*t,x[t+512>>0]=7471*t+32768,x[t+768>>0]=-11059*t,x[t+1024>>0]=-21709*t,x[t+1280>>0]=32768*t+8421375,x[t+1536>>0]=-27439*t,x[t+1792>>0]=-5329*t}(),P(t),(new Date).getTime()}t.exports=function(t,e){return void 0===e&&(e=50),{data:new i(e).encode(t,e),width:t.width,height:t.height}}},3327:(t,e,n)=>{var r=n(9208).Buffer,i=n(568),a=function(){},s=n(7561),o=n(3940),l=n(1944),u=n(2419),h=n(7270),c=self.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest;t.exports=function(t,e){e="function"==typeof e?e:a,"string"==typeof t?t={uri:t}:t||(t={}),t.binary&&(t=function(t){if(c)return h(t,{responseType:"arraybuffer"});if(void 0===self.XMLHttpRequest)throw new Error("your browser does not support XHR loading");var e=new self.XMLHttpRequest;return e.overrideMimeType("text/plain; charset=x-user-defined"),h({xhr:e},t)}(t)),i(t,(function(n,i,h){if(n)return e(n);if(!/^2/.test(i.statusCode))return e(new Error("http status code: "+i.statusCode));if(!h)return e(new Error("no body result"));var c,d,f=!1;if(c=h,"[object ArrayBuffer]"===Object.prototype.toString.call(c)){var p=new Uint8Array(h);h=r.from(p,"binary")}u(h)&&(f=!0,"string"==typeof h&&(h=r.from(h,"binary"))),f||(r.isBuffer(h)&&(h=h.toString(t.encoding)),h=h.trim());try{var m=i.headers["content-type"];d=f?l(h):/json/.test(m)||"{"===h.charAt(0)?JSON.parse(h):/xml/.test(m)||"<"===h.charAt(0)?o(h):s(h)}catch(t){e(new Error("error parsing font "+t.message)),e=a}e(null,d)}))}},2419:(t,e,n)=>{var r=n(9208).Buffer,i=n(5298),a=r.from([66,77,70,3]);t.exports=function(t){return"string"==typeof t?"BMF"===t.substring(0,3):t.length>4&&i(t.slice(0,4),a)}},4255:t=>{t.exports=n;var e=null;try{e=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(t){}function n(t,e,n){this.low=0|t,this.high=0|e,this.unsigned=!!n}function r(t){return!0===(t&&t.__isLong__)}n.prototype.__isLong__,Object.defineProperty(n.prototype,"__isLong__",{value:!0}),n.isLong=r;var i={},a={};function s(t,e){var n,r,s;return e?(s=0<=(t>>>=0)&&t<256)&&(r=a[t])?r:(n=l(t,(0|t)<0?-1:0,!0),s&&(a[t]=n),n):(s=-128<=(t|=0)&&t<128)&&(r=i[t])?r:(n=l(t,t<0?-1:0,!1),s&&(i[t]=n),n)}function o(t,e){if(isNaN(t))return e?b:g;if(e){if(t<0)return b;if(t>=f)return k}else{if(t<=-p)return x;if(t+1>=p)return _}return t<0?o(-t,e).neg():l(t%d|0,t/d|0,e)}function l(t,e,r){return new n(t,e,r)}n.fromInt=s,n.fromNumber=o,n.fromBits=l;var u=Math.pow;function h(t,e,n){if(0===t.length)throw Error("empty string");if("NaN"===t||"Infinity"===t||"+Infinity"===t||"-Infinity"===t)return g;if("number"==typeof e?(n=e,e=!1):e=!!e,(n=n||10)<2||36<n)throw RangeError("radix");var r;if((r=t.indexOf("-"))>0)throw Error("interior hyphen");if(0===r)return h(t.substring(1),e,n).neg();for(var i=o(u(n,8)),a=g,s=0;s<t.length;s+=8){var l=Math.min(8,t.length-s),c=parseInt(t.substring(s,s+l),n);if(l<8){var d=o(u(n,l));a=a.mul(d).add(o(c))}else a=(a=a.mul(i)).add(o(c))}return a.unsigned=e,a}function c(t,e){return"number"==typeof t?o(t,e):"string"==typeof t?h(t,e):l(t.low,t.high,"boolean"==typeof e?e:t.unsigned)}n.fromString=h,n.fromValue=c;var d=4294967296,f=d*d,p=f/2,m=s(1<<24),g=s(0);n.ZERO=g;var b=s(0,!0);n.UZERO=b;var y=s(1);n.ONE=y;var v=s(1,!0);n.UONE=v;var w=s(-1);n.NEG_ONE=w;var _=l(-1,2147483647,!1);n.MAX_VALUE=_;var k=l(-1,-1,!0);n.MAX_UNSIGNED_VALUE=k;var x=l(0,-2147483648,!1);n.MIN_VALUE=x;var S=n.prototype;S.toInt=function(){return this.unsigned?this.low>>>0:this.low},S.toNumber=function(){return this.unsigned?(this.high>>>0)*d+(this.low>>>0):this.high*d+(this.low>>>0)},S.toString=function(t){if((t=t||10)<2||36<t)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(x)){var e=o(t),n=this.div(e),r=n.mul(e).sub(this);return n.toString(t)+r.toInt().toString(t)}return"-"+this.neg().toString(t)}for(var i=o(u(t,6),this.unsigned),a=this,s="";;){var l=a.div(i),h=(a.sub(l.mul(i)).toInt()>>>0).toString(t);if((a=l).isZero())return h+s;for(;h.length<6;)h="0"+h;s=""+h+s}},S.getHighBits=function(){return this.high},S.getHighBitsUnsigned=function(){return this.high>>>0},S.getLowBits=function(){return this.low},S.getLowBitsUnsigned=function(){return this.low>>>0},S.getNumBitsAbs=function(){if(this.isNegative())return this.eq(x)?64:this.neg().getNumBitsAbs();for(var t=0!=this.high?this.high:this.low,e=31;e>0&&0==(t&1<<e);e--);return 0!=this.high?e+33:e+1},S.isZero=function(){return 0===this.high&&0===this.low},S.eqz=S.isZero,S.isNegative=function(){return!this.unsigned&&this.high<0},S.isPositive=function(){return this.unsigned||this.high>=0},S.isOdd=function(){return 1==(1&this.low)},S.isEven=function(){return 0==(1&this.low)},S.equals=function(t){return r(t)||(t=c(t)),(this.unsigned===t.unsigned||this.high>>>31!=1||t.high>>>31!=1)&&this.high===t.high&&this.low===t.low},S.eq=S.equals,S.notEquals=function(t){return!this.eq(t)},S.neq=S.notEquals,S.ne=S.notEquals,S.lessThan=function(t){return this.comp(t)<0},S.lt=S.lessThan,S.lessThanOrEqual=function(t){return this.comp(t)<=0},S.lte=S.lessThanOrEqual,S.le=S.lessThanOrEqual,S.greaterThan=function(t){return this.comp(t)>0},S.gt=S.greaterThan,S.greaterThanOrEqual=function(t){return this.comp(t)>=0},S.gte=S.greaterThanOrEqual,S.ge=S.greaterThanOrEqual,S.compare=function(t){if(r(t)||(t=c(t)),this.eq(t))return 0;var e=this.isNegative(),n=t.isNegative();return e&&!n?-1:!e&&n?1:this.unsigned?t.high>>>0>this.high>>>0||t.high===this.high&&t.low>>>0>this.low>>>0?-1:1:this.sub(t).isNegative()?-1:1},S.comp=S.compare,S.negate=function(){return!this.unsigned&&this.eq(x)?x:this.not().add(y)},S.neg=S.negate,S.add=function(t){r(t)||(t=c(t));var e=this.high>>>16,n=65535&this.high,i=this.low>>>16,a=65535&this.low,s=t.high>>>16,o=65535&t.high,u=t.low>>>16,h=0,d=0,f=0,p=0;return f+=(p+=a+(65535&t.low))>>>16,d+=(f+=i+u)>>>16,h+=(d+=n+o)>>>16,h+=e+s,l((f&=65535)<<16|(p&=65535),(h&=65535)<<16|(d&=65535),this.unsigned)},S.subtract=function(t){return r(t)||(t=c(t)),this.add(t.neg())},S.sub=S.subtract,S.multiply=function(t){if(this.isZero())return g;if(r(t)||(t=c(t)),e)return l(e.mul(this.low,this.high,t.low,t.high),e.get_high(),this.unsigned);if(t.isZero())return g;if(this.eq(x))return t.isOdd()?x:g;if(t.eq(x))return this.isOdd()?x:g;if(this.isNegative())return t.isNegative()?this.neg().mul(t.neg()):this.neg().mul(t).neg();if(t.isNegative())return this.mul(t.neg()).neg();if(this.lt(m)&&t.lt(m))return o(this.toNumber()*t.toNumber(),this.unsigned);var n=this.high>>>16,i=65535&this.high,a=this.low>>>16,s=65535&this.low,u=t.high>>>16,h=65535&t.high,d=t.low>>>16,f=65535&t.low,p=0,b=0,y=0,v=0;return y+=(v+=s*f)>>>16,b+=(y+=a*f)>>>16,y&=65535,b+=(y+=s*d)>>>16,p+=(b+=i*f)>>>16,b&=65535,p+=(b+=a*d)>>>16,b&=65535,p+=(b+=s*h)>>>16,p+=n*f+i*d+a*h+s*u,l((y&=65535)<<16|(v&=65535),(p&=65535)<<16|(b&=65535),this.unsigned)},S.mul=S.multiply,S.divide=function(t){if(r(t)||(t=c(t)),t.isZero())throw Error("division by zero");var n,i,a;if(e)return this.unsigned||-2147483648!==this.high||-1!==t.low||-1!==t.high?l((this.unsigned?e.div_u:e.div_s)(this.low,this.high,t.low,t.high),e.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?b:g;if(this.unsigned){if(t.unsigned||(t=t.toUnsigned()),t.gt(this))return b;if(t.gt(this.shru(1)))return v;a=b}else{if(this.eq(x))return t.eq(y)||t.eq(w)?x:t.eq(x)?y:(n=this.shr(1).div(t).shl(1)).eq(g)?t.isNegative()?y:w:(i=this.sub(t.mul(n)),a=n.add(i.div(t)));if(t.eq(x))return this.unsigned?b:g;if(this.isNegative())return t.isNegative()?this.neg().div(t.neg()):this.neg().div(t).neg();if(t.isNegative())return this.div(t.neg()).neg();a=g}for(i=this;i.gte(t);){n=Math.max(1,Math.floor(i.toNumber()/t.toNumber()));for(var s=Math.ceil(Math.log(n)/Math.LN2),h=s<=48?1:u(2,s-48),d=o(n),f=d.mul(t);f.isNegative()||f.gt(i);)f=(d=o(n-=h,this.unsigned)).mul(t);d.isZero()&&(d=y),a=a.add(d),i=i.sub(f)}return a},S.div=S.divide,S.modulo=function(t){return r(t)||(t=c(t)),e?l((this.unsigned?e.rem_u:e.rem_s)(this.low,this.high,t.low,t.high),e.get_high(),this.unsigned):this.sub(this.div(t).mul(t))},S.mod=S.modulo,S.rem=S.modulo,S.not=function(){return l(~this.low,~this.high,this.unsigned)},S.and=function(t){return r(t)||(t=c(t)),l(this.low&t.low,this.high&t.high,this.unsigned)},S.or=function(t){return r(t)||(t=c(t)),l(this.low|t.low,this.high|t.high,this.unsigned)},S.xor=function(t){return r(t)||(t=c(t)),l(this.low^t.low,this.high^t.high,this.unsigned)},S.shiftLeft=function(t){return r(t)&&(t=t.toInt()),0==(t&=63)?this:t<32?l(this.low<<t,this.high<<t|this.low>>>32-t,this.unsigned):l(0,this.low<<t-32,this.unsigned)},S.shl=S.shiftLeft,S.shiftRight=function(t){return r(t)&&(t=t.toInt()),0==(t&=63)?this:t<32?l(this.low>>>t|this.high<<32-t,this.high>>t,this.unsigned):l(this.high>>t-32,this.high>=0?0:-1,this.unsigned)},S.shr=S.shiftRight,S.shiftRightUnsigned=function(t){if(r(t)&&(t=t.toInt()),0==(t&=63))return this;var e=this.high;return t<32?l(this.low>>>t|e<<32-t,e>>>t,this.unsigned):l(32===t?e:e>>>t-32,0,this.unsigned)},S.shru=S.shiftRightUnsigned,S.shr_u=S.shiftRightUnsigned,S.toSigned=function(){return this.unsigned?l(this.low,this.high,!1):this},S.toUnsigned=function(){return this.unsigned?this:l(this.low,this.high,!0)},S.toBytes=function(t){return t?this.toBytesLE():this.toBytesBE()},S.toBytesLE=function(){var t=this.high,e=this.low;return[255&e,e>>>8&255,e>>>16&255,e>>>24,255&t,t>>>8&255,t>>>16&255,t>>>24]},S.toBytesBE=function(){var t=this.high,e=this.low;return[t>>>24,t>>>16&255,t>>>8&255,255&t,e>>>24,e>>>16&255,e>>>8&255,255&e]},n.fromBytes=function(t,e,r){return r?n.fromBytesLE(t,e):n.fromBytesBE(t,e)},n.fromBytesLE=function(t,e){return new n(t[0]|t[1]<<8|t[2]<<16|t[3]<<24,t[4]|t[5]<<8|t[6]<<16|t[7]<<24,e)},n.fromBytesBE=function(t,e){return new n(t[4]<<24|t[5]<<16|t[6]<<8|t[7],t[0]<<24|t[1]<<16|t[2]<<8|t[3],e)}},6932:(t,e,n)=>{var r=n(6072),i=n(2611),a=parseInt("0777",8);function s(t,e,n,o){"function"==typeof e?(n=e,e={}):e&&"object"==typeof e||(e={mode:e});var l=e.mode,u=e.fs||i;void 0===l&&(l=a),o||(o=null);var h=n||function(){};t=r.resolve(t),u.mkdir(t,l,(function(n){if(!n)return h(null,o=o||t);if("ENOENT"===n.code){if(r.dirname(t)===t)return h(n);s(r.dirname(t),e,(function(n,r){n?h(n,r):s(t,e,h,r)}))}else u.stat(t,(function(t,e){t||!e.isDirectory()?h(n,o):h(null,o)}))}))}t.exports=s.mkdirp=s.mkdirP=s,s.sync=function t(e,n,s){n&&"object"==typeof n||(n={mode:n});var o=n.mode,l=n.fs||i;void 0===o&&(o=a),s||(s=null),e=r.resolve(e);try{l.mkdirSync(e,o),s=s||e}catch(i){if("ENOENT"===i.code)s=t(r.dirname(e),n,s),t(e,n,s);else{var u;try{u=l.statSync(e)}catch(t){throw i}if(!u.isDirectory())throw i}}return s}},4126:t=>{"use strict";var e=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable;function i(t){if(null==t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}t.exports=function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},n=0;n<10;n++)e["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(e).map((function(t){return e[t]})).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach((function(t){r[t]=t})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(t){return!1}}()?Object.assign:function(t,a){for(var s,o,l=i(t),u=1;u<arguments.length;u++){for(var h in s=Object(arguments[u]))n.call(s,h)&&(l[h]=s[h]);if(e){o=e(s);for(var c=0;c<o.length;c++)r.call(s,o[c])&&(l[o[c]]=s[o[c]])}}return l}},8233:(t,e)=>{"use strict";function n(t,e,n,r){for(var i=t[e++],a=1<<i,s=a+1,o=s+1,l=i+1,u=(1<<l)-1,h=0,c=0,d=0,f=t[e++],p=new Int32Array(4096),m=null;;){for(;h<16&&0!==f;)c|=t[e++]<<h,h+=8,1===f?f=t[e++]:--f;if(h<l)break;var g=c&u;if(c>>=l,h-=l,g!==a){if(g===s)break;for(var b=g<o?g:m,y=0,v=b;v>a;)v=p[v]>>8,++y;var w=v;if(d+y+(b!==g?1:0)>r)return void console.log("Warning, gif stream longer than expected.");n[d++]=w;var _=d+=y;for(b!==g&&(n[d++]=w),v=b;y--;)v=p[v],n[--_]=255&v,v>>=8;null!==m&&o<4096&&(p[o++]=m<<8|w,o>=u+1&&l<12&&(++l,u=u<<1|1)),m=g}else o=s+1,u=(1<<(l=i+1))-1,m=null}return d!==r&&console.log("Warning, gif stream shorter than expected."),n}try{e.GifWriter=function(t,e,n,r){var i=0,a=void 0===(r=void 0===r?{}:r).loop?null:r.loop,s=void 0===r.palette?null:r.palette;if(e<=0||n<=0||e>65535||n>65535)throw new Error("Width/Height invalid.");function o(t){var e=t.length;if(e<2||e>256||e&e-1)throw new Error("Invalid code/color length, must be power of 2 and 2 .. 256.");return e}t[i++]=71,t[i++]=73,t[i++]=70,t[i++]=56,t[i++]=57,t[i++]=97;var l=0,u=0;if(null!==s){for(var h=o(s);h>>=1;)++l;if(h=1<<l,--l,void 0!==r.background){if((u=r.background)>=h)throw new Error("Background index out of range.");if(0===u)throw new Error("Background index explicitly passed as 0.")}}if(t[i++]=255&e,t[i++]=e>>8&255,t[i++]=255&n,t[i++]=n>>8&255,t[i++]=(null!==s?128:0)|l,t[i++]=u,t[i++]=0,null!==s)for(var c=0,d=s.length;c<d;++c){var f=s[c];t[i++]=f>>16&255,t[i++]=f>>8&255,t[i++]=255&f}if(null!==a){if(a<0||a>65535)throw new Error("Loop count invalid.");t[i++]=33,t[i++]=255,t[i++]=11,t[i++]=78,t[i++]=69,t[i++]=84,t[i++]=83,t[i++]=67,t[i++]=65,t[i++]=80,t[i++]=69,t[i++]=50,t[i++]=46,t[i++]=48,t[i++]=3,t[i++]=1,t[i++]=255&a,t[i++]=a>>8&255,t[i++]=0}var p=!1;this.addFrame=function(e,n,r,a,l,u){if(!0===p&&(--i,p=!1),u=void 0===u?{}:u,e<0||n<0||e>65535||n>65535)throw new Error("x/y invalid.");if(r<=0||a<=0||r>65535||a>65535)throw new Error("Width/Height invalid.");if(l.length<r*a)throw new Error("Not enough pixels for the frame size.");var h=!0,c=u.palette;if(null==c&&(h=!1,c=s),null==c)throw new Error("Must supply either a local or global palette.");for(var d=o(c),f=0;d>>=1;)++f;d=1<<f;var m=void 0===u.delay?0:u.delay,g=void 0===u.disposal?0:u.disposal;if(g<0||g>3)throw new Error("Disposal out of range.");var b=!1,y=0;if(void 0!==u.transparent&&null!==u.transparent&&(b=!0,(y=u.transparent)<0||y>=d))throw new Error("Transparent color index.");if((0!==g||b||0!==m)&&(t[i++]=33,t[i++]=249,t[i++]=4,t[i++]=g<<2|(!0===b?1:0),t[i++]=255&m,t[i++]=m>>8&255,t[i++]=y,t[i++]=0),t[i++]=44,t[i++]=255&e,t[i++]=e>>8&255,t[i++]=255&n,t[i++]=n>>8&255,t[i++]=255&r,t[i++]=r>>8&255,t[i++]=255&a,t[i++]=a>>8&255,t[i++]=!0===h?128|f-1:0,!0===h)for(var v=0,w=c.length;v<w;++v){var _=c[v];t[i++]=_>>16&255,t[i++]=_>>8&255,t[i++]=255&_}return i=function(t,e,n,r){t[e++]=n;var i=e++,a=1<<n,s=a-1,o=a+1,l=o+1,u=n+1,h=0,c=0;function d(n){for(;h>=n;)t[e++]=255&c,c>>=8,h-=8,e===i+256&&(t[i]=255,i=e++)}function f(t){c|=t<<h,h+=u,d(8)}var p=r[0]&s,m={};f(a);for(var g=1,b=r.length;g<b;++g){var y=r[g]&s,v=p<<8|y,w=m[v];if(void 0===w){for(c|=p<<h,h+=u;h>=8;)t[e++]=255&c,c>>=8,h-=8,e===i+256&&(t[i]=255,i=e++);4096===l?(f(a),l=o+1,u=n+1,m={}):(l>=1<<u&&++u,m[v]=l++),p=y}else p=w}return f(p),f(o),d(1),i+1===e?t[i]=0:(t[i]=e-i-1,t[e++]=0),e}(t,i,f<2?2:f,l),i},this.end=function(){return!1===p&&(t[i++]=59,p=!0),i},this.getOutputBuffer=function(){return t},this.setOutputBuffer=function(e){t=e},this.getOutputBufferPosition=function(){return i},this.setOutputBufferPosition=function(t){i=t}},e.GifReader=function(t){var e=0;if(71!==t[e++]||73!==t[e++]||70!==t[e++]||56!==t[e++]||56!=(t[e++]+1&253)||97!==t[e++])throw new Error("Invalid GIF 87a/89a header.");var r=t[e++]|t[e++]<<8,i=t[e++]|t[e++]<<8,a=t[e++],s=a>>7,o=1<<1+(7&a);t[e++],t[e++];var l=null,u=null;s&&(l=e,u=o,e+=3*o);var h=!0,c=[],d=0,f=null,p=0,m=null;for(this.width=r,this.height=i;h&&e<t.length;)switch(t[e++]){case 33:switch(t[e++]){case 255:if(11!==t[e]||78==t[e+1]&&69==t[e+2]&&84==t[e+3]&&83==t[e+4]&&67==t[e+5]&&65==t[e+6]&&80==t[e+7]&&69==t[e+8]&&50==t[e+9]&&46==t[e+10]&&48==t[e+11]&&3==t[e+12]&&1==t[e+13]&&0==t[e+16])e+=14,m=t[e++]|t[e++]<<8,e++;else for(e+=12;;){if(!((M=t[e++])>=0))throw Error("Invalid block size");if(0===M)break;e+=M}break;case 249:if(4!==t[e++]||0!==t[e+4])throw new Error("Invalid graphics extension block.");var g=t[e++];d=t[e++]|t[e++]<<8,f=t[e++],0==(1&g)&&(f=null),p=g>>2&7,e++;break;case 254:for(;;){if(!((M=t[e++])>=0))throw Error("Invalid block size");if(0===M)break;e+=M}break;default:throw new Error("Unknown graphic control label: 0x"+t[e-1].toString(16))}break;case 44:var b=t[e++]|t[e++]<<8,y=t[e++]|t[e++]<<8,v=t[e++]|t[e++]<<8,w=t[e++]|t[e++]<<8,_=t[e++],k=_>>6&1,x=1<<1+(7&_),S=l,E=u,I=!1;_>>7&&(I=!0,S=e,E=x,e+=3*x);var A=e;for(e++;;){var M;if(!((M=t[e++])>=0))throw Error("Invalid block size");if(0===M)break;e+=M}c.push({x:b,y,width:v,height:w,has_local_palette:I,palette_offset:S,palette_size:E,data_offset:A,data_length:e-A,transparent_index:f,interlaced:!!k,delay:d,disposal:p});break;case 59:h=!1;break;default:throw new Error("Unknown gif block: 0x"+t[e-1].toString(16))}this.numFrames=function(){return c.length},this.loopCount=function(){return m},this.frameInfo=function(t){if(t<0||t>=c.length)throw new Error("Frame index out of range.");return c[t]},this.decodeAndBlitFrameBGRA=function(e,i){var a=this.frameInfo(e),s=a.width*a.height,o=new Uint8Array(s);n(t,a.data_offset,o,s);var l=a.palette_offset,u=a.transparent_index;null===u&&(u=256);var h=a.width,c=r-h,d=h,f=4*(a.y*r+a.x),p=4*((a.y+a.height)*r+a.x),m=f,g=4*c;!0===a.interlaced&&(g+=4*r*7);for(var b=8,y=0,v=o.length;y<v;++y){var w=o[y];if(0===d&&(d=h,(m+=g)>=p&&(g=4*c+4*r*(b-1),m=f+(h+c)*(b<<1),b>>=1)),w===u)m+=4;else{var _=t[l+3*w],k=t[l+3*w+1],x=t[l+3*w+2];i[m++]=x,i[m++]=k,i[m++]=_,i[m++]=255}--d}},this.decodeAndBlitFrameRGBA=function(e,i){var a=this.frameInfo(e),s=a.width*a.height,o=new Uint8Array(s);n(t,a.data_offset,o,s);var l=a.palette_offset,u=a.transparent_index;null===u&&(u=256);var h=a.width,c=r-h,d=h,f=4*(a.y*r+a.x),p=4*((a.y+a.height)*r+a.x),m=f,g=4*c;!0===a.interlaced&&(g+=4*r*7);for(var b=8,y=0,v=o.length;y<v;++y){var w=o[y];if(0===d&&(d=h,(m+=g)>=p&&(g=4*c+4*r*(b-1),m=f+(h+c)*(b<<1),b>>=1)),w===u)m+=4;else{var _=t[l+3*w],k=t[l+3*w+1],x=t[l+3*w+2];i[m++]=_,i[m++]=k,i[m++]=x,i[m++]=255}--d}}}}catch(t){}},2911:(t,e,n)=>{"use strict";var r={};(0,n(4491).assign)(r,n(700),n(8479),n(1537)),t.exports=r},700:(t,e,n)=>{"use strict";var r=n(7930),i=n(4491),a=n(3317),s=n(2116),o=n(2716),l=Object.prototype.toString;function u(t){if(!(this instanceof u))return new u(t);this.options=i.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},t||{});var e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new o,this.strm.avail_out=0;var n=r.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(0!==n)throw new Error(s[n]);if(e.header&&r.deflateSetHeader(this.strm,e.header),e.dictionary){var h;if(h="string"==typeof e.dictionary?a.string2buf(e.dictionary):"[object ArrayBuffer]"===l.call(e.dictionary)?new Uint8Array(e.dictionary):e.dictionary,0!==(n=r.deflateSetDictionary(this.strm,h)))throw new Error(s[n]);this._dict_set=!0}}function h(t,e){var n=new u(e);if(n.push(t,!0),n.err)throw n.msg||s[n.err];return n.result}u.prototype.push=function(t,e){var n,s,o=this.strm,u=this.options.chunkSize;if(this.ended)return!1;s=e===~~e?e:!0===e?4:0,"string"==typeof t?o.input=a.string2buf(t):"[object ArrayBuffer]"===l.call(t)?o.input=new Uint8Array(t):o.input=t,o.next_in=0,o.avail_in=o.input.length;do{if(0===o.avail_out&&(o.output=new i.Buf8(u),o.next_out=0,o.avail_out=u),1!==(n=r.deflate(o,s))&&0!==n)return this.onEnd(n),this.ended=!0,!1;0!==o.avail_out&&(0!==o.avail_in||4!==s&&2!==s)||("string"===this.options.to?this.onData(a.buf2binstring(i.shrinkBuf(o.output,o.next_out))):this.onData(i.shrinkBuf(o.output,o.next_out)))}while((o.avail_in>0||0===o.avail_out)&&1!==n);return 4===s?(n=r.deflateEnd(this.strm),this.onEnd(n),this.ended=!0,0===n):2!==s||(this.onEnd(0),o.avail_out=0,!0)},u.prototype.onData=function(t){this.chunks.push(t)},u.prototype.onEnd=function(t){0===t&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},e.Deflate=u,e.deflate=h,e.deflateRaw=function(t,e){return(e=e||{}).raw=!0,h(t,e)},e.gzip=function(t,e){return(e=e||{}).gzip=!0,h(t,e)}},8479:(t,e,n)=>{"use strict";var r=n(3775),i=n(4491),a=n(3317),s=n(1537),o=n(2116),l=n(2716),u=n(1789),h=Object.prototype.toString;function c(t){if(!(this instanceof c))return new c(t);this.options=i.assign({chunkSize:16384,windowBits:0,to:""},t||{});var e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,0===e.windowBits&&(e.windowBits=-15)),!(e.windowBits>=0&&e.windowBits<16)||t&&t.windowBits||(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&0==(15&e.windowBits)&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new l,this.strm.avail_out=0;var n=r.inflateInit2(this.strm,e.windowBits);if(n!==s.Z_OK)throw new Error(o[n]);if(this.header=new u,r.inflateGetHeader(this.strm,this.header),e.dictionary&&("string"==typeof e.dictionary?e.dictionary=a.string2buf(e.dictionary):"[object ArrayBuffer]"===h.call(e.dictionary)&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(n=r.inflateSetDictionary(this.strm,e.dictionary))!==s.Z_OK))throw new Error(o[n])}function d(t,e){var n=new c(e);if(n.push(t,!0),n.err)throw n.msg||o[n.err];return n.result}c.prototype.push=function(t,e){var n,o,l,u,c,d=this.strm,f=this.options.chunkSize,p=this.options.dictionary,m=!1;if(this.ended)return!1;o=e===~~e?e:!0===e?s.Z_FINISH:s.Z_NO_FLUSH,"string"==typeof t?d.input=a.binstring2buf(t):"[object ArrayBuffer]"===h.call(t)?d.input=new Uint8Array(t):d.input=t,d.next_in=0,d.avail_in=d.input.length;do{if(0===d.avail_out&&(d.output=new i.Buf8(f),d.next_out=0,d.avail_out=f),(n=r.inflate(d,s.Z_NO_FLUSH))===s.Z_NEED_DICT&&p&&(n=r.inflateSetDictionary(this.strm,p)),n===s.Z_BUF_ERROR&&!0===m&&(n=s.Z_OK,m=!1),n!==s.Z_STREAM_END&&n!==s.Z_OK)return this.onEnd(n),this.ended=!0,!1;d.next_out&&(0!==d.avail_out&&n!==s.Z_STREAM_END&&(0!==d.avail_in||o!==s.Z_FINISH&&o!==s.Z_SYNC_FLUSH)||("string"===this.options.to?(l=a.utf8border(d.output,d.next_out),u=d.next_out-l,c=a.buf2string(d.output,l),d.next_out=u,d.avail_out=f-u,u&&i.arraySet(d.output,d.output,l,u,0),this.onData(c)):this.onData(i.shrinkBuf(d.output,d.next_out)))),0===d.avail_in&&0===d.avail_out&&(m=!0)}while((d.avail_in>0||0===d.avail_out)&&n!==s.Z_STREAM_END);return n===s.Z_STREAM_END&&(o=s.Z_FINISH),o===s.Z_FINISH?(n=r.inflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===s.Z_OK):o!==s.Z_SYNC_FLUSH||(this.onEnd(s.Z_OK),d.avail_out=0,!0)},c.prototype.onData=function(t){this.chunks.push(t)},c.prototype.onEnd=function(t){t===s.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},e.Inflate=c,e.inflate=d,e.inflateRaw=function(t,e){return(e=e||{}).raw=!0,d(t,e)},e.ungzip=d},4491:(t,e)=>{"use strict";var n="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;function r(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.assign=function(t){for(var e=Array.prototype.slice.call(arguments,1);e.length;){var n=e.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(var i in n)r(n,i)&&(t[i]=n[i])}}return t},e.shrinkBuf=function(t,e){return t.length===e?t:t.subarray?t.subarray(0,e):(t.length=e,t)};var i={arraySet:function(t,e,n,r,i){if(e.subarray&&t.subarray)t.set(e.subarray(n,n+r),i);else for(var a=0;a<r;a++)t[i+a]=e[n+a]},flattenChunks:function(t){var e,n,r,i,a,s;for(r=0,e=0,n=t.length;e<n;e++)r+=t[e].length;for(s=new Uint8Array(r),i=0,e=0,n=t.length;e<n;e++)a=t[e],s.set(a,i),i+=a.length;return s}},a={arraySet:function(t,e,n,r,i){for(var a=0;a<r;a++)t[i+a]=e[n+a]},flattenChunks:function(t){return[].concat.apply([],t)}};e.setTyped=function(t){t?(e.Buf8=Uint8Array,e.Buf16=Uint16Array,e.Buf32=Int32Array,e.assign(e,i)):(e.Buf8=Array,e.Buf16=Array,e.Buf32=Array,e.assign(e,a))},e.setTyped(n)},3317:(t,e,n)=>{"use strict";var r=n(4491),i=!0,a=!0;try{String.fromCharCode.apply(null,[0])}catch(t){i=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(t){a=!1}for(var s=new r.Buf8(256),o=0;o<256;o++)s[o]=o>=252?6:o>=248?5:o>=240?4:o>=224?3:o>=192?2:1;function l(t,e){if(e<65534&&(t.subarray&&a||!t.subarray&&i))return String.fromCharCode.apply(null,r.shrinkBuf(t,e));for(var n="",s=0;s<e;s++)n+=String.fromCharCode(t[s]);return n}s[254]=s[254]=1,e.string2buf=function(t){var e,n,i,a,s,o=t.length,l=0;for(a=0;a<o;a++)55296==(64512&(n=t.charCodeAt(a)))&&a+1<o&&56320==(64512&(i=t.charCodeAt(a+1)))&&(n=65536+(n-55296<<10)+(i-56320),a++),l+=n<128?1:n<2048?2:n<65536?3:4;for(e=new r.Buf8(l),s=0,a=0;s<l;a++)55296==(64512&(n=t.charCodeAt(a)))&&a+1<o&&56320==(64512&(i=t.charCodeAt(a+1)))&&(n=65536+(n-55296<<10)+(i-56320),a++),n<128?e[s++]=n:n<2048?(e[s++]=192|n>>>6,e[s++]=128|63&n):n<65536?(e[s++]=224|n>>>12,e[s++]=128|n>>>6&63,e[s++]=128|63&n):(e[s++]=240|n>>>18,e[s++]=128|n>>>12&63,e[s++]=128|n>>>6&63,e[s++]=128|63&n);return e},e.buf2binstring=function(t){return l(t,t.length)},e.binstring2buf=function(t){for(var e=new r.Buf8(t.length),n=0,i=e.length;n<i;n++)e[n]=t.charCodeAt(n);return e},e.buf2string=function(t,e){var n,r,i,a,o=e||t.length,u=new Array(2*o);for(r=0,n=0;n<o;)if((i=t[n++])<128)u[r++]=i;else if((a=s[i])>4)u[r++]=65533,n+=a-1;else{for(i&=2===a?31:3===a?15:7;a>1&&n<o;)i=i<<6|63&t[n++],a--;a>1?u[r++]=65533:i<65536?u[r++]=i:(i-=65536,u[r++]=55296|i>>10&1023,u[r++]=56320|1023&i)}return l(u,r)},e.utf8border=function(t,e){var n;for((e=e||t.length)>t.length&&(e=t.length),n=e-1;n>=0&&128==(192&t[n]);)n--;return n<0||0===n?e:n+s[t[n]]>e?n:e}},2818:t=>{"use strict";t.exports=function(t,e,n,r){for(var i=65535&t|0,a=t>>>16&65535|0,s=0;0!==n;){n-=s=n>2e3?2e3:n;do{a=a+(i=i+e[r++]|0)|0}while(--s);i%=65521,a%=65521}return i|a<<16|0}},1537:t=>{"use strict";t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},8400:t=>{"use strict";var e=function(){for(var t,e=[],n=0;n<256;n++){t=n;for(var r=0;r<8;r++)t=1&t?3988292384^t>>>1:t>>>1;e[n]=t}return e}();t.exports=function(t,n,r,i){var a=e,s=i+r;t^=-1;for(var o=i;o<s;o++)t=t>>>8^a[255&(t^n[o])];return-1^t}},7930:(t,e,n)=>{"use strict";var r,i=n(4491),a=n(2509),s=n(2818),o=n(8400),l=n(2116),u=-2,h=258,c=262,d=103,f=113,p=666;function m(t,e){return t.msg=l[e],e}function g(t){return(t<<1)-(t>4?9:0)}function b(t){for(var e=t.length;--e>=0;)t[e]=0}function y(t){var e=t.state,n=e.pending;n>t.avail_out&&(n=t.avail_out),0!==n&&(i.arraySet(t.output,e.pending_buf,e.pending_out,n,t.next_out),t.next_out+=n,e.pending_out+=n,t.total_out+=n,t.avail_out-=n,e.pending-=n,0===e.pending&&(e.pending_out=0))}function v(t,e){a._tr_flush_block(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,y(t.strm)}function w(t,e){t.pending_buf[t.pending++]=e}function _(t,e){t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=255&e}function k(t,e){var n,r,i=t.max_chain_length,a=t.strstart,s=t.prev_length,o=t.nice_match,l=t.strstart>t.w_size-c?t.strstart-(t.w_size-c):0,u=t.window,d=t.w_mask,f=t.prev,p=t.strstart+h,m=u[a+s-1],g=u[a+s];t.prev_length>=t.good_match&&(i>>=2),o>t.lookahead&&(o=t.lookahead);do{if(u[(n=e)+s]===g&&u[n+s-1]===m&&u[n]===u[a]&&u[++n]===u[a+1]){a+=2,n++;do{}while(u[++a]===u[++n]&&u[++a]===u[++n]&&u[++a]===u[++n]&&u[++a]===u[++n]&&u[++a]===u[++n]&&u[++a]===u[++n]&&u[++a]===u[++n]&&u[++a]===u[++n]&&a<p);if(r=h-(p-a),a=p-h,r>s){if(t.match_start=e,s=r,r>=o)break;m=u[a+s-1],g=u[a+s]}}}while((e=f[e&d])>l&&0!=--i);return s<=t.lookahead?s:t.lookahead}function x(t){var e,n,r,a,l,u,h,d,f,p,m=t.w_size;do{if(a=t.window_size-t.lookahead-t.strstart,t.strstart>=m+(m-c)){i.arraySet(t.window,t.window,m,m,0),t.match_start-=m,t.strstart-=m,t.block_start-=m,e=n=t.hash_size;do{r=t.head[--e],t.head[e]=r>=m?r-m:0}while(--n);e=n=m;do{r=t.prev[--e],t.prev[e]=r>=m?r-m:0}while(--n);a+=m}if(0===t.strm.avail_in)break;if(u=t.strm,h=t.window,d=t.strstart+t.lookahead,f=a,p=void 0,(p=u.avail_in)>f&&(p=f),n=0===p?0:(u.avail_in-=p,i.arraySet(h,u.input,u.next_in,p,d),1===u.state.wrap?u.adler=s(u.adler,h,p,d):2===u.state.wrap&&(u.adler=o(u.adler,h,p,d)),u.next_in+=p,u.total_in+=p,p),t.lookahead+=n,t.lookahead+t.insert>=3)for(l=t.strstart-t.insert,t.ins_h=t.window[l],t.ins_h=(t.ins_h<<t.hash_shift^t.window[l+1])&t.hash_mask;t.insert&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[l+3-1])&t.hash_mask,t.prev[l&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=l,l++,t.insert--,!(t.lookahead+t.insert<3)););}while(t.lookahead<c&&0!==t.strm.avail_in)}function S(t,e){for(var n,r;;){if(t.lookahead<c){if(x(t),t.lookahead<c&&0===e)return 1;if(0===t.lookahead)break}if(n=0,t.lookahead>=3&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+3-1])&t.hash_mask,n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!==n&&t.strstart-n<=t.w_size-c&&(t.match_length=k(t,n)),t.match_length>=3)if(r=a._tr_tally(t,t.strstart-t.match_start,t.match_length-3),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=3){t.match_length--;do{t.strstart++,t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+3-1])&t.hash_mask,n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart}while(0!=--t.match_length);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+1])&t.hash_mask;else r=a._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(r&&(v(t,!1),0===t.strm.avail_out))return 1}return t.insert=t.strstart<2?t.strstart:2,4===e?(v(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(v(t,!1),0===t.strm.avail_out)?1:2}function E(t,e){for(var n,r,i;;){if(t.lookahead<c){if(x(t),t.lookahead<c&&0===e)return 1;if(0===t.lookahead)break}if(n=0,t.lookahead>=3&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+3-1])&t.hash_mask,n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=2,0!==n&&t.prev_length<t.max_lazy_match&&t.strstart-n<=t.w_size-c&&(t.match_length=k(t,n),t.match_length<=5&&(1===t.strategy||3===t.match_length&&t.strstart-t.match_start>4096)&&(t.match_length=2)),t.prev_length>=3&&t.match_length<=t.prev_length){i=t.strstart+t.lookahead-3,r=a._tr_tally(t,t.strstart-1-t.prev_match,t.prev_length-3),t.lookahead-=t.prev_length-1,t.prev_length-=2;do{++t.strstart<=i&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+3-1])&t.hash_mask,n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart)}while(0!=--t.prev_length);if(t.match_available=0,t.match_length=2,t.strstart++,r&&(v(t,!1),0===t.strm.avail_out))return 1}else if(t.match_available){if((r=a._tr_tally(t,0,t.window[t.strstart-1]))&&v(t,!1),t.strstart++,t.lookahead--,0===t.strm.avail_out)return 1}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(r=a._tr_tally(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<2?t.strstart:2,4===e?(v(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(v(t,!1),0===t.strm.avail_out)?1:2}function I(t,e,n,r,i){this.good_length=t,this.max_lazy=e,this.nice_length=n,this.max_chain=r,this.func=i}function A(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new i.Buf16(1146),this.dyn_dtree=new i.Buf16(122),this.bl_tree=new i.Buf16(78),b(this.dyn_ltree),b(this.dyn_dtree),b(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new i.Buf16(16),this.heap=new i.Buf16(573),b(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new i.Buf16(573),b(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function M(t){var e;return t&&t.state?(t.total_in=t.total_out=0,t.data_type=2,(e=t.state).pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap?42:f,t.adler=2===e.wrap?0:1,e.last_flush=0,a._tr_init(e),0):m(t,u)}function T(t){var e,n=M(t);return 0===n&&((e=t.state).window_size=2*e.w_size,b(e.head),e.max_lazy_match=r[e.level].max_lazy,e.good_match=r[e.level].good_length,e.nice_match=r[e.level].nice_length,e.max_chain_length=r[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=2,e.match_available=0,e.ins_h=0),n}function N(t,e,n,r,a,s){if(!t)return u;var o=1;if(-1===e&&(e=6),r<0?(o=0,r=-r):r>15&&(o=2,r-=16),a<1||a>9||8!==n||r<8||r>15||e<0||e>9||s<0||s>4)return m(t,u);8===r&&(r=9);var l=new A;return t.state=l,l.strm=t,l.wrap=o,l.gzhead=null,l.w_bits=r,l.w_size=1<<l.w_bits,l.w_mask=l.w_size-1,l.hash_bits=a+7,l.hash_size=1<<l.hash_bits,l.hash_mask=l.hash_size-1,l.hash_shift=~~((l.hash_bits+3-1)/3),l.window=new i.Buf8(2*l.w_size),l.head=new i.Buf16(l.hash_size),l.prev=new i.Buf16(l.w_size),l.lit_bufsize=1<<a+6,l.pending_buf_size=4*l.lit_bufsize,l.pending_buf=new i.Buf8(l.pending_buf_size),l.d_buf=1*l.lit_bufsize,l.l_buf=3*l.lit_bufsize,l.level=e,l.strategy=s,l.method=n,T(t)}r=[new I(0,0,0,0,(function(t,e){var n=65535;for(n>t.pending_buf_size-5&&(n=t.pending_buf_size-5);;){if(t.lookahead<=1){if(x(t),0===t.lookahead&&0===e)return 1;if(0===t.lookahead)break}t.strstart+=t.lookahead,t.lookahead=0;var r=t.block_start+n;if((0===t.strstart||t.strstart>=r)&&(t.lookahead=t.strstart-r,t.strstart=r,v(t,!1),0===t.strm.avail_out))return 1;if(t.strstart-t.block_start>=t.w_size-c&&(v(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,4===e?(v(t,!0),0===t.strm.avail_out?3:4):(t.strstart>t.block_start&&(v(t,!1),t.strm.avail_out),1)})),new I(4,4,8,4,S),new I(4,5,16,8,S),new I(4,6,32,32,S),new I(4,4,16,16,E),new I(8,16,32,32,E),new I(8,16,128,128,E),new I(8,32,128,256,E),new I(32,128,258,1024,E),new I(32,258,258,4096,E)],e.deflateInit=function(t,e){return N(t,e,8,15,8,0)},e.deflateInit2=N,e.deflateReset=T,e.deflateResetKeep=M,e.deflateSetHeader=function(t,e){return t&&t.state?2!==t.state.wrap?u:(t.state.gzhead=e,0):u},e.deflate=function(t,e){var n,i,s,l;if(!t||!t.state||e>5||e<0)return t?m(t,u):u;if(i=t.state,!t.output||!t.input&&0!==t.avail_in||i.status===p&&4!==e)return m(t,0===t.avail_out?-5:u);if(i.strm=t,n=i.last_flush,i.last_flush=e,42===i.status)if(2===i.wrap)t.adler=0,w(i,31),w(i,139),w(i,8),i.gzhead?(w(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),w(i,255&i.gzhead.time),w(i,i.gzhead.time>>8&255),w(i,i.gzhead.time>>16&255),w(i,i.gzhead.time>>24&255),w(i,9===i.level?2:i.strategy>=2||i.level<2?4:0),w(i,255&i.gzhead.os),i.gzhead.extra&&i.gzhead.extra.length&&(w(i,255&i.gzhead.extra.length),w(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(t.adler=o(t.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=69):(w(i,0),w(i,0),w(i,0),w(i,0),w(i,0),w(i,9===i.level?2:i.strategy>=2||i.level<2?4:0),w(i,3),i.status=f);else{var c=8+(i.w_bits-8<<4)<<8;c|=(i.strategy>=2||i.level<2?0:i.level<6?1:6===i.level?2:3)<<6,0!==i.strstart&&(c|=32),c+=31-c%31,i.status=f,_(i,c),0!==i.strstart&&(_(i,t.adler>>>16),_(i,65535&t.adler)),t.adler=1}if(69===i.status)if(i.gzhead.extra){for(s=i.pending;i.gzindex<(65535&i.gzhead.extra.length)&&(i.pending!==i.pending_buf_size||(i.gzhead.hcrc&&i.pending>s&&(t.adler=o(t.adler,i.pending_buf,i.pending-s,s)),y(t),s=i.pending,i.pending!==i.pending_buf_size));)w(i,255&i.gzhead.extra[i.gzindex]),i.gzindex++;i.gzhead.hcrc&&i.pending>s&&(t.adler=o(t.adler,i.pending_buf,i.pending-s,s)),i.gzindex===i.gzhead.extra.length&&(i.gzindex=0,i.status=73)}else i.status=73;if(73===i.status)if(i.gzhead.name){s=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>s&&(t.adler=o(t.adler,i.pending_buf,i.pending-s,s)),y(t),s=i.pending,i.pending===i.pending_buf_size)){l=1;break}l=i.gzindex<i.gzhead.name.length?255&i.gzhead.name.charCodeAt(i.gzindex++):0,w(i,l)}while(0!==l);i.gzhead.hcrc&&i.pending>s&&(t.adler=o(t.adler,i.pending_buf,i.pending-s,s)),0===l&&(i.gzindex=0,i.status=91)}else i.status=91;if(91===i.status)if(i.gzhead.comment){s=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>s&&(t.adler=o(t.adler,i.pending_buf,i.pending-s,s)),y(t),s=i.pending,i.pending===i.pending_buf_size)){l=1;break}l=i.gzindex<i.gzhead.comment.length?255&i.gzhead.comment.charCodeAt(i.gzindex++):0,w(i,l)}while(0!==l);i.gzhead.hcrc&&i.pending>s&&(t.adler=o(t.adler,i.pending_buf,i.pending-s,s)),0===l&&(i.status=d)}else i.status=d;if(i.status===d&&(i.gzhead.hcrc?(i.pending+2>i.pending_buf_size&&y(t),i.pending+2<=i.pending_buf_size&&(w(i,255&t.adler),w(i,t.adler>>8&255),t.adler=0,i.status=f)):i.status=f),0!==i.pending){if(y(t),0===t.avail_out)return i.last_flush=-1,0}else if(0===t.avail_in&&g(e)<=g(n)&&4!==e)return m(t,-5);if(i.status===p&&0!==t.avail_in)return m(t,-5);if(0!==t.avail_in||0!==i.lookahead||0!==e&&i.status!==p){var k=2===i.strategy?function(t,e){for(var n;;){if(0===t.lookahead&&(x(t),0===t.lookahead)){if(0===e)return 1;break}if(t.match_length=0,n=a._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,n&&(v(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,4===e?(v(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(v(t,!1),0===t.strm.avail_out)?1:2}(i,e):3===i.strategy?function(t,e){for(var n,r,i,s,o=t.window;;){if(t.lookahead<=h){if(x(t),t.lookahead<=h&&0===e)return 1;if(0===t.lookahead)break}if(t.match_length=0,t.lookahead>=3&&t.strstart>0&&(r=o[i=t.strstart-1])===o[++i]&&r===o[++i]&&r===o[++i]){s=t.strstart+h;do{}while(r===o[++i]&&r===o[++i]&&r===o[++i]&&r===o[++i]&&r===o[++i]&&r===o[++i]&&r===o[++i]&&r===o[++i]&&i<s);t.match_length=h-(s-i),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=3?(n=a._tr_tally(t,1,t.match_length-3),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(n=a._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),n&&(v(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,4===e?(v(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(v(t,!1),0===t.strm.avail_out)?1:2}(i,e):r[i.level].func(i,e);if(3!==k&&4!==k||(i.status=p),1===k||3===k)return 0===t.avail_out&&(i.last_flush=-1),0;if(2===k&&(1===e?a._tr_align(i):5!==e&&(a._tr_stored_block(i,0,0,!1),3===e&&(b(i.head),0===i.lookahead&&(i.strstart=0,i.block_start=0,i.insert=0))),y(t),0===t.avail_out))return i.last_flush=-1,0}return 4!==e?0:i.wrap<=0?1:(2===i.wrap?(w(i,255&t.adler),w(i,t.adler>>8&255),w(i,t.adler>>16&255),w(i,t.adler>>24&255),w(i,255&t.total_in),w(i,t.total_in>>8&255),w(i,t.total_in>>16&255),w(i,t.total_in>>24&255)):(_(i,t.adler>>>16),_(i,65535&t.adler)),y(t),i.wrap>0&&(i.wrap=-i.wrap),0!==i.pending?0:1)},e.deflateEnd=function(t){var e;return t&&t.state?42!==(e=t.state.status)&&69!==e&&73!==e&&91!==e&&e!==d&&e!==f&&e!==p?m(t,u):(t.state=null,e===f?m(t,-3):0):u},e.deflateSetDictionary=function(t,e){var n,r,a,o,l,h,c,d,f=e.length;if(!t||!t.state)return u;if(2===(o=(n=t.state).wrap)||1===o&&42!==n.status||n.lookahead)return u;for(1===o&&(t.adler=s(t.adler,e,f,0)),n.wrap=0,f>=n.w_size&&(0===o&&(b(n.head),n.strstart=0,n.block_start=0,n.insert=0),d=new i.Buf8(n.w_size),i.arraySet(d,e,f-n.w_size,n.w_size,0),e=d,f=n.w_size),l=t.avail_in,h=t.next_in,c=t.input,t.avail_in=f,t.next_in=0,t.input=e,x(n);n.lookahead>=3;){r=n.strstart,a=n.lookahead-2;do{n.ins_h=(n.ins_h<<n.hash_shift^n.window[r+3-1])&n.hash_mask,n.prev[r&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=r,r++}while(--a);n.strstart=r,n.lookahead=2,x(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=2,n.match_available=0,t.next_in=h,t.input=c,t.avail_in=l,n.wrap=o,0},e.deflateInfo="pako deflate (from Nodeca project)"},1789:t=>{"use strict";t.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},3222:t=>{"use strict";t.exports=function(t,e){var n,r,i,a,s,o,l,u,h,c,d,f,p,m,g,b,y,v,w,_,k,x,S,E,I;n=t.state,r=t.next_in,E=t.input,i=r+(t.avail_in-5),a=t.next_out,I=t.output,s=a-(e-t.avail_out),o=a+(t.avail_out-257),l=n.dmax,u=n.wsize,h=n.whave,c=n.wnext,d=n.window,f=n.hold,p=n.bits,m=n.lencode,g=n.distcode,b=(1<<n.lenbits)-1,y=(1<<n.distbits)-1;t:do{p<15&&(f+=E[r++]<<p,p+=8,f+=E[r++]<<p,p+=8),v=m[f&b];e:for(;;){if(f>>>=w=v>>>24,p-=w,0==(w=v>>>16&255))I[a++]=65535&v;else{if(!(16&w)){if(0==(64&w)){v=m[(65535&v)+(f&(1<<w)-1)];continue e}if(32&w){n.mode=12;break t}t.msg="invalid literal/length code",n.mode=30;break t}_=65535&v,(w&=15)&&(p<w&&(f+=E[r++]<<p,p+=8),_+=f&(1<<w)-1,f>>>=w,p-=w),p<15&&(f+=E[r++]<<p,p+=8,f+=E[r++]<<p,p+=8),v=g[f&y];n:for(;;){if(f>>>=w=v>>>24,p-=w,!(16&(w=v>>>16&255))){if(0==(64&w)){v=g[(65535&v)+(f&(1<<w)-1)];continue n}t.msg="invalid distance code",n.mode=30;break t}if(k=65535&v,p<(w&=15)&&(f+=E[r++]<<p,(p+=8)<w&&(f+=E[r++]<<p,p+=8)),(k+=f&(1<<w)-1)>l){t.msg="invalid distance too far back",n.mode=30;break t}if(f>>>=w,p-=w,k>(w=a-s)){if((w=k-w)>h&&n.sane){t.msg="invalid distance too far back",n.mode=30;break t}if(x=0,S=d,0===c){if(x+=u-w,w<_){_-=w;do{I[a++]=d[x++]}while(--w);x=a-k,S=I}}else if(c<w){if(x+=u+c-w,(w-=c)<_){_-=w;do{I[a++]=d[x++]}while(--w);if(x=0,c<_){_-=w=c;do{I[a++]=d[x++]}while(--w);x=a-k,S=I}}}else if(x+=c-w,w<_){_-=w;do{I[a++]=d[x++]}while(--w);x=a-k,S=I}for(;_>2;)I[a++]=S[x++],I[a++]=S[x++],I[a++]=S[x++],_-=3;_&&(I[a++]=S[x++],_>1&&(I[a++]=S[x++]))}else{x=a-k;do{I[a++]=I[x++],I[a++]=I[x++],I[a++]=I[x++],_-=3}while(_>2);_&&(I[a++]=I[x++],_>1&&(I[a++]=I[x++]))}break}}break}}while(r<i&&a<o);r-=_=p>>3,f&=(1<<(p-=_<<3))-1,t.next_in=r,t.next_out=a,t.avail_in=r<i?i-r+5:5-(r-i),t.avail_out=a<o?o-a+257:257-(a-o),n.hold=f,n.bits=p}},3775:(t,e,n)=>{"use strict";var r=n(4491),i=n(2818),a=n(8400),s=n(3222),o=n(2030),l=-2,u=12,h=30;function c(t){return(t>>>24&255)+(t>>>8&65280)+((65280&t)<<8)+((255&t)<<24)}function d(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new r.Buf16(320),this.work=new r.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function f(t){var e;return t&&t.state?(e=t.state,t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=1&e.wrap),e.mode=1,e.last=0,e.havedict=0,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new r.Buf32(852),e.distcode=e.distdyn=new r.Buf32(592),e.sane=1,e.back=-1,0):l}function p(t){var e;return t&&t.state?((e=t.state).wsize=0,e.whave=0,e.wnext=0,f(t)):l}function m(t,e){var n,r;return t&&t.state?(r=t.state,e<0?(n=0,e=-e):(n=1+(e>>4),e<48&&(e&=15)),e&&(e<8||e>15)?l:(null!==r.window&&r.wbits!==e&&(r.window=null),r.wrap=n,r.wbits=e,p(t))):l}function g(t,e){var n,r;return t?(r=new d,t.state=r,r.window=null,0!==(n=m(t,e))&&(t.state=null),n):l}var b,y,v=!0;function w(t){if(v){var e;for(b=new r.Buf32(512),y=new r.Buf32(32),e=0;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(o(1,t.lens,0,288,b,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;o(2,t.lens,0,32,y,0,t.work,{bits:5}),v=!1}t.lencode=b,t.lenbits=9,t.distcode=y,t.distbits=5}function _(t,e,n,i){var a,s=t.state;return null===s.window&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new r.Buf8(s.wsize)),i>=s.wsize?(r.arraySet(s.window,e,n-s.wsize,s.wsize,0),s.wnext=0,s.whave=s.wsize):((a=s.wsize-s.wnext)>i&&(a=i),r.arraySet(s.window,e,n-i,a,s.wnext),(i-=a)?(r.arraySet(s.window,e,n-i,i,0),s.wnext=i,s.whave=s.wsize):(s.wnext+=a,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=a))),0}e.inflateReset=p,e.inflateReset2=m,e.inflateResetKeep=f,e.inflateInit=function(t){return g(t,15)},e.inflateInit2=g,e.inflate=function(t,e){var n,d,f,p,m,g,b,y,v,k,x,S,E,I,A,M,T,N,C,R,O,D,z,B,F=0,P=new r.Buf8(4),L=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!t||!t.state||!t.output||!t.input&&0!==t.avail_in)return l;(n=t.state).mode===u&&(n.mode=13),m=t.next_out,f=t.output,b=t.avail_out,p=t.next_in,d=t.input,g=t.avail_in,y=n.hold,v=n.bits,k=g,x=b,D=0;t:for(;;)switch(n.mode){case 1:if(0===n.wrap){n.mode=13;break}for(;v<16;){if(0===g)break t;g--,y+=d[p++]<<v,v+=8}if(2&n.wrap&&35615===y){n.check=0,P[0]=255&y,P[1]=y>>>8&255,n.check=a(n.check,P,2,0),y=0,v=0,n.mode=2;break}if(n.flags=0,n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&y)<<8)+(y>>8))%31){t.msg="incorrect header check",n.mode=h;break}if(8!=(15&y)){t.msg="unknown compression method",n.mode=h;break}if(v-=4,O=8+(15&(y>>>=4)),0===n.wbits)n.wbits=O;else if(O>n.wbits){t.msg="invalid window size",n.mode=h;break}n.dmax=1<<O,t.adler=n.check=1,n.mode=512&y?10:u,y=0,v=0;break;case 2:for(;v<16;){if(0===g)break t;g--,y+=d[p++]<<v,v+=8}if(n.flags=y,8!=(255&n.flags)){t.msg="unknown compression method",n.mode=h;break}if(57344&n.flags){t.msg="unknown header flags set",n.mode=h;break}n.head&&(n.head.text=y>>8&1),512&n.flags&&(P[0]=255&y,P[1]=y>>>8&255,n.check=a(n.check,P,2,0)),y=0,v=0,n.mode=3;case 3:for(;v<32;){if(0===g)break t;g--,y+=d[p++]<<v,v+=8}n.head&&(n.head.time=y),512&n.flags&&(P[0]=255&y,P[1]=y>>>8&255,P[2]=y>>>16&255,P[3]=y>>>24&255,n.check=a(n.check,P,4,0)),y=0,v=0,n.mode=4;case 4:for(;v<16;){if(0===g)break t;g--,y+=d[p++]<<v,v+=8}n.head&&(n.head.xflags=255&y,n.head.os=y>>8),512&n.flags&&(P[0]=255&y,P[1]=y>>>8&255,n.check=a(n.check,P,2,0)),y=0,v=0,n.mode=5;case 5:if(1024&n.flags){for(;v<16;){if(0===g)break t;g--,y+=d[p++]<<v,v+=8}n.length=y,n.head&&(n.head.extra_len=y),512&n.flags&&(P[0]=255&y,P[1]=y>>>8&255,n.check=a(n.check,P,2,0)),y=0,v=0}else n.head&&(n.head.extra=null);n.mode=6;case 6:if(1024&n.flags&&((S=n.length)>g&&(S=g),S&&(n.head&&(O=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Array(n.head.extra_len)),r.arraySet(n.head.extra,d,p,S,O)),512&n.flags&&(n.check=a(n.check,d,S,p)),g-=S,p+=S,n.length-=S),n.length))break t;n.length=0,n.mode=7;case 7:if(2048&n.flags){if(0===g)break t;S=0;do{O=d[p+S++],n.head&&O&&n.length<65536&&(n.head.name+=String.fromCharCode(O))}while(O&&S<g);if(512&n.flags&&(n.check=a(n.check,d,S,p)),g-=S,p+=S,O)break t}else n.head&&(n.head.name=null);n.length=0,n.mode=8;case 8:if(4096&n.flags){if(0===g)break t;S=0;do{O=d[p+S++],n.head&&O&&n.length<65536&&(n.head.comment+=String.fromCharCode(O))}while(O&&S<g);if(512&n.flags&&(n.check=a(n.check,d,S,p)),g-=S,p+=S,O)break t}else n.head&&(n.head.comment=null);n.mode=9;case 9:if(512&n.flags){for(;v<16;){if(0===g)break t;g--,y+=d[p++]<<v,v+=8}if(y!==(65535&n.check)){t.msg="header crc mismatch",n.mode=h;break}y=0,v=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),t.adler=n.check=0,n.mode=u;break;case 10:for(;v<32;){if(0===g)break t;g--,y+=d[p++]<<v,v+=8}t.adler=n.check=c(y),y=0,v=0,n.mode=11;case 11:if(0===n.havedict)return t.next_out=m,t.avail_out=b,t.next_in=p,t.avail_in=g,n.hold=y,n.bits=v,2;t.adler=n.check=1,n.mode=u;case u:if(5===e||6===e)break t;case 13:if(n.last){y>>>=7&v,v-=7&v,n.mode=27;break}for(;v<3;){if(0===g)break t;g--,y+=d[p++]<<v,v+=8}switch(n.last=1&y,v-=1,3&(y>>>=1)){case 0:n.mode=14;break;case 1:if(w(n),n.mode=20,6===e){y>>>=2,v-=2;break t}break;case 2:n.mode=17;break;case 3:t.msg="invalid block type",n.mode=h}y>>>=2,v-=2;break;case 14:for(y>>>=7&v,v-=7&v;v<32;){if(0===g)break t;g--,y+=d[p++]<<v,v+=8}if((65535&y)!=(y>>>16^65535)){t.msg="invalid stored block lengths",n.mode=h;break}if(n.length=65535&y,y=0,v=0,n.mode=15,6===e)break t;case 15:n.mode=16;case 16:if(S=n.length){if(S>g&&(S=g),S>b&&(S=b),0===S)break t;r.arraySet(f,d,p,S,m),g-=S,p+=S,b-=S,m+=S,n.length-=S;break}n.mode=u;break;case 17:for(;v<14;){if(0===g)break t;g--,y+=d[p++]<<v,v+=8}if(n.nlen=257+(31&y),y>>>=5,v-=5,n.ndist=1+(31&y),y>>>=5,v-=5,n.ncode=4+(15&y),y>>>=4,v-=4,n.nlen>286||n.ndist>30){t.msg="too many length or distance symbols",n.mode=h;break}n.have=0,n.mode=18;case 18:for(;n.have<n.ncode;){for(;v<3;){if(0===g)break t;g--,y+=d[p++]<<v,v+=8}n.lens[L[n.have++]]=7&y,y>>>=3,v-=3}for(;n.have<19;)n.lens[L[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,z={bits:n.lenbits},D=o(0,n.lens,0,19,n.lencode,0,n.work,z),n.lenbits=z.bits,D){t.msg="invalid code lengths set",n.mode=h;break}n.have=0,n.mode=19;case 19:for(;n.have<n.nlen+n.ndist;){for(;M=(F=n.lencode[y&(1<<n.lenbits)-1])>>>16&255,T=65535&F,!((A=F>>>24)<=v);){if(0===g)break t;g--,y+=d[p++]<<v,v+=8}if(T<16)y>>>=A,v-=A,n.lens[n.have++]=T;else{if(16===T){for(B=A+2;v<B;){if(0===g)break t;g--,y+=d[p++]<<v,v+=8}if(y>>>=A,v-=A,0===n.have){t.msg="invalid bit length repeat",n.mode=h;break}O=n.lens[n.have-1],S=3+(3&y),y>>>=2,v-=2}else if(17===T){for(B=A+3;v<B;){if(0===g)break t;g--,y+=d[p++]<<v,v+=8}v-=A,O=0,S=3+(7&(y>>>=A)),y>>>=3,v-=3}else{for(B=A+7;v<B;){if(0===g)break t;g--,y+=d[p++]<<v,v+=8}v-=A,O=0,S=11+(127&(y>>>=A)),y>>>=7,v-=7}if(n.have+S>n.nlen+n.ndist){t.msg="invalid bit length repeat",n.mode=h;break}for(;S--;)n.lens[n.have++]=O}}if(n.mode===h)break;if(0===n.lens[256]){t.msg="invalid code -- missing end-of-block",n.mode=h;break}if(n.lenbits=9,z={bits:n.lenbits},D=o(1,n.lens,0,n.nlen,n.lencode,0,n.work,z),n.lenbits=z.bits,D){t.msg="invalid literal/lengths set",n.mode=h;break}if(n.distbits=6,n.distcode=n.distdyn,z={bits:n.distbits},D=o(2,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,z),n.distbits=z.bits,D){t.msg="invalid distances set",n.mode=h;break}if(n.mode=20,6===e)break t;case 20:n.mode=21;case 21:if(g>=6&&b>=258){t.next_out=m,t.avail_out=b,t.next_in=p,t.avail_in=g,n.hold=y,n.bits=v,s(t,x),m=t.next_out,f=t.output,b=t.avail_out,p=t.next_in,d=t.input,g=t.avail_in,y=n.hold,v=n.bits,n.mode===u&&(n.back=-1);break}for(n.back=0;M=(F=n.lencode[y&(1<<n.lenbits)-1])>>>16&255,T=65535&F,!((A=F>>>24)<=v);){if(0===g)break t;g--,y+=d[p++]<<v,v+=8}if(M&&0==(240&M)){for(N=A,C=M,R=T;M=(F=n.lencode[R+((y&(1<<N+C)-1)>>N)])>>>16&255,T=65535&F,!(N+(A=F>>>24)<=v);){if(0===g)break t;g--,y+=d[p++]<<v,v+=8}y>>>=N,v-=N,n.back+=N}if(y>>>=A,v-=A,n.back+=A,n.length=T,0===M){n.mode=26;break}if(32&M){n.back=-1,n.mode=u;break}if(64&M){t.msg="invalid literal/length code",n.mode=h;break}n.extra=15&M,n.mode=22;case 22:if(n.extra){for(B=n.extra;v<B;){if(0===g)break t;g--,y+=d[p++]<<v,v+=8}n.length+=y&(1<<n.extra)-1,y>>>=n.extra,v-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=23;case 23:for(;M=(F=n.distcode[y&(1<<n.distbits)-1])>>>16&255,T=65535&F,!((A=F>>>24)<=v);){if(0===g)break t;g--,y+=d[p++]<<v,v+=8}if(0==(240&M)){for(N=A,C=M,R=T;M=(F=n.distcode[R+((y&(1<<N+C)-1)>>N)])>>>16&255,T=65535&F,!(N+(A=F>>>24)<=v);){if(0===g)break t;g--,y+=d[p++]<<v,v+=8}y>>>=N,v-=N,n.back+=N}if(y>>>=A,v-=A,n.back+=A,64&M){t.msg="invalid distance code",n.mode=h;break}n.offset=T,n.extra=15&M,n.mode=24;case 24:if(n.extra){for(B=n.extra;v<B;){if(0===g)break t;g--,y+=d[p++]<<v,v+=8}n.offset+=y&(1<<n.extra)-1,y>>>=n.extra,v-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){t.msg="invalid distance too far back",n.mode=h;break}n.mode=25;case 25:if(0===b)break t;if(S=x-b,n.offset>S){if((S=n.offset-S)>n.whave&&n.sane){t.msg="invalid distance too far back",n.mode=h;break}S>n.wnext?(S-=n.wnext,E=n.wsize-S):E=n.wnext-S,S>n.length&&(S=n.length),I=n.window}else I=f,E=m-n.offset,S=n.length;S>b&&(S=b),b-=S,n.length-=S;do{f[m++]=I[E++]}while(--S);0===n.length&&(n.mode=21);break;case 26:if(0===b)break t;f[m++]=n.length,b--,n.mode=21;break;case 27:if(n.wrap){for(;v<32;){if(0===g)break t;g--,y|=d[p++]<<v,v+=8}if(x-=b,t.total_out+=x,n.total+=x,x&&(t.adler=n.check=n.flags?a(n.check,f,x,m-x):i(n.check,f,x,m-x)),x=b,(n.flags?y:c(y))!==n.check){t.msg="incorrect data check",n.mode=h;break}y=0,v=0}n.mode=28;case 28:if(n.wrap&&n.flags){for(;v<32;){if(0===g)break t;g--,y+=d[p++]<<v,v+=8}if(y!==(4294967295&n.total)){t.msg="incorrect length check",n.mode=h;break}y=0,v=0}n.mode=29;case 29:D=1;break t;case h:D=-3;break t;case 31:return-4;default:return l}return t.next_out=m,t.avail_out=b,t.next_in=p,t.avail_in=g,n.hold=y,n.bits=v,(n.wsize||x!==t.avail_out&&n.mode<h&&(n.mode<27||4!==e))&&_(t,t.output,t.next_out,x-t.avail_out)?(n.mode=31,-4):(k-=t.avail_in,x-=t.avail_out,t.total_in+=k,t.total_out+=x,n.total+=x,n.wrap&&x&&(t.adler=n.check=n.flags?a(n.check,f,x,t.next_out-x):i(n.check,f,x,t.next_out-x)),t.data_type=n.bits+(n.last?64:0)+(n.mode===u?128:0)+(20===n.mode||15===n.mode?256:0),(0===k&&0===x||4===e)&&0===D&&(D=-5),D)},e.inflateEnd=function(t){if(!t||!t.state)return l;var e=t.state;return e.window&&(e.window=null),t.state=null,0},e.inflateGetHeader=function(t,e){var n;return t&&t.state?0==(2&(n=t.state).wrap)?l:(n.head=e,e.done=!1,0):l},e.inflateSetDictionary=function(t,e){var n,r=e.length;return t&&t.state?0!==(n=t.state).wrap&&11!==n.mode?l:11===n.mode&&i(1,e,r,0)!==n.check?-3:_(t,e,r,r)?(n.mode=31,-4):(n.havedict=1,0):l},e.inflateInfo="pako inflate (from Nodeca project)"},2030:(t,e,n)=>{"use strict";var r=n(4491),i=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],a=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],s=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],o=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(t,e,n,l,u,h,c,d){var f,p,m,g,b,y,v,w,_,k=d.bits,x=0,S=0,E=0,I=0,A=0,M=0,T=0,N=0,C=0,R=0,O=null,D=0,z=new r.Buf16(16),B=new r.Buf16(16),F=null,P=0;for(x=0;x<=15;x++)z[x]=0;for(S=0;S<l;S++)z[e[n+S]]++;for(A=k,I=15;I>=1&&0===z[I];I--);if(A>I&&(A=I),0===I)return u[h++]=20971520,u[h++]=20971520,d.bits=1,0;for(E=1;E<I&&0===z[E];E++);for(A<E&&(A=E),N=1,x=1;x<=15;x++)if(N<<=1,(N-=z[x])<0)return-1;if(N>0&&(0===t||1!==I))return-1;for(B[1]=0,x=1;x<15;x++)B[x+1]=B[x]+z[x];for(S=0;S<l;S++)0!==e[n+S]&&(c[B[e[n+S]]++]=S);if(0===t?(O=F=c,y=19):1===t?(O=i,D-=257,F=a,P-=257,y=256):(O=s,F=o,y=-1),R=0,S=0,x=E,b=h,M=A,T=0,m=-1,g=(C=1<<A)-1,1===t&&C>852||2===t&&C>592)return 1;for(;;){v=x-T,c[S]<y?(w=0,_=c[S]):c[S]>y?(w=F[P+c[S]],_=O[D+c[S]]):(w=96,_=0),f=1<<x-T,E=p=1<<M;do{u[b+(R>>T)+(p-=f)]=v<<24|w<<16|_|0}while(0!==p);for(f=1<<x-1;R&f;)f>>=1;if(0!==f?(R&=f-1,R+=f):R=0,S++,0==--z[x]){if(x===I)break;x=e[n+c[S]]}if(x>A&&(R&g)!==m){for(0===T&&(T=A),b+=E,N=1<<(M=x-T);M+T<I&&!((N-=z[M+T])<=0);)M++,N<<=1;if(C+=1<<M,1===t&&C>852||2===t&&C>592)return 1;u[m=R&g]=A<<24|M<<16|b-h|0}}return 0!==R&&(u[b+R]=x-T<<24|64<<16|0),d.bits=A,0}},2116:t=>{"use strict";t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},2509:(t,e,n)=>{"use strict";var r=n(4491);function i(t){for(var e=t.length;--e>=0;)t[e]=0}var a=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],s=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],l=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],u=new Array(576);i(u);var h=new Array(60);i(h);var c=new Array(512);i(c);var d=new Array(256);i(d);var f=new Array(29);i(f);var p,m,g,b=new Array(30);function y(t,e,n,r,i){this.static_tree=t,this.extra_bits=e,this.extra_base=n,this.elems=r,this.max_length=i,this.has_stree=t&&t.length}function v(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e}function w(t){return t<256?c[t]:c[256+(t>>>7)]}function _(t,e){t.pending_buf[t.pending++]=255&e,t.pending_buf[t.pending++]=e>>>8&255}function k(t,e,n){t.bi_valid>16-n?(t.bi_buf|=e<<t.bi_valid&65535,_(t,t.bi_buf),t.bi_buf=e>>16-t.bi_valid,t.bi_valid+=n-16):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=n)}function x(t,e,n){k(t,n[2*e],n[2*e+1])}function S(t,e){var n=0;do{n|=1&t,t>>>=1,n<<=1}while(--e>0);return n>>>1}function E(t,e,n){var r,i,a=new Array(16),s=0;for(r=1;r<=15;r++)a[r]=s=s+n[r-1]<<1;for(i=0;i<=e;i++){var o=t[2*i+1];0!==o&&(t[2*i]=S(a[o]++,o))}}function I(t){var e;for(e=0;e<286;e++)t.dyn_ltree[2*e]=0;for(e=0;e<30;e++)t.dyn_dtree[2*e]=0;for(e=0;e<19;e++)t.bl_tree[2*e]=0;t.dyn_ltree[512]=1,t.opt_len=t.static_len=0,t.last_lit=t.matches=0}function A(t){t.bi_valid>8?_(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0}function M(t,e,n,r){var i=2*e,a=2*n;return t[i]<t[a]||t[i]===t[a]&&r[e]<=r[n]}function T(t,e,n){for(var r=t.heap[n],i=n<<1;i<=t.heap_len&&(i<t.heap_len&&M(e,t.heap[i+1],t.heap[i],t.depth)&&i++,!M(e,r,t.heap[i],t.depth));)t.heap[n]=t.heap[i],n=i,i<<=1;t.heap[n]=r}function N(t,e,n){var r,i,o,l,u=0;if(0!==t.last_lit)do{r=t.pending_buf[t.d_buf+2*u]<<8|t.pending_buf[t.d_buf+2*u+1],i=t.pending_buf[t.l_buf+u],u++,0===r?x(t,i,e):(x(t,(o=d[i])+256+1,e),0!==(l=a[o])&&k(t,i-=f[o],l),x(t,o=w(--r),n),0!==(l=s[o])&&k(t,r-=b[o],l))}while(u<t.last_lit);x(t,256,e)}function C(t,e){var n,r,i,a=e.dyn_tree,s=e.stat_desc.static_tree,o=e.stat_desc.has_stree,l=e.stat_desc.elems,u=-1;for(t.heap_len=0,t.heap_max=573,n=0;n<l;n++)0!==a[2*n]?(t.heap[++t.heap_len]=u=n,t.depth[n]=0):a[2*n+1]=0;for(;t.heap_len<2;)a[2*(i=t.heap[++t.heap_len]=u<2?++u:0)]=1,t.depth[i]=0,t.opt_len--,o&&(t.static_len-=s[2*i+1]);for(e.max_code=u,n=t.heap_len>>1;n>=1;n--)T(t,a,n);i=l;do{n=t.heap[1],t.heap[1]=t.heap[t.heap_len--],T(t,a,1),r=t.heap[1],t.heap[--t.heap_max]=n,t.heap[--t.heap_max]=r,a[2*i]=a[2*n]+a[2*r],t.depth[i]=(t.depth[n]>=t.depth[r]?t.depth[n]:t.depth[r])+1,a[2*n+1]=a[2*r+1]=i,t.heap[1]=i++,T(t,a,1)}while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],function(t,e){var n,r,i,a,s,o,l=e.dyn_tree,u=e.max_code,h=e.stat_desc.static_tree,c=e.stat_desc.has_stree,d=e.stat_desc.extra_bits,f=e.stat_desc.extra_base,p=e.stat_desc.max_length,m=0;for(a=0;a<=15;a++)t.bl_count[a]=0;for(l[2*t.heap[t.heap_max]+1]=0,n=t.heap_max+1;n<573;n++)(a=l[2*l[2*(r=t.heap[n])+1]+1]+1)>p&&(a=p,m++),l[2*r+1]=a,r>u||(t.bl_count[a]++,s=0,r>=f&&(s=d[r-f]),o=l[2*r],t.opt_len+=o*(a+s),c&&(t.static_len+=o*(h[2*r+1]+s)));if(0!==m){do{for(a=p-1;0===t.bl_count[a];)a--;t.bl_count[a]--,t.bl_count[a+1]+=2,t.bl_count[p]--,m-=2}while(m>0);for(a=p;0!==a;a--)for(r=t.bl_count[a];0!==r;)(i=t.heap[--n])>u||(l[2*i+1]!==a&&(t.opt_len+=(a-l[2*i+1])*l[2*i],l[2*i+1]=a),r--)}}(t,e),E(a,u,t.bl_count)}function R(t,e,n){var r,i,a=-1,s=e[1],o=0,l=7,u=4;for(0===s&&(l=138,u=3),e[2*(n+1)+1]=65535,r=0;r<=n;r++)i=s,s=e[2*(r+1)+1],++o<l&&i===s||(o<u?t.bl_tree[2*i]+=o:0!==i?(i!==a&&t.bl_tree[2*i]++,t.bl_tree[32]++):o<=10?t.bl_tree[34]++:t.bl_tree[36]++,o=0,a=i,0===s?(l=138,u=3):i===s?(l=6,u=3):(l=7,u=4))}function O(t,e,n){var r,i,a=-1,s=e[1],o=0,l=7,u=4;for(0===s&&(l=138,u=3),r=0;r<=n;r++)if(i=s,s=e[2*(r+1)+1],!(++o<l&&i===s)){if(o<u)do{x(t,i,t.bl_tree)}while(0!=--o);else 0!==i?(i!==a&&(x(t,i,t.bl_tree),o--),x(t,16,t.bl_tree),k(t,o-3,2)):o<=10?(x(t,17,t.bl_tree),k(t,o-3,3)):(x(t,18,t.bl_tree),k(t,o-11,7));o=0,a=i,0===s?(l=138,u=3):i===s?(l=6,u=3):(l=7,u=4)}}i(b);var D=!1;function z(t,e,n,i){k(t,0+(i?1:0),3),function(t,e,n,i){A(t),_(t,n),_(t,~n),r.arraySet(t.pending_buf,t.window,e,n,t.pending),t.pending+=n}(t,e,n)}e._tr_init=function(t){D||(function(){var t,e,n,r,i,l=new Array(16);for(n=0,r=0;r<28;r++)for(f[r]=n,t=0;t<1<<a[r];t++)d[n++]=r;for(d[n-1]=r,i=0,r=0;r<16;r++)for(b[r]=i,t=0;t<1<<s[r];t++)c[i++]=r;for(i>>=7;r<30;r++)for(b[r]=i<<7,t=0;t<1<<s[r]-7;t++)c[256+i++]=r;for(e=0;e<=15;e++)l[e]=0;for(t=0;t<=143;)u[2*t+1]=8,t++,l[8]++;for(;t<=255;)u[2*t+1]=9,t++,l[9]++;for(;t<=279;)u[2*t+1]=7,t++,l[7]++;for(;t<=287;)u[2*t+1]=8,t++,l[8]++;for(E(u,287,l),t=0;t<30;t++)h[2*t+1]=5,h[2*t]=S(t,5);p=new y(u,a,257,286,15),m=new y(h,s,0,30,15),g=new y(new Array(0),o,0,19,7)}(),D=!0),t.l_desc=new v(t.dyn_ltree,p),t.d_desc=new v(t.dyn_dtree,m),t.bl_desc=new v(t.bl_tree,g),t.bi_buf=0,t.bi_valid=0,I(t)},e._tr_stored_block=z,e._tr_flush_block=function(t,e,n,r){var i,a,s=0;t.level>0?(2===t.strm.data_type&&(t.strm.data_type=function(t){var e,n=4093624447;for(e=0;e<=31;e++,n>>>=1)if(1&n&&0!==t.dyn_ltree[2*e])return 0;if(0!==t.dyn_ltree[18]||0!==t.dyn_ltree[20]||0!==t.dyn_ltree[26])return 1;for(e=32;e<256;e++)if(0!==t.dyn_ltree[2*e])return 1;return 0}(t)),C(t,t.l_desc),C(t,t.d_desc),s=function(t){var e;for(R(t,t.dyn_ltree,t.l_desc.max_code),R(t,t.dyn_dtree,t.d_desc.max_code),C(t,t.bl_desc),e=18;e>=3&&0===t.bl_tree[2*l[e]+1];e--);return t.opt_len+=3*(e+1)+5+5+4,e}(t),i=t.opt_len+3+7>>>3,(a=t.static_len+3+7>>>3)<=i&&(i=a)):i=a=n+5,n+4<=i&&-1!==e?z(t,e,n,r):4===t.strategy||a===i?(k(t,2+(r?1:0),3),N(t,u,h)):(k(t,4+(r?1:0),3),function(t,e,n,r){var i;for(k(t,e-257,5),k(t,n-1,5),k(t,r-4,4),i=0;i<r;i++)k(t,t.bl_tree[2*l[i]+1],3);O(t,t.dyn_ltree,e-1),O(t,t.dyn_dtree,n-1)}(t,t.l_desc.max_code+1,t.d_desc.max_code+1,s+1),N(t,t.dyn_ltree,t.dyn_dtree)),I(t),r&&A(t)},e._tr_tally=function(t,e,n){return t.pending_buf[t.d_buf+2*t.last_lit]=e>>>8&255,t.pending_buf[t.d_buf+2*t.last_lit+1]=255&e,t.pending_buf[t.l_buf+t.last_lit]=255&n,t.last_lit++,0===e?t.dyn_ltree[2*n]++:(t.matches++,e--,t.dyn_ltree[2*(d[n]+256+1)]++,t.dyn_dtree[2*w(e)]++),t.last_lit===t.lit_bufsize-1},e._tr_align=function(t){k(t,2,3),x(t,256,u),function(t){16===t.bi_valid?(_(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)}(t)}},2716:t=>{"use strict";t.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},7561:t=>{function e(t,e){if(!(t=t.replace(/\t+/g," ").trim()))return null;var r=t.indexOf(" ");if(-1===r)throw new Error("no named row at line "+e);var i=t.substring(0,r);t=(t=(t=(t=t.substring(r+1)).replace(/letter=[\'\"]\S+[\'\"]/gi,"")).split("=")).map((function(t){return t.trim().match(/(".*?"|[^"\s]+)+(?=\s*|\s*$)/g)}));for(var a=[],s=0;s<t.length;s++){var o=t[s];0===s?a.push({key:o[0],data:""}):s===t.length-1?a[a.length-1].data=n(o[0]):(a[a.length-1].data=n(o[0]),a.push({key:o[1],data:""}))}var l={key:i,data:{}};return a.forEach((function(t){l.data[t.key]=t.data})),l}function n(t){return t&&0!==t.length?0===t.indexOf('"')||0===t.indexOf("'")?t.substring(1,t.length-1):-1!==t.indexOf(",")?function(t){return t.split(",").map((function(t){return parseInt(t,10)}))}(t):parseInt(t,10):""}t.exports=function(t){if(!t)throw new Error("no data provided");var n={pages:[],chars:[],kernings:[]},r=(t=t.toString().trim()).split(/\r\n?|\n/g);if(0===r.length)throw new Error("no data in BMFont file");for(var i=0;i<r.length;i++){var a=e(r[i],i);if(a)if("page"===a.key){if("number"!=typeof a.data.id)throw new Error("malformed file at line "+i+" -- needs page id=N");if("string"!=typeof a.data.file)throw new Error("malformed file at line "+i+' -- needs page file="path"');n.pages[a.data.id]=a.data.file}else"chars"===a.key||"kernings"===a.key||("char"===a.key?n.chars.push(a.data):"kerning"===a.key?n.kernings.push(a.data):n[a.key]=a.data)}return n}},1944:t=>{var e=[66,77,70];function n(t,e,n){if(n>e.length-1)return 0;var i=e.readUInt8(n++),a=e.readInt32LE(n);switch(n+=4,i){case 1:t.info=function(t,e){var n={};n.size=t.readInt16LE(e);var i=t.readUInt8(e+2);return n.smooth=i>>7&1,n.unicode=i>>6&1,n.italic=i>>5&1,n.bold=i>>4&1,i>>3&1&&(n.fixedHeight=1),n.charset=t.readUInt8(e+3)||"",n.stretchH=t.readUInt16LE(e+4),n.aa=t.readUInt8(e+6),n.padding=[t.readInt8(e+7),t.readInt8(e+8),t.readInt8(e+9),t.readInt8(e+10)],n.spacing=[t.readInt8(e+11),t.readInt8(e+12)],n.outline=t.readUInt8(e+13),n.face=function(t,e){return r(t,e).toString("utf8")}(t,e+14),n}(e,n);break;case 2:t.common=function(t,e){var n={};return n.lineHeight=t.readUInt16LE(e),n.base=t.readUInt16LE(e+2),n.scaleW=t.readUInt16LE(e+4),n.scaleH=t.readUInt16LE(e+6),n.pages=t.readUInt16LE(e+8),t.readUInt8(e+10),n.packed=0,n.alphaChnl=t.readUInt8(e+11),n.redChnl=t.readUInt8(e+12),n.greenChnl=t.readUInt8(e+13),n.blueChnl=t.readUInt8(e+14),n}(e,n);break;case 3:t.pages=function(t,e,n){for(var i=[],a=r(t,e),s=a.length+1,o=n/s,l=0;l<o;l++)i[l]=t.slice(e,e+a.length).toString("utf8"),e+=s;return i}(e,n,a);break;case 4:t.chars=function(t,e,n){for(var r=[],i=n/20,a=0;a<i;a++){var s={},o=20*a;s.id=t.readUInt32LE(e+0+o),s.x=t.readUInt16LE(e+4+o),s.y=t.readUInt16LE(e+6+o),s.width=t.readUInt16LE(e+8+o),s.height=t.readUInt16LE(e+10+o),s.xoffset=t.readInt16LE(e+12+o),s.yoffset=t.readInt16LE(e+14+o),s.xadvance=t.readInt16LE(e+16+o),s.page=t.readUInt8(e+18+o),s.chnl=t.readUInt8(e+19+o),r[a]=s}return r}(e,n,a);break;case 5:t.kernings=function(t,e,n){for(var r=[],i=n/10,a=0;a<i;a++){var s={},o=10*a;s.first=t.readUInt32LE(e+0+o),s.second=t.readUInt32LE(e+4+o),s.amount=t.readInt16LE(e+8+o),r[a]=s}return r}(e,n,a)}return 5+a}function r(t,e){for(var n=e;n<t.length&&0!==t[n];n++);return t.slice(e,n)}t.exports=function(t){if(t.length<6)throw new Error("invalid buffer length for BMFont");var r=e.every((function(e,n){return t.readUInt8(n)===e}));if(!r)throw new Error("BMFont missing BMF byte header");var i=3;if(t.readUInt8(i++)>3)throw new Error("Only supports BMFont Binary v3 (BMFont App v1.10)");for(var a={kernings:[],chars:[]},s=0;s<5;s++)i+=n(a,t,i);return a}},3940:(t,e,n)=>{var r=n(9863),i=n(6483),a={scaleh:"scaleH",scalew:"scaleW",stretchh:"stretchH",lineheight:"lineHeight",alphachnl:"alphaChnl",redchnl:"redChnl",greenchnl:"greenChnl",bluechnl:"blueChnl"};function s(t){var e=function(t){for(var e=[],n=0;n<t.attributes.length;n++)e.push(t.attributes[n]);return e}(t);return e.reduce((function(t,e){var n;return t[(n=e.nodeName,a[n.toLowerCase()]||n)]=e.nodeValue,t}),{})}t.exports=function(t){t=t.toString();var e=i(t),n={pages:[],chars:[],kernings:[]};["info","common"].forEach((function(t){var i=e.getElementsByTagName(t)[0];i&&(n[t]=r(s(i)))}));var a=e.getElementsByTagName("pages")[0];if(!a)throw new Error("malformed file -- no <pages> element");for(var o=a.getElementsByTagName("page"),l=0;l<o.length;l++){var u=o[l],h=parseInt(u.getAttribute("id"),10),c=u.getAttribute("file");if(isNaN(h))throw new Error('malformed file -- page "id" attribute is NaN');if(!c)throw new Error('malformed file -- needs page "file" attribute');n.pages[parseInt(h,10)]=c}return["chars","kernings"].forEach((function(t){var i=e.getElementsByTagName(t)[0];if(i)for(var a=t.substring(0,t.length-1),o=i.getElementsByTagName(a),l=0;l<o.length;l++){var u=o[l];n[t].push(r(s(u)))}})),n}},9863:t=>{t.exports=function(t){for(var e in"chasrset"in t&&(t.charset=t.chasrset,delete t.chasrset),t)"face"!==e&&"charset"!==e&&(t[e]="padding"===e||"spacing"===e?t[e].split(",").map((function(t){return parseInt(t,10)})):parseInt(t[e],10));return t}},2459:t=>{var e=function(t){return t.replace(/^\s+|\s+$/g,"")};t.exports=function(t){if(!t)return{};for(var n,r={},i=e(t).split("\n"),a=0;a<i.length;a++){var s=i[a],o=s.indexOf(":"),l=e(s.slice(0,o)).toLowerCase(),u=e(s.slice(o+1));void 0===r[l]?r[l]=u:(n=r[l],"[object Array]"===Object.prototype.toString.call(n)?r[l].push(u):r[l]=[r[l],u])}return r}},6072:(t,e,n)=>{var r=n(7671);function i(t,e){for(var n=0,r=t.length-1;r>=0;r--){var i=t[r];"."===i?t.splice(r,1):".."===i?(t.splice(r,1),n++):n&&(t.splice(r,1),n--)}if(e)for(;n--;n)t.unshift("..");return t}function a(t,e){if(t.filter)return t.filter(e);for(var n=[],r=0;r<t.length;r++)e(t[r],r,t)&&n.push(t[r]);return n}e.resolve=function(){for(var t="",e=!1,n=arguments.length-1;n>=-1&&!e;n--){var s=n>=0?arguments[n]:r.cwd();if("string"!=typeof s)throw new TypeError("Arguments to path.resolve must be strings");s&&(t=s+"/"+t,e="/"===s.charAt(0))}return(e?"/":"")+(t=i(a(t.split("/"),(function(t){return!!t})),!e).join("/"))||"."},e.normalize=function(t){var n=e.isAbsolute(t),r="/"===s(t,-1);return(t=i(a(t.split("/"),(function(t){return!!t})),!n).join("/"))||n||(t="."),t&&r&&(t+="/"),(n?"/":"")+t},e.isAbsolute=function(t){return"/"===t.charAt(0)},e.join=function(){var t=Array.prototype.slice.call(arguments,0);return e.normalize(a(t,(function(t,e){if("string"!=typeof t)throw new TypeError("Arguments to path.join must be strings");return t})).join("/"))},e.relative=function(t,n){function r(t){for(var e=0;e<t.length&&""===t[e];e++);for(var n=t.length-1;n>=0&&""===t[n];n--);return e>n?[]:t.slice(e,n-e+1)}t=e.resolve(t).substr(1),n=e.resolve(n).substr(1);for(var i=r(t.split("/")),a=r(n.split("/")),s=Math.min(i.length,a.length),o=s,l=0;l<s;l++)if(i[l]!==a[l]){o=l;break}var u=[];for(l=o;l<i.length;l++)u.push("..");return(u=u.concat(a.slice(o))).join("/")},e.sep="/",e.delimiter=":",e.dirname=function(t){if("string"!=typeof t&&(t+=""),0===t.length)return".";for(var e=t.charCodeAt(0),n=47===e,r=-1,i=!0,a=t.length-1;a>=1;--a)if(47===(e=t.charCodeAt(a))){if(!i){r=a;break}}else i=!1;return-1===r?n?"/":".":n&&1===r?"/":t.slice(0,r)},e.basename=function(t,e){var n=function(t){"string"!=typeof t&&(t+="");var e,n=0,r=-1,i=!0;for(e=t.length-1;e>=0;--e)if(47===t.charCodeAt(e)){if(!i){n=e+1;break}}else-1===r&&(i=!1,r=e+1);return-1===r?"":t.slice(n,r)}(t);return e&&n.substr(-1*e.length)===e&&(n=n.substr(0,n.length-e.length)),n},e.extname=function(t){"string"!=typeof t&&(t+="");for(var e=-1,n=0,r=-1,i=!0,a=0,s=t.length-1;s>=0;--s){var o=t.charCodeAt(s);if(47!==o)-1===r&&(i=!1,r=s+1),46===o?-1===e?e=s:1!==a&&(a=1):-1!==e&&(a=-1);else if(!i){n=s+1;break}}return-1===e||-1===r||0===a||1===a&&e===r-1&&e===n+1?"":t.slice(e,r)};var s=function(t,e,n){return t.substr(e,n)}},4939:(t,e,n)=>{"use strict";var r=n(9208).Buffer,i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a=n(6824),s=n(7500),o=n(1892),l=n(7459),u=n(6189),h=n(9953),c=function(t,e){if("string"!=typeof t&&!t.hasOwnProperty("url"))throw new Error("Missing url option from options for request method.");var n="object"===(void 0===t?"undefined":i(t))?o.parse(t.url):o.parse(t),h={hostname:n.hostname,port:n.port||("http:"===n.protocol.toLowerCase()?80:443),path:n.path,method:"GET",headers:{},auth:n.auth||null,parse:"none",stream:!1};if("object"===(void 0===t?"undefined":i(t))&&(h=Object.assign(h,t)),h.port=Number(h.port),h.hasOwnProperty("timeout")&&delete h.timeout,!0===h.compressed&&(h.headers["accept-encoding"]="gzip, deflate"),t.hasOwnProperty("form")){if("object"!==i(t.form))throw new Error("phin 'form' option must be of type Object if present.");var c=l.stringify(t.form);h.headers["Content-Type"]="application/x-www-form-urlencoded",h.headers["Content-Length"]=r.byteLength(c),t.data=c}var d=void 0,f=function(t){var n=t;!0===h.compressed&&("gzip"===t.headers["content-encoding"]?n=t.pipe(u.createGunzip()):"deflate"===t.headers["content-encoding"]&&(n=t.pipe(u.createInflate()))),!0===h.stream?(t.stream=n,e&&e(null,t)):(t.body=new r([]),n.on("data",(function(e){t.body=r.concat([t.body,e])})),n.on("end",(function(){if(e){if("json"===h.parse)try{t.body=JSON.parse(t.body.toString())}catch(n){return void e("Invalid JSON received.",t)}e(null,t)}})))};switch(n.protocol.toLowerCase()){case"http:":d=a.request(h,f);break;case"https:":d=s.request(h,f);break;default:return void(e&&e(new Error("Invalid / unknown URL protocol. Expected HTTP or HTTPS."),null))}if("number"==typeof t.timeout&&d.setTimeout(t.timeout,(function(){d.abort(),e&&e(new Error("Timeout has been reached."),null),e=null})),d.on("error",(function(t){e&&e(t,null)})),t.hasOwnProperty("data")){var p=t.data;if(!(t.data instanceof r)&&"object"===i(t.data))if("application/x-www-form-urlencoded"===(h.headers["content-type"]||h.headers["Content-Type"]))p=l.stringify(t.data);else try{p=JSON.stringify(t.data)}catch(t){e&&e(new Error("Couldn't stringify object. (Likely due to a circular reference.)"),null)}d.write(p)}d.end()};c.promisified=function(t,e){return new Promise((function(e,n){c(t,(function(t,r){t?n(t):e(r)}))}))},h.promisify&&(c[h.promisify.custom]=c.promisified),t.exports=c},3545:t=>{"use strict";function e(t,r,i,a,s,o){for(var l,u,h,c,d=Math.max(r-1,0),f=Math.max(i-1,0),p=Math.min(r+1,a-1),m=Math.min(i+1,s-1),g=4*(i*a+r),b=0,y=0,v=0,w=0,_=0,k=d;k<=p;k++)for(var x=f;x<=m;x++)if(k!==r||x!==i){var S=n(t,t,g,4*(x*a+k),!0);if(0===S?b++:S<0?v++:S>0&&y++,b>2)return!1;o&&(S<w&&(w=S,l=k,u=x),S>_&&(_=S,h=k,c=x))}return!o||0!==v&&0!==y&&(!e(t,l,u,a,s)&&!e(o,l,u,a,s)||!e(t,h,c,a,s)&&!e(o,h,c,a,s))}function n(t,e,n,o,l){var u=t[n+3]/255,h=e[o+3]/255,c=s(t[n+0],u),d=s(t[n+1],u),f=s(t[n+2],u),p=s(e[o+0],h),m=s(e[o+1],h),g=s(e[o+2],h),b=r(c,d,f)-r(p,m,g);if(l)return b;var y=i(c,d,f)-i(p,m,g),v=a(c,d,f)-a(p,m,g);return.5053*b*b+.299*y*y+.1957*v*v}function r(t,e,n){return.29889531*t+.58662247*e+.11448223*n}function i(t,e,n){return.59597799*t-.2741761*e-.32180189*n}function a(t,e,n){return.21147017*t-.52261711*e+.31114694*n}function s(t,e){return 255+(t-255)*e}function o(t,e,n,r,i){t[e+0]=n,t[e+1]=r,t[e+2]=i,t[e+3]=255}function l(t,e){var n=t[e+3]/255;return r(s(t[e+0],n),s(t[e+1],n),s(t[e+2],n))}t.exports=function(t,r,i,a,u,h){h||(h={});for(var c=void 0===h.threshold?.1:h.threshold,d=35215*c*c,f=0,p=0;p<u;p++)for(var m=0;m<a;m++){var g=4*(p*a+m);if(n(t,r,g,g)>d)h.includeAA||!e(t,m,p,a,u,r)&&!e(r,m,p,a,u,t)?(i&&o(i,g,255,0,0),f++):i&&o(i,g,255,255,0);else if(i){var b=s(l(t,g),.1);o(i,g,b,b,b)}}return f}},6159:(t,e,n)=>{"use strict";var r=n(9208).Buffer,i=n(4904),a=[function(){},function(t,e,n,r){if(r===e.length)throw new Error("Ran out of data");var i=e[r];t[n]=i,t[n+1]=i,t[n+2]=i,t[n+3]=255},function(t,e,n,r){if(r+1>=e.length)throw new Error("Ran out of data");var i=e[r];t[n]=i,t[n+1]=i,t[n+2]=i,t[n+3]=e[r+1]},function(t,e,n,r){if(r+2>=e.length)throw new Error("Ran out of data");t[n]=e[r],t[n+1]=e[r+1],t[n+2]=e[r+2],t[n+3]=255},function(t,e,n,r){if(r+3>=e.length)throw new Error("Ran out of data");t[n]=e[r],t[n+1]=e[r+1],t[n+2]=e[r+2],t[n+3]=e[r+3]}],s=[function(){},function(t,e,n,r){var i=e[0];t[n]=i,t[n+1]=i,t[n+2]=i,t[n+3]=r},function(t,e,n){var r=e[0];t[n]=r,t[n+1]=r,t[n+2]=r,t[n+3]=e[1]},function(t,e,n,r){t[n]=e[0],t[n+1]=e[1],t[n+2]=e[2],t[n+3]=r},function(t,e,n){t[n]=e[0],t[n+1]=e[1],t[n+2]=e[2],t[n+3]=e[3]}];function o(t,e,n,r,i,s){for(var o=t.width,l=t.height,u=t.index,h=0;h<l;h++)for(var c=0;c<o;c++){var d=n(c,h,u);a[r](e,i,d,s),s+=r}return s}function l(t,e,n,r,i,a){for(var o=t.width,l=t.height,u=t.index,h=0;h<l;h++){for(var c=0;c<o;c++){var d=i.get(r),f=n(c,h,u);s[r](e,d,f,a)}i.resetAfterLine()}}e.dataToBitMap=function(t,e){var n,a=e.width,s=e.height,u=e.depth,h=e.bpp,c=e.interlace;if(8!==u)var d=function(t,e){var n=[],r=0;function i(){if(r===t.length)throw new Error("Ran out of data");var i,a,s,o,l,u,h,c,d=t[r];switch(r++,e){default:throw new Error("unrecognised depth");case 16:h=t[r],r++,n.push((d<<8)+h);break;case 4:h=15&d,c=d>>4,n.push(c,h);break;case 2:l=3&d,u=d>>2&3,h=d>>4&3,c=d>>6&3,n.push(c,h,u,l);break;case 1:i=1&d,a=d>>1&1,s=d>>2&1,o=d>>3&1,l=d>>4&1,u=d>>5&1,h=d>>6&1,c=d>>7&1,n.push(c,h,u,l,o,s,a,i)}}return{get:function(t){for(;n.length<t;)i();var e=n.slice(0,t);return n=n.slice(t),e},resetAfterLine:function(){n.length=0},end:function(){if(r!==t.length)throw new Error("extra data found")}}}(t,u);n=u<=8?new r(a*s*4):new Uint16Array(a*s*4);var f,p,m=Math.pow(2,u)-1,g=0;if(c)f=i.getImagePasses(a,s),p=i.getInterlaceIterator(a,s);else{var b=0;p=function(){var t=b;return b+=4,t},f=[{width:a,height:s}]}for(var y=0;y<f.length;y++)8===u?g=o(f[y],n,p,h,t,g):l(f[y],n,p,h,d,m);if(8===u){if(g!==t.length)throw new Error("extra data found")}else d.end();return n}},456:(t,e,n)=>{"use strict";var r=n(9208).Buffer,i=n(1157);t.exports=function(t,e,n,a){var s,o=-1!==[i.COLORTYPE_COLOR_ALPHA,i.COLORTYPE_ALPHA].indexOf(a.colorType);if(a.colorType===a.inputColorType){var l=(s=new ArrayBuffer(2),new DataView(s).setInt16(0,256,!0),256!==new Int16Array(s)[0]);if(8===a.bitDepth||16===a.bitDepth&&l)return t}var u=16!==a.bitDepth?t:new Uint16Array(t.buffer),h=255,c=i.COLORTYPE_TO_BPP_MAP[a.inputColorType];4!==c||a.inputHasAlpha||(c=3);var d=i.COLORTYPE_TO_BPP_MAP[a.colorType];16===a.bitDepth&&(h=65535,d*=2);var f=new r(e*n*d),p=0,m=0,g=a.bgColor||{};function b(){var t,e,n,r=h;switch(a.inputColorType){case i.COLORTYPE_COLOR_ALPHA:r=u[p+3],t=u[p],e=u[p+1],n=u[p+2];break;case i.COLORTYPE_COLOR:t=u[p],e=u[p+1],n=u[p+2];break;case i.COLORTYPE_ALPHA:r=u[p+1],e=t=u[p],n=t;break;case i.COLORTYPE_GRAYSCALE:e=t=u[p],n=t;break;default:throw new Error("input color type:"+a.inputColorType+" is not supported at present")}return a.inputHasAlpha&&(o||(r/=h,t=Math.min(Math.max(Math.round((1-r)*g.red+r*t),0),h),e=Math.min(Math.max(Math.round((1-r)*g.green+r*e),0),h),n=Math.min(Math.max(Math.round((1-r)*g.blue+r*n),0),h))),{red:t,green:e,blue:n,alpha:r}}void 0===g.red&&(g.red=h),void 0===g.green&&(g.green=h),void 0===g.blue&&(g.blue=h);for(var y=0;y<n;y++)for(var v=0;v<e;v++){var w=b();switch(a.colorType){case i.COLORTYPE_COLOR_ALPHA:case i.COLORTYPE_COLOR:8===a.bitDepth?(f[m]=w.red,f[m+1]=w.green,f[m+2]=w.blue,o&&(f[m+3]=w.alpha)):(f.writeUInt16BE(w.red,m),f.writeUInt16BE(w.green,m+2),f.writeUInt16BE(w.blue,m+4),o&&f.writeUInt16BE(w.alpha,m+6));break;case i.COLORTYPE_ALPHA:case i.COLORTYPE_GRAYSCALE:var _=(w.red+w.green+w.blue)/3;8===a.bitDepth?(f[m]=_,o&&(f[m+1]=w.alpha)):(f.writeUInt16BE(_,m),o&&f.writeUInt16BE(w.alpha,m+2));break;default:throw new Error("unrecognised color Type "+a.colorType)}p+=c,m+=d}return f}},7475:(t,e,n)=>{"use strict";var r=n(7671),i=n(9208).Buffer,a=n(9953),s=n(4663),o=t.exports=function(){s.call(this),this._buffers=[],this._buffered=0,this._reads=[],this._paused=!1,this._encoding="utf8",this.writable=!0};a.inherits(o,s),o.prototype.read=function(t,e){this._reads.push({length:Math.abs(t),allowLess:t<0,func:e}),r.nextTick(function(){this._process(),this._paused&&this._reads.length>0&&(this._paused=!1,this.emit("drain"))}.bind(this))},o.prototype.write=function(t,e){return this.writable?(n=i.isBuffer(t)?t:new i(t,e||this._encoding),this._buffers.push(n),this._buffered+=n.length,this._process(),this._reads&&0===this._reads.length&&(this._paused=!0),this.writable&&!this._paused):(this.emit("error",new Error("Stream not writable")),!1);var n},o.prototype.end=function(t,e){t&&this.write(t,e),this.writable=!1,this._buffers&&(0===this._buffers.length?this._end():(this._buffers.push(null),this._process()))},o.prototype.destroySoon=o.prototype.end,o.prototype._end=function(){this._reads.length>0&&this.emit("error",new Error("Unexpected end of input")),this.destroy()},o.prototype.destroy=function(){this._buffers&&(this.writable=!1,this._reads=null,this._buffers=null,this.emit("close"))},o.prototype._processReadAllowingLess=function(t){this._reads.shift();var e=this._buffers[0];e.length>t.length?(this._buffered-=t.length,this._buffers[0]=e.slice(t.length),t.func.call(this,e.slice(0,t.length))):(this._buffered-=e.length,this._buffers.shift(),t.func.call(this,e))},o.prototype._processRead=function(t){this._reads.shift();for(var e=0,n=0,r=new i(t.length);e<t.length;){var a=this._buffers[n++],s=Math.min(a.length,t.length-e);a.copy(r,e,0,s),e+=s,s!==a.length&&(this._buffers[--n]=a.slice(s))}n>0&&this._buffers.splice(0,n),this._buffered-=t.length,t.func.call(this,r)},o.prototype._process=function(){try{for(;this._buffered>0&&this._reads&&this._reads.length>0;){var t=this._reads[0];if(t.allowLess)this._processReadAllowingLess(t);else{if(!(this._buffered>=t.length))break;this._processRead(t)}}this._buffers&&!this.writable&&this._end()}catch(t){this.emit("error",t)}}},1157:t=>{"use strict";t.exports={PNG_SIGNATURE:[137,80,78,71,13,10,26,10],TYPE_IHDR:1229472850,TYPE_IEND:1229278788,TYPE_IDAT:1229209940,TYPE_PLTE:1347179589,TYPE_tRNS:1951551059,TYPE_gAMA:1732332865,COLORTYPE_GRAYSCALE:0,COLORTYPE_PALETTE:1,COLORTYPE_COLOR:2,COLORTYPE_ALPHA:4,COLORTYPE_PALETTE_COLOR:3,COLORTYPE_COLOR_ALPHA:6,COLORTYPE_TO_BPP_MAP:{0:1,2:3,3:1,4:2,6:4},GAMMA_DIVISION:1e5}},9315:t=>{"use strict";var e=[];!function(){for(var t=0;t<256;t++){for(var n=t,r=0;r<8;r++)1&n?n=3988292384^n>>>1:n>>>=1;e[t]=n}}();var n=t.exports=function(){this._crc=-1};n.prototype.write=function(t){for(var n=0;n<t.length;n++)this._crc=e[255&(this._crc^t[n])]^this._crc>>>8;return!0},n.prototype.crc32=function(){return-1^this._crc},n.crc32=function(t){for(var n=-1,r=0;r<t.length;r++)n=e[255&(n^t[r])]^n>>>8;return-1^n}},3737:(t,e,n)=>{"use strict";var r=n(9208).Buffer,i=n(251),a={0:function(t,e,n,r,i){for(var a=0;a<n;a++)r[i+a]=t[e+a]},1:function(t,e,n,r,i,a){for(var s=0;s<n;s++){var o=s>=a?t[e+s-a]:0,l=t[e+s]-o;r[i+s]=l}},2:function(t,e,n,r,i){for(var a=0;a<n;a++){var s=e>0?t[e+a-n]:0,o=t[e+a]-s;r[i+a]=o}},3:function(t,e,n,r,i,a){for(var s=0;s<n;s++){var o=s>=a?t[e+s-a]:0,l=e>0?t[e+s-n]:0,u=t[e+s]-(o+l>>1);r[i+s]=u}},4:function(t,e,n,r,a,s){for(var o=0;o<n;o++){var l=o>=s?t[e+o-s]:0,u=e>0?t[e+o-n]:0,h=e>0&&o>=s?t[e+o-(n+s)]:0,c=t[e+o]-i(l,u,h);r[a+o]=c}}},s={0:function(t,e,n){for(var r=0,i=e+n,a=e;a<i;a++)r+=Math.abs(t[a]);return r},1:function(t,e,n,r){for(var i=0,a=0;a<n;a++){var s=a>=r?t[e+a-r]:0,o=t[e+a]-s;i+=Math.abs(o)}return i},2:function(t,e,n){for(var r=0,i=e+n,a=e;a<i;a++){var s=e>0?t[a-n]:0,o=t[a]-s;r+=Math.abs(o)}return r},3:function(t,e,n,r){for(var i=0,a=0;a<n;a++){var s=a>=r?t[e+a-r]:0,o=e>0?t[e+a-n]:0,l=t[e+a]-(s+o>>1);i+=Math.abs(l)}return i},4:function(t,e,n,r){for(var a=0,s=0;s<n;s++){var o=s>=r?t[e+s-r]:0,l=e>0?t[e+s-n]:0,u=e>0&&s>=r?t[e+s-(n+r)]:0,h=t[e+s]-i(o,l,u);a+=Math.abs(h)}return a}};t.exports=function(t,e,n,i,o){var l;if("filterType"in i&&-1!==i.filterType){if("number"!=typeof i.filterType)throw new Error("unrecognised filter types");l=[i.filterType]}else l=[0,1,2,3,4];16===i.bitDepth&&(o*=2);for(var u=e*o,h=0,c=0,d=new r((u+1)*n),f=l[0],p=0;p<n;p++){if(l.length>1)for(var m=1/0,g=0;g<l.length;g++){var b=s[l[g]](t,c,u,o);b<m&&(f=l[g],m=b)}d[h]=f,h++,a[f](t,c,u,d,h,o),h+=u,c+=u}return d}},9772:(t,e,n)=>{"use strict";var r=n(9208).Buffer,i=n(9953),a=n(7475),s=n(3326),o=t.exports=function(t){a.call(this);var e=[],n=this;this._filter=new s(t,{read:this.read.bind(this),write:function(t){e.push(t)},complete:function(){n.emit("complete",r.concat(e))}}),this._filter.start()};i.inherits(o,a)},9538:(t,e,n)=>{"use strict";var r=n(9208).Buffer,i=n(4789),a=n(3326);e.process=function(t,e){var n=[],s=new i(t);return new a(e,{read:s.read.bind(s),write:function(t){n.push(t)},complete:function(){}}).start(),s.process(),r.concat(n)}},3326:(t,e,n)=>{"use strict";var r=n(9208).Buffer,i=n(4904),a=n(251);function s(t,e,n){var r=t*e;return 8!==n&&(r=Math.ceil(r/(8/n))),r}var o=t.exports=function(t,e){var n=t.width,r=t.height,a=t.interlace,o=t.bpp,l=t.depth;if(this.read=e.read,this.write=e.write,this.complete=e.complete,this._imageIndex=0,this._images=[],a)for(var u=i.getImagePasses(n,r),h=0;h<u.length;h++)this._images.push({byteWidth:s(u[h].width,o,l),height:u[h].height,lineIndex:0});else this._images.push({byteWidth:s(n,o,l),height:r,lineIndex:0});this._xComparison=8===l?o:16===l?2*o:1};o.prototype.start=function(){this.read(this._images[this._imageIndex].byteWidth+1,this._reverseFilterLine.bind(this))},o.prototype._unFilterType1=function(t,e,n){for(var r=this._xComparison,i=r-1,a=0;a<n;a++){var s=t[1+a],o=a>i?e[a-r]:0;e[a]=s+o}},o.prototype._unFilterType2=function(t,e,n){for(var r=this._lastLine,i=0;i<n;i++){var a=t[1+i],s=r?r[i]:0;e[i]=a+s}},o.prototype._unFilterType3=function(t,e,n){for(var r=this._xComparison,i=r-1,a=this._lastLine,s=0;s<n;s++){var o=t[1+s],l=a?a[s]:0,u=s>i?e[s-r]:0,h=Math.floor((u+l)/2);e[s]=o+h}},o.prototype._unFilterType4=function(t,e,n){for(var r=this._xComparison,i=r-1,s=this._lastLine,o=0;o<n;o++){var l=t[1+o],u=s?s[o]:0,h=o>i?e[o-r]:0,c=o>i&&s?s[o-r]:0,d=a(h,u,c);e[o]=l+d}},o.prototype._reverseFilterLine=function(t){var e,n=t[0],i=this._images[this._imageIndex],a=i.byteWidth;if(0===n)e=t.slice(1,a+1);else switch(e=new r(a),n){case 1:this._unFilterType1(t,e,a);break;case 2:this._unFilterType2(t,e,a);break;case 3:this._unFilterType3(t,e,a);break;case 4:this._unFilterType4(t,e,a);break;default:throw new Error("Unrecognised filter type - "+n)}this.write(e),i.lineIndex++,i.lineIndex>=i.height?(this._lastLine=null,this._imageIndex++,i=this._images[this._imageIndex]):this._lastLine=e,i?this.read(i.byteWidth+1,this._reverseFilterLine.bind(this)):(this._lastLine=null,this.complete())}},3910:(t,e,n)=>{"use strict";var r=n(9208).Buffer;t.exports=function(t,e){var n=e.depth,i=e.width,a=e.height,s=e.colorType,o=e.transColor,l=e.palette,u=t;return 3===s?function(t,e,n,r,i){for(var a=0,s=0;s<r;s++)for(var o=0;o<n;o++){var l=i[t[a]];if(!l)throw new Error("index "+t[a]+" not in palette");for(var u=0;u<4;u++)e[a+u]=l[u];a+=4}}(t,u,i,a,l):(o&&function(t,e,n,r,i){for(var a=0,s=0;s<r;s++)for(var o=0;o<n;o++){var l=!1;if(1===i.length?i[0]===t[a]&&(l=!0):i[0]===t[a]&&i[1]===t[a+1]&&i[2]===t[a+2]&&(l=!0),l)for(var u=0;u<4;u++)e[a+u]=0;a+=4}}(t,u,i,a,o),8!==n&&(16===n&&(u=new r(i*a*4)),function(t,e,n,r,i){for(var a=Math.pow(2,i)-1,s=0,o=0;o<r;o++)for(var l=0;l<n;l++){for(var u=0;u<4;u++)e[s+u]=Math.floor(255*t[s+u]/a+.5);s+=4}}(t,u,i,a,n))),u}},4904:(t,e)=>{"use strict";var n=[{x:[0],y:[0]},{x:[4],y:[0]},{x:[0,4],y:[4]},{x:[2,6],y:[0,4]},{x:[0,2,4,6],y:[2,6]},{x:[1,3,5,7],y:[0,2,4,6]},{x:[0,1,2,3,4,5,6,7],y:[1,3,5,7]}];e.getImagePasses=function(t,e){for(var r=[],i=t%8,a=e%8,s=(t-i)/8,o=(e-a)/8,l=0;l<n.length;l++){for(var u=n[l],h=s*u.x.length,c=o*u.y.length,d=0;d<u.x.length&&u.x[d]<i;d++)h++;for(d=0;d<u.y.length&&u.y[d]<a;d++)c++;h>0&&c>0&&r.push({width:h,height:c,index:l})}return r},e.getInterlaceIterator=function(t){return function(e,r,i){var a=e%n[i].x.length,s=(e-a)/n[i].x.length*8+n[i].x[a],o=r%n[i].y.length;return 4*s+((r-o)/n[i].y.length*8+n[i].y[o])*t*4}}},8716:(t,e,n)=>{"use strict";var r=n(9208).Buffer,i=n(9953),a=n(4663),s=n(1157),o=n(8105),l=t.exports=function(t){a.call(this);var e=t||{};this._packer=new o(e),this._deflate=this._packer.createDeflate(),this.readable=!0};i.inherits(l,a),l.prototype.pack=function(t,e,n,i){this.emit("data",new r(s.PNG_SIGNATURE)),this.emit("data",this._packer.packIHDR(e,n)),i&&this.emit("data",this._packer.packGAMA(i));var a=this._packer.filterData(t,e,n);this._deflate.on("error",this.emit.bind(this,"error")),this._deflate.on("data",function(t){this.emit("data",this._packer.packIDAT(t))}.bind(this)),this._deflate.on("end",function(){this.emit("data",this._packer.packIEND()),this.emit("end")}.bind(this)),this._deflate.end(a)}},4313:(t,e,n)=>{"use strict";var r=n(9208).Buffer,i=!0,a=n(6189);a.deflateSync||(i=!1);var s=n(1157),o=n(8105);t.exports=function(t,e){if(!i)throw new Error("To use the sync capability of this library in old node versions, please pin pngjs to v2.3.0");var n=new o(e||{}),l=[];l.push(new r(s.PNG_SIGNATURE)),l.push(n.packIHDR(t.width,t.height)),t.gamma&&l.push(n.packGAMA(t.gamma));var u=n.filterData(t.data,t.width,t.height),h=a.deflateSync(u,n.getDeflateOptions());if(u=null,!h||!h.length)throw new Error("bad png - invalid compressed data response");return l.push(n.packIDAT(h)),l.push(n.packIEND()),r.concat(l)}},8105:(t,e,n)=>{"use strict";var r=n(9208).Buffer,i=n(1157),a=n(9315),s=n(456),o=n(3737),l=n(6189),u=t.exports=function(t){if(this._options=t,t.deflateChunkSize=t.deflateChunkSize||32768,t.deflateLevel=null!=t.deflateLevel?t.deflateLevel:9,t.deflateStrategy=null!=t.deflateStrategy?t.deflateStrategy:3,t.inputHasAlpha=null==t.inputHasAlpha||t.inputHasAlpha,t.deflateFactory=t.deflateFactory||l.createDeflate,t.bitDepth=t.bitDepth||8,t.colorType="number"==typeof t.colorType?t.colorType:i.COLORTYPE_COLOR_ALPHA,t.inputColorType="number"==typeof t.inputColorType?t.inputColorType:i.COLORTYPE_COLOR_ALPHA,-1===[i.COLORTYPE_GRAYSCALE,i.COLORTYPE_COLOR,i.COLORTYPE_COLOR_ALPHA,i.COLORTYPE_ALPHA].indexOf(t.colorType))throw new Error("option color type:"+t.colorType+" is not supported at present");if(-1===[i.COLORTYPE_GRAYSCALE,i.COLORTYPE_COLOR,i.COLORTYPE_COLOR_ALPHA,i.COLORTYPE_ALPHA].indexOf(t.inputColorType))throw new Error("option input color type:"+t.inputColorType+" is not supported at present");if(8!==t.bitDepth&&16!==t.bitDepth)throw new Error("option bit depth:"+t.bitDepth+" is not supported at present")};u.prototype.getDeflateOptions=function(){return{chunkSize:this._options.deflateChunkSize,level:this._options.deflateLevel,strategy:this._options.deflateStrategy}},u.prototype.createDeflate=function(){return this._options.deflateFactory(this.getDeflateOptions())},u.prototype.filterData=function(t,e,n){var r=s(t,e,n,this._options),a=i.COLORTYPE_TO_BPP_MAP[this._options.colorType];return o(r,e,n,this._options,a)},u.prototype._packChunk=function(t,e){var n=e?e.length:0,i=new r(n+12);return i.writeUInt32BE(n,0),i.writeUInt32BE(t,4),e&&e.copy(i,8),i.writeInt32BE(a.crc32(i.slice(4,i.length-4)),i.length-4),i},u.prototype.packGAMA=function(t){var e=new r(4);return e.writeUInt32BE(Math.floor(t*i.GAMMA_DIVISION),0),this._packChunk(i.TYPE_gAMA,e)},u.prototype.packIHDR=function(t,e){var n=new r(13);return n.writeUInt32BE(t,0),n.writeUInt32BE(e,4),n[8]=this._options.bitDepth,n[9]=this._options.colorType,n[10]=0,n[11]=0,n[12]=0,this._packChunk(i.TYPE_IHDR,n)},u.prototype.packIDAT=function(t){return this._packChunk(i.TYPE_IDAT,t)},u.prototype.packIEND=function(){return this._packChunk(i.TYPE_IEND,null)}},251:t=>{"use strict";t.exports=function(t,e,n){var r=t+e-n,i=Math.abs(r-t),a=Math.abs(r-e),s=Math.abs(r-n);return i<=a&&i<=s?t:a<=s?e:n}},4021:(t,e,n)=>{"use strict";var r=n(9953),i=n(6189),a=n(7475),s=n(9772),o=n(3664),l=n(6159),u=n(3910),h=t.exports=function(t){a.call(this),this._parser=new o(t,{read:this.read.bind(this),error:this._handleError.bind(this),metadata:this._handleMetaData.bind(this),gamma:this.emit.bind(this,"gamma"),palette:this._handlePalette.bind(this),transColor:this._handleTransColor.bind(this),finished:this._finished.bind(this),inflateData:this._inflateData.bind(this),simpleTransparency:this._simpleTransparency.bind(this),headersFinished:this._headersFinished.bind(this)}),this._options=t,this.writable=!0,this._parser.start()};r.inherits(h,a),h.prototype._handleError=function(t){this.emit("error",t),this.writable=!1,this.destroy(),this._inflate&&this._inflate.destroy&&this._inflate.destroy(),this._filter&&(this._filter.destroy(),this._filter.on("error",(function(){}))),this.errord=!0},h.prototype._inflateData=function(t){if(!this._inflate)if(this._bitmapInfo.interlace)this._inflate=i.createInflate(),this._inflate.on("error",this.emit.bind(this,"error")),this._filter.on("complete",this._complete.bind(this)),this._inflate.pipe(this._filter);else{var e=(1+(this._bitmapInfo.width*this._bitmapInfo.bpp*this._bitmapInfo.depth+7>>3))*this._bitmapInfo.height,n=Math.max(e,i.Z_MIN_CHUNK);this._inflate=i.createInflate({chunkSize:n});var r=e,a=this.emit.bind(this,"error");this._inflate.on("error",(function(t){r&&a(t)})),this._filter.on("complete",this._complete.bind(this));var s=this._filter.write.bind(this._filter);this._inflate.on("data",(function(t){r&&(t.length>r&&(t=t.slice(0,r)),r-=t.length,s(t))})),this._inflate.on("end",this._filter.end.bind(this._filter))}this._inflate.write(t)},h.prototype._handleMetaData=function(t){this._metaData=t,this._bitmapInfo=Object.create(t),this._filter=new s(this._bitmapInfo)},h.prototype._handleTransColor=function(t){this._bitmapInfo.transColor=t},h.prototype._handlePalette=function(t){this._bitmapInfo.palette=t},h.prototype._simpleTransparency=function(){this._metaData.alpha=!0},h.prototype._headersFinished=function(){this.emit("metadata",this._metaData)},h.prototype._finished=function(){this.errord||(this._inflate?this._inflate.end():this.emit("error","No Inflate block"),this.destroySoon())},h.prototype._complete=function(t){if(!this.errord){try{var e=l.dataToBitMap(t,this._bitmapInfo),n=u(e,this._bitmapInfo);e=null}catch(t){return void this._handleError(t)}this.emit("parsed",n)}}},1469:(t,e,n)=>{"use strict";var r=n(9208).Buffer,i=!0,a=n(6189),s=n(9079);a.deflateSync||(i=!1);var o=n(4789),l=n(9538),u=n(3664),h=n(6159),c=n(3910);t.exports=function(t,e){if(!i)throw new Error("To use the sync capability of this library in old node versions, please pin pngjs to v2.3.0");var n,d,f,p=[],m=new o(t),g=new u(e,{read:m.read.bind(m),error:function(t){n=t},metadata:function(t){d=t},gamma:function(t){f=t},palette:function(t){d.palette=t},transColor:function(t){d.transColor=t},inflateData:function(t){p.push(t)},simpleTransparency:function(){d.alpha=!0}});if(g.start(),m.process(),n)throw n;var b,y=r.concat(p);if(p.length=0,d.interlace)b=a.inflateSync(y);else{var v=(1+(d.width*d.bpp*d.depth+7>>3))*d.height;b=s(y,{chunkSize:v,maxLength:v})}if(y=null,!b||!b.length)throw new Error("bad png - invalid inflate data response");var w=l.process(b,d);y=null;var _=h.dataToBitMap(w,d);w=null;var k=c(_,d);return d.data=k,d.gamma=f||0,d}},3664:(t,e,n)=>{"use strict";var r=n(9208).Buffer,i=n(1157),a=n(9315),s=t.exports=function(t,e){this._options=t,t.checkCRC=!1!==t.checkCRC,this._hasIHDR=!1,this._hasIEND=!1,this._emittedHeadersFinished=!1,this._palette=[],this._colorType=0,this._chunks={},this._chunks[i.TYPE_IHDR]=this._handleIHDR.bind(this),this._chunks[i.TYPE_IEND]=this._handleIEND.bind(this),this._chunks[i.TYPE_IDAT]=this._handleIDAT.bind(this),this._chunks[i.TYPE_PLTE]=this._handlePLTE.bind(this),this._chunks[i.TYPE_tRNS]=this._handleTRNS.bind(this),this._chunks[i.TYPE_gAMA]=this._handleGAMA.bind(this),this.read=e.read,this.error=e.error,this.metadata=e.metadata,this.gamma=e.gamma,this.transColor=e.transColor,this.palette=e.palette,this.parsed=e.parsed,this.inflateData=e.inflateData,this.finished=e.finished,this.simpleTransparency=e.simpleTransparency,this.headersFinished=e.headersFinished||function(){}};s.prototype.start=function(){this.read(i.PNG_SIGNATURE.length,this._parseSignature.bind(this))},s.prototype._parseSignature=function(t){for(var e=i.PNG_SIGNATURE,n=0;n<e.length;n++)if(t[n]!==e[n])return void this.error(new Error("Invalid file signature"));this.read(8,this._parseChunkBegin.bind(this))},s.prototype._parseChunkBegin=function(t){for(var e=t.readUInt32BE(0),n=t.readUInt32BE(4),s="",o=4;o<8;o++)s+=String.fromCharCode(t[o]);var l=Boolean(32&t[4]);if(this._hasIHDR||n===i.TYPE_IHDR){if(this._crc=new a,this._crc.write(new r(s)),this._chunks[n])return this._chunks[n](e);l?this.read(e+4,this._skipChunk.bind(this)):this.error(new Error("Unsupported critical chunk type "+s))}else this.error(new Error("Expected IHDR on beggining"))},s.prototype._skipChunk=function(){this.read(8,this._parseChunkBegin.bind(this))},s.prototype._handleChunkEnd=function(){this.read(4,this._parseChunkEnd.bind(this))},s.prototype._parseChunkEnd=function(t){var e=t.readInt32BE(0),n=this._crc.crc32();this._options.checkCRC&&n!==e?this.error(new Error("Crc error - "+e+" - "+n)):this._hasIEND||this.read(8,this._parseChunkBegin.bind(this))},s.prototype._handleIHDR=function(t){this.read(t,this._parseIHDR.bind(this))},s.prototype._parseIHDR=function(t){this._crc.write(t);var e=t.readUInt32BE(0),n=t.readUInt32BE(4),r=t[8],a=t[9],s=t[10],o=t[11],l=t[12];if(8===r||4===r||2===r||1===r||16===r)if(a in i.COLORTYPE_TO_BPP_MAP)if(0===s)if(0===o)if(0===l||1===l){this._colorType=a;var u=i.COLORTYPE_TO_BPP_MAP[this._colorType];this._hasIHDR=!0,this.metadata({width:e,height:n,depth:r,interlace:Boolean(l),palette:Boolean(a&i.COLORTYPE_PALETTE),color:Boolean(a&i.COLORTYPE_COLOR),alpha:Boolean(a&i.COLORTYPE_ALPHA),bpp:u,colorType:a}),this._handleChunkEnd()}else this.error(new Error("Unsupported interlace method"));else this.error(new Error("Unsupported filter method"));else this.error(new Error("Unsupported compression method"));else this.error(new Error("Unsupported color type"));else this.error(new Error("Unsupported bit depth "+r))},s.prototype._handlePLTE=function(t){this.read(t,this._parsePLTE.bind(this))},s.prototype._parsePLTE=function(t){this._crc.write(t);for(var e=Math.floor(t.length/3),n=0;n<e;n++)this._palette.push([t[3*n],t[3*n+1],t[3*n+2],255]);this.palette(this._palette),this._handleChunkEnd()},s.prototype._handleTRNS=function(t){this.simpleTransparency(),this.read(t,this._parseTRNS.bind(this))},s.prototype._parseTRNS=function(t){if(this._crc.write(t),this._colorType===i.COLORTYPE_PALETTE_COLOR){if(0===this._palette.length)return void this.error(new Error("Transparency chunk must be after palette"));if(t.length>this._palette.length)return void this.error(new Error("More transparent colors than palette size"));for(var e=0;e<t.length;e++)this._palette[e][3]=t[e];this.palette(this._palette)}this._colorType===i.COLORTYPE_GRAYSCALE&&this.transColor([t.readUInt16BE(0)]),this._colorType===i.COLORTYPE_COLOR&&this.transColor([t.readUInt16BE(0),t.readUInt16BE(2),t.readUInt16BE(4)]),this._handleChunkEnd()},s.prototype._handleGAMA=function(t){this.read(t,this._parseGAMA.bind(this))},s.prototype._parseGAMA=function(t){this._crc.write(t),this.gamma(t.readUInt32BE(0)/i.GAMMA_DIVISION),this._handleChunkEnd()},s.prototype._handleIDAT=function(t){this._emittedHeadersFinished||(this._emittedHeadersFinished=!0,this.headersFinished()),this.read(-t,this._parseIDAT.bind(this,t))},s.prototype._parseIDAT=function(t,e){if(this._crc.write(e),this._colorType===i.COLORTYPE_PALETTE_COLOR&&0===this._palette.length)throw new Error("Expected palette not found");this.inflateData(e);var n=t-e.length;n>0?this._handleIDAT(n):this._handleChunkEnd()},s.prototype._handleIEND=function(t){this.read(t,this._parseIEND.bind(this))},s.prototype._parseIEND=function(t){this._crc.write(t),this._hasIEND=!0,this._handleChunkEnd(),this.finished&&this.finished()}},3170:(t,e,n)=>{"use strict";var r=n(1469),i=n(4313);e.read=function(t,e){return r(t,e||{})},e.write=function(t,e){return i(t,e)}},6941:(t,e,n)=>{"use strict";var r=n(9208).Buffer,i=n(7671),a=n(9953),s=n(4663),o=n(4021),l=n(8716),u=n(3170),h=e.PNG=function(t){s.call(this),t=t||{},this.width=0|t.width,this.height=0|t.height,this.data=this.width>0&&this.height>0?new r(4*this.width*this.height):null,t.fill&&this.data&&this.data.fill(0),this.gamma=0,this.readable=this.writable=!0,this._parser=new o(t),this._parser.on("error",this.emit.bind(this,"error")),this._parser.on("close",this._handleClose.bind(this)),this._parser.on("metadata",this._metadata.bind(this)),this._parser.on("gamma",this._gamma.bind(this)),this._parser.on("parsed",function(t){this.data=t,this.emit("parsed",t)}.bind(this)),this._packer=new l(t),this._packer.on("data",this.emit.bind(this,"data")),this._packer.on("end",this.emit.bind(this,"end")),this._parser.on("close",this._handleClose.bind(this)),this._packer.on("error",this.emit.bind(this,"error"))};a.inherits(h,s),h.sync=u,h.prototype.pack=function(){return this.data&&this.data.length?(i.nextTick(function(){this._packer.pack(this.data,this.width,this.height,this.gamma)}.bind(this)),this):(this.emit("error","No data provided"),this)},h.prototype.parse=function(t,e){var n,r;return e&&(n=function(t){this.removeListener("error",r),this.data=t,e(null,this)}.bind(this),r=function(t){this.removeListener("parsed",n),e(t,null)}.bind(this),this.once("parsed",n),this.once("error",r)),this.end(t),this},h.prototype.write=function(t){return this._parser.write(t),!0},h.prototype.end=function(t){this._parser.end(t)},h.prototype._metadata=function(t){this.width=t.width,this.height=t.height,this.emit("metadata",t)},h.prototype._gamma=function(t){this.gamma=t},h.prototype._handleClose=function(){this._parser.writable||this._packer.readable||this.emit("close")},h.bitblt=function(t,e,n,r,i,a,s,o){if(r|=0,i|=0,a|=0,s|=0,o|=0,(n|=0)>t.width||r>t.height||n+i>t.width||r+a>t.height)throw new Error("bitblt reading outside image");if(s>e.width||o>e.height||s+i>e.width||o+a>e.height)throw new Error("bitblt writing outside image");for(var l=0;l<a;l++)t.data.copy(e.data,(o+l)*e.width+s<<2,(r+l)*t.width+n<<2,(r+l)*t.width+n+i<<2)},h.prototype.bitblt=function(t,e,n,r,i,a,s){return h.bitblt(this,t,e,n,r,i,a,s),this},h.adjustGamma=function(t){if(t.gamma){for(var e=0;e<t.height;e++)for(var n=0;n<t.width;n++)for(var r=t.width*e+n<<2,i=0;i<3;i++){var a=t.data[r+i]/255;a=Math.pow(a,1/2.2/t.gamma),t.data[r+i]=Math.round(255*a)}t.gamma=0}},h.prototype.adjustGamma=function(){h.adjustGamma(this)}},9079:(t,e,n)=>{"use strict";var r=n(7671),i=n(9208).Buffer,a=n(6188).ok,s=n(6189),o=n(9953),l=n(9208).kMaxLength;function u(t){if(!(this instanceof u))return new u(t);t&&t.chunkSize<s.Z_MIN_CHUNK&&(t.chunkSize=s.Z_MIN_CHUNK),s.Inflate.call(this,t),this._offset=void 0===this._offset?this._outOffset:this._offset,this._buffer=this._buffer||this._outBuffer,t&&null!=t.maxLength&&(this._maxLength=t.maxLength)}function h(t,e){e&&r.nextTick(e),t._handle&&(t._handle.close(),t._handle=null)}function c(t,e){return function(t,e){if("string"==typeof e&&(e=i.from(e)),!(e instanceof i))throw new TypeError("Not a string or buffer");var n=t._finishFlushFlag;return null==n&&(n=s.Z_FINISH),t._processChunk(e,n)}(new u(e),t)}u.prototype._processChunk=function(t,e,n){if("function"==typeof n)return s.Inflate._processChunk.call(this,t,e,n);var r,o=this,u=t&&t.length,c=this._chunkSize-this._offset,d=this._maxLength,f=0,p=[],m=0;function g(t,e){if(!o._hadError){var n=c-e;if(a(n>=0,"have should not go down"),n>0){var r=o._buffer.slice(o._offset,o._offset+n);if(o._offset+=n,r.length>d&&(r=r.slice(0,d)),p.push(r),m+=r.length,0==(d-=r.length))return!1}return(0===e||o._offset>=o._chunkSize)&&(c=o._chunkSize,o._offset=0,o._buffer=i.allocUnsafe(o._chunkSize)),0===e&&(f+=u-t,u=t,!0)}}this.on("error",(function(t){r=t})),a(this._handle,"zlib binding closed");do{var b=this._handle.writeSync(e,t,f,u,this._buffer,this._offset,c);b=b||this._writeState}while(!this._hadError&&g(b[0],b[1]));if(this._hadError)throw r;if(m>=l)throw h(this),new RangeError("Cannot create final Buffer. It would be larger than 0x"+l.toString(16)+" bytes");var y=i.concat(p,m);return h(this),y},o.inherits(u,s.Inflate),t.exports=e=c,e.Inflate=u,e.createInflate=function(t){return new u(t)},e.inflateSync=c},4789:t=>{"use strict";var e=t.exports=function(t){this._buffer=t,this._reads=[]};e.prototype.read=function(t,e){this._reads.push({length:Math.abs(t),allowLess:t<0,func:e})},e.prototype.process=function(){for(;this._reads.length>0&&this._buffer.length;){var t=this._reads[0];if(!this._buffer.length||!(this._buffer.length>=t.length||t.allowLess))break;this._reads.shift();var e=this._buffer;this._buffer=e.slice(t.length),t.func.call(this,e.slice(0,t.length))}return this._reads.length>0?new Error("There are some read requests waitng on finished stream"):this._buffer.length>0?new Error("unrecognised content at end of stream"):void 0}},9020:(t,e,n)=>{"use strict";var r=n(7671);void 0===r||!r.version||0===r.version.indexOf("v0.")||0===r.version.indexOf("v1.")&&0!==r.version.indexOf("v1.8.")?t.exports={nextTick:function(t,e,n,i){if("function"!=typeof t)throw new TypeError('"callback" argument must be a function');var a,s,o=arguments.length;switch(o){case 0:case 1:return r.nextTick(t);case 2:return r.nextTick((function(){t.call(null,e)}));case 3:return r.nextTick((function(){t.call(null,e,n)}));case 4:return r.nextTick((function(){t.call(null,e,n,i)}));default:for(a=new Array(o-1),s=0;s<a.length;)a[s++]=arguments[s];return r.nextTick((function(){t.apply(null,a)}))}}}:t.exports=r},7671:t=>{var e,n,r=t.exports={};function i(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(t){if(e===setTimeout)return setTimeout(t,0);if((e===i||!e)&&setTimeout)return e=setTimeout,setTimeout(t,0);try{return e(t,0)}catch(n){try{return e.call(null,t,0)}catch(n){return e.call(this,t,0)}}}!function(){try{e="function"==typeof setTimeout?setTimeout:i}catch(t){e=i}try{n="function"==typeof clearTimeout?clearTimeout:a}catch(t){n=a}}();var o,l=[],u=!1,h=-1;function c(){u&&o&&(u=!1,o.length?l=o.concat(l):h=-1,l.length&&d())}function d(){if(!u){var t=s(c);u=!0;for(var e=l.length;e;){for(o=l,l=[];++h<e;)o&&o[h].run();h=-1,e=l.length}o=null,u=!1,function(t){if(n===clearTimeout)return clearTimeout(t);if((n===a||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(t);try{n(t)}catch(e){try{return n.call(null,t)}catch(e){return n.call(this,t)}}}(t)}}function f(t,e){this.fun=t,this.array=e}function p(){}r.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];l.push(new f(t,e)),1!==l.length||u||s(d)},f.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=p,r.addListener=p,r.once=p,r.off=p,r.removeListener=p,r.removeAllListeners=p,r.emit=p,r.prependListener=p,r.prependOnceListener=p,r.listeners=function(t){return[]},r.binding=function(t){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(t){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},4489:function(t,e,n){var r;t=n.nmd(t),function(i){e&&e.nodeType,t&&t.nodeType;var a="object"==typeof n.g&&n.g;a.global!==a&&a.window!==a&&a.self;var s,o=2147483647,l=36,u=/^xn--/,h=/[^\x20-\x7E]/,c=/[\x2E\u3002\uFF0E\uFF61]/g,d={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},f=Math.floor,p=String.fromCharCode;function m(t){throw RangeError(d[t])}function g(t,e){for(var n=t.length,r=[];n--;)r[n]=e(t[n]);return r}function b(t,e){var n=t.split("@"),r="";return n.length>1&&(r=n[0]+"@",t=n[1]),r+g((t=t.replace(c,".")).split("."),e).join(".")}function y(t){for(var e,n,r=[],i=0,a=t.length;i<a;)(e=t.charCodeAt(i++))>=55296&&e<=56319&&i<a?56320==(64512&(n=t.charCodeAt(i++)))?r.push(((1023&e)<<10)+(1023&n)+65536):(r.push(e),i--):r.push(e);return r}function v(t){return g(t,(function(t){var e="";return t>65535&&(e+=p((t-=65536)>>>10&1023|55296),t=56320|1023&t),e+p(t)})).join("")}function w(t,e){return t+22+75*(t<26)-((0!=e)<<5)}function _(t,e,n){var r=0;for(t=n?f(t/700):t>>1,t+=f(t/e);t>455;r+=l)t=f(t/35);return f(r+36*t/(t+38))}function k(t){var e,n,r,i,a,s,u,h,c,d,p,g=[],b=t.length,y=0,w=128,k=72;for((n=t.lastIndexOf("-"))<0&&(n=0),r=0;r<n;++r)t.charCodeAt(r)>=128&&m("not-basic"),g.push(t.charCodeAt(r));for(i=n>0?n+1:0;i<b;){for(a=y,s=1,u=l;i>=b&&m("invalid-input"),((h=(p=t.charCodeAt(i++))-48<10?p-22:p-65<26?p-65:p-97<26?p-97:l)>=l||h>f((o-y)/s))&&m("overflow"),y+=h*s,!(h<(c=u<=k?1:u>=k+26?26:u-k));u+=l)s>f(o/(d=l-c))&&m("overflow"),s*=d;k=_(y-a,e=g.length+1,0==a),f(y/e)>o-w&&m("overflow"),w+=f(y/e),y%=e,g.splice(y++,0,w)}return v(g)}function x(t){var e,n,r,i,a,s,u,h,c,d,g,b,v,k,x,S=[];for(b=(t=y(t)).length,e=128,n=0,a=72,s=0;s<b;++s)(g=t[s])<128&&S.push(p(g));for(r=i=S.length,i&&S.push("-");r<b;){for(u=o,s=0;s<b;++s)(g=t[s])>=e&&g<u&&(u=g);for(u-e>f((o-n)/(v=r+1))&&m("overflow"),n+=(u-e)*v,e=u,s=0;s<b;++s)if((g=t[s])<e&&++n>o&&m("overflow"),g==e){for(h=n,c=l;!(h<(d=c<=a?1:c>=a+26?26:c-a));c+=l)x=h-d,k=l-d,S.push(p(w(d+x%k,0))),h=f(x/k);S.push(p(w(h,0))),a=_(n,v,r==i),n=0,++r}++n,++e}return S.join("")}s={version:"1.3.2",ucs2:{decode:y,encode:v},decode:k,encode:x,toASCII:function(t){return b(t,(function(t){return h.test(t)?"xn--"+x(t):t}))},toUnicode:function(t){return b(t,(function(t){return u.test(t)?k(t.slice(4).toLowerCase()):t}))}},void 0===(r=function(){return s}.call(e,n,e,t))||(t.exports=r)}()},5719:t=>{"use strict";function e(t,e){return Object.prototype.hasOwnProperty.call(t,e)}t.exports=function(t,n,r,i){n=n||"&",r=r||"=";var a={};if("string"!=typeof t||0===t.length)return a;var s=/\+/g;t=t.split(n);var o=1e3;i&&"number"==typeof i.maxKeys&&(o=i.maxKeys);var l=t.length;o>0&&l>o&&(l=o);for(var u=0;u<l;++u){var h,c,d,f,p=t[u].replace(s,"%20"),m=p.indexOf(r);m>=0?(h=p.substr(0,m),c=p.substr(m+1)):(h=p,c=""),d=decodeURIComponent(h),f=decodeURIComponent(c),e(a,d)?Array.isArray(a[d])?a[d].push(f):a[d]=[a[d],f]:a[d]=f}return a}},3612:t=>{"use strict";var e=function(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}};t.exports=function(t,n,r,i){return n=n||"&",r=r||"=",null===t&&(t=void 0),"object"==typeof t?Object.keys(t).map((function(i){var a=encodeURIComponent(e(i))+r;return Array.isArray(t[i])?t[i].map((function(t){return a+encodeURIComponent(e(t))})).join(n):a+encodeURIComponent(e(t[i]))})).join(n):i?encodeURIComponent(e(i))+r+encodeURIComponent(e(t)):""}},7459:(t,e,n)=>{"use strict";e.decode=e.parse=n(5719),e.encode=e.stringify=n(3612)},2063:(t,e,n)=>{t.exports=n(9927)},9927:(t,e,n)=>{"use strict";var r=n(9020),i=Object.keys||function(t){var e=[];for(var n in t)e.push(n);return e};t.exports=c;var a=Object.create(n(7801));a.inherits=n(4603);var s=n(1680),o=n(5228);a.inherits(c,s);for(var l=i(o.prototype),u=0;u<l.length;u++){var h=l[u];c.prototype[h]||(c.prototype[h]=o.prototype[h])}function c(t){if(!(this instanceof c))return new c(t);s.call(this,t),o.call(this,t),t&&!1===t.readable&&(this.readable=!1),t&&!1===t.writable&&(this.writable=!1),this.allowHalfOpen=!0,t&&!1===t.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",d)}function d(){this.allowHalfOpen||this._writableState.ended||r.nextTick(f,this)}function f(t){t.end()}Object.defineProperty(c.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(c.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set:function(t){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=t,this._writableState.destroyed=t)}}),c.prototype._destroy=function(t,e){this.push(null),this.end(),r.nextTick(e,t)}},1379:(t,e,n)=>{"use strict";t.exports=a;var r=n(4951),i=Object.create(n(7801));function a(t){if(!(this instanceof a))return new a(t);r.call(this,t)}i.inherits=n(4603),i.inherits(a,r),a.prototype._transform=function(t,e,n){n(null,t)}},1680:(t,e,n)=>{"use strict";var r=n(7671),i=n(9020);t.exports=v;var a,s=n(9100);v.ReadableState=y,n(6204).EventEmitter;var o=function(t,e){return t.listeners(e).length},l=n(632),u=n(5299).Buffer,h=n.g.Uint8Array||function(){},c=Object.create(n(7801));c.inherits=n(4603);var d=n(779),f=void 0;f=d&&d.debuglog?d.debuglog("stream"):function(){};var p,m=n(6691),g=n(737);c.inherits(v,l);var b=["error","close","destroy","pause","resume"];function y(t,e){t=t||{};var r=e instanceof(a=a||n(9927));this.objectMode=!!t.objectMode,r&&(this.objectMode=this.objectMode||!!t.readableObjectMode);var i=t.highWaterMark,s=t.readableHighWaterMark,o=this.objectMode?16:16384;this.highWaterMark=i||0===i?i:r&&(s||0===s)?s:o,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new m,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(p||(p=n(1212).s),this.decoder=new p(t.encoding),this.encoding=t.encoding)}function v(t){if(a=a||n(9927),!(this instanceof v))return new v(t);this._readableState=new y(t,this),this.readable=!0,t&&("function"==typeof t.read&&(this._read=t.read),"function"==typeof t.destroy&&(this._destroy=t.destroy)),l.call(this)}function w(t,e,n,r,i){var a,s=t._readableState;return null===e?(s.reading=!1,function(t,e){if(!e.ended){if(e.decoder){var n=e.decoder.end();n&&n.length&&(e.buffer.push(n),e.length+=e.objectMode?1:n.length)}e.ended=!0,S(t)}}(t,s)):(i||(a=function(t,e){var n,r;return r=e,u.isBuffer(r)||r instanceof h||"string"==typeof e||void 0===e||t.objectMode||(n=new TypeError("Invalid non-string/buffer chunk")),n}(s,e)),a?t.emit("error",a):s.objectMode||e&&e.length>0?("string"==typeof e||s.objectMode||Object.getPrototypeOf(e)===u.prototype||(e=function(t){return u.from(t)}(e)),r?s.endEmitted?t.emit("error",new Error("stream.unshift() after end event")):_(t,s,e,!0):s.ended?t.emit("error",new Error("stream.push() after EOF")):(s.reading=!1,s.decoder&&!n?(e=s.decoder.write(e),s.objectMode||0!==e.length?_(t,s,e,!1):I(t,s)):_(t,s,e,!1))):r||(s.reading=!1)),function(t){return!t.ended&&(t.needReadable||t.length<t.highWaterMark||0===t.length)}(s)}function _(t,e,n,r){e.flowing&&0===e.length&&!e.sync?(t.emit("data",n),t.read(0)):(e.length+=e.objectMode?1:n.length,r?e.buffer.unshift(n):e.buffer.push(n),e.needReadable&&S(t)),I(t,e)}Object.defineProperty(v.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(t){this._readableState&&(this._readableState.destroyed=t)}}),v.prototype.destroy=g.destroy,v.prototype._undestroy=g.undestroy,v.prototype._destroy=function(t,e){this.push(null),e(t)},v.prototype.push=function(t,e){var n,r=this._readableState;return r.objectMode?n=!0:"string"==typeof t&&((e=e||r.defaultEncoding)!==r.encoding&&(t=u.from(t,e),e=""),n=!0),w(this,t,e,!1,n)},v.prototype.unshift=function(t){return w(this,t,null,!0,!1)},v.prototype.isPaused=function(){return!1===this._readableState.flowing},v.prototype.setEncoding=function(t){return p||(p=n(1212).s),this._readableState.decoder=new p(t),this._readableState.encoding=t,this};var k=8388608;function x(t,e){return t<=0||0===e.length&&e.ended?0:e.objectMode?1:t!=t?e.flowing&&e.length?e.buffer.head.data.length:e.length:(t>e.highWaterMark&&(e.highWaterMark=function(t){return t>=k?t=k:(t--,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t++),t}(t)),t<=e.length?t:e.ended?e.length:(e.needReadable=!0,0))}function S(t){var e=t._readableState;e.needReadable=!1,e.emittedReadable||(f("emitReadable",e.flowing),e.emittedReadable=!0,e.sync?i.nextTick(E,t):E(t))}function E(t){f("emit readable"),t.emit("readable"),N(t)}function I(t,e){e.readingMore||(e.readingMore=!0,i.nextTick(A,t,e))}function A(t,e){for(var n=e.length;!e.reading&&!e.flowing&&!e.ended&&e.length<e.highWaterMark&&(f("maybeReadMore read 0"),t.read(0),n!==e.length);)n=e.length;e.readingMore=!1}function M(t){f("readable nexttick read 0"),t.read(0)}function T(t,e){e.reading||(f("resume read 0"),t.read(0)),e.resumeScheduled=!1,e.awaitDrain=0,t.emit("resume"),N(t),e.flowing&&!e.reading&&t.read(0)}function N(t){var e=t._readableState;for(f("flow",e.flowing);e.flowing&&null!==t.read(););}function C(t,e){return 0===e.length?null:(e.objectMode?n=e.buffer.shift():!t||t>=e.length?(n=e.decoder?e.buffer.join(""):1===e.buffer.length?e.buffer.head.data:e.buffer.concat(e.length),e.buffer.clear()):n=function(t,e,n){var r;return t<e.head.data.length?(r=e.head.data.slice(0,t),e.head.data=e.head.data.slice(t)):r=t===e.head.data.length?e.shift():n?function(t,e){var n=e.head,r=1,i=n.data;for(t-=i.length;n=n.next;){var a=n.data,s=t>a.length?a.length:t;if(s===a.length?i+=a:i+=a.slice(0,t),0==(t-=s)){s===a.length?(++r,n.next?e.head=n.next:e.head=e.tail=null):(e.head=n,n.data=a.slice(s));break}++r}return e.length-=r,i}(t,e):function(t,e){var n=u.allocUnsafe(t),r=e.head,i=1;for(r.data.copy(n),t-=r.data.length;r=r.next;){var a=r.data,s=t>a.length?a.length:t;if(a.copy(n,n.length-t,0,s),0==(t-=s)){s===a.length?(++i,r.next?e.head=r.next:e.head=e.tail=null):(e.head=r,r.data=a.slice(s));break}++i}return e.length-=i,n}(t,e),r}(t,e.buffer,e.decoder),n);var n}function R(t){var e=t._readableState;if(e.length>0)throw new Error('"endReadable()" called on non-empty stream');e.endEmitted||(e.ended=!0,i.nextTick(O,e,t))}function O(t,e){t.endEmitted||0!==t.length||(t.endEmitted=!0,e.readable=!1,e.emit("end"))}function D(t,e){for(var n=0,r=t.length;n<r;n++)if(t[n]===e)return n;return-1}v.prototype.read=function(t){f("read",t),t=parseInt(t,10);var e=this._readableState,n=t;if(0!==t&&(e.emittedReadable=!1),0===t&&e.needReadable&&(e.length>=e.highWaterMark||e.ended))return f("read: emitReadable",e.length,e.ended),0===e.length&&e.ended?R(this):S(this),null;if(0===(t=x(t,e))&&e.ended)return 0===e.length&&R(this),null;var r,i=e.needReadable;return f("need readable",i),(0===e.length||e.length-t<e.highWaterMark)&&f("length less than watermark",i=!0),e.ended||e.reading?f("reading or ended",i=!1):i&&(f("do read"),e.reading=!0,e.sync=!0,0===e.length&&(e.needReadable=!0),this._read(e.highWaterMark),e.sync=!1,e.reading||(t=x(n,e))),null===(r=t>0?C(t,e):null)?(e.needReadable=!0,t=0):e.length-=t,0===e.length&&(e.ended||(e.needReadable=!0),n!==t&&e.ended&&R(this)),null!==r&&this.emit("data",r),r},v.prototype._read=function(t){this.emit("error",new Error("_read() is not implemented"))},v.prototype.pipe=function(t,e){var n=this,a=this._readableState;switch(a.pipesCount){case 0:a.pipes=t;break;case 1:a.pipes=[a.pipes,t];break;default:a.pipes.push(t)}a.pipesCount+=1,f("pipe count=%d opts=%j",a.pipesCount,e);var l=e&&!1===e.end||t===r.stdout||t===r.stderr?y:u;function u(){f("onend"),t.end()}a.endEmitted?i.nextTick(l):n.once("end",l),t.on("unpipe",(function e(r,i){f("onunpipe"),r===n&&i&&!1===i.hasUnpiped&&(i.hasUnpiped=!0,f("cleanup"),t.removeListener("close",g),t.removeListener("finish",b),t.removeListener("drain",h),t.removeListener("error",m),t.removeListener("unpipe",e),n.removeListener("end",u),n.removeListener("end",y),n.removeListener("data",p),c=!0,!a.awaitDrain||t._writableState&&!t._writableState.needDrain||h())}));var h=function(t){return function(){var e=t._readableState;f("pipeOnDrain",e.awaitDrain),e.awaitDrain&&e.awaitDrain--,0===e.awaitDrain&&o(t,"data")&&(e.flowing=!0,N(t))}}(n);t.on("drain",h);var c=!1,d=!1;function p(e){f("ondata"),d=!1,!1!==t.write(e)||d||((1===a.pipesCount&&a.pipes===t||a.pipesCount>1&&-1!==D(a.pipes,t))&&!c&&(f("false write response, pause",n._readableState.awaitDrain),n._readableState.awaitDrain++,d=!0),n.pause())}function m(e){f("onerror",e),y(),t.removeListener("error",m),0===o(t,"error")&&t.emit("error",e)}function g(){t.removeListener("finish",b),y()}function b(){f("onfinish"),t.removeListener("close",g),y()}function y(){f("unpipe"),n.unpipe(t)}return n.on("data",p),function(t,e,n){if("function"==typeof t.prependListener)return t.prependListener(e,n);t._events&&t._events.error?s(t._events.error)?t._events.error.unshift(n):t._events.error=[n,t._events.error]:t.on(e,n)}(t,"error",m),t.once("close",g),t.once("finish",b),t.emit("pipe",n),a.flowing||(f("pipe resume"),n.resume()),t},v.prototype.unpipe=function(t){var e=this._readableState,n={hasUnpiped:!1};if(0===e.pipesCount)return this;if(1===e.pipesCount)return t&&t!==e.pipes||(t||(t=e.pipes),e.pipes=null,e.pipesCount=0,e.flowing=!1,t&&t.emit("unpipe",this,n)),this;if(!t){var r=e.pipes,i=e.pipesCount;e.pipes=null,e.pipesCount=0,e.flowing=!1;for(var a=0;a<i;a++)r[a].emit("unpipe",this,n);return this}var s=D(e.pipes,t);return-1===s||(e.pipes.splice(s,1),e.pipesCount-=1,1===e.pipesCount&&(e.pipes=e.pipes[0]),t.emit("unpipe",this,n)),this},v.prototype.on=function(t,e){var n=l.prototype.on.call(this,t,e);if("data"===t)!1!==this._readableState.flowing&&this.resume();else if("readable"===t){var r=this._readableState;r.endEmitted||r.readableListening||(r.readableListening=r.needReadable=!0,r.emittedReadable=!1,r.reading?r.length&&S(this):i.nextTick(M,this))}return n},v.prototype.addListener=v.prototype.on,v.prototype.resume=function(){var t=this._readableState;return t.flowing||(f("resume"),t.flowing=!0,function(t,e){e.resumeScheduled||(e.resumeScheduled=!0,i.nextTick(T,t,e))}(this,t)),this},v.prototype.pause=function(){return f("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(f("pause"),this._readableState.flowing=!1,this.emit("pause")),this},v.prototype.wrap=function(t){var e=this,n=this._readableState,r=!1;for(var i in t.on("end",(function(){if(f("wrapped end"),n.decoder&&!n.ended){var t=n.decoder.end();t&&t.length&&e.push(t)}e.push(null)})),t.on("data",(function(i){f("wrapped data"),n.decoder&&(i=n.decoder.write(i)),n.objectMode&&null==i||(n.objectMode||i&&i.length)&&(e.push(i)||(r=!0,t.pause()))})),t)void 0===this[i]&&"function"==typeof t[i]&&(this[i]=function(e){return function(){return t[e].apply(t,arguments)}}(i));for(var a=0;a<b.length;a++)t.on(b[a],this.emit.bind(this,b[a]));return this._read=function(e){f("wrapped _read",e),r&&(r=!1,t.resume())},this},Object.defineProperty(v.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),v._fromList=C},4951:(t,e,n)=>{"use strict";t.exports=s;var r=n(9927),i=Object.create(n(7801));function a(t,e){var n=this._transformState;n.transforming=!1;var r=n.writecb;if(!r)return this.emit("error",new Error("write callback called multiple times"));n.writechunk=null,n.writecb=null,null!=e&&this.push(e),r(t);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}function s(t){if(!(this instanceof s))return new s(t);r.call(this,t),this._transformState={afterTransform:a.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,t&&("function"==typeof t.transform&&(this._transform=t.transform),"function"==typeof t.flush&&(this._flush=t.flush)),this.on("prefinish",o)}function o(){var t=this;"function"==typeof this._flush?this._flush((function(e,n){l(t,e,n)})):l(this,null,null)}function l(t,e,n){if(e)return t.emit("error",e);if(null!=n&&t.push(n),t._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(t._transformState.transforming)throw new Error("Calling transform done when still transforming");return t.push(null)}i.inherits=n(4603),i.inherits(s,r),s.prototype.push=function(t,e){return this._transformState.needTransform=!1,r.prototype.push.call(this,t,e)},s.prototype._transform=function(t,e,n){throw new Error("_transform() is not implemented")},s.prototype._write=function(t,e,n){var r=this._transformState;if(r.writecb=n,r.writechunk=t,r.writeencoding=e,!r.transforming){var i=this._readableState;(r.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},s.prototype._read=function(t){var e=this._transformState;null!==e.writechunk&&e.writecb&&!e.transforming?(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform)):e.needTransform=!0},s.prototype._destroy=function(t,e){var n=this;r.prototype._destroy.call(this,t,(function(t){e(t),n.emit("close")}))}},5228:(t,e,n)=>{"use strict";var r=n(7671),i=n(9020);function a(t){var e=this;this.next=null,this.entry=null,this.finish=function(){!function(t,e,n){var r=t.entry;for(t.entry=null;r;){var i=r.callback;e.pendingcb--,i(undefined),r=r.next}e.corkedRequestsFree?e.corkedRequestsFree.next=t:e.corkedRequestsFree=t}(e,t)}}t.exports=b;var s,o=!r.browser&&["v0.10","v0.9."].indexOf(r.version.slice(0,5))>-1?setImmediate:i.nextTick;b.WritableState=g;var l=Object.create(n(7801));l.inherits=n(4603);var u,h={deprecate:n(5091)},c=n(632),d=n(5299).Buffer,f=n.g.Uint8Array||function(){},p=n(737);function m(){}function g(t,e){s=s||n(9927),t=t||{};var r=e instanceof s;this.objectMode=!!t.objectMode,r&&(this.objectMode=this.objectMode||!!t.writableObjectMode);var l=t.highWaterMark,u=t.writableHighWaterMark,h=this.objectMode?16:16384;this.highWaterMark=l||0===l?l:r&&(u||0===u)?u:h,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var c=!1===t.decodeStrings;this.decodeStrings=!c,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(t){!function(t,e){var n=t._writableState,r=n.sync,a=n.writecb;if(function(t){t.writing=!1,t.writecb=null,t.length-=t.writelen,t.writelen=0}(n),e)!function(t,e,n,r,a){--e.pendingcb,n?(i.nextTick(a,r),i.nextTick(x,t,e),t._writableState.errorEmitted=!0,t.emit("error",r)):(a(r),t._writableState.errorEmitted=!0,t.emit("error",r),x(t,e))}(t,n,r,e,a);else{var s=_(n);s||n.corked||n.bufferProcessing||!n.bufferedRequest||w(t,n),r?o(v,t,n,s,a):v(t,n,s,a)}}(e,t)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new a(this)}function b(t){if(s=s||n(9927),!(u.call(b,this)||this instanceof s))return new b(t);this._writableState=new g(t,this),this.writable=!0,t&&("function"==typeof t.write&&(this._write=t.write),"function"==typeof t.writev&&(this._writev=t.writev),"function"==typeof t.destroy&&(this._destroy=t.destroy),"function"==typeof t.final&&(this._final=t.final)),c.call(this)}function y(t,e,n,r,i,a,s){e.writelen=r,e.writecb=s,e.writing=!0,e.sync=!0,n?t._writev(i,e.onwrite):t._write(i,a,e.onwrite),e.sync=!1}function v(t,e,n,r){n||function(t,e){0===e.length&&e.needDrain&&(e.needDrain=!1,t.emit("drain"))}(t,e),e.pendingcb--,r(),x(t,e)}function w(t,e){e.bufferProcessing=!0;var n=e.bufferedRequest;if(t._writev&&n&&n.next){var r=e.bufferedRequestCount,i=new Array(r),s=e.corkedRequestsFree;s.entry=n;for(var o=0,l=!0;n;)i[o]=n,n.isBuf||(l=!1),n=n.next,o+=1;i.allBuffers=l,y(t,e,!0,e.length,i,"",s.finish),e.pendingcb++,e.lastBufferedRequest=null,s.next?(e.corkedRequestsFree=s.next,s.next=null):e.corkedRequestsFree=new a(e),e.bufferedRequestCount=0}else{for(;n;){var u=n.chunk,h=n.encoding,c=n.callback;if(y(t,e,!1,e.objectMode?1:u.length,u,h,c),n=n.next,e.bufferedRequestCount--,e.writing)break}null===n&&(e.lastBufferedRequest=null)}e.bufferedRequest=n,e.bufferProcessing=!1}function _(t){return t.ending&&0===t.length&&null===t.bufferedRequest&&!t.finished&&!t.writing}function k(t,e){t._final((function(n){e.pendingcb--,n&&t.emit("error",n),e.prefinished=!0,t.emit("prefinish"),x(t,e)}))}function x(t,e){var n=_(e);return n&&(function(t,e){e.prefinished||e.finalCalled||("function"==typeof t._final?(e.pendingcb++,e.finalCalled=!0,i.nextTick(k,t,e)):(e.prefinished=!0,t.emit("prefinish")))}(t,e),0===e.pendingcb&&(e.finished=!0,t.emit("finish"))),n}l.inherits(b,c),g.prototype.getBuffer=function(){for(var t=this.bufferedRequest,e=[];t;)e.push(t),t=t.next;return e},function(){try{Object.defineProperty(g.prototype,"buffer",{get:h.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(t){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(u=Function.prototype[Symbol.hasInstance],Object.defineProperty(b,Symbol.hasInstance,{value:function(t){return!!u.call(this,t)||this===b&&t&&t._writableState instanceof g}})):u=function(t){return t instanceof this},b.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},b.prototype.write=function(t,e,n){var r,a=this._writableState,s=!1,o=!a.objectMode&&(r=t,d.isBuffer(r)||r instanceof f);return o&&!d.isBuffer(t)&&(t=function(t){return d.from(t)}(t)),"function"==typeof e&&(n=e,e=null),o?e="buffer":e||(e=a.defaultEncoding),"function"!=typeof n&&(n=m),a.ended?function(t,e){var n=new Error("write after end");t.emit("error",n),i.nextTick(e,n)}(this,n):(o||function(t,e,n,r){var a=!0,s=!1;return null===n?s=new TypeError("May not write null values to stream"):"string"==typeof n||void 0===n||e.objectMode||(s=new TypeError("Invalid non-string/buffer chunk")),s&&(t.emit("error",s),i.nextTick(r,s),a=!1),a}(this,a,t,n))&&(a.pendingcb++,s=function(t,e,n,r,i,a){if(!n){var s=function(t,e,n){return t.objectMode||!1===t.decodeStrings||"string"!=typeof e||(e=d.from(e,n)),e}(e,r,i);r!==s&&(n=!0,i="buffer",r=s)}var o=e.objectMode?1:r.length;e.length+=o;var l=e.length<e.highWaterMark;if(l||(e.needDrain=!0),e.writing||e.corked){var u=e.lastBufferedRequest;e.lastBufferedRequest={chunk:r,encoding:i,isBuf:n,callback:a,next:null},u?u.next=e.lastBufferedRequest:e.bufferedRequest=e.lastBufferedRequest,e.bufferedRequestCount+=1}else y(t,e,!1,o,r,i,a);return l}(this,a,o,t,e,n)),s},b.prototype.cork=function(){this._writableState.corked++},b.prototype.uncork=function(){var t=this._writableState;t.corked&&(t.corked--,t.writing||t.corked||t.finished||t.bufferProcessing||!t.bufferedRequest||w(this,t))},b.prototype.setDefaultEncoding=function(t){if("string"==typeof t&&(t=t.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((t+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+t);return this._writableState.defaultEncoding=t,this},Object.defineProperty(b.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),b.prototype._write=function(t,e,n){n(new Error("_write() is not implemented"))},b.prototype._writev=null,b.prototype.end=function(t,e,n){var r=this._writableState;"function"==typeof t?(n=t,t=null,e=null):"function"==typeof e&&(n=e,e=null),null!=t&&this.write(t,e),r.corked&&(r.corked=1,this.uncork()),r.ending||r.finished||function(t,e,n){e.ending=!0,x(t,e),n&&(e.finished?i.nextTick(n):t.once("finish",n)),e.ended=!0,t.writable=!1}(this,r,n)},Object.defineProperty(b.prototype,"destroyed",{get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(t){this._writableState&&(this._writableState.destroyed=t)}}),b.prototype.destroy=p.destroy,b.prototype._undestroy=p.undestroy,b.prototype._destroy=function(t,e){this.end(),e(t)}},6691:(t,e,n)=>{"use strict";var r=n(5299).Buffer,i=n(4696);t.exports=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.head=null,this.tail=null,this.length=0}return t.prototype.push=function(t){var e={data:t,next:null};this.length>0?this.tail.next=e:this.head=e,this.tail=e,++this.length},t.prototype.unshift=function(t){var e={data:t,next:this.head};0===this.length&&(this.tail=e),this.head=e,++this.length},t.prototype.shift=function(){if(0!==this.length){var t=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,t}},t.prototype.clear=function(){this.head=this.tail=null,this.length=0},t.prototype.join=function(t){if(0===this.length)return"";for(var e=this.head,n=""+e.data;e=e.next;)n+=t+e.data;return n},t.prototype.concat=function(t){if(0===this.length)return r.alloc(0);if(1===this.length)return this.head.data;for(var e,n,i=r.allocUnsafe(t>>>0),a=this.head,s=0;a;)e=i,n=s,a.data.copy(e,n),s+=a.data.length,a=a.next;return i},t}(),i&&i.inspect&&i.inspect.custom&&(t.exports.prototype[i.inspect.custom]=function(){var t=i.inspect({length:this.length});return this.constructor.name+" "+t})},737:(t,e,n)=>{"use strict";var r=n(9020);function i(t,e){t.emit("error",e)}t.exports={destroy:function(t,e){var n=this,a=this._readableState&&this._readableState.destroyed,s=this._writableState&&this._writableState.destroyed;return a||s?(e?e(t):!t||this._writableState&&this._writableState.errorEmitted||r.nextTick(i,this,t),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(t||null,(function(t){!e&&t?(r.nextTick(i,n,t),n._writableState&&(n._writableState.errorEmitted=!0)):e&&e(t)})),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}}},632:(t,e,n)=>{t.exports=n(6204).EventEmitter},5991:(t,e,n)=>{t.exports=n(8263).PassThrough},8263:(t,e,n)=>{(e=t.exports=n(1680)).Stream=e,e.Readable=e,e.Writable=n(5228),e.Duplex=n(9927),e.Transform=n(4951),e.PassThrough=n(1379)},8595:(t,e,n)=>{t.exports=n(8263).Transform},7642:(t,e,n)=>{t.exports=n(5228)},1686:t=>{"use strict";var e={};function n(t,n,r){r||(r=Error);var i=function(t){var e,r;function i(e,r,i){return t.call(this,function(t,e,r){return"string"==typeof n?n:n(t,e,r)}(e,r,i))||this}return r=t,(e=i).prototype=Object.create(r.prototype),e.prototype.constructor=e,e.__proto__=r,i}(r);i.prototype.name=r.name,i.prototype.code=t,e[t]=i}function r(t,e){if(Array.isArray(t)){var n=t.length;return t=t.map((function(t){return String(t)})),n>2?"one of ".concat(e," ").concat(t.slice(0,n-1).join(", "),", or ")+t[n-1]:2===n?"one of ".concat(e," ").concat(t[0]," or ").concat(t[1]):"of ".concat(e," ").concat(t[0])}return"of ".concat(e," ").concat(String(t))}n("ERR_INVALID_OPT_VALUE",(function(t,e){return'The value "'+e+'" is invalid for option "'+t+'"'}),TypeError),n("ERR_INVALID_ARG_TYPE",(function(t,e,n){var i,a,s,o,l;if("string"==typeof e&&(a="not ",e.substr(0,a.length)===a)?(i="must not be",e=e.replace(/^not /,"")):i="must be",function(t,e,n){return(void 0===n||n>t.length)&&(n=t.length),t.substring(n-e.length,n)===e}(t," argument"))s="The ".concat(t," ").concat(i," ").concat(r(e,"type"));else{var u=("number"!=typeof l&&(l=0),l+".".length>(o=t).length||-1===o.indexOf(".",l)?"argument":"property");s='The "'.concat(t,'" ').concat(u," ").concat(i," ").concat(r(e,"type"))}return s+". Received type ".concat(typeof n)}),TypeError),n("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),n("ERR_METHOD_NOT_IMPLEMENTED",(function(t){return"The "+t+" method is not implemented"})),n("ERR_STREAM_PREMATURE_CLOSE","Premature close"),n("ERR_STREAM_DESTROYED",(function(t){return"Cannot call "+t+" after a stream was destroyed"})),n("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),n("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),n("ERR_STREAM_WRITE_AFTER_END","write after end"),n("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),n("ERR_UNKNOWN_ENCODING",(function(t){return"Unknown encoding: "+t}),TypeError),n("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),t.exports.q=e},8600:(t,e,n)=>{"use strict";var r=n(7671),i=Object.keys||function(t){var e=[];for(var n in t)e.push(n);return e};t.exports=h;var a=n(9723),s=n(349);n(4603)(h,a);for(var o=i(s.prototype),l=0;l<o.length;l++){var u=o[l];h.prototype[u]||(h.prototype[u]=s.prototype[u])}function h(t){if(!(this instanceof h))return new h(t);a.call(this,t),s.call(this,t),this.allowHalfOpen=!0,t&&(!1===t.readable&&(this.readable=!1),!1===t.writable&&(this.writable=!1),!1===t.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",c)))}function c(){this._writableState.ended||r.nextTick(d,this)}function d(t){t.end()}Object.defineProperty(h.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(h.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(h.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(h.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set:function(t){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=t,this._writableState.destroyed=t)}})},9795:(t,e,n)=>{"use strict";t.exports=i;var r=n(7756);function i(t){if(!(this instanceof i))return new i(t);r.call(this,t)}n(4603)(i,r),i.prototype._transform=function(t,e,n){n(null,t)}},9723:(t,e,n)=>{"use strict";var r,i=n(7671);t.exports=E,E.ReadableState=S,n(6204).EventEmitter;var a,s=function(t,e){return t.listeners(e).length},o=n(2670),l=n(9208).Buffer,u=n.g.Uint8Array||function(){},h=n(8364);a=h&&h.debuglog?h.debuglog("stream"):function(){};var c,d,f,p=n(1748),m=n(528),g=n(814).getHighWaterMark,b=n(1686).q,y=b.ERR_INVALID_ARG_TYPE,v=b.ERR_STREAM_PUSH_AFTER_EOF,w=b.ERR_METHOD_NOT_IMPLEMENTED,_=b.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;n(4603)(E,o);var k=m.errorOrDestroy,x=["error","close","destroy","pause","resume"];function S(t,e,i){r=r||n(8600),t=t||{},"boolean"!=typeof i&&(i=e instanceof r),this.objectMode=!!t.objectMode,i&&(this.objectMode=this.objectMode||!!t.readableObjectMode),this.highWaterMark=g(this,t,"readableHighWaterMark",i),this.buffer=new p,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==t.emitClose,this.autoDestroy=!!t.autoDestroy,this.destroyed=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(c||(c=n(8154).s),this.decoder=new c(t.encoding),this.encoding=t.encoding)}function E(t){if(r=r||n(8600),!(this instanceof E))return new E(t);var e=this instanceof r;this._readableState=new S(t,this,e),this.readable=!0,t&&("function"==typeof t.read&&(this._read=t.read),"function"==typeof t.destroy&&(this._destroy=t.destroy)),o.call(this)}function I(t,e,n,r,i){a("readableAddChunk",e);var s,o=t._readableState;if(null===e)o.reading=!1,function(t,e){if(a("onEofChunk"),!e.ended){if(e.decoder){var n=e.decoder.end();n&&n.length&&(e.buffer.push(n),e.length+=e.objectMode?1:n.length)}e.ended=!0,e.sync?N(t):(e.needReadable=!1,e.emittedReadable||(e.emittedReadable=!0,C(t)))}}(t,o);else if(i||(s=function(t,e){var n,r;return r=e,l.isBuffer(r)||r instanceof u||"string"==typeof e||void 0===e||t.objectMode||(n=new y("chunk",["string","Buffer","Uint8Array"],e)),n}(o,e)),s)k(t,s);else if(o.objectMode||e&&e.length>0)if("string"==typeof e||o.objectMode||Object.getPrototypeOf(e)===l.prototype||(e=function(t){return l.from(t)}(e)),r)o.endEmitted?k(t,new _):A(t,o,e,!0);else if(o.ended)k(t,new v);else{if(o.destroyed)return!1;o.reading=!1,o.decoder&&!n?(e=o.decoder.write(e),o.objectMode||0!==e.length?A(t,o,e,!1):R(t,o)):A(t,o,e,!1)}else r||(o.reading=!1,R(t,o));return!o.ended&&(o.length<o.highWaterMark||0===o.length)}function A(t,e,n,r){e.flowing&&0===e.length&&!e.sync?(e.awaitDrain=0,t.emit("data",n)):(e.length+=e.objectMode?1:n.length,r?e.buffer.unshift(n):e.buffer.push(n),e.needReadable&&N(t)),R(t,e)}Object.defineProperty(E.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(t){this._readableState&&(this._readableState.destroyed=t)}}),E.prototype.destroy=m.destroy,E.prototype._undestroy=m.undestroy,E.prototype._destroy=function(t,e){e(t)},E.prototype.push=function(t,e){var n,r=this._readableState;return r.objectMode?n=!0:"string"==typeof t&&((e=e||r.defaultEncoding)!==r.encoding&&(t=l.from(t,e),e=""),n=!0),I(this,t,e,!1,n)},E.prototype.unshift=function(t){return I(this,t,null,!0,!1)},E.prototype.isPaused=function(){return!1===this._readableState.flowing},E.prototype.setEncoding=function(t){c||(c=n(8154).s);var e=new c(t);this._readableState.decoder=e,this._readableState.encoding=this._readableState.decoder.encoding;for(var r=this._readableState.buffer.head,i="";null!==r;)i+=e.write(r.data),r=r.next;return this._readableState.buffer.clear(),""!==i&&this._readableState.buffer.push(i),this._readableState.length=i.length,this};var M=1073741824;function T(t,e){return t<=0||0===e.length&&e.ended?0:e.objectMode?1:t!=t?e.flowing&&e.length?e.buffer.head.data.length:e.length:(t>e.highWaterMark&&(e.highWaterMark=function(t){return t>=M?t=M:(t--,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t++),t}(t)),t<=e.length?t:e.ended?e.length:(e.needReadable=!0,0))}function N(t){var e=t._readableState;a("emitReadable",e.needReadable,e.emittedReadable),e.needReadable=!1,e.emittedReadable||(a("emitReadable",e.flowing),e.emittedReadable=!0,i.nextTick(C,t))}function C(t){var e=t._readableState;a("emitReadable_",e.destroyed,e.length,e.ended),e.destroyed||!e.length&&!e.ended||(t.emit("readable"),e.emittedReadable=!1),e.needReadable=!e.flowing&&!e.ended&&e.length<=e.highWaterMark,F(t)}function R(t,e){e.readingMore||(e.readingMore=!0,i.nextTick(O,t,e))}function O(t,e){for(;!e.reading&&!e.ended&&(e.length<e.highWaterMark||e.flowing&&0===e.length);){var n=e.length;if(a("maybeReadMore read 0"),t.read(0),n===e.length)break}e.readingMore=!1}function D(t){var e=t._readableState;e.readableListening=t.listenerCount("readable")>0,e.resumeScheduled&&!e.paused?e.flowing=!0:t.listenerCount("data")>0&&t.resume()}function z(t){a("readable nexttick read 0"),t.read(0)}function B(t,e){a("resume",e.reading),e.reading||t.read(0),e.resumeScheduled=!1,t.emit("resume"),F(t),e.flowing&&!e.reading&&t.read(0)}function F(t){var e=t._readableState;for(a("flow",e.flowing);e.flowing&&null!==t.read(););}function P(t,e){return 0===e.length?null:(e.objectMode?n=e.buffer.shift():!t||t>=e.length?(n=e.decoder?e.buffer.join(""):1===e.buffer.length?e.buffer.first():e.buffer.concat(e.length),e.buffer.clear()):n=e.buffer.consume(t,e.decoder),n);var n}function L(t){var e=t._readableState;a("endReadable",e.endEmitted),e.endEmitted||(e.ended=!0,i.nextTick($,e,t))}function $(t,e){if(a("endReadableNT",t.endEmitted,t.length),!t.endEmitted&&0===t.length&&(t.endEmitted=!0,e.readable=!1,e.emit("end"),t.autoDestroy)){var n=e._writableState;(!n||n.autoDestroy&&n.finished)&&e.destroy()}}function U(t,e){for(var n=0,r=t.length;n<r;n++)if(t[n]===e)return n;return-1}E.prototype.read=function(t){a("read",t),t=parseInt(t,10);var e=this._readableState,n=t;if(0!==t&&(e.emittedReadable=!1),0===t&&e.needReadable&&((0!==e.highWaterMark?e.length>=e.highWaterMark:e.length>0)||e.ended))return a("read: emitReadable",e.length,e.ended),0===e.length&&e.ended?L(this):N(this),null;if(0===(t=T(t,e))&&e.ended)return 0===e.length&&L(this),null;var r,i=e.needReadable;return a("need readable",i),(0===e.length||e.length-t<e.highWaterMark)&&a("length less than watermark",i=!0),e.ended||e.reading?a("reading or ended",i=!1):i&&(a("do read"),e.reading=!0,e.sync=!0,0===e.length&&(e.needReadable=!0),this._read(e.highWaterMark),e.sync=!1,e.reading||(t=T(n,e))),null===(r=t>0?P(t,e):null)?(e.needReadable=e.length<=e.highWaterMark,t=0):(e.length-=t,e.awaitDrain=0),0===e.length&&(e.ended||(e.needReadable=!0),n!==t&&e.ended&&L(this)),null!==r&&this.emit("data",r),r},E.prototype._read=function(t){k(this,new w("_read()"))},E.prototype.pipe=function(t,e){var n=this,r=this._readableState;switch(r.pipesCount){case 0:r.pipes=t;break;case 1:r.pipes=[r.pipes,t];break;default:r.pipes.push(t)}r.pipesCount+=1,a("pipe count=%d opts=%j",r.pipesCount,e);var o=e&&!1===e.end||t===i.stdout||t===i.stderr?m:l;function l(){a("onend"),t.end()}r.endEmitted?i.nextTick(o):n.once("end",o),t.on("unpipe",(function e(i,s){a("onunpipe"),i===n&&s&&!1===s.hasUnpiped&&(s.hasUnpiped=!0,a("cleanup"),t.removeListener("close",f),t.removeListener("finish",p),t.removeListener("drain",u),t.removeListener("error",d),t.removeListener("unpipe",e),n.removeListener("end",l),n.removeListener("end",m),n.removeListener("data",c),h=!0,!r.awaitDrain||t._writableState&&!t._writableState.needDrain||u())}));var u=function(t){return function(){var e=t._readableState;a("pipeOnDrain",e.awaitDrain),e.awaitDrain&&e.awaitDrain--,0===e.awaitDrain&&s(t,"data")&&(e.flowing=!0,F(t))}}(n);t.on("drain",u);var h=!1;function c(e){a("ondata");var i=t.write(e);a("dest.write",i),!1===i&&((1===r.pipesCount&&r.pipes===t||r.pipesCount>1&&-1!==U(r.pipes,t))&&!h&&(a("false write response, pause",r.awaitDrain),r.awaitDrain++),n.pause())}function d(e){a("onerror",e),m(),t.removeListener("error",d),0===s(t,"error")&&k(t,e)}function f(){t.removeListener("finish",p),m()}function p(){a("onfinish"),t.removeListener("close",f),m()}function m(){a("unpipe"),n.unpipe(t)}return n.on("data",c),function(t,e,n){if("function"==typeof t.prependListener)return t.prependListener(e,n);t._events&&t._events.error?Array.isArray(t._events.error)?t._events.error.unshift(n):t._events.error=[n,t._events.error]:t.on(e,n)}(t,"error",d),t.once("close",f),t.once("finish",p),t.emit("pipe",n),r.flowing||(a("pipe resume"),n.resume()),t},E.prototype.unpipe=function(t){var e=this._readableState,n={hasUnpiped:!1};if(0===e.pipesCount)return this;if(1===e.pipesCount)return t&&t!==e.pipes||(t||(t=e.pipes),e.pipes=null,e.pipesCount=0,e.flowing=!1,t&&t.emit("unpipe",this,n)),this;if(!t){var r=e.pipes,i=e.pipesCount;e.pipes=null,e.pipesCount=0,e.flowing=!1;for(var a=0;a<i;a++)r[a].emit("unpipe",this,{hasUnpiped:!1});return this}var s=U(e.pipes,t);return-1===s||(e.pipes.splice(s,1),e.pipesCount-=1,1===e.pipesCount&&(e.pipes=e.pipes[0]),t.emit("unpipe",this,n)),this},E.prototype.on=function(t,e){var n=o.prototype.on.call(this,t,e),r=this._readableState;return"data"===t?(r.readableListening=this.listenerCount("readable")>0,!1!==r.flowing&&this.resume()):"readable"===t&&(r.endEmitted||r.readableListening||(r.readableListening=r.needReadable=!0,r.flowing=!1,r.emittedReadable=!1,a("on readable",r.length,r.reading),r.length?N(this):r.reading||i.nextTick(z,this))),n},E.prototype.addListener=E.prototype.on,E.prototype.removeListener=function(t,e){var n=o.prototype.removeListener.call(this,t,e);return"readable"===t&&i.nextTick(D,this),n},E.prototype.removeAllListeners=function(t){var e=o.prototype.removeAllListeners.apply(this,arguments);return"readable"!==t&&void 0!==t||i.nextTick(D,this),e},E.prototype.resume=function(){var t=this._readableState;return t.flowing||(a("resume"),t.flowing=!t.readableListening,function(t,e){e.resumeScheduled||(e.resumeScheduled=!0,i.nextTick(B,t,e))}(this,t)),t.paused=!1,this},E.prototype.pause=function(){return a("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(a("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},E.prototype.wrap=function(t){var e=this,n=this._readableState,r=!1;for(var i in t.on("end",(function(){if(a("wrapped end"),n.decoder&&!n.ended){var t=n.decoder.end();t&&t.length&&e.push(t)}e.push(null)})),t.on("data",(function(i){a("wrapped data"),n.decoder&&(i=n.decoder.write(i)),n.objectMode&&null==i||(n.objectMode||i&&i.length)&&(e.push(i)||(r=!0,t.pause()))})),t)void 0===this[i]&&"function"==typeof t[i]&&(this[i]=function(e){return function(){return t[e].apply(t,arguments)}}(i));for(var s=0;s<x.length;s++)t.on(x[s],this.emit.bind(this,x[s]));return this._read=function(e){a("wrapped _read",e),r&&(r=!1,t.resume())},this},"function"==typeof Symbol&&(E.prototype[Symbol.asyncIterator]=function(){return void 0===d&&(d=n(5252)),d(this)}),Object.defineProperty(E.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(E.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(E.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(t){this._readableState&&(this._readableState.flowing=t)}}),E._fromList=P,Object.defineProperty(E.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"==typeof Symbol&&(E.from=function(t,e){return void 0===f&&(f=n(3730)),f(E,t,e)})},7756:(t,e,n)=>{"use strict";t.exports=h;var r=n(1686).q,i=r.ERR_METHOD_NOT_IMPLEMENTED,a=r.ERR_MULTIPLE_CALLBACK,s=r.ERR_TRANSFORM_ALREADY_TRANSFORMING,o=r.ERR_TRANSFORM_WITH_LENGTH_0,l=n(8600);function u(t,e){var n=this._transformState;n.transforming=!1;var r=n.writecb;if(null===r)return this.emit("error",new a);n.writechunk=null,n.writecb=null,null!=e&&this.push(e),r(t);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}function h(t){if(!(this instanceof h))return new h(t);l.call(this,t),this._transformState={afterTransform:u.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,t&&("function"==typeof t.transform&&(this._transform=t.transform),"function"==typeof t.flush&&(this._flush=t.flush)),this.on("prefinish",c)}function c(){var t=this;"function"!=typeof this._flush||this._readableState.destroyed?d(this,null,null):this._flush((function(e,n){d(t,e,n)}))}function d(t,e,n){if(e)return t.emit("error",e);if(null!=n&&t.push(n),t._writableState.length)throw new o;if(t._transformState.transforming)throw new s;return t.push(null)}n(4603)(h,l),h.prototype.push=function(t,e){return this._transformState.needTransform=!1,l.prototype.push.call(this,t,e)},h.prototype._transform=function(t,e,n){n(new i("_transform()"))},h.prototype._write=function(t,e,n){var r=this._transformState;if(r.writecb=n,r.writechunk=t,r.writeencoding=e,!r.transforming){var i=this._readableState;(r.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},h.prototype._read=function(t){var e=this._transformState;null===e.writechunk||e.transforming?e.needTransform=!0:(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform))},h.prototype._destroy=function(t,e){l.prototype._destroy.call(this,t,(function(t){e(t)}))}},349:(t,e,n)=>{"use strict";var r,i=n(7671);function a(t){var e=this;this.next=null,this.entry=null,this.finish=function(){!function(t,e,n){var r=t.entry;for(t.entry=null;r;){var i=r.callback;e.pendingcb--,i(undefined),r=r.next}e.corkedRequestsFree.next=t}(e,t)}}t.exports=E,E.WritableState=S;var s,o={deprecate:n(5091)},l=n(2670),u=n(9208).Buffer,h=n.g.Uint8Array||function(){},c=n(528),d=n(814).getHighWaterMark,f=n(1686).q,p=f.ERR_INVALID_ARG_TYPE,m=f.ERR_METHOD_NOT_IMPLEMENTED,g=f.ERR_MULTIPLE_CALLBACK,b=f.ERR_STREAM_CANNOT_PIPE,y=f.ERR_STREAM_DESTROYED,v=f.ERR_STREAM_NULL_VALUES,w=f.ERR_STREAM_WRITE_AFTER_END,_=f.ERR_UNKNOWN_ENCODING,k=c.errorOrDestroy;function x(){}function S(t,e,s){r=r||n(8600),t=t||{},"boolean"!=typeof s&&(s=e instanceof r),this.objectMode=!!t.objectMode,s&&(this.objectMode=this.objectMode||!!t.writableObjectMode),this.highWaterMark=d(this,t,"writableHighWaterMark",s),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var o=!1===t.decodeStrings;this.decodeStrings=!o,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(t){!function(t,e){var n=t._writableState,r=n.sync,a=n.writecb;if("function"!=typeof a)throw new g;if(function(t){t.writing=!1,t.writecb=null,t.length-=t.writelen,t.writelen=0}(n),e)!function(t,e,n,r,a){--e.pendingcb,n?(i.nextTick(a,r),i.nextTick(C,t,e),t._writableState.errorEmitted=!0,k(t,r)):(a(r),t._writableState.errorEmitted=!0,k(t,r),C(t,e))}(t,n,r,e,a);else{var s=T(n)||t.destroyed;s||n.corked||n.bufferProcessing||!n.bufferedRequest||M(t,n),r?i.nextTick(A,t,n,s,a):A(t,n,s,a)}}(e,t)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==t.emitClose,this.autoDestroy=!!t.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new a(this)}function E(t){var e=this instanceof(r=r||n(8600));if(!e&&!s.call(E,this))return new E(t);this._writableState=new S(t,this,e),this.writable=!0,t&&("function"==typeof t.write&&(this._write=t.write),"function"==typeof t.writev&&(this._writev=t.writev),"function"==typeof t.destroy&&(this._destroy=t.destroy),"function"==typeof t.final&&(this._final=t.final)),l.call(this)}function I(t,e,n,r,i,a,s){e.writelen=r,e.writecb=s,e.writing=!0,e.sync=!0,e.destroyed?e.onwrite(new y("write")):n?t._writev(i,e.onwrite):t._write(i,a,e.onwrite),e.sync=!1}function A(t,e,n,r){n||function(t,e){0===e.length&&e.needDrain&&(e.needDrain=!1,t.emit("drain"))}(t,e),e.pendingcb--,r(),C(t,e)}function M(t,e){e.bufferProcessing=!0;var n=e.bufferedRequest;if(t._writev&&n&&n.next){var r=e.bufferedRequestCount,i=new Array(r),s=e.corkedRequestsFree;s.entry=n;for(var o=0,l=!0;n;)i[o]=n,n.isBuf||(l=!1),n=n.next,o+=1;i.allBuffers=l,I(t,e,!0,e.length,i,"",s.finish),e.pendingcb++,e.lastBufferedRequest=null,s.next?(e.corkedRequestsFree=s.next,s.next=null):e.corkedRequestsFree=new a(e),e.bufferedRequestCount=0}else{for(;n;){var u=n.chunk,h=n.encoding,c=n.callback;if(I(t,e,!1,e.objectMode?1:u.length,u,h,c),n=n.next,e.bufferedRequestCount--,e.writing)break}null===n&&(e.lastBufferedRequest=null)}e.bufferedRequest=n,e.bufferProcessing=!1}function T(t){return t.ending&&0===t.length&&null===t.bufferedRequest&&!t.finished&&!t.writing}function N(t,e){t._final((function(n){e.pendingcb--,n&&k(t,n),e.prefinished=!0,t.emit("prefinish"),C(t,e)}))}function C(t,e){var n=T(e);if(n&&(function(t,e){e.prefinished||e.finalCalled||("function"!=typeof t._final||e.destroyed?(e.prefinished=!0,t.emit("prefinish")):(e.pendingcb++,e.finalCalled=!0,i.nextTick(N,t,e)))}(t,e),0===e.pendingcb&&(e.finished=!0,t.emit("finish"),e.autoDestroy))){var r=t._readableState;(!r||r.autoDestroy&&r.endEmitted)&&t.destroy()}return n}n(4603)(E,l),S.prototype.getBuffer=function(){for(var t=this.bufferedRequest,e=[];t;)e.push(t),t=t.next;return e},function(){try{Object.defineProperty(S.prototype,"buffer",{get:o.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(t){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(s=Function.prototype[Symbol.hasInstance],Object.defineProperty(E,Symbol.hasInstance,{value:function(t){return!!s.call(this,t)||this===E&&t&&t._writableState instanceof S}})):s=function(t){return t instanceof this},E.prototype.pipe=function(){k(this,new b)},E.prototype.write=function(t,e,n){var r,a=this._writableState,s=!1,o=!a.objectMode&&(r=t,u.isBuffer(r)||r instanceof h);return o&&!u.isBuffer(t)&&(t=function(t){return u.from(t)}(t)),"function"==typeof e&&(n=e,e=null),o?e="buffer":e||(e=a.defaultEncoding),"function"!=typeof n&&(n=x),a.ending?function(t,e){var n=new w;k(t,n),i.nextTick(e,n)}(this,n):(o||function(t,e,n,r){var a;return null===n?a=new v:"string"==typeof n||e.objectMode||(a=new p("chunk",["string","Buffer"],n)),!a||(k(t,a),i.nextTick(r,a),!1)}(this,a,t,n))&&(a.pendingcb++,s=function(t,e,n,r,i,a){if(!n){var s=function(t,e,n){return t.objectMode||!1===t.decodeStrings||"string"!=typeof e||(e=u.from(e,n)),e}(e,r,i);r!==s&&(n=!0,i="buffer",r=s)}var o=e.objectMode?1:r.length;e.length+=o;var l=e.length<e.highWaterMark;if(l||(e.needDrain=!0),e.writing||e.corked){var h=e.lastBufferedRequest;e.lastBufferedRequest={chunk:r,encoding:i,isBuf:n,callback:a,next:null},h?h.next=e.lastBufferedRequest:e.bufferedRequest=e.lastBufferedRequest,e.bufferedRequestCount+=1}else I(t,e,!1,o,r,i,a);return l}(this,a,o,t,e,n)),s},E.prototype.cork=function(){this._writableState.corked++},E.prototype.uncork=function(){var t=this._writableState;t.corked&&(t.corked--,t.writing||t.corked||t.bufferProcessing||!t.bufferedRequest||M(this,t))},E.prototype.setDefaultEncoding=function(t){if("string"==typeof t&&(t=t.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((t+"").toLowerCase())>-1))throw new _(t);return this._writableState.defaultEncoding=t,this},Object.defineProperty(E.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(E.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),E.prototype._write=function(t,e,n){n(new m("_write()"))},E.prototype._writev=null,E.prototype.end=function(t,e,n){var r=this._writableState;return"function"==typeof t?(n=t,t=null,e=null):"function"==typeof e&&(n=e,e=null),null!=t&&this.write(t,e),r.corked&&(r.corked=1,this.uncork()),r.ending||function(t,e,n){e.ending=!0,C(t,e),n&&(e.finished?i.nextTick(n):t.once("finish",n)),e.ended=!0,t.writable=!1}(this,r,n),this},Object.defineProperty(E.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(E.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(t){this._writableState&&(this._writableState.destroyed=t)}}),E.prototype.destroy=c.destroy,E.prototype._undestroy=c.undestroy,E.prototype._destroy=function(t,e){e(t)}},5252:(t,e,n)=>{"use strict";var r,i=n(7671);function a(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var s=n(6583),o=Symbol("lastResolve"),l=Symbol("lastReject"),u=Symbol("error"),h=Symbol("ended"),c=Symbol("lastPromise"),d=Symbol("handlePromise"),f=Symbol("stream");function p(t,e){return{value:t,done:e}}function m(t){var e=t[o];if(null!==e){var n=t[f].read();null!==n&&(t[c]=null,t[o]=null,t[l]=null,e(p(n,!1)))}}function g(t){i.nextTick(m,t)}var b=Object.getPrototypeOf((function(){})),y=Object.setPrototypeOf((a(r={get stream(){return this[f]},next:function(){var t=this,e=this[u];if(null!==e)return Promise.reject(e);if(this[h])return Promise.resolve(p(void 0,!0));if(this[f].destroyed)return new Promise((function(e,n){i.nextTick((function(){t[u]?n(t[u]):e(p(void 0,!0))}))}));var n,r=this[c];if(r)n=new Promise(function(t,e){return function(n,r){t.then((function(){e[h]?n(p(void 0,!0)):e[d](n,r)}),r)}}(r,this));else{var a=this[f].read();if(null!==a)return Promise.resolve(p(a,!1));n=new Promise(this[d])}return this[c]=n,n}},Symbol.asyncIterator,(function(){return this})),a(r,"return",(function(){var t=this;return new Promise((function(e,n){t[f].destroy(null,(function(t){t?n(t):e(p(void 0,!0))}))}))})),r),b);t.exports=function(t){var e,n=Object.create(y,(a(e={},f,{value:t,writable:!0}),a(e,o,{value:null,writable:!0}),a(e,l,{value:null,writable:!0}),a(e,u,{value:null,writable:!0}),a(e,h,{value:t._readableState.endEmitted,writable:!0}),a(e,d,{value:function(t,e){var r=n[f].read();r?(n[c]=null,n[o]=null,n[l]=null,t(p(r,!1))):(n[o]=t,n[l]=e)},writable:!0}),e));return n[c]=null,s(t,(function(t){if(t&&"ERR_STREAM_PREMATURE_CLOSE"!==t.code){var e=n[l];return null!==e&&(n[c]=null,n[o]=null,n[l]=null,e(t)),void(n[u]=t)}var r=n[o];null!==r&&(n[c]=null,n[o]=null,n[l]=null,r(p(void 0,!0))),n[h]=!0})),t.on("readable",g.bind(null,n)),n}},1748:(t,e,n)=>{"use strict";function r(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function i(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var s=n(9208).Buffer,o=n(8901).inspect,l=o&&o.custom||"inspect";t.exports=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.head=null,this.tail=null,this.length=0}var e,n;return e=t,n=[{key:"push",value:function(t){var e={data:t,next:null};this.length>0?this.tail.next=e:this.head=e,this.tail=e,++this.length}},{key:"unshift",value:function(t){var e={data:t,next:this.head};0===this.length&&(this.tail=e),this.head=e,++this.length}},{key:"shift",value:function(){if(0!==this.length){var t=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,t}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(t){if(0===this.length)return"";for(var e=this.head,n=""+e.data;e=e.next;)n+=t+e.data;return n}},{key:"concat",value:function(t){if(0===this.length)return s.alloc(0);for(var e,n,r,i=s.allocUnsafe(t>>>0),a=this.head,o=0;a;)e=a.data,n=i,r=o,s.prototype.copy.call(e,n,r),o+=a.data.length,a=a.next;return i}},{key:"consume",value:function(t,e){var n;return t<this.head.data.length?(n=this.head.data.slice(0,t),this.head.data=this.head.data.slice(t)):n=t===this.head.data.length?this.shift():e?this._getString(t):this._getBuffer(t),n}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(t){var e=this.head,n=1,r=e.data;for(t-=r.length;e=e.next;){var i=e.data,a=t>i.length?i.length:t;if(a===i.length?r+=i:r+=i.slice(0,t),0==(t-=a)){a===i.length?(++n,e.next?this.head=e.next:this.head=this.tail=null):(this.head=e,e.data=i.slice(a));break}++n}return this.length-=n,r}},{key:"_getBuffer",value:function(t){var e=s.allocUnsafe(t),n=this.head,r=1;for(n.data.copy(e),t-=n.data.length;n=n.next;){var i=n.data,a=t>i.length?i.length:t;if(i.copy(e,e.length-t,0,a),0==(t-=a)){a===i.length?(++r,n.next?this.head=n.next:this.head=this.tail=null):(this.head=n,n.data=i.slice(a));break}++r}return this.length-=r,e}},{key:l,value:function(t,e){return o(this,function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?r(Object(n),!0).forEach((function(e){i(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},e,{depth:0,customInspect:!1}))}}],n&&a(e.prototype,n),t}()},528:(t,e,n)=>{"use strict";var r=n(7671);function i(t,e){s(t,e),a(t)}function a(t){t._writableState&&!t._writableState.emitClose||t._readableState&&!t._readableState.emitClose||t.emit("close")}function s(t,e){t.emit("error",e)}t.exports={destroy:function(t,e){var n=this,o=this._readableState&&this._readableState.destroyed,l=this._writableState&&this._writableState.destroyed;return o||l?(e?e(t):t&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,r.nextTick(s,this,t)):r.nextTick(s,this,t)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(t||null,(function(t){!e&&t?n._writableState?n._writableState.errorEmitted?r.nextTick(a,n):(n._writableState.errorEmitted=!0,r.nextTick(i,n,t)):r.nextTick(i,n,t):e?(r.nextTick(a,n),e(t)):r.nextTick(a,n)})),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(t,e){var n=t._readableState,r=t._writableState;n&&n.autoDestroy||r&&r.autoDestroy?t.destroy(e):t.emit("error",e)}}},6583:(t,e,n)=>{"use strict";var r=n(1686).q.ERR_STREAM_PREMATURE_CLOSE;function i(){}t.exports=function t(e,n,a){if("function"==typeof n)return t(e,null,n);n||(n={}),a=function(t){var e=!1;return function(){if(!e){e=!0;for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];t.apply(this,r)}}}(a||i);var s=n.readable||!1!==n.readable&&e.readable,o=n.writable||!1!==n.writable&&e.writable,l=function(){e.writable||h()},u=e._writableState&&e._writableState.finished,h=function(){o=!1,u=!0,s||a.call(e)},c=e._readableState&&e._readableState.endEmitted,d=function(){s=!1,c=!0,o||a.call(e)},f=function(t){a.call(e,t)},p=function(){var t;return s&&!c?(e._readableState&&e._readableState.ended||(t=new r),a.call(e,t)):o&&!u?(e._writableState&&e._writableState.ended||(t=new r),a.call(e,t)):void 0},m=function(){e.req.on("finish",h)};return function(t){return t.setHeader&&"function"==typeof t.abort}(e)?(e.on("complete",h),e.on("abort",p),e.req?m():e.on("request",m)):o&&!e._writableState&&(e.on("end",l),e.on("close",l)),e.on("end",d),e.on("finish",h),!1!==n.error&&e.on("error",f),e.on("close",p),function(){e.removeListener("complete",h),e.removeListener("abort",p),e.removeListener("request",m),e.req&&e.req.removeListener("finish",h),e.removeListener("end",l),e.removeListener("close",l),e.removeListener("finish",h),e.removeListener("end",d),e.removeListener("error",f),e.removeListener("close",p)}}},3730:t=>{t.exports=function(){throw new Error("Readable.from is not available in the browser")}},5924:(t,e,n)=>{"use strict";var r,i=n(1686).q,a=i.ERR_MISSING_ARGS,s=i.ERR_STREAM_DESTROYED;function o(t){if(t)throw t}function l(t,e,i,a){a=function(t){var e=!1;return function(){e||(e=!0,t.apply(void 0,arguments))}}(a);var o=!1;t.on("close",(function(){o=!0})),void 0===r&&(r=n(6583)),r(t,{readable:e,writable:i},(function(t){if(t)return a(t);o=!0,a()}));var l=!1;return function(e){if(!o&&!l)return l=!0,function(t){return t.setHeader&&"function"==typeof t.abort}(t)?t.abort():"function"==typeof t.destroy?t.destroy():void a(e||new s("pipe"))}}function u(t){t()}function h(t,e){return t.pipe(e)}function c(t){return t.length?"function"!=typeof t[t.length-1]?o:t.pop():o}t.exports=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r,i=c(e);if(Array.isArray(e[0])&&(e=e[0]),e.length<2)throw new a("streams");var s=e.map((function(t,n){var a=n<e.length-1;return l(t,a,n>0,(function(t){r||(r=t),t&&s.forEach(u),a||(s.forEach(u),i(r))}))}));return e.reduce(h)}},814:(t,e,n)=>{"use strict";var r=n(1686).q.ERR_INVALID_OPT_VALUE;t.exports={getHighWaterMark:function(t,e,n,i){var a=function(t,e,n){return null!=t.highWaterMark?t.highWaterMark:e?t[n]:null}(e,i,n);if(null!=a){if(!isFinite(a)||Math.floor(a)!==a||a<0)throw new r(i?n:"highWaterMark",a);return Math.floor(a)}return t.objectMode?16:16384}}},2670:(t,e,n)=>{t.exports=n(6204).EventEmitter},1902:(t,e,n)=>{(e=t.exports=n(9723)).Stream=e,e.Readable=e,e.Writable=n(349),e.Duplex=n(8600),e.Transform=n(7756),e.PassThrough=n(9795),e.finished=n(6583),e.pipeline=n(5924)},405:t=>{var e=function(t){"use strict";var e,n=Object.prototype,r=n.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",o=i.toStringTag||"@@toStringTag";function l(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,n){return t[e]=n}}function u(t,e,n,r){var i=e&&e.prototype instanceof g?e:g,a=Object.create(i.prototype),s=new M(r||[]);return a._invoke=function(t,e,n){var r=c;return function(i,a){if(r===f)throw new Error("Generator is already running");if(r===p){if("throw"===i)throw a;return N()}for(n.method=i,n.arg=a;;){var s=n.delegate;if(s){var o=E(s,n);if(o){if(o===m)continue;return o}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===c)throw r=p,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=f;var l=h(t,e,n);if("normal"===l.type){if(r=n.done?p:d,l.arg===m)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(r=p,n.method="throw",n.arg=l.arg)}}}(t,n,s),a}function h(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=u;var c="suspendedStart",d="suspendedYield",f="executing",p="completed",m={};function g(){}function b(){}function y(){}var v={};l(v,a,(function(){return this}));var w=Object.getPrototypeOf,_=w&&w(w(T([])));_&&_!==n&&r.call(_,a)&&(v=_);var k=y.prototype=g.prototype=Object.create(v);function x(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function n(i,a,s,o){var l=h(t[i],t,a);if("throw"!==l.type){var u=l.arg,c=u.value;return c&&"object"==typeof c&&r.call(c,"__await")?e.resolve(c.__await).then((function(t){n("next",t,s,o)}),(function(t){n("throw",t,s,o)})):e.resolve(c).then((function(t){u.value=t,s(u)}),(function(t){return n("throw",t,s,o)}))}o(l.arg)}var i;this._invoke=function(t,r){function a(){return new e((function(e,i){n(t,r,e,i)}))}return i=i?i.then(a,a):a()}}function E(t,n){var r=t.iterator[n.method];if(r===e){if(n.delegate=null,"throw"===n.method){if(t.iterator.return&&(n.method="return",n.arg=e,E(t,n),"throw"===n.method))return m;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return m}var i=h(r,t.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,m;var a=i.arg;return a?a.done?(n[t.resultName]=a.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,m):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,m)}function I(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function A(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function M(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(I,this),this.reset(!0)}function T(t){if(t){var n=t[a];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,s=function n(){for(;++i<t.length;)if(r.call(t,i))return n.value=t[i],n.done=!1,n;return n.value=e,n.done=!0,n};return s.next=s}}return{next:N}}function N(){return{value:e,done:!0}}return b.prototype=y,l(k,"constructor",y),l(y,"constructor",b),b.displayName=l(y,o,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,y):(t.__proto__=y,l(t,o,"GeneratorFunction")),t.prototype=Object.create(k),t},t.awrap=function(t){return{__await:t}},x(S.prototype),l(S.prototype,s,(function(){return this})),t.AsyncIterator=S,t.async=function(e,n,r,i,a){void 0===a&&(a=Promise);var s=new S(u(e,n,r,i),a);return t.isGeneratorFunction(n)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},x(k),l(k,o,"Generator"),l(k,a,(function(){return this})),l(k,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=T,M.prototype={constructor:M,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(A),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function i(r,i){return o.type="throw",o.arg=t,n.next=r,i&&(n.method="next",n.arg=e),!!i}for(var a=this.tryEntries.length-1;a>=0;--a){var s=this.tryEntries[a],o=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var l=r.call(s,"catchLoc"),u=r.call(s,"finallyLoc");if(l&&u){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var a=i;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var s=a?a.completion:{};return s.type=t,s.arg=e,a?(this.method="next",this.next=a.finallyLoc,m):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),A(n),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;A(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:T(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),m}},t}(t.exports);try{regeneratorRuntime=e}catch(t){"object"==typeof globalThis?globalThis.regeneratorRuntime=e:Function("r","regeneratorRuntime = r")(e)}},5299:(t,e,n)=>{var r=n(9208),i=r.Buffer;function a(t,e){for(var n in t)e[n]=t[n]}function s(t,e,n){return i(t,e,n)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?t.exports=r:(a(r,e),e.Buffer=s),a(i,s),s.from=function(t,e,n){if("number"==typeof t)throw new TypeError("Argument must not be a number");return i(t,e,n)},s.alloc=function(t,e,n){if("number"!=typeof t)throw new TypeError("Argument must be a number");var r=i(t);return void 0!==e?"string"==typeof n?r.fill(e,n):r.fill(e):r.fill(0),r},s.allocUnsafe=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return i(t)},s.allocUnsafeSlow=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return r.SlowBuffer(t)}},8467:(t,e,n)=>{var r=n(9208),i=r.Buffer;function a(t,e){for(var n in t)e[n]=t[n]}function s(t,e,n){return i(t,e,n)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?t.exports=r:(a(r,e),e.Buffer=s),s.prototype=Object.create(i.prototype),a(i,s),s.from=function(t,e,n){if("number"==typeof t)throw new TypeError("Argument must not be a number");return i(t,e,n)},s.alloc=function(t,e,n){if("number"!=typeof t)throw new TypeError("Argument must be a number");var r=i(t);return void 0!==e?"string"==typeof n?r.fill(e,n):r.fill(e):r.fill(0),r},s.allocUnsafe=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return i(t)},s.allocUnsafeSlow=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return r.SlowBuffer(t)}},3883:(t,e,n)=>{var r=n(5758),i=n(8620),a=n(8264),s=n(1701),o=n(284),l=n(4147),u=n(5652);u.alea=r,u.xor128=i,u.xorwow=a,u.xorshift7=s,u.xor4096=o,u.tychei=l,t.exports=u},5758:function(t,e,n){var r;!function(t,i,a){function s(t){var e,n=this,r=(e=4022871197,function(t){t=t.toString();for(var n=0;n<t.length;n++){var r=.02519603282416938*(e+=t.charCodeAt(n));r-=e=r>>>0,e=(r*=e)>>>0,e+=4294967296*(r-=e)}return 2.3283064365386963e-10*(e>>>0)});n.next=function(){var t=2091639*n.s0+2.3283064365386963e-10*n.c;return n.s0=n.s1,n.s1=n.s2,n.s2=t-(n.c=0|t)},n.c=1,n.s0=r(" "),n.s1=r(" "),n.s2=r(" "),n.s0-=r(t),n.s0<0&&(n.s0+=1),n.s1-=r(t),n.s1<0&&(n.s1+=1),n.s2-=r(t),n.s2<0&&(n.s2+=1),r=null}function o(t,e){return e.c=t.c,e.s0=t.s0,e.s1=t.s1,e.s2=t.s2,e}function l(t,e){var n=new s(t),r=e&&e.state,i=n.next;return i.int32=function(){return 4294967296*n.next()|0},i.double=function(){return i()+11102230246251565e-32*(2097152*i()|0)},i.quick=i,r&&("object"==typeof r&&o(r,n),i.state=function(){return o(n,{})}),i}i&&i.exports?i.exports=l:n.amdD&&n.amdO?void 0===(r=function(){return l}.call(e,n,e,i))||(i.exports=r):this.alea=l}(0,t=n.nmd(t),n.amdD)},4147:function(t,e,n){var r;!function(t,i,a){function s(t){var e=this,n="";e.next=function(){var t=e.b,n=e.c,r=e.d,i=e.a;return t=t<<25^t>>>7^n,n=n-r|0,r=r<<24^r>>>8^i,i=i-t|0,e.b=t=t<<20^t>>>12^n,e.c=n=n-r|0,e.d=r<<16^n>>>16^i,e.a=i-t|0},e.a=0,e.b=0,e.c=-1640531527,e.d=1367130551,t===Math.floor(t)?(e.a=t/4294967296|0,e.b=0|t):n+=t;for(var r=0;r<n.length+20;r++)e.b^=0|n.charCodeAt(r),e.next()}function o(t,e){return e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e}function l(t,e){var n=new s(t),r=e&&e.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},i.int32=n.next,i.quick=i,r&&("object"==typeof r&&o(r,n),i.state=function(){return o(n,{})}),i}i&&i.exports?i.exports=l:n.amdD&&n.amdO?void 0===(r=function(){return l}.call(e,n,e,i))||(i.exports=r):this.tychei=l}(0,t=n.nmd(t),n.amdD)},8620:function(t,e,n){var r;!function(t,i,a){function s(t){var e=this,n="";e.x=0,e.y=0,e.z=0,e.w=0,e.next=function(){var t=e.x^e.x<<11;return e.x=e.y,e.y=e.z,e.z=e.w,e.w^=e.w>>>19^t^t>>>8},t===(0|t)?e.x=t:n+=t;for(var r=0;r<n.length+64;r++)e.x^=0|n.charCodeAt(r),e.next()}function o(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e}function l(t,e){var n=new s(t),r=e&&e.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},i.int32=n.next,i.quick=i,r&&("object"==typeof r&&o(r,n),i.state=function(){return o(n,{})}),i}i&&i.exports?i.exports=l:n.amdD&&n.amdO?void 0===(r=function(){return l}.call(e,n,e,i))||(i.exports=r):this.xor128=l}(0,t=n.nmd(t),n.amdD)},284:function(t,e,n){var r;!function(t,i,a){function s(t){var e=this;e.next=function(){var t,n,r=e.w,i=e.X,a=e.i;return e.w=r=r+1640531527|0,n=i[a+34&127],t=i[a=a+1&127],n^=n<<13,t^=t<<17,n^=n>>>15,t^=t>>>12,n=i[a]=n^t,e.i=a,n+(r^r>>>16)|0},function(t,e){var n,r,i,a,s,o=[],l=128;for(e===(0|e)?(r=e,e=null):(e+="\0",r=0,l=Math.max(l,e.length)),i=0,a=-32;a<l;++a)e&&(r^=e.charCodeAt((a+32)%e.length)),0===a&&(s=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,a>=0&&(s=s+1640531527|0,i=0==(n=o[127&a]^=r+s)?i+1:0);for(i>=128&&(o[127&(e&&e.length||0)]=-1),i=127,a=512;a>0;--a)r=o[i+34&127],n=o[i=i+1&127],r^=r<<13,n^=n<<17,r^=r>>>15,n^=n>>>12,o[i]=r^n;t.w=s,t.X=o,t.i=i}(e,t)}function o(t,e){return e.i=t.i,e.w=t.w,e.X=t.X.slice(),e}function l(t,e){null==t&&(t=+new Date);var n=new s(t),r=e&&e.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},i.int32=n.next,i.quick=i,r&&(r.X&&o(r,n),i.state=function(){return o(n,{})}),i}i&&i.exports?i.exports=l:n.amdD&&n.amdO?void 0===(r=function(){return l}.call(e,n,e,i))||(i.exports=r):this.xor4096=l}(0,t=n.nmd(t),n.amdD)},1701:function(t,e,n){var r;!function(t,i,a){function s(t){var e=this;e.next=function(){var t,n,r=e.x,i=e.i;return t=r[i],n=(t^=t>>>7)^t<<24,n^=(t=r[i+1&7])^t>>>10,n^=(t=r[i+3&7])^t>>>3,n^=(t=r[i+4&7])^t<<7,t=r[i+7&7],n^=(t^=t<<13)^t<<9,r[i]=n,e.i=i+1&7,n},function(t,e){var n,r=[];if(e===(0|e))r[0]=e;else for(e=""+e,n=0;n<e.length;++n)r[7&n]=r[7&n]<<15^e.charCodeAt(n)+r[n+1&7]<<13;for(;r.length<8;)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n?r[7]=-1:r[n],t.x=r,t.i=0,n=256;n>0;--n)t.next()}(e,t)}function o(t,e){return e.x=t.x.slice(),e.i=t.i,e}function l(t,e){null==t&&(t=+new Date);var n=new s(t),r=e&&e.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},i.int32=n.next,i.quick=i,r&&(r.x&&o(r,n),i.state=function(){return o(n,{})}),i}i&&i.exports?i.exports=l:n.amdD&&n.amdO?void 0===(r=function(){return l}.call(e,n,e,i))||(i.exports=r):this.xorshift7=l}(0,t=n.nmd(t),n.amdD)},8264:function(t,e,n){var r;!function(t,i,a){function s(t){var e=this,n="";e.next=function(){var t=e.x^e.x>>>2;return e.x=e.y,e.y=e.z,e.z=e.w,e.w=e.v,(e.d=e.d+362437|0)+(e.v=e.v^e.v<<4^t^t<<1)|0},e.x=0,e.y=0,e.z=0,e.w=0,e.v=0,t===(0|t)?e.x=t:n+=t;for(var r=0;r<n.length+64;r++)e.x^=0|n.charCodeAt(r),r==n.length&&(e.d=e.x<<10^e.x>>>4),e.next()}function o(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e.v=t.v,e.d=t.d,e}function l(t,e){var n=new s(t),r=e&&e.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},i.int32=n.next,i.quick=i,r&&("object"==typeof r&&o(r,n),i.state=function(){return o(n,{})}),i}i&&i.exports?i.exports=l:n.amdD&&n.amdO?void 0===(r=function(){return l}.call(e,n,e,i))||(i.exports=r):this.xorwow=l}(0,t=n.nmd(t),n.amdD)},5652:(t,e,n)=>{var r;!function(i,a){var s,o=this,l=256,u=a.pow(l,6),h=a.pow(2,52),c=2*h,d=255;function f(t,e,n){var r=[],d=b(g((e=1==e?{entropy:!0}:e||{}).entropy?[t,y(i)]:null==t?function(){try{var t;return s&&(t=s.randomBytes)?t=t(l):(t=new Uint8Array(l),(o.crypto||o.msCrypto).getRandomValues(t)),y(t)}catch(t){var e=o.navigator,n=e&&e.plugins;return[+new Date,o,n,o.screen,y(i)]}}():t,3),r),f=new p(r),v=function(){for(var t=f.g(6),e=u,n=0;t<h;)t=(t+n)*l,e*=l,n=f.g(1);for(;t>=c;)t/=2,e/=2,n>>>=1;return(t+n)/e};return v.int32=function(){return 0|f.g(4)},v.quick=function(){return f.g(4)/4294967296},v.double=v,b(y(f.S),i),(e.pass||n||function(t,e,n,r){return r&&(r.S&&m(r,f),t.state=function(){return m(f,{})}),n?(a.random=t,e):t})(v,d,"global"in e?e.global:this==a,e.state)}function p(t){var e,n=t.length,r=this,i=0,a=r.i=r.j=0,s=r.S=[];for(n||(t=[n++]);i<l;)s[i]=i++;for(i=0;i<l;i++)s[i]=s[a=d&a+t[i%n]+(e=s[i])],s[a]=e;(r.g=function(t){for(var e,n=0,i=r.i,a=r.j,s=r.S;t--;)e=s[i=d&i+1],n=n*l+s[d&(s[i]=s[a=d&a+e])+(s[a]=e)];return r.i=i,r.j=a,n})(l)}function m(t,e){return e.i=t.i,e.j=t.j,e.S=t.S.slice(),e}function g(t,e){var n,r=[],i=typeof t;if(e&&"object"==i)for(n in t)try{r.push(g(t[n],e-1))}catch(t){}return r.length?r:"string"==i?t:t+"\0"}function b(t,e){for(var n,r=t+"",i=0;i<r.length;)e[d&i]=d&(n^=19*e[d&i])+r.charCodeAt(i++);return y(e)}function y(t){return String.fromCharCode.apply(0,t)}if(a.seedrandom=f,b(a.random(),i),t.exports){t.exports=f;try{s=n(3039)}catch(t){}}else void 0===(r=function(){return f}.call(e,n,e,t))||(t.exports=r)}([],Math)},1058:(t,e,n)=>{var r=n(4322),i=n(4861),a=n(4557),s=n(3046),o=n(2841),l=n(5872),u=n(9429);u.alea=r,u.xor128=i,u.xorwow=a,u.xorshift7=s,u.xor4096=o,u.tychei=l,t.exports=u},4322:function(t,e,n){var r;!function(t,i,a){function s(t){var e,n=this,r=(e=4022871197,function(t){t=String(t);for(var n=0;n<t.length;n++){var r=.02519603282416938*(e+=t.charCodeAt(n));r-=e=r>>>0,e=(r*=e)>>>0,e+=4294967296*(r-=e)}return 2.3283064365386963e-10*(e>>>0)});n.next=function(){var t=2091639*n.s0+2.3283064365386963e-10*n.c;return n.s0=n.s1,n.s1=n.s2,n.s2=t-(n.c=0|t)},n.c=1,n.s0=r(" "),n.s1=r(" "),n.s2=r(" "),n.s0-=r(t),n.s0<0&&(n.s0+=1),n.s1-=r(t),n.s1<0&&(n.s1+=1),n.s2-=r(t),n.s2<0&&(n.s2+=1),r=null}function o(t,e){return e.c=t.c,e.s0=t.s0,e.s1=t.s1,e.s2=t.s2,e}function l(t,e){var n=new s(t),r=e&&e.state,i=n.next;return i.int32=function(){return 4294967296*n.next()|0},i.double=function(){return i()+11102230246251565e-32*(2097152*i()|0)},i.quick=i,r&&("object"==typeof r&&o(r,n),i.state=function(){return o(n,{})}),i}i&&i.exports?i.exports=l:n.amdD&&n.amdO?void 0===(r=function(){return l}.call(e,n,e,i))||(i.exports=r):this.alea=l}(0,t=n.nmd(t),n.amdD)},5872:function(t,e,n){var r;!function(t,i,a){function s(t){var e=this,n="";e.next=function(){var t=e.b,n=e.c,r=e.d,i=e.a;return t=t<<25^t>>>7^n,n=n-r|0,r=r<<24^r>>>8^i,i=i-t|0,e.b=t=t<<20^t>>>12^n,e.c=n=n-r|0,e.d=r<<16^n>>>16^i,e.a=i-t|0},e.a=0,e.b=0,e.c=-1640531527,e.d=1367130551,t===Math.floor(t)?(e.a=t/4294967296|0,e.b=0|t):n+=t;for(var r=0;r<n.length+20;r++)e.b^=0|n.charCodeAt(r),e.next()}function o(t,e){return e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e}function l(t,e){var n=new s(t),r=e&&e.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},i.int32=n.next,i.quick=i,r&&("object"==typeof r&&o(r,n),i.state=function(){return o(n,{})}),i}i&&i.exports?i.exports=l:n.amdD&&n.amdO?void 0===(r=function(){return l}.call(e,n,e,i))||(i.exports=r):this.tychei=l}(0,t=n.nmd(t),n.amdD)},4861:function(t,e,n){var r;!function(t,i,a){function s(t){var e=this,n="";e.x=0,e.y=0,e.z=0,e.w=0,e.next=function(){var t=e.x^e.x<<11;return e.x=e.y,e.y=e.z,e.z=e.w,e.w^=e.w>>>19^t^t>>>8},t===(0|t)?e.x=t:n+=t;for(var r=0;r<n.length+64;r++)e.x^=0|n.charCodeAt(r),e.next()}function o(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e}function l(t,e){var n=new s(t),r=e&&e.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},i.int32=n.next,i.quick=i,r&&("object"==typeof r&&o(r,n),i.state=function(){return o(n,{})}),i}i&&i.exports?i.exports=l:n.amdD&&n.amdO?void 0===(r=function(){return l}.call(e,n,e,i))||(i.exports=r):this.xor128=l}(0,t=n.nmd(t),n.amdD)},2841:function(t,e,n){var r;!function(t,i,a){function s(t){var e=this;e.next=function(){var t,n,r=e.w,i=e.X,a=e.i;return e.w=r=r+1640531527|0,n=i[a+34&127],t=i[a=a+1&127],n^=n<<13,t^=t<<17,n^=n>>>15,t^=t>>>12,n=i[a]=n^t,e.i=a,n+(r^r>>>16)|0},function(t,e){var n,r,i,a,s,o=[],l=128;for(e===(0|e)?(r=e,e=null):(e+="\0",r=0,l=Math.max(l,e.length)),i=0,a=-32;a<l;++a)e&&(r^=e.charCodeAt((a+32)%e.length)),0===a&&(s=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,a>=0&&(s=s+1640531527|0,i=0==(n=o[127&a]^=r+s)?i+1:0);for(i>=128&&(o[127&(e&&e.length||0)]=-1),i=127,a=512;a>0;--a)r=o[i+34&127],n=o[i=i+1&127],r^=r<<13,n^=n<<17,r^=r>>>15,n^=n>>>12,o[i]=r^n;t.w=s,t.X=o,t.i=i}(e,t)}function o(t,e){return e.i=t.i,e.w=t.w,e.X=t.X.slice(),e}function l(t,e){null==t&&(t=+new Date);var n=new s(t),r=e&&e.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},i.int32=n.next,i.quick=i,r&&(r.X&&o(r,n),i.state=function(){return o(n,{})}),i}i&&i.exports?i.exports=l:n.amdD&&n.amdO?void 0===(r=function(){return l}.call(e,n,e,i))||(i.exports=r):this.xor4096=l}(0,t=n.nmd(t),n.amdD)},3046:function(t,e,n){var r;!function(t,i,a){function s(t){var e=this;e.next=function(){var t,n,r=e.x,i=e.i;return t=r[i],n=(t^=t>>>7)^t<<24,n^=(t=r[i+1&7])^t>>>10,n^=(t=r[i+3&7])^t>>>3,n^=(t=r[i+4&7])^t<<7,t=r[i+7&7],n^=(t^=t<<13)^t<<9,r[i]=n,e.i=i+1&7,n},function(t,e){var n,r=[];if(e===(0|e))r[0]=e;else for(e=""+e,n=0;n<e.length;++n)r[7&n]=r[7&n]<<15^e.charCodeAt(n)+r[n+1&7]<<13;for(;r.length<8;)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n?r[7]=-1:r[n],t.x=r,t.i=0,n=256;n>0;--n)t.next()}(e,t)}function o(t,e){return e.x=t.x.slice(),e.i=t.i,e}function l(t,e){null==t&&(t=+new Date);var n=new s(t),r=e&&e.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},i.int32=n.next,i.quick=i,r&&(r.x&&o(r,n),i.state=function(){return o(n,{})}),i}i&&i.exports?i.exports=l:n.amdD&&n.amdO?void 0===(r=function(){return l}.call(e,n,e,i))||(i.exports=r):this.xorshift7=l}(0,t=n.nmd(t),n.amdD)},4557:function(t,e,n){var r;!function(t,i,a){function s(t){var e=this,n="";e.next=function(){var t=e.x^e.x>>>2;return e.x=e.y,e.y=e.z,e.z=e.w,e.w=e.v,(e.d=e.d+362437|0)+(e.v=e.v^e.v<<4^t^t<<1)|0},e.x=0,e.y=0,e.z=0,e.w=0,e.v=0,t===(0|t)?e.x=t:n+=t;for(var r=0;r<n.length+64;r++)e.x^=0|n.charCodeAt(r),r==n.length&&(e.d=e.x<<10^e.x>>>4),e.next()}function o(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e.v=t.v,e.d=t.d,e}function l(t,e){var n=new s(t),r=e&&e.state,i=function(){return(n.next()>>>0)/4294967296};return i.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},i.int32=n.next,i.quick=i,r&&("object"==typeof r&&o(r,n),i.state=function(){return o(n,{})}),i}i&&i.exports?i.exports=l:n.amdD&&n.amdO?void 0===(r=function(){return l}.call(e,n,e,i))||(i.exports=r):this.xorwow=l}(0,t=n.nmd(t),n.amdD)},9429:function(t,e,n){var r;!function(i,a,s){var o,l=256,u=s.pow(l,6),h=s.pow(2,52),c=2*h,d=255;function f(t,e,n){var r=[],d=b(g((e=1==e?{entropy:!0}:e||{}).entropy?[t,y(a)]:null==t?function(){try{var t;return o&&(t=o.randomBytes)?t=t(l):(t=new Uint8Array(l),(i.crypto||i.msCrypto).getRandomValues(t)),y(t)}catch(t){var e=i.navigator,n=e&&e.plugins;return[+new Date,i,n,i.screen,y(a)]}}():t,3),r),f=new p(r),v=function(){for(var t=f.g(6),e=u,n=0;t<h;)t=(t+n)*l,e*=l,n=f.g(1);for(;t>=c;)t/=2,e/=2,n>>>=1;return(t+n)/e};return v.int32=function(){return 0|f.g(4)},v.quick=function(){return f.g(4)/4294967296},v.double=v,b(y(f.S),a),(e.pass||n||function(t,e,n,r){return r&&(r.S&&m(r,f),t.state=function(){return m(f,{})}),n?(s.random=t,e):t})(v,d,"global"in e?e.global:this==s,e.state)}function p(t){var e,n=t.length,r=this,i=0,a=r.i=r.j=0,s=r.S=[];for(n||(t=[n++]);i<l;)s[i]=i++;for(i=0;i<l;i++)s[i]=s[a=d&a+t[i%n]+(e=s[i])],s[a]=e;(r.g=function(t){for(var e,n=0,i=r.i,a=r.j,s=r.S;t--;)e=s[i=d&i+1],n=n*l+s[d&(s[i]=s[a=d&a+e])+(s[a]=e)];return r.i=i,r.j=a,n})(l)}function m(t,e){return e.i=t.i,e.j=t.j,e.S=t.S.slice(),e}function g(t,e){var n,r=[],i=typeof t;if(e&&"object"==i)for(n in t)try{r.push(g(t[n],e-1))}catch(t){}return r.length?r:"string"==i?t:t+"\0"}function b(t,e){for(var n,r=t+"",i=0;i<r.length;)e[d&i]=d&(n^=19*e[d&i])+r.charCodeAt(i++);return y(e)}function y(t){return String.fromCharCode.apply(0,t)}if(b(s.random(),a),t.exports){t.exports=f;try{o=n(6789)}catch(t){}}else void 0===(r=function(){return f}.call(e,n,e,t))||(t.exports=r)}("undefined"!=typeof self?self:this,[],Math)},4663:(t,e,n)=>{t.exports=i;var r=n(6204).EventEmitter;function i(){r.call(this)}n(4603)(i,r),i.Readable=n(8263),i.Writable=n(7642),i.Duplex=n(2063),i.Transform=n(8595),i.PassThrough=n(5991),i.Stream=i,i.prototype.pipe=function(t,e){var n=this;function i(e){t.writable&&!1===t.write(e)&&n.pause&&n.pause()}function a(){n.readable&&n.resume&&n.resume()}n.on("data",i),t.on("drain",a),t._isStdio||e&&!1===e.end||(n.on("end",o),n.on("close",l));var s=!1;function o(){s||(s=!0,t.end())}function l(){s||(s=!0,"function"==typeof t.destroy&&t.destroy())}function u(t){if(h(),0===r.listenerCount(this,"error"))throw t}function h(){n.removeListener("data",i),t.removeListener("drain",a),n.removeListener("end",o),n.removeListener("close",l),n.removeListener("error",u),t.removeListener("error",u),n.removeListener("end",h),n.removeListener("close",h),t.removeListener("close",h)}return n.on("error",u),t.on("error",u),n.on("end",h),n.on("close",h),t.on("close",h),t.emit("pipe",n),t}},6824:(t,e,n)=>{var r=n(4554),i=n(8854),a=n(7270),s=n(8708),o=n(1892),l=e;l.request=function(t,e){t="string"==typeof t?o.parse(t):a(t);var i=-1===n.g.location.protocol.search(/^https?:$/)?"http:":"",s=t.protocol||i,l=t.hostname||t.host,u=t.port,h=t.path||"/";l&&-1!==l.indexOf(":")&&(l="["+l+"]"),t.url=(l?s+"//"+l:"")+(u?":"+u:"")+h,t.method=(t.method||"GET").toUpperCase(),t.headers=t.headers||{};var c=new r(t);return e&&c.on("response",e),c},l.get=function(t,e){var n=l.request(t,e);return n.end(),n},l.ClientRequest=r,l.IncomingMessage=i.IncomingMessage,l.Agent=function(){},l.Agent.defaultMaxSockets=4,l.globalAgent=new l.Agent,l.STATUS_CODES=s,l.METHODS=["CHECKOUT","CONNECT","COPY","DELETE","GET","HEAD","LOCK","M-SEARCH","MERGE","MKACTIVITY","MKCOL","MOVE","NOTIFY","OPTIONS","PATCH","POST","PROPFIND","PROPPATCH","PURGE","PUT","REPORT","SEARCH","SUBSCRIBE","TRACE","UNLOCK","UNSUBSCRIBE"]},8509:(t,e,n)=>{var r;function i(){if(void 0!==r)return r;if(n.g.XMLHttpRequest){r=new n.g.XMLHttpRequest;try{r.open("GET",n.g.XDomainRequest?"/":"https://example.com")}catch(t){r=null}}else r=null;return r}function a(t){var e=i();if(!e)return!1;try{return e.responseType=t,e.responseType===t}catch(t){}return!1}function s(t){return"function"==typeof t}e.fetch=s(n.g.fetch)&&s(n.g.ReadableStream),e.writableStream=s(n.g.WritableStream),e.abortController=s(n.g.AbortController),e.arraybuffer=e.fetch||a("arraybuffer"),e.msstream=!e.fetch&&a("ms-stream"),e.mozchunkedarraybuffer=!e.fetch&&a("moz-chunked-arraybuffer"),e.overrideMimeType=e.fetch||!!i()&&s(i().overrideMimeType),r=null},4554:(t,e,n)=>{var r=n(9208).Buffer,i=n(7671),a=n(8509),s=n(4603),o=n(8854),l=n(1902),u=o.IncomingMessage,h=o.readyStates,c=t.exports=function(t){var e,n=this;l.Writable.call(n),n._opts=t,n._body=[],n._headers={},t.auth&&n.setHeader("Authorization","Basic "+r.from(t.auth).toString("base64")),Object.keys(t.headers).forEach((function(e){n.setHeader(e,t.headers[e])}));var i=!0;if("disable-fetch"===t.mode||"requestTimeout"in t&&!a.abortController)i=!1,e=!0;else if("prefer-streaming"===t.mode)e=!1;else if("allow-wrong-content-type"===t.mode)e=!a.overrideMimeType;else{if(t.mode&&"default"!==t.mode&&"prefer-fast"!==t.mode)throw new Error("Invalid value for opts.mode");e=!0}n._mode=function(t,e){return a.fetch&&e?"fetch":a.mozchunkedarraybuffer?"moz-chunked-arraybuffer":a.msstream?"ms-stream":a.arraybuffer&&t?"arraybuffer":"text"}(e,i),n._fetchTimer=null,n._socketTimeout=null,n._socketTimer=null,n.on("finish",(function(){n._onFinish()}))};s(c,l.Writable),c.prototype.setHeader=function(t,e){var n=t.toLowerCase();-1===d.indexOf(n)&&(this._headers[n]={name:t,value:e})},c.prototype.getHeader=function(t){var e=this._headers[t.toLowerCase()];return e?e.value:null},c.prototype.removeHeader=function(t){delete this._headers[t.toLowerCase()]},c.prototype._onFinish=function(){var t=this;if(!t._destroyed){var e=t._opts;"timeout"in e&&0!==e.timeout&&t.setTimeout(e.timeout);var r=t._headers,s=null;"GET"!==e.method&&"HEAD"!==e.method&&(s=new Blob(t._body,{type:(r["content-type"]||{}).value||""}));var o=[];if(Object.keys(r).forEach((function(t){var e=r[t].name,n=r[t].value;Array.isArray(n)?n.forEach((function(t){o.push([e,t])})):o.push([e,n])})),"fetch"===t._mode){var l=null;if(a.abortController){var u=new AbortController;l=u.signal,t._fetchAbortController=u,"requestTimeout"in e&&0!==e.requestTimeout&&(t._fetchTimer=n.g.setTimeout((function(){t.emit("requestTimeout"),t._fetchAbortController&&t._fetchAbortController.abort()}),e.requestTimeout))}n.g.fetch(t._opts.url,{method:t._opts.method,headers:o,body:s||void 0,mode:"cors",credentials:e.withCredentials?"include":"same-origin",signal:l}).then((function(e){t._fetchResponse=e,t._resetTimers(!1),t._connect()}),(function(e){t._resetTimers(!0),t._destroyed||t.emit("error",e)}))}else{var c=t._xhr=new n.g.XMLHttpRequest;try{c.open(t._opts.method,t._opts.url,!0)}catch(e){return void i.nextTick((function(){t.emit("error",e)}))}"responseType"in c&&(c.responseType=t._mode),"withCredentials"in c&&(c.withCredentials=!!e.withCredentials),"text"===t._mode&&"overrideMimeType"in c&&c.overrideMimeType("text/plain; charset=x-user-defined"),"requestTimeout"in e&&(c.timeout=e.requestTimeout,c.ontimeout=function(){t.emit("requestTimeout")}),o.forEach((function(t){c.setRequestHeader(t[0],t[1])})),t._response=null,c.onreadystatechange=function(){switch(c.readyState){case h.LOADING:case h.DONE:t._onXHRProgress()}},"moz-chunked-arraybuffer"===t._mode&&(c.onprogress=function(){t._onXHRProgress()}),c.onerror=function(){t._destroyed||(t._resetTimers(!0),t.emit("error",new Error("XHR error")))};try{c.send(s)}catch(e){return void i.nextTick((function(){t.emit("error",e)}))}}}},c.prototype._onXHRProgress=function(){var t=this;t._resetTimers(!1),function(t){try{var e=t.status;return null!==e&&0!==e}catch(t){return!1}}(t._xhr)&&!t._destroyed&&(t._response||t._connect(),t._response._onXHRProgress(t._resetTimers.bind(t)))},c.prototype._connect=function(){var t=this;t._destroyed||(t._response=new u(t._xhr,t._fetchResponse,t._mode,t._resetTimers.bind(t)),t._response.on("error",(function(e){t.emit("error",e)})),t.emit("response",t._response))},c.prototype._write=function(t,e,n){this._body.push(t),n()},c.prototype._resetTimers=function(t){var e=this;n.g.clearTimeout(e._socketTimer),e._socketTimer=null,t?(n.g.clearTimeout(e._fetchTimer),e._fetchTimer=null):e._socketTimeout&&(e._socketTimer=n.g.setTimeout((function(){e.emit("timeout")}),e._socketTimeout))},c.prototype.abort=c.prototype.destroy=function(t){var e=this;e._destroyed=!0,e._resetTimers(!0),e._response&&(e._response._destroyed=!0),e._xhr?e._xhr.abort():e._fetchAbortController&&e._fetchAbortController.abort(),t&&e.emit("error",t)},c.prototype.end=function(t,e,n){"function"==typeof t&&(n=t,t=void 0),l.Writable.prototype.end.call(this,t,e,n)},c.prototype.setTimeout=function(t,e){var n=this;e&&n.once("timeout",e),n._socketTimeout=t,n._resetTimers(!1)},c.prototype.flushHeaders=function(){},c.prototype.setNoDelay=function(){},c.prototype.setSocketKeepAlive=function(){};var d=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","cookie","cookie2","date","dnt","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","via"]},8854:(t,e,n)=>{var r=n(7671),i=n(9208).Buffer,a=n(8509),s=n(4603),o=n(1902),l=e.readyStates={UNSENT:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4},u=e.IncomingMessage=function(t,e,n,s){var l=this;if(o.Readable.call(l),l._mode=n,l.headers={},l.rawHeaders=[],l.trailers={},l.rawTrailers=[],l.on("end",(function(){r.nextTick((function(){l.emit("close")}))})),"fetch"===n){if(l._fetchResponse=e,l.url=e.url,l.statusCode=e.status,l.statusMessage=e.statusText,e.headers.forEach((function(t,e){l.headers[e.toLowerCase()]=t,l.rawHeaders.push(e,t)})),a.writableStream){var u=new WritableStream({write:function(t){return s(!1),new Promise((function(e,n){l._destroyed?n():l.push(i.from(t))?e():l._resumeFetch=e}))},close:function(){s(!0),l._destroyed||l.push(null)},abort:function(t){s(!0),l._destroyed||l.emit("error",t)}});try{return void e.body.pipeTo(u).catch((function(t){s(!0),l._destroyed||l.emit("error",t)}))}catch(t){}}var h=e.body.getReader();!function t(){h.read().then((function(e){l._destroyed||(s(e.done),e.done?l.push(null):(l.push(i.from(e.value)),t()))})).catch((function(t){s(!0),l._destroyed||l.emit("error",t)}))}()}else if(l._xhr=t,l._pos=0,l.url=t.responseURL,l.statusCode=t.status,l.statusMessage=t.statusText,t.getAllResponseHeaders().split(/\r?\n/).forEach((function(t){var e=t.match(/^([^:]+):\s*(.*)/);if(e){var n=e[1].toLowerCase();"set-cookie"===n?(void 0===l.headers[n]&&(l.headers[n]=[]),l.headers[n].push(e[2])):void 0!==l.headers[n]?l.headers[n]+=", "+e[2]:l.headers[n]=e[2],l.rawHeaders.push(e[1],e[2])}})),l._charset="x-user-defined",!a.overrideMimeType){var c=l.rawHeaders["mime-type"];if(c){var d=c.match(/;\s*charset=([^;])(;|$)/);d&&(l._charset=d[1].toLowerCase())}l._charset||(l._charset="utf-8")}};s(u,o.Readable),u.prototype._read=function(){var t=this._resumeFetch;t&&(this._resumeFetch=null,t())},u.prototype._onXHRProgress=function(t){var e=this,r=e._xhr,a=null;switch(e._mode){case"text":if((a=r.responseText).length>e._pos){var s=a.substr(e._pos);if("x-user-defined"===e._charset){for(var o=i.alloc(s.length),u=0;u<s.length;u++)o[u]=255&s.charCodeAt(u);e.push(o)}else e.push(s,e._charset);e._pos=a.length}break;case"arraybuffer":if(r.readyState!==l.DONE||!r.response)break;a=r.response,e.push(i.from(new Uint8Array(a)));break;case"moz-chunked-arraybuffer":if(a=r.response,r.readyState!==l.LOADING||!a)break;e.push(i.from(new Uint8Array(a)));break;case"ms-stream":if(a=r.response,r.readyState!==l.LOADING)break;var h=new n.g.MSStreamReader;h.onprogress=function(){h.result.byteLength>e._pos&&(e.push(i.from(new Uint8Array(h.result.slice(e._pos)))),e._pos=h.result.byteLength)},h.onload=function(){t(!0),e.push(null)},h.readAsArrayBuffer(a)}e._xhr.readyState===l.DONE&&"ms-stream"!==e._mode&&(t(!0),e.push(null))}},1212:(t,e,n)=>{"use strict";var r=n(5299).Buffer,i=r.isEncoding||function(t){switch((t=""+t)&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function a(t){var e;switch(this.encoding=function(t){var e=function(t){if(!t)return"utf8";for(var e;;)switch(t){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return t;default:if(e)return;t=(""+t).toLowerCase(),e=!0}}(t);if("string"!=typeof e&&(r.isEncoding===i||!i(t)))throw new Error("Unknown encoding: "+t);return e||t}(t),this.encoding){case"utf16le":this.text=l,this.end=u,e=4;break;case"utf8":this.fillLast=o,e=4;break;case"base64":this.text=h,this.end=c,e=3;break;default:return this.write=d,void(this.end=f)}this.lastNeed=0,this.lastTotal=0,this.lastChar=r.allocUnsafe(e)}function s(t){return t<=127?0:t>>5==6?2:t>>4==14?3:t>>3==30?4:t>>6==2?-1:-2}function o(t){var e=this.lastTotal-this.lastNeed,n=function(t,e,n){if(128!=(192&e[0]))return t.lastNeed=0,"�";if(t.lastNeed>1&&e.length>1){if(128!=(192&e[1]))return t.lastNeed=1,"�";if(t.lastNeed>2&&e.length>2&&128!=(192&e[2]))return t.lastNeed=2,"�"}}(this,t);return void 0!==n?n:this.lastNeed<=t.length?(t.copy(this.lastChar,e,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(t.copy(this.lastChar,e,0,t.length),void(this.lastNeed-=t.length))}function l(t,e){if((t.length-e)%2==0){var n=t.toString("utf16le",e);if(n){var r=n.charCodeAt(n.length-1);if(r>=55296&&r<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1],n.slice(0,-1)}return n}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=t[t.length-1],t.toString("utf16le",e,t.length-1)}function u(t){var e=t&&t.length?this.write(t):"";if(this.lastNeed){var n=this.lastTotal-this.lastNeed;return e+this.lastChar.toString("utf16le",0,n)}return e}function h(t,e){var n=(t.length-e)%3;return 0===n?t.toString("base64",e):(this.lastNeed=3-n,this.lastTotal=3,1===n?this.lastChar[0]=t[t.length-1]:(this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1]),t.toString("base64",e,t.length-n))}function c(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function d(t){return t.toString(this.encoding)}function f(t){return t&&t.length?this.write(t):""}e.s=a,a.prototype.write=function(t){if(0===t.length)return"";var e,n;if(this.lastNeed){if(void 0===(e=this.fillLast(t)))return"";n=this.lastNeed,this.lastNeed=0}else n=0;return n<t.length?e?e+this.text(t,n):this.text(t,n):e||""},a.prototype.end=function(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+"�":e},a.prototype.text=function(t,e){var n=function(t,e,n){var r=e.length-1;if(r<n)return 0;var i=s(e[r]);return i>=0?(i>0&&(t.lastNeed=i-1),i):--r<n||-2===i?0:(i=s(e[r]))>=0?(i>0&&(t.lastNeed=i-2),i):--r<n||-2===i?0:(i=s(e[r]))>=0?(i>0&&(2===i?i=0:t.lastNeed=i-3),i):0}(this,t,e);if(!this.lastNeed)return t.toString("utf8",e);this.lastTotal=n;var r=t.length-(n-this.lastNeed);return t.copy(this.lastChar,0,r),t.toString("utf8",e,r)},a.prototype.fillLast=function(t){if(this.lastNeed<=t.length)return t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,t.length),this.lastNeed-=t.length}},8154:(t,e,n)=>{"use strict";var r=n(8467).Buffer,i=r.isEncoding||function(t){switch((t=""+t)&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function a(t){var e;switch(this.encoding=function(t){var e=function(t){if(!t)return"utf8";for(var e;;)switch(t){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return t;default:if(e)return;t=(""+t).toLowerCase(),e=!0}}(t);if("string"!=typeof e&&(r.isEncoding===i||!i(t)))throw new Error("Unknown encoding: "+t);return e||t}(t),this.encoding){case"utf16le":this.text=l,this.end=u,e=4;break;case"utf8":this.fillLast=o,e=4;break;case"base64":this.text=h,this.end=c,e=3;break;default:return this.write=d,void(this.end=f)}this.lastNeed=0,this.lastTotal=0,this.lastChar=r.allocUnsafe(e)}function s(t){return t<=127?0:t>>5==6?2:t>>4==14?3:t>>3==30?4:t>>6==2?-1:-2}function o(t){var e=this.lastTotal-this.lastNeed,n=function(t,e,n){if(128!=(192&e[0]))return t.lastNeed=0,"�";if(t.lastNeed>1&&e.length>1){if(128!=(192&e[1]))return t.lastNeed=1,"�";if(t.lastNeed>2&&e.length>2&&128!=(192&e[2]))return t.lastNeed=2,"�"}}(this,t);return void 0!==n?n:this.lastNeed<=t.length?(t.copy(this.lastChar,e,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(t.copy(this.lastChar,e,0,t.length),void(this.lastNeed-=t.length))}function l(t,e){if((t.length-e)%2==0){var n=t.toString("utf16le",e);if(n){var r=n.charCodeAt(n.length-1);if(r>=55296&&r<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1],n.slice(0,-1)}return n}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=t[t.length-1],t.toString("utf16le",e,t.length-1)}function u(t){var e=t&&t.length?this.write(t):"";if(this.lastNeed){var n=this.lastTotal-this.lastNeed;return e+this.lastChar.toString("utf16le",0,n)}return e}function h(t,e){var n=(t.length-e)%3;return 0===n?t.toString("base64",e):(this.lastNeed=3-n,this.lastTotal=3,1===n?this.lastChar[0]=t[t.length-1]:(this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1]),t.toString("base64",e,t.length-n))}function c(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function d(t){return t.toString(this.encoding)}function f(t){return t&&t.length?this.write(t):""}e.s=a,a.prototype.write=function(t){if(0===t.length)return"";var e,n;if(this.lastNeed){if(void 0===(e=this.fillLast(t)))return"";n=this.lastNeed,this.lastNeed=0}else n=0;return n<t.length?e?e+this.text(t,n):this.text(t,n):e||""},a.prototype.end=function(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+"�":e},a.prototype.text=function(t,e){var n=function(t,e,n){var r=e.length-1;if(r<n)return 0;var i=s(e[r]);return i>=0?(i>0&&(t.lastNeed=i-1),i):--r<n||-2===i?0:(i=s(e[r]))>=0?(i>0&&(t.lastNeed=i-2),i):--r<n||-2===i?0:(i=s(e[r]))>=0?(i>0&&(2===i?i=0:t.lastNeed=i-3),i):0}(this,t,e);if(!this.lastNeed)return t.toString("utf8",e);this.lastTotal=n;var r=t.length-(n-this.lastNeed);return t.copy(this.lastChar,0,r),t.toString("utf8",e,r)},a.prototype.fillLast=function(t){if(this.lastNeed<=t.length)return t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,t.length),this.lastNeed-=t.length}},5595:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.clone=s,e.addLast=l,e.addFirst=u,e.removeLast=h,e.removeFirst=c,e.insert=d,e.removeAt=f,e.replaceAt=p,e.getIn=m,e.set=g,e.setIn=b,e.update=v,e.updateIn=w,e.merge=_,e.mergeDeep=k,e.mergeIn=x,e.omit=S,e.addDefaults=E,e.default=void 0;const n="INVALID_ARGS";function r(t){throw new Error(t)}function i(t){const e=Object.keys(t);return Object.getOwnPropertySymbols?e.concat(Object.getOwnPropertySymbols(t)):e}const a={}.hasOwnProperty;function s(t){if(Array.isArray(t))return t.slice();const e=t,n=i(e),r={};for(let t=0;t<n.length;t++){const i=n[t];r[i]=e[i]}return r}function o(t){return null!=t&&"object"==typeof t}function l(t,e){return Array.isArray(e)?t.concat(e):t.concat([e])}function u(t,e){return Array.isArray(e)?e.concat(t):[e].concat(t)}function h(t){return t.length?t.slice(0,t.length-1):t}function c(t){return t.length?t.slice(1):t}function d(t,e,n){return t.slice(0,e).concat(Array.isArray(n)?n:[n]).concat(t.slice(e))}function f(t,e){return e>=t.length||e<0?t:t.slice(0,e).concat(t.slice(e+1))}function p(t,e,n){if(t[e]===n)return t;const r=t.length,i=Array(r);for(let e=0;e<r;e++)i[e]=t[e];return i[e]=n,i}function m(t,e){if(Array.isArray(e)||r(n),null==t)return;let i=t;for(let t=0;t<e.length;t++){const n=e[t];if(i=null!=i?i[n]:void 0,void 0===i)return i}return i}function g(t,e,n){let r=t;if(null==r&&(r="number"==typeof e?[]:{}),r[e]===n)return r;const i=s(r);return i[e]=n,i}function b(t,e,n){return e.length?y(t,e,n,0):n}function y(t,e,n,r){let i;const a=e[r];return i=r===e.length-1?n:y(o(t)&&o(t[a])?t[a]:"number"==typeof e[r+1]?[]:{},e,n,r+1),g(t,a,i)}function v(t,e,n){return g(t,e,n(null==t?void 0:t[e]))}function w(t,e,n){return b(t,e,n(m(t,e)))}function _(t,e,n,r,i,a,...s){return s.length?I.call(null,!1,!1,t,e,n,r,i,a,...s):I(!1,!1,t,e,n,r,i,a)}function k(t,e,n,r,i,a,...s){return s.length?I.call(null,!1,!0,t,e,n,r,i,a,...s):I(!1,!0,t,e,n,r,i,a)}function x(t,e,n,r,i,a,s,...o){let l,u=m(t,e);return null==u&&(u={}),l=o.length?I.call(null,!1,!1,u,n,r,i,a,s,...o):I(!1,!1,u,n,r,i,a,s),b(t,e,l)}function S(t,e){const n=Array.isArray(e)?e:[e];let r=!1;for(let e=0;e<n.length;e++)if(a.call(t,n[e])){r=!0;break}if(!r)return t;const s={},o=i(t);for(let e=0;e<o.length;e++){const r=o[e];n.indexOf(r)>=0||(s[r]=t[r])}return s}function E(t,e,n,r,i,a,...s){return s.length?I.call(null,!0,!1,t,e,n,r,i,a,...s):I(!0,!1,t,e,n,r,i,a)}function I(t,e,a,...l){let u=a;null==u&&r(n);let h=!1;for(let n=0;n<l.length;n++){const r=l[n];if(null==r)continue;const a=i(r);if(a.length)for(let n=0;n<=a.length;n++){const i=a[n];if(t&&void 0!==u[i])continue;let l=r[i];e&&o(u[i])&&o(l)&&(l=I(t,e,u[i],l)),void 0!==l&&l!==u[i]&&(h||(h=!0,u=s(u)),u[i]=l)}}return u}var A={clone:s,addLast:l,addFirst:u,removeLast:h,removeFirst:c,insert:d,removeAt:f,replaceAt:p,getIn:m,set:g,setIn:b,update:v,updateIn:w,merge:_,mergeDeep:k,mergeIn:x,omit:S,addDefaults:E};e.default=A},9231:(t,e,n)=>{var r;!function(i){var a=/^\s+/,s=/\s+$/,o=0,l=i.round,u=i.min,h=i.max,c=i.random;function d(t,e){if(e=e||{},(t=t||"")instanceof d)return t;if(!(this instanceof d))return new d(t,e);var n=function(t){var e,n,r,o={r:0,g:0,b:0},l=1,c=null,d=null,f=null,p=!1,m=!1;return"string"==typeof t&&(t=function(t){t=t.replace(a,"").replace(s,"").toLowerCase();var e,n=!1;if(N[t])t=N[t],n=!0;else if("transparent"==t)return{r:0,g:0,b:0,a:0,format:"name"};return(e=W.rgb.exec(t))?{r:e[1],g:e[2],b:e[3]}:(e=W.rgba.exec(t))?{r:e[1],g:e[2],b:e[3],a:e[4]}:(e=W.hsl.exec(t))?{h:e[1],s:e[2],l:e[3]}:(e=W.hsla.exec(t))?{h:e[1],s:e[2],l:e[3],a:e[4]}:(e=W.hsv.exec(t))?{h:e[1],s:e[2],v:e[3]}:(e=W.hsva.exec(t))?{h:e[1],s:e[2],v:e[3],a:e[4]}:(e=W.hex8.exec(t))?{r:z(e[1]),g:z(e[2]),b:z(e[3]),a:L(e[4]),format:n?"name":"hex8"}:(e=W.hex6.exec(t))?{r:z(e[1]),g:z(e[2]),b:z(e[3]),format:n?"name":"hex"}:(e=W.hex4.exec(t))?{r:z(e[1]+""+e[1]),g:z(e[2]+""+e[2]),b:z(e[3]+""+e[3]),a:L(e[4]+""+e[4]),format:n?"name":"hex8"}:!!(e=W.hex3.exec(t))&&{r:z(e[1]+""+e[1]),g:z(e[2]+""+e[2]),b:z(e[3]+""+e[3]),format:n?"name":"hex"}}(t)),"object"==typeof t&&(G(t.r)&&G(t.g)&&G(t.b)?(e=t.r,n=t.g,r=t.b,o={r:255*O(e,255),g:255*O(n,255),b:255*O(r,255)},p=!0,m="%"===String(t.r).substr(-1)?"prgb":"rgb"):G(t.h)&&G(t.s)&&G(t.v)?(c=F(t.s),d=F(t.v),o=function(t,e,n){t=6*O(t,360),e=O(e,100),n=O(n,100);var r=i.floor(t),a=t-r,s=n*(1-e),o=n*(1-a*e),l=n*(1-(1-a)*e),u=r%6;return{r:255*[n,o,s,s,l,n][u],g:255*[l,n,n,o,s,s][u],b:255*[s,s,l,n,n,o][u]}}(t.h,c,d),p=!0,m="hsv"):G(t.h)&&G(t.s)&&G(t.l)&&(c=F(t.s),f=F(t.l),o=function(t,e,n){var r,i,a;function s(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+(e-t)*(2/3-n)*6:t}if(t=O(t,360),e=O(e,100),n=O(n,100),0===e)r=i=a=n;else{var o=n<.5?n*(1+e):n+e-n*e,l=2*n-o;r=s(l,o,t+1/3),i=s(l,o,t),a=s(l,o,t-1/3)}return{r:255*r,g:255*i,b:255*a}}(t.h,c,f),p=!0,m="hsl"),t.hasOwnProperty("a")&&(l=t.a)),l=R(l),{ok:p,format:t.format||m,r:u(255,h(o.r,0)),g:u(255,h(o.g,0)),b:u(255,h(o.b,0)),a:l}}(t);this._originalInput=t,this._r=n.r,this._g=n.g,this._b=n.b,this._a=n.a,this._roundA=l(100*this._a)/100,this._format=e.format||n.format,this._gradientType=e.gradientType,this._r<1&&(this._r=l(this._r)),this._g<1&&(this._g=l(this._g)),this._b<1&&(this._b=l(this._b)),this._ok=n.ok,this._tc_id=o++}function f(t,e,n){t=O(t,255),e=O(e,255),n=O(n,255);var r,i,a=h(t,e,n),s=u(t,e,n),o=(a+s)/2;if(a==s)r=i=0;else{var l=a-s;switch(i=o>.5?l/(2-a-s):l/(a+s),a){case t:r=(e-n)/l+(e<n?6:0);break;case e:r=(n-t)/l+2;break;case n:r=(t-e)/l+4}r/=6}return{h:r,s:i,l:o}}function p(t,e,n){t=O(t,255),e=O(e,255),n=O(n,255);var r,i,a=h(t,e,n),s=u(t,e,n),o=a,l=a-s;if(i=0===a?0:l/a,a==s)r=0;else{switch(a){case t:r=(e-n)/l+(e<n?6:0);break;case e:r=(n-t)/l+2;break;case n:r=(t-e)/l+4}r/=6}return{h:r,s:i,v:o}}function m(t,e,n,r){var i=[B(l(t).toString(16)),B(l(e).toString(16)),B(l(n).toString(16))];return r&&i[0].charAt(0)==i[0].charAt(1)&&i[1].charAt(0)==i[1].charAt(1)&&i[2].charAt(0)==i[2].charAt(1)?i[0].charAt(0)+i[1].charAt(0)+i[2].charAt(0):i.join("")}function g(t,e,n,r){return[B(P(r)),B(l(t).toString(16)),B(l(e).toString(16)),B(l(n).toString(16))].join("")}function b(t,e){e=0===e?0:e||10;var n=d(t).toHsl();return n.s-=e/100,n.s=D(n.s),d(n)}function y(t,e){e=0===e?0:e||10;var n=d(t).toHsl();return n.s+=e/100,n.s=D(n.s),d(n)}function v(t){return d(t).desaturate(100)}function w(t,e){e=0===e?0:e||10;var n=d(t).toHsl();return n.l+=e/100,n.l=D(n.l),d(n)}function _(t,e){e=0===e?0:e||10;var n=d(t).toRgb();return n.r=h(0,u(255,n.r-l(-e/100*255))),n.g=h(0,u(255,n.g-l(-e/100*255))),n.b=h(0,u(255,n.b-l(-e/100*255))),d(n)}function k(t,e){e=0===e?0:e||10;var n=d(t).toHsl();return n.l-=e/100,n.l=D(n.l),d(n)}function x(t,e){var n=d(t).toHsl(),r=(n.h+e)%360;return n.h=r<0?360+r:r,d(n)}function S(t){var e=d(t).toHsl();return e.h=(e.h+180)%360,d(e)}function E(t){var e=d(t).toHsl(),n=e.h;return[d(t),d({h:(n+120)%360,s:e.s,l:e.l}),d({h:(n+240)%360,s:e.s,l:e.l})]}function I(t){var e=d(t).toHsl(),n=e.h;return[d(t),d({h:(n+90)%360,s:e.s,l:e.l}),d({h:(n+180)%360,s:e.s,l:e.l}),d({h:(n+270)%360,s:e.s,l:e.l})]}function A(t){var e=d(t).toHsl(),n=e.h;return[d(t),d({h:(n+72)%360,s:e.s,l:e.l}),d({h:(n+216)%360,s:e.s,l:e.l})]}function M(t,e,n){e=e||6,n=n||30;var r=d(t).toHsl(),i=360/n,a=[d(t)];for(r.h=(r.h-(i*e>>1)+720)%360;--e;)r.h=(r.h+i)%360,a.push(d(r));return a}function T(t,e){e=e||6;for(var n=d(t).toHsv(),r=n.h,i=n.s,a=n.v,s=[],o=1/e;e--;)s.push(d({h:r,s:i,v:a})),a=(a+o)%1;return s}d.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var t=this.toRgb();return(299*t.r+587*t.g+114*t.b)/1e3},getLuminance:function(){var t,e,n,r=this.toRgb();return t=r.r/255,e=r.g/255,n=r.b/255,.2126*(t<=.03928?t/12.92:i.pow((t+.055)/1.055,2.4))+.7152*(e<=.03928?e/12.92:i.pow((e+.055)/1.055,2.4))+.0722*(n<=.03928?n/12.92:i.pow((n+.055)/1.055,2.4))},setAlpha:function(t){return this._a=R(t),this._roundA=l(100*this._a)/100,this},toHsv:function(){var t=p(this._r,this._g,this._b);return{h:360*t.h,s:t.s,v:t.v,a:this._a}},toHsvString:function(){var t=p(this._r,this._g,this._b),e=l(360*t.h),n=l(100*t.s),r=l(100*t.v);return 1==this._a?"hsv("+e+", "+n+"%, "+r+"%)":"hsva("+e+", "+n+"%, "+r+"%, "+this._roundA+")"},toHsl:function(){var t=f(this._r,this._g,this._b);return{h:360*t.h,s:t.s,l:t.l,a:this._a}},toHslString:function(){var t=f(this._r,this._g,this._b),e=l(360*t.h),n=l(100*t.s),r=l(100*t.l);return 1==this._a?"hsl("+e+", "+n+"%, "+r+"%)":"hsla("+e+", "+n+"%, "+r+"%, "+this._roundA+")"},toHex:function(t){return m(this._r,this._g,this._b,t)},toHexString:function(t){return"#"+this.toHex(t)},toHex8:function(t){return function(t,e,n,r,i){var a=[B(l(t).toString(16)),B(l(e).toString(16)),B(l(n).toString(16)),B(P(r))];return i&&a[0].charAt(0)==a[0].charAt(1)&&a[1].charAt(0)==a[1].charAt(1)&&a[2].charAt(0)==a[2].charAt(1)&&a[3].charAt(0)==a[3].charAt(1)?a[0].charAt(0)+a[1].charAt(0)+a[2].charAt(0)+a[3].charAt(0):a.join("")}(this._r,this._g,this._b,this._a,t)},toHex8String:function(t){return"#"+this.toHex8(t)},toRgb:function(){return{r:l(this._r),g:l(this._g),b:l(this._b),a:this._a}},toRgbString:function(){return 1==this._a?"rgb("+l(this._r)+", "+l(this._g)+", "+l(this._b)+")":"rgba("+l(this._r)+", "+l(this._g)+", "+l(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:l(100*O(this._r,255))+"%",g:l(100*O(this._g,255))+"%",b:l(100*O(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return 1==this._a?"rgb("+l(100*O(this._r,255))+"%, "+l(100*O(this._g,255))+"%, "+l(100*O(this._b,255))+"%)":"rgba("+l(100*O(this._r,255))+"%, "+l(100*O(this._g,255))+"%, "+l(100*O(this._b,255))+"%, "+this._roundA+")"},toName:function(){return 0===this._a?"transparent":!(this._a<1)&&(C[m(this._r,this._g,this._b,!0)]||!1)},toFilter:function(t){var e="#"+g(this._r,this._g,this._b,this._a),n=e,r=this._gradientType?"GradientType = 1, ":"";if(t){var i=d(t);n="#"+g(i._r,i._g,i._b,i._a)}return"progid:DXImageTransform.Microsoft.gradient("+r+"startColorstr="+e+",endColorstr="+n+")"},toString:function(t){var e=!!t;t=t||this._format;var n=!1,r=this._a<1&&this._a>=0;return e||!r||"hex"!==t&&"hex6"!==t&&"hex3"!==t&&"hex4"!==t&&"hex8"!==t&&"name"!==t?("rgb"===t&&(n=this.toRgbString()),"prgb"===t&&(n=this.toPercentageRgbString()),"hex"!==t&&"hex6"!==t||(n=this.toHexString()),"hex3"===t&&(n=this.toHexString(!0)),"hex4"===t&&(n=this.toHex8String(!0)),"hex8"===t&&(n=this.toHex8String()),"name"===t&&(n=this.toName()),"hsl"===t&&(n=this.toHslString()),"hsv"===t&&(n=this.toHsvString()),n||this.toHexString()):"name"===t&&0===this._a?this.toName():this.toRgbString()},clone:function(){return d(this.toString())},_applyModification:function(t,e){var n=t.apply(null,[this].concat([].slice.call(e)));return this._r=n._r,this._g=n._g,this._b=n._b,this.setAlpha(n._a),this},lighten:function(){return this._applyModification(w,arguments)},brighten:function(){return this._applyModification(_,arguments)},darken:function(){return this._applyModification(k,arguments)},desaturate:function(){return this._applyModification(b,arguments)},saturate:function(){return this._applyModification(y,arguments)},greyscale:function(){return this._applyModification(v,arguments)},spin:function(){return this._applyModification(x,arguments)},_applyCombination:function(t,e){return t.apply(null,[this].concat([].slice.call(e)))},analogous:function(){return this._applyCombination(M,arguments)},complement:function(){return this._applyCombination(S,arguments)},monochromatic:function(){return this._applyCombination(T,arguments)},splitcomplement:function(){return this._applyCombination(A,arguments)},triad:function(){return this._applyCombination(E,arguments)},tetrad:function(){return this._applyCombination(I,arguments)}},d.fromRatio=function(t,e){if("object"==typeof t){var n={};for(var r in t)t.hasOwnProperty(r)&&(n[r]="a"===r?t[r]:F(t[r]));t=n}return d(t,e)},d.equals=function(t,e){return!(!t||!e)&&d(t).toRgbString()==d(e).toRgbString()},d.random=function(){return d.fromRatio({r:c(),g:c(),b:c()})},d.mix=function(t,e,n){n=0===n?0:n||50;var r=d(t).toRgb(),i=d(e).toRgb(),a=n/100;return d({r:(i.r-r.r)*a+r.r,g:(i.g-r.g)*a+r.g,b:(i.b-r.b)*a+r.b,a:(i.a-r.a)*a+r.a})},d.readability=function(t,e){var n=d(t),r=d(e);return(i.max(n.getLuminance(),r.getLuminance())+.05)/(i.min(n.getLuminance(),r.getLuminance())+.05)},d.isReadable=function(t,e,n){var r,i,a,s,o,l=d.readability(t,e);switch(i=!1,(a=n,"AA"!==(s=((a=a||{level:"AA",size:"small"}).level||"AA").toUpperCase())&&"AAA"!==s&&(s="AA"),"small"!==(o=(a.size||"small").toLowerCase())&&"large"!==o&&(o="small"),r={level:s,size:o}).level+r.size){case"AAsmall":case"AAAlarge":i=l>=4.5;break;case"AAlarge":i=l>=3;break;case"AAAsmall":i=l>=7}return i},d.mostReadable=function(t,e,n){var r,i,a,s,o=null,l=0;i=(n=n||{}).includeFallbackColors,a=n.level,s=n.size;for(var u=0;u<e.length;u++)(r=d.readability(t,e[u]))>l&&(l=r,o=d(e[u]));return d.isReadable(t,o,{level:a,size:s})||!i?o:(n.includeFallbackColors=!1,d.mostReadable(t,["#fff","#000"],n))};var N=d.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},C=d.hexNames=function(t){var e={};for(var n in t)t.hasOwnProperty(n)&&(e[t[n]]=n);return e}(N);function R(t){return t=parseFloat(t),(isNaN(t)||t<0||t>1)&&(t=1),t}function O(t,e){(function(t){return"string"==typeof t&&-1!=t.indexOf(".")&&1===parseFloat(t)})(t)&&(t="100%");var n=function(t){return"string"==typeof t&&-1!=t.indexOf("%")}(t);return t=u(e,h(0,parseFloat(t))),n&&(t=parseInt(t*e,10)/100),i.abs(t-e)<1e-6?1:t%e/parseFloat(e)}function D(t){return u(1,h(0,t))}function z(t){return parseInt(t,16)}function B(t){return 1==t.length?"0"+t:""+t}function F(t){return t<=1&&(t=100*t+"%"),t}function P(t){return i.round(255*parseFloat(t)).toString(16)}function L(t){return z(t)/255}var $,U,j,W=(U="[\\s|\\(]+("+($="(?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?)")+")[,|\\s]+("+$+")[,|\\s]+("+$+")\\s*\\)?",j="[\\s|\\(]+("+$+")[,|\\s]+("+$+")[,|\\s]+("+$+")[,|\\s]+("+$+")\\s*\\)?",{CSS_UNIT:new RegExp($),rgb:new RegExp("rgb"+U),rgba:new RegExp("rgba"+j),hsl:new RegExp("hsl"+U),hsla:new RegExp("hsla"+j),hsv:new RegExp("hsv"+U),hsva:new RegExp("hsva"+j),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/});function G(t){return!!W.CSS_UNIT.exec(t)}t.exports?t.exports=d:void 0===(r=function(){return d}.call(e,n,e,t))||(t.exports=r)}(Math)},2274:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.extractCategoriesFromCoco=e.makeDatasetFromCoco=void 0;const r=n(3436);e.makeDatasetFromCoco=function(t){return function(t){if(!Array.isArray(t.images))throw new TypeError("images should be array");if(!Array.isArray(t.annotations))throw new TypeError("annotations should be array");t.images.forEach((t=>{if("number"!=typeof t.id)throw new TypeError("invalid id field found in image data");if("number"!=typeof t.width)throw new TypeError("invalid width field found in image data");if("number"!=typeof t.height)throw new TypeError("invalid height field found in image data");if("string"!=typeof t.url&&"string"!=typeof t.coco_url&&"string"!=typeof t.flickr_url)throw new TypeError("invalid url/flickr_url/coco_url field found in image data")}))}(t),new r.ArrayDatasetImpl(function(t){const e={};for(const n of t.annotations)e[n.image_id]||(e[n.image_id]=[]),e[n.image_id].push(n);return t.images.map((t=>({data:t,label:e[t.id]})))}(t))},e.extractCategoriesFromCoco=function(t){return t.categories}},6942:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.makeDatasetFromCsv=void 0;const r=n(3436);e.makeDatasetFromCsv=(t,e)=>{const n=(i=e,t.map((t=>{const e={},n=Object.assign({},t);return null==i||i.forEach((t=>{e[t]=n[t],delete n[t]})),{data:n,label:e}})));var i;return new r.ArrayDatasetImpl(n)}},3482:function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),i=this&&this.__exportStar||function(t,e){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(e,n)||r(e,t,n)};Object.defineProperty(e,"__esModule",{value:!0}),i(n(2274),e),i(n(4125),e),i(n(6942),e)},4125:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.extractCategoriesFromPascalVoc=e.makeDatasetFromPascalVoc=void 0;const r=n(3436);function i(t){return Array.isArray(t)}e.makeDatasetFromPascalVoc=function(t){const e=t.map((t=>({data:t,label:i(t.annotation.object)?t.annotation.object:[t.annotation.object]})));return new r.ArrayDatasetImpl(e)},e.extractCategoriesFromPascalVoc=function(t){const e=new Set;return t.forEach((t=>{i(t.annotation.object)?t.annotation.object.forEach((t=>{e.add(t.name)})):e.add(t.annotation.object.name)})),Array.from(e)}},4149:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.makeImageClassificationDatasetFromList=void 0;const r=n(3223);e.makeImageClassificationDatasetFromList=function(t){const e=t.map((t=>({data:{uri:t.uri,buffer:t.buffer},label:t.category})));return new r.ArrayDatasetImpl(e)}},3223:function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),i=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),a=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&r(e,t,n);return i(e,t),e},s=this&&this.__exportStar||function(t,e){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(e,n)||r(e,t,n)};Object.defineProperty(e,"__esModule",{value:!0}),e.Types=void 0,e.Types=a(n(4771)),s(n(3436),e),s(n(3482),e),s(n(7139),e),s(n(4149),e),s(n(1775),e)},7139:function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,a){function s(t){try{l(r.next(t))}catch(t){a(t)}}function o(t){try{l(r.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,o)}l((r=r.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.makeObjectDetectionDatasetFromPascalVoc=e.makeObjectDetectionDatasetFromCoco=void 0;const i=n(2274),a=n(4125),s=n(3223);e.makeObjectDetectionDatasetFromCoco=function(t){const e=(0,i.makeDatasetFromCoco)(t),n=(0,i.extractCategoriesFromCoco)(t),a={};return n.forEach((t=>{a[t.id]=t})),(0,s.makeTransform)(e,(t=>r(this,void 0,void 0,(function*(){const e=t.label.map((t=>{var e;return{name:null===(e=a[t.category_id])||void 0===e?void 0:e.name,bbox:t.bbox}}));return{data:{uri:t.data.url||t.data.coco_url||t.data.flickr_url},label:e}}))))},e.makeObjectDetectionDatasetFromPascalVoc=function(t){const e=(0,a.makeDatasetFromPascalVoc)(t);return(0,s.makeTransform)(e,(t=>r(this,void 0,void 0,(function*(){const e=t.label.map((t=>({name:t.name,bbox:[t.bndbox.xmin,t.bndbox.ymin,t.bndbox.xmax-t.bndbox.xmin,t.bndbox.ymax-t.bndbox.ymin]})));return{data:{uri:t.data.annotation.path},label:e}}))))}},1775:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.makeTextClassificationDatasetFromList=void 0;const r=n(3223);e.makeTextClassificationDatasetFromList=function(t){const e=t.map((t=>({data:t.text,label:t.category})));return new r.ArrayDatasetImpl(e)}},5448:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})},4056:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})},745:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})},4771:function(t,e,n){"use strict";var r,i,a=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),s=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),o=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&a(e,t,n);return s(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.Csv=e.PascalVoc=e.Coco=e.TextClassification=e.ImageClassification=e.ObjectDetection=e.DatasetType=e.TableColumnType=void 0,(i=e.TableColumnType||(e.TableColumnType={}))[i.Number=0]="Number",i[i.String=1]="String",i[i.Bool=2]="Bool",i[i.Map=3]="Map",i[i.Datetime=4]="Datetime",i[i.Unknown=5]="Unknown",(r=e.DatasetType||(e.DatasetType={}))[r.Table=0]="Table",r[r.Image=1]="Image",r[r.Sound=2]="Sound",r[r.General=3]="General",r[r.Text=4]="Text",e.ObjectDetection=o(n(2047)),e.ImageClassification=o(n(745)),e.TextClassification=o(n(5230)),e.Coco=o(n(5448)),e.PascalVoc=o(n(4470)),e.Csv=o(n(4056))},2047:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})},4470:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})},5230:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0})},3436:function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,a){function s(t){try{l(r.next(t))}catch(t){a(t)}}function o(t){try{l(r.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,o)}l((r=r.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.makeTransform=e.ArrayDatasetImpl=void 0;const i=n(8540);e.ArrayDatasetImpl=class{constructor(t){this.data=t,this.cursor=0,this.dataIndexes=(0,i.range)(0,t.length)}shuffle(){0===this.data.length?this.dataIndexes=[]:(0,i.shuffle)(this.dataIndexes)}next(){return r(this,void 0,void 0,(function*(){return this.data[this.dataIndexes[this.cursor++]]}))}nextBatch(t){return r(this,void 0,void 0,(function*(){const e=[];if(t<=0||void 0===t){let t=yield this.next();for(;t;)e.push(t),t=yield this.next();return e}for(;t--;){const t=yield this.next();if(!t)break;e.push(t)}return e}))}seek(t){return r(this,void 0,void 0,(function*(){t<0?this.cursor=0:t>=this.data.length?this.cursor=this.data.length:this.cursor=t}))}},e.makeTransform=function(t,e){const n={seek:e=>t.seek(e),shuffle:e=>t.shuffle(e),next:()=>r(this,void 0,void 0,(function*(){const n=yield t.next();return n?e(n):void 0})),nextBatch:t=>r(this,void 0,void 0,(function*(){const e=[];for(;t--;){const t=yield n.next();if(!t)break;e.push(t)}return e}))};return n}},8540:function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),i=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),a=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&r(e,t,n);return i(e,t),e},s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.range=e.seed=e.shuffle=e.split=e.npy=void 0;const o=n(1420),l=s(n(1058));e.seed=function(t){(0,l.default)(t,{global:!0})},e.shuffle=function(t){for(let e=t.length-1;e>0;e--){const n=Math.floor(Math.random()*(e+1));[t[e],t[n]]=[t[n],t[e]]}},e.split=function(t,e=.75){if(0===t.length)throw new Error("inputs should not have length of zero");const n=t[0].shape[0];for(let e=1;e<t.length;e++)if(n!==t[e].shape[0])throw new Error("inputs should have the same length");const r=Math.floor(n*e),i=n-r;return t.map((t=>(0,o.split)(t,[r,i]))).reduce(((t,e)=>(t.push(...e),t)),[])},e.range=function(t,e,n=1){if(n>0&&t>e||n<0&&t<e)return[];const r=Math.floor(Math.abs(e-t)/Math.abs(n)),i=new Array(r);let a=t,s=0;for(;n>0&&a<e||n<0&&a>e;)i[s]=a,s+=1,a+=n;return i},e.npy=a(n(1874))},1874:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.parse2Tensor=e.parse=void 0;const r=n(9953),i=n(1420),a={"<u1":{name:"uint8",size:8,arrayConstructor:Uint8Array},"|u1":{name:"uint8",size:8,arrayConstructor:Uint8Array},"<u2":{name:"uint16",size:16,arrayConstructor:Uint16Array},"|i1":{name:"int8",size:8,arrayConstructor:Int8Array},"<i2":{name:"int16",size:16,arrayConstructor:Int16Array},"<u4":{name:"uint32",size:32,arrayConstructor:Int32Array},"<i4":{name:"int32",size:32,arrayConstructor:Int32Array},"<u8":{name:"uint64",size:64,arrayConstructor:BigUint64Array},"<i8":{name:"int64",size:64,arrayConstructor:BigInt64Array},"<f4":{name:"float32",size:32,arrayConstructor:Float32Array},"<f8":{name:"float64",size:64,arrayConstructor:Float64Array}};function s(t){if("NUMPY"!=String.fromCharCode.apply(null,new Uint8Array(t.slice(1,6))))throw new Error("input is not a npy file");const e=new DataView(t.slice(8,10)).getUint8(0),n=10+e,i=new r.TextDecoder("utf-8").decode(new Uint8Array(t.slice(10,e+10))),s=JSON.parse(i.replace(/'/g,'"').replace("False","false").replace("(","[").replace(/,*\),*/g,"]")),o=s.shape,l=s.descr,u=a[l],h=new u.arrayConstructor(t,n);return{dtype:u.name,data:h,shape:o}}e.parse=s,e.parse2Tensor=function(t){const e=s(t);if(e.data instanceof Float64Array||e.data instanceof BigInt64Array||e.data instanceof BigUint64Array)throw new Error(`tfjs does not support ${e.dtype} at this time`);return(0,i.tensor)(e.data,e.shape)}},6319:function(t,e,n){"use strict";var r=n(9208).Buffer,i=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),a=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),s=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&i(e,t,n);return a(e,t),e},o=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,a){function s(t){try{l(r.next(t))}catch(t){a(t)}}function o(t){try{l(r.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,o)}l((r=r.apply(t,e||[])).next())}))},l=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.Image=void 0;const u=l(n(8159)),h=n(5670),c=s(n(1420));class d{constructor(t){this.img=t}static read(t){return o(this,void 0,void 0,(function*(){let e;return e="string"==typeof t?yield u.default.read(t):yield u.default.read(r.from(t)),new d(e)}))}toTensor(t=3){return c.browser.fromPixels({data:this.data,height:this.height,width:this.width},t)}static fromTensor(t){return o(this,void 0,void 0,(function*(){const e=yield c.browser.toPixels(t),n=r.from(e),[i,a]=t.shape.slice(0,2),s=yield new u.default({data:n,width:i,height:a});return new d(s)}))}resize(t,e){return this.img=this.img.resize(t,e),this}get width(){return this.img.bitmap.width}get height(){return this.img.bitmap.height}get channel(){return this.img.hasAlpha()?4:3}get data(){return this.img.bitmap.data}save(t){return new Promise(((e,n)=>{this.img.write(t,(t=>{t&&n(t),e(!0)}))}))}rotate(t){return this.img=this.img.rotate(t),this}flip(t,e){return this.img=this.img.flip(t,e),this}crop(t,e,n,r){return this.img=this.img.crop(t,e,n,r),this}static normalize(t,e,n){const r=e||c.round(c.mean(t)).arraySync(),i=n||(0,h.stdCalc)(t);return c.div(c.sub(t,r),i)}static unnormalize(t,e,n){return c.cast(c.add(c.mul(t,n),e),"int32")}}e.Image=d},5670:function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),i=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),a=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&r(e,t,n);return i(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.stdCalc=void 0;const s=a(n(1420));e.stdCalc=function(t){return s.round(s.sqrt(s.moments(t).variance)).arraySync()}},6852:function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),i=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),a=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&r(e,t,n);return i(e,t),e},s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.Encoder=e.Text=e.Stat=e.Preprocess=e.Linalg=e.Metrics=e.Model=e.Rand=e.Image=e.Generic=e.Dataset=void 0;const o=s(n(3431)),l=s(n(4121)),u=s(n(1730)),h=n(1073);e.Dataset=a(n(3223)),e.Generic=a(n(8540));var c=n(6319);Object.defineProperty(e,"Image",{enumerable:!0,get:function(){return c.Image}}),e.Rand=a(n(8898)),e.Model=a(n(6722)),e.Metrics=a(n(8045)),e.Linalg=a(n(4130)),e.Preprocess=a(n(126)),e.Stat=a(n(8368)),e.Text={Counter:o.default,CountVectorizer:l.default,Word2Vec:u.default},e.Encoder={LabelEncoder:h.LabelEncoder,OneHotEncoder:h.OneHotEncoder}},2996:function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,a){function s(t){try{l(r.next(t))}catch(t){a(t)}}function o(t){try{l(r.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,o)}l((r=r.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.eigenSolve=e.solveEigenVectors=e.eigenBackSolve=e.solveEigenValues=void 0;const i=n(1420),a=n(5813),s=n(1354);e.solveEigenValues=(t,e=1e-4,n=200)=>(0,i.tidy)((()=>{let r,a,[o,l]=i.linalg.qr(t),u=(0,s.fillNaN)(o,0),h=(0,s.fillNaN)(l,0),c=t;const d=t.shape[0];let f=i.linalg.bandPart(c,0,0),p=u;for(let t=0;t<n&&(r=c,c=(0,i.matMul)(h,u),[o,l]=i.linalg.qr(c),u=(0,s.fillNaN)(o,0),h=(0,s.fillNaN)(l,0),p=(0,i.matMul)(p,u),f=i.linalg.bandPart(c,0,0),a=i.linalg.bandPart(r,0,0),!((0,i.max)((0,i.abs)((0,i.sub)(a,f))).arraySync()<e));t++);c=(0,i.matMul)(h,u);const m=[];for(let t=0;t<d;t++)m.push((0,i.slice)(c,[t,t],[1,1]));return[(0,i.squeeze)((0,i.stack)(m)),p]})),e.eigenBackSolve=(t,e,n=1e-4,o=200)=>r(void 0,void 0,void 0,(function*(){const r=t.shape[0];let l,u=(0,i.tensor)(new Array(r).fill(1));const h=e,c=(0,i.sub)(t,(0,i.mul)((0,i.eye)(r),h));for(let t=0;t<o&&(l=u,u=yield(0,a.linSolveQR)(c,l),u=(0,s.tensorNormalize)(u),Number(yield(0,i.slice)(u,0,1).data())<0&&(u=(0,i.neg)(u)),!(0,s.tensorEqual)(u,l,n));t++);return u})),e.solveEigenVectors=(t,n,a=1e-4,s=200)=>r(void 0,void 0,void 0,(function*(){const r=n.shape[0],o=[];for(let l=0;l<r;l++){const r=Number(yield(0,i.slice)(n,l,1).data()),u=yield(0,e.eigenBackSolve)(t,r,a,s);o.push(u)}return(0,i.transpose)((0,i.stack)(o))})),e.eigenSolve=(t,n=1e-4,i=200,a=!1)=>r(void 0,void 0,void 0,(function*(){const[r,s]=(0,e.solveEigenValues)(t,n,i);return a?[r,s]:[r,yield(0,e.solveEigenVectors)(t,r,n,i)]}))},4130:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.checkShape=e.fillDiag=e.shapeEqual=e.tensorNormalize=e.tensorEqual=e.inverse=e.svd=e.eigenSolve=e.linSolveQR=void 0;var r=n(5813);Object.defineProperty(e,"linSolveQR",{enumerable:!0,get:function(){return r.linSolveQR}});var i=n(2996);Object.defineProperty(e,"eigenSolve",{enumerable:!0,get:function(){return i.eigenSolve}});var a=n(1359);Object.defineProperty(e,"svd",{enumerable:!0,get:function(){return a.svd}});var s=n(8503);Object.defineProperty(e,"inverse",{enumerable:!0,get:function(){return s.inverse}});var o=n(1354);Object.defineProperty(e,"tensorEqual",{enumerable:!0,get:function(){return o.tensorEqual}}),Object.defineProperty(e,"tensorNormalize",{enumerable:!0,get:function(){return o.tensorNormalize}}),Object.defineProperty(e,"shapeEqual",{enumerable:!0,get:function(){return o.shapeEqual}}),Object.defineProperty(e,"fillDiag",{enumerable:!0,get:function(){return o.fillDiag}}),Object.defineProperty(e,"checkShape",{enumerable:!0,get:function(){return o.checkShape}})},8503:function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,a){function s(t){try{l(r.next(t))}catch(t){a(t)}}function o(t){try{l(r.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,o)}l((r=r.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.inverse=void 0;const i=n(1420),a=n(2996),s=n(1354);e.inverse=(t,e=1e-4,n=200)=>r(void 0,void 0,void 0,(function*(){if(!(0,s.isSquareMatrix)(t))throw new TypeError("Not square matrix");const[r,o]=yield(0,a.eigenSolve)(t,e,n),l=(0,i.min)((0,i.abs)(r));if(!Boolean((yield(0,i.greater)(l,1e-4).data())[0]))throw new TypeError("Singular matrix error");const u=(0,i.divNoNan)(1,r);return(0,i.matMul)((0,i.matMul)(o,(0,i.diag)(u)),(0,i.transpose)(o))}))},5813:function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,a){function s(t){try{l(r.next(t))}catch(t){a(t)}}function o(t){try{l(r.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,o)}l((r=r.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.linSolveQR=e.linSolveFromQR=e.linSolveUpperTriangle=void 0;const i=n(1420);e.linSolveUpperTriangle=(t,e)=>r(void 0,void 0,void 0,(function*(){const n=e.shape[0],r=new Array(n).fill(0);let a;for(let s=n-1;s>=0;s--)if(a=0,s<n-1){for(let e=s+1;e<=n-1;e++)a+=r[e]*Number(yield(0,i.slice)(t,[s,e],[1,1]).data());const o=Number(yield(0,i.slice)(e,[s],[1]).data()),l=Number(yield(0,i.slice)(t,[s,s],[1,1]).data());r[s]=1*(o-a)/l}else{const n=Number(yield(0,i.slice)(e,[s],[1]).data()),a=Number(yield(0,i.slice)(t,[s,s],[1,1]).data());r[s]=1*n/a}return(0,i.tensor)(r)})),e.linSolveFromQR=(t,n,a)=>r(void 0,void 0,void 0,(function*(){const r=(0,i.squeeze)((0,i.matMul)((0,i.transpose)(t),(0,i.reshape)(a,[-1,1])));return yield(0,e.linSolveUpperTriangle)(n,r)})),e.linSolveQR=(t,n)=>r(void 0,void 0,void 0,(function*(){const[r,a]=i.linalg.qr(t);return yield(0,e.linSolveFromQR)(r,a,n)}))},1359:function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,a){function s(t){try{l(r.next(t))}catch(t){a(t)}}function o(t){try{l(r.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,o)}l((r=r.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.svd=void 0;const i=n(2996),a=n(1420);e.svd=(t,e=1e-4,n=200)=>r(void 0,void 0,void 0,(function*(){const r=(0,a.matMul)(t,(0,a.transpose)(t)),s=(0,a.matMul)((0,a.transpose)(t),t),[o,l]=t.shape,[u,h]=yield(0,i.eigenSolve)(r,e,n),[c,d]=yield(0,i.eigenSolve)(s,e,n);return[h,o<l?(0,a.sqrt)(u):(0,a.sqrt)(c),d]}))},1354:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.fillNaN=e.fillDiag=e.tensorEqual=e.shapeEqual=e.isSquareMatrix=e.checkShape=e.checkDimension=e.tensorNormalize=void 0;const r=n(1420),i=n(813);e.tensorNormalize=t=>(0,r.div)(t,(0,r.norm)(t)),e.checkDimension=(t,e)=>t.shape.length===e,e.checkShape=(t,e)=>{const n=t.shape;if(n.length!=e.length)return!1;for(let t=0;t<n.length;t++)if(-1!==e[t]&&e[t]!==n[t])return!1;return!0},e.isSquareMatrix=t=>(0,e.checkDimension)(t,2)&&t.shape[0]===t.shape[1],e.shapeEqual=(t,e)=>{const n=t.shape,r=e.shape;if(n.length!=r.length)return!1;for(let t=0;t<n.length;t++)if(n[t]!==r[t])return!1;return!0},e.tensorEqual=(t,n,i=0)=>(0,r.tidy)((()=>{if(!(0,e.shapeEqual)(t,n))throw new TypeError("tensor1 and tensor2 not of same shape");return Boolean((0,r.lessEqual)((0,r.max)((0,r.abs)((0,r.sub)(t,n))),i).dataSync()[0])})),e.fillDiag=(t,e,n)=>{const i=e>n?n:e,a=t instanceof r.Tensor?t.dataSync():t,s=a.length,o=new Array(e).fill(0).map((()=>new Array(n).fill(0)));for(let t=0;t<i;t++)t<s&&(o[t][t]=Number((0,r.slice)(a,t,1).dataSync()));return(0,r.tensor)(o)},e.fillNaN=(t,e=0)=>(0,r.tidy)((()=>{const n=(0,i.checkArray)(t,"float32",2),a=(0,r.isNaN)(n);return(0,r.where)(a,e,n)}))},2988:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.accuracyScore=void 0;const r=n(1420),i=n(813);e.accuracyScore=(t,e)=>{const n=(0,i.checkArray)(t,"any",1),a=(0,i.checkArray)(e,"any",1),s=n.shape[0];if(s!=a.shape[0])throw new Error("Shape of yTrue should match shape of yPred");return(0,r.div)((0,r.sum)((0,r.equal)(e,t)),s).dataSync()[0]}},8045:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.accuracyScore=void 0;var r=n(2988);Object.defineProperty(e,"accuracyScore",{enumerable:!0,get:function(){return r.accuracyScore}})},2480:function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,a){function s(t){try{l(r.next(t))}catch(t){a(t)}}function o(t){try{l(r.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,o)}l((r=r.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.BaseEstimater=e.BaseClassifier=e.BaseClustering=e.BaseEstimator=void 0;const i=n(1420),a=n(813),s=n(126);class o{checkAndSetNFeatures(t,e){var n;if(2!==(null===(n=null==t?void 0:t.shape)||void 0===n?void 0:n.length))throw new TypeError("x should be 2D tensor");const r=t.shape[1];if(!e&&r!==this.nFeature)throw new TypeError(`X has ${r} features, but is expected to have ${this.nFeature} features as input.`);!e&&this.nFeature||(this.nFeature=t.shape[1])}clean(){for(const t in this){const e=this[t];e instanceof i.Tensor&&(0,i.dispose)(e)}}cleanAndSetParam(t,e){if(t in this){const e=this[t];e instanceof i.Tensor&&(0,i.dispose)(e)}this[t]=e}}e.BaseEstimator=o,e.BaseClustering=class extends o{constructor(){super(),this.estimatorType="clustering"}validateData(t,e){return(0,i.tidy)((()=>{const n=(0,a.checkArray)(t,"float32",2);return this.checkAndSetNFeatures(n,e),n}))}},e.BaseClassifier=class{constructor(){this.estimatorType="classifier"}score(t,e){const n=t.shape[0],r=e.shape[0];if(0==n||0==r)throw new Error("Inputs should not have length of zero");return(0,i.tensor)([0])}getLabelOneHot(t){return r(this,void 0,void 0,(function*(){return yield this.classOneHotEncoder.encode(t)}))}initClasses(t,e="none"){return r(this,void 0,void 0,(function*(){this.classOneHotEncoder=new s.OneHotEncoder({drop:e}),yield this.classOneHotEncoder.init(t)}))}classes(){var t;return null===(t=this.classOneHotEncoder)||void 0===t?void 0:t.categories}isBinaryClassification(){return 2===this.classes().shape[0]}getPredClass(t){return r(this,void 0,void 0,(function*(){return yield this.classOneHotEncoder.decode(t)}))}validateData(t,e,n=2,r=1){const i=(0,a.checkArray)(t,"float32",n),s=(0,a.checkArray)(e,"any",r);if(i.shape[0]!=s.shape[0])throw new RangeError("The size of training set and training labels must be the same.");return{x:i,y:s}}},e.BaseEstimater=class{validateData(t,e,n=2,r=1){const i=(0,a.checkArray)(t,"float32",n),s=(0,a.checkArray)(e,"float32",r);if(i.shape[0]!=s.shape[0])throw new RangeError("The size of the training set and the training labels must be the same.");return{x:i,y:s}}}},2991:function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,a){function s(t){try{l(r.next(t))}catch(t){a(t)}}function o(t){try{l(r.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,o)}l((r=r.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.KMeans=void 0;const i=n(2480),a=n(4130),s=n(1420),o=n(8540),l=n(813),u=1e3,h=1e-5,c="kmeans++";class d extends i.BaseClustering{constructor(t={nInit:10,nClusters:8,maxIterTimes:u,tol:h,init:c}){super(),this.nInit=t.nInit?t.nInit:10,this.nClusters=t.nClusters?t.nClusters:8,this.maxIterTimes=t.maxIterTimes?t.maxIterTimes:u,this.tol=t.tol?t.tol:h,this.firstTrainOnBatch=!0,this.init=t.init?t.init:c,this.verbose=!!t.verbose&&!!t.verbose}getInitCentroids(t){return(0,s.tidy)((()=>{if("kmeans++"===this.init)return this.kmeansPlusPlus(t,this.nClusters);if("random"===this.init){const e=Array.from(Array(t.shape[0]).keys());return(0,o.shuffle)(e),(0,s.gather)(t,e.slice(0,this.nClusters))}if(this.init instanceof s.Tensor||this.init instanceof Array){const e=(0,l.checkArray)(this.init,"float32",2);return this.validataCentroidsShape(t,e),e}return this.kmeansPlusPlus(t,this.nClusters)}))}initCentroids(t){return r(this,void 0,void 0,(function*(){if(this.init instanceof s.Tensor||this.init instanceof Array){const e=this.getInitCentroids(t);return{selectedCentroids:e,inertia:this.inertiaDense(t,e)}}let e,n=Number.MAX_SAFE_INTEGER;for(let r=0;r<this.nInit;r++){const r=this.getInitCentroids(t),{newCentroids:i,newClusIndex:a}=yield this.update(t,r),o=this.inertiaDense(t,i);o<n&&(n=o,(0,s.dispose)(e),e=(0,s.add)(i,1)),(0,s.dispose)([r,i,a])}return{selectedCentroids:e,inertia:n}}))}inertiaDense(t,e){return(0,s.tidy)((()=>{const n=this.getClusDist(t,e),r=(0,s.min)(n,1);return(0,s.sum)(r).dataSync()[0]}))}kmeansPlusPlus(t,e){return(0,s.tidy)((()=>{const n=[],r=t.shape[0],i=Math.floor(Math.random()*r);for(n.push((0,s.squeeze)((0,s.gather)(t,[i])));n.length<e;){const e=this.getClusDist(t,(0,s.stack)(n)),i=(0,s.min)(e,1),a=(0,s.sum)(i),o=Math.random()*a.dataSync()[0],l=(0,s.cumsum)(i).dataSync();let u=0;for(;u<r-1&&!(l[u]>o);u++);n.push((0,s.squeeze)((0,s.gather)(t,[u])))}return(0,s.stack)(n)}))}validataCentroidsShape(t,e){if(e.shape[0]!==this.nClusters)throw new TypeError(`The shape of the initial centers ${e.shape} does not match the number of clusters ${this.nClusters}.`);if(e.shape[1]!==t.shape[1])throw new TypeError(`The shape of the initial centers ${e.shape[1]} does not match the number of features of the data ${t.shape[1]}.`)}getClusDist(t,e){return(0,s.tidy)((()=>{const n=[],r=e.shape[0];for(let i=0;i<r;i++)n.push((0,s.sum)((0,s.square)((0,s.sub)(t,(0,s.gather)(e,i))),1));return(0,s.transpose)((0,s.stack)(n))}))}getClusIndex(t,e){return(0,s.tidy)((()=>{const n=this.getClusDist(t,e);return(0,s.argMin)(n,1)}))}update(t,e){return r(this,void 0,void 0,(function*(){const n=[],r=this.getClusIndex(t,e);for(let e=0;e<this.nClusters;e++){const i=(0,s.equal)(r,e),a=yield(0,s.booleanMaskAsync)(t,i);n.push((0,s.mean)(a,0)),(0,s.dispose)([i,a])}const i=(0,s.tidy)((()=>(0,s.stack)(n)));return n.forEach((t=>(0,s.dispose)(t))),{newCentroids:i,newClusIndex:r}}))}fit(t){return r(this,void 0,void 0,(function*(){const e=this.validateData(t,!0);let n;const{selectedCentroids:r,inertia:i}=yield this.initCentroids(e);this.centroids=r,this.verbose&&console.log(`Initialization complete with inertia ${i}`);for(let r=0;r<this.maxIterTimes;r++){const{newCentroids:i,newClusIndex:o}=yield this.update(e,this.centroids);if(this.verbose){const t=this.inertiaDense(e,this.centroids);console.log(`Iteration ${r}, inertia ${t}.`)}if(n&&(0,a.tensorEqual)(o,n))return this.verbose&&console.log(`Converged at iteration ${r}: strict converge.`),(0,s.dispose)([n,o,i]),void(t instanceof s.Tensor||(0,s.dispose)(e));if((0,a.tensorEqual)(i,this.centroids,this.tol))return this.verbose&&console.log(`Converged at iteration ${r}: center shift within tolerance ${this.tol}.`),n&&(0,s.dispose)(n),(0,s.dispose)([o,i]),void(t instanceof s.Tensor||(0,s.dispose)(e));(0,s.dispose)([this.centroids,n]),this.centroids=i,n=o}t instanceof s.Tensor||(0,s.dispose)(e)}))}trainOnBatch(t){return r(this,void 0,void 0,(function*(){const e=this.validateData(t,this.firstTrainOnBatch);this.firstTrainOnBatch&&(this.centroids=(yield this.initCentroids(e)).selectedCentroids,this.firstTrainOnBatch=!1,this.clusWeightedSum=(0,s.zeros)([this.nClusters]));const n=[],r=this.getClusIndex(e,this.centroids),i=[];for(let t=0;t<this.nClusters;t++){const a=(0,s.equal)(r,t);i.push((0,s.tidy)((()=>(0,s.sum)(a).dataSync()[0])));const o=yield(0,s.booleanMaskAsync)(e,a);n.push((0,s.mean)(o,0)),(0,s.dispose)([o,a])}const a=(0,s.tidy)((()=>(0,s.stack)(n))),o=(0,s.tidy)((()=>(0,s.add)(this.clusWeightedSum,(0,s.tensor)(i)))),l=(0,s.tidy)((()=>(0,s.add)((0,s.mul)(this.centroids,(0,s.reshape)(this.clusWeightedSum,[-1,1])),(0,s.mul)(a,(0,s.reshape)(i,[-1,1]))))),u=(0,s.tidy)((()=>(0,s.divNoNan)(l,(0,s.reshape)(o,[-1,1]))));return(0,s.dispose)([this.clusWeightedSum,this.centroids]),this.centroids=(0,s.tidy)((()=>(0,s.add)(u,0))),this.clusWeightedSum=(0,s.tidy)((()=>(0,s.add)(o,0))),(0,s.dispose)([r,a,o,u,l]),n.map((t=>(0,s.dispose)(t))),this.inertiaDense(e,this.centroids)}))}predict(t){return r(this,void 0,void 0,(function*(){return(0,s.tidy)((()=>{const e=this.validateData(t,!1);return this.getClusIndex(e,this.centroids)}))}))}score(t){return r(this,void 0,void 0,(function*(){return(0,s.tidy)((()=>{const e=this.validateData(t,!1),n=this.inertiaDense(e,this.centroids);return(0,s.neg)(n).dataSync()[0]}))}))}fromJson(t){return r(this,void 0,void 0,(function*(){const e=JSON.parse(t);if("KMeans"!==e.name)throw new TypeError(`${e.name} is not KMeans`);if(!e.nClusters)throw new TypeError("nClusters is not specified");return this.nInit=e.nInit?e.nInit:10,this.nClusters=e.nClusters,this.maxIterTimes=e.maxIterTimes?e.maxIterTimes:u,this.tol=e.tol?e.tol:h,this.firstTrainOnBatch=!0,this.init=e.init?e.init:c,this.centroids&&(0,s.dispose)(this.centroids),this.centroids=e.centroids?(0,s.tensor)(e.centroids):null,this.nFeature=e.nFeature,this}))}toJson(){return r(this,void 0,void 0,(function*(){const t={name:"KMeans",nInit:this.nInit,nClusters:this.nClusters,maxIterTimes:this.maxIterTimes,tol:this.tol,firstTrainOnBatch:this.firstTrainOnBatch,init:this.init,centroids:yield this.centroids.array(),nFeature:this.nFeature};return JSON.stringify(t)}))}}e.KMeans=d},6722:function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),i=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),a=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&r(e,t,n);return i(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.KMeans=e.PCA=e.LinearRegression=e.LogisticRegression=e.NaiveBayes=void 0,e.NaiveBayes=a(n(1759));var s=n(8427);Object.defineProperty(e,"LogisticRegression",{enumerable:!0,get:function(){return s.LogisticRegression}}),Object.defineProperty(e,"LinearRegression",{enumerable:!0,get:function(){return s.LinearRegression}});var o=n(4883);Object.defineProperty(e,"PCA",{enumerable:!0,get:function(){return o.PCA}});var l=n(2991);Object.defineProperty(e,"KMeans",{enumerable:!0,get:function(){return l.KMeans}})},8427:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.LogisticRegressionPredictor=e.LinearRegression=e.LogisticRegression=void 0;var r=n(9881);Object.defineProperty(e,"LogisticRegression",{enumerable:!0,get:function(){return r.LogisticRegression}});var i=n(6395);Object.defineProperty(e,"LinearRegression",{enumerable:!0,get:function(){return i.LinearRegression}});var a=n(6716);Object.defineProperty(e,"LogisticRegressionPredictor",{enumerable:!0,get:function(){return a.LogisticRegressionPredictor}})},6395:function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,a){function s(t){try{l(r.next(t))}catch(t){a(t)}}function o(t){try{l(r.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,o)}l((r=r.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.LinearRegression=void 0;const i=n(1420),a=n(4402),s=n(2480),o=n(813),l=n(4705);class u extends s.BaseEstimater{constructor(t={}){super(),this.fitIntercept=!1!==t.fitIntercept,this.normalize=t.normalize,this.optimizerType=t.optimizerType?t.optimizerType:"adam",this.optimizerProps=t.optimizerProps?t.optimizerProps:{learningRate:.1},this.optimizer=(0,l.getOptimizer)(this.optimizerType,this.optimizerProps)}initLinearModel(t,e=!0,n=[]){const r=(0,a.sequential)();r.add(a.layers.dense({inputShape:[t],units:1,useBias:e})),r.compile({optimizer:this.optimizer,loss:i.losses.meanSquaredError,metrics:["mse"]}),(null==n?void 0:n.length)&&r.setWeights(n),this.model=r}trainOnBatch(t,e){return r(this,void 0,void 0,(function*(){const{x:n,y:r}=this.validateData(t,e),i=n.shape[1];if(this.model&&i!==this.featureSize)throw new TypeError("feature size does not match previous training set");return this.model||(this.initLinearModel(i,this.fitIntercept),this.featureSize=i),yield this.model.trainOnBatch(n,r),this}))}fit(t,e,n={batchSize:32,epochs:-1}){return r(this,void 0,void 0,(function*(){const{x:r,y:i}=this.validateData(t,e),a=r.shape[1],s=r.shape[0],o=s>n.batchSize?n.batchSize:s,l=n.epochs>0?n.epochs:null;return this.initLinearModel(a,this.fitIntercept),this.featureSize=a,yield this.model.fit(r,i,{batchSize:o,epochs:l,shuffle:!0}),this}))}predict(t){return r(this,void 0,void 0,(function*(){const e=(0,o.checkArray)(t,"float32"),n=this.model.predict(e);return n instanceof i.Tensor?(0,i.squeeze)(n):(0,i.squeeze)((0,i.stack)(n))}))}initModelFromWeights(t,e,n){const r=[];for(const t of n)r.push((0,i.tensor)(t));this.initLinearModel(t,e,r)}getCoef(){return{coefficients:(0,i.squeeze)(this.model.getWeights()[0]),intercept:this.fitIntercept?this.model.getWeights()[1]:(0,i.tensor)(0)}}getModelWeightsArray(){return Promise.all(this.model.getWeights().map((t=>t.array())))}fromJson(t){return r(this,void 0,void 0,(function*(){const e=JSON.parse(t);if("LinearRegression"!==e.name)throw new TypeError(`${e.name} is not Linear Regression`);const{fitIntercept:n,optimizerType:r,optimizerProps:i,modelWeights:a,featureSize:s}=e;return this.fitIntercept=!!n,this.featureSize=s,r&&i&&(this.optimizer=(0,l.getOptimizer)(r,i),this.optimizerType=r,this.optimizerProps=i),(null==a?void 0:a.length)&&this.initModelFromWeights(s,n,a),this}))}toJson(){return r(this,void 0,void 0,(function*(){const t={name:"LinearRegression",fitIntercept:this.fitIntercept,optimizerType:this.optimizerType,optimizerProps:this.optimizerProps,modelWeights:yield this.getModelWeightsArray(),featureSize:this.featureSize};return JSON.stringify(t)}))}}e.LinearRegression=u},6716:function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,a){function s(t){try{l(r.next(t))}catch(t){a(t)}}function o(t){try{l(r.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,o)}l((r=r.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.LogisticRegressionPredictor=void 0;const i=n(1420),a=n(1354),s=n(813),o=n(2480);n(7441);class l extends o.BaseClassifier{predict(t){return r(this,void 0,void 0,(function*(){const e=(0,s.checkArray)(t,"float32"),n=(0,i.add)((0,i.matMul)(e,(0,i.tensor)(this.modelWeights[0])),this.modelWeights[1]);return this.getPredClass(n)}))}predictProba(t){return r(this,void 0,void 0,(function*(){const e=(0,s.checkArray)(t,"float32");if(!(0,a.checkShape)(e,[-1,this.featureSize]))throw TypeError("Feature size does not match");const n=(0,i.add)((0,i.matMul)(e,(0,i.tensor)(this.modelWeights[0])),this.modelWeights[1]);return this.isBinaryClassification()?(0,i.sigmoid)(n):(0,i.softmax)(n)}))}fromJson(t){return r(this,void 0,void 0,(function*(){const e=JSON.parse(t);if("LogisticRegression"!==e.name)throw new RangeError(`${e.name} is not Logistic Regression`);const{classes:n,modelWeights:r,featureSize:i}=e;return this.featureSize=i,n&&this.initClasses(n,"binary-only"),(null==r?void 0:r.length)&&(this.modelWeights=r),this}))}}e.LogisticRegressionPredictor=l},9881:function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,a){function s(t){try{l(r.next(t))}catch(t){a(t)}}function o(t){try{l(r.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,o)}l((r=r.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.LogisticRegression=void 0;const i=n(1420),a=n(4402),s=n(813),o=n(2480),l=n(4705);class u extends o.BaseClassifier{constructor(t={penalty:"none",fitIntercept:!0,c:1,optimizerType:"adam",optimizerProps:{learningRate:.1}}){super(),this.fitIntercept=!1!==t.fitIntercept,this.penalty=t.penalty?t.penalty:"none",this.c=t.c?t.c:1,this.optimizerType=t.optimizerType?t.optimizerType:"adam",this.optimizerProps=t.optimizerProps?t.optimizerProps:{learningRate:.1},this.optimizer=(0,l.getOptimizer)(this.optimizerType,this.optimizerProps)}initModel(t,e,n=!0,r=[]){const s=(0,a.sequential)(),o=this.c,l=this.penalty;s.add(a.layers.dense({inputShape:[t],units:e,useBias:n,kernelInitializer:a.initializers.zeros(),biasInitializer:a.initializers.zeros(),kernelRegularizer:"l2"===l?a.regularizers.l2({l2:o}):"l1"===l?a.regularizers.l1({l1:o}):null})),s.compile({optimizer:this.optimizer,loss:this.isBinaryClassification()?i.losses.sigmoidCrossEntropy:i.losses.softmaxCrossEntropy}),r.length>0&&s.setWeights(r),this.model=s}trainOnBatch(t,e){return r(this,void 0,void 0,(function*(){const{x:n,y:r}=this.validateData(t,e),i=n.shape[1];if(this.model&&i!=this.featureSize)throw new Error("feature size does not match previous training set");if(!this.model){this.classes()&&this.classes().shape[0]||(yield this.initClasses(r,"binary-only"));const t=this.isBinaryClassification()?1:this.classes().shape[0];this.initModel(i,t,this.fitIntercept),this.featureSize=i,this.outputSize=t}return yield this.model.trainOnBatch(n,yield this.getLabelOneHot(r)),this}))}fit(t,e,n={tol:0,batchSize:32,epochs:-1}){return r(this,void 0,void 0,(function*(){const{x:r,y:i}=this.validateData(t,e);yield this.initClasses(i,"binary-only");const s=r.shape[1],o=r.shape[0],l=o>n.batchSize?n.batchSize:o,u=n.epochs>0?n.epochs:null,h=this.isBinaryClassification()?1:this.classes().shape[0];this.initModel(s,h,this.fitIntercept),this.featureSize=s,this.outputSize=h;const c=yield this.getLabelOneHot(i);return yield this.model.fit(r,c,{batchSize:l,epochs:u,shuffle:!0,callbacks:a.callbacks.earlyStopping({monitor:"loss",minDelta:n.tol})}),this}))}predict(t){return r(this,void 0,void 0,(function*(){const e=(0,s.checkArray)(t,"float32"),n=this.model.predict(e);return n instanceof i.Tensor?this.getPredClass(n):this.getPredClass((0,i.stack)(n))}))}predictProba(t){return r(this,void 0,void 0,(function*(){const e=(0,s.checkArray)(t,"float32"),n=this.model.predict(e);return n instanceof Array?this.isBinaryClassification()?(0,i.stack)(n):(0,i.softmax)((0,i.stack)(n)):this.isBinaryClassification()?(0,i.sigmoid)(n):(0,i.softmax)(n)}))}getCoef(){return{coefficients:(0,i.squeeze)(this.model.getWeights()[0]),intercept:this.fitIntercept?this.model.getWeights()[1]:(0,i.tensor)(0)}}getModelWeightsArray(){return Promise.all(this.model.getWeights().map((t=>t.array())))}initModelFromWeights(t,e,n,r){const a=r.map((t=>(0,i.tensor)(t)));this.initModel(t,e,n,a)}fromJson(t){return r(this,void 0,void 0,(function*(){const e=JSON.parse(t);if("LogisticRegression"!==e.name)throw new TypeError(`${e.name} is not Logistic Regression`);const{classes:n,fitIntercept:r,penalty:i,c:a,optimizerType:s,optimizerProps:o,modelWeights:u,featureSize:h,outputSize:c}=e;return n&&this.initClasses(n,"binary-only"),this.fitIntercept=r,i&&(this.penalty=i),a&&(this.c=a),s&&o&&(this.optimizerType=s,this.optimizerProps=o,this.optimizer=(0,l.getOptimizer)(s,o)),(null==u?void 0:u.length)&&this.initModelFromWeights(h,c,r,u),this}))}toJson(){var t;return r(this,void 0,void 0,(function*(){const e={name:"LogisticRegression",classes:yield null===(t=this.classes())||void 0===t?void 0:t.array(),fitIntercept:this.fitIntercept,penalty:this.penalty,c:this.c,optimizerType:this.optimizerType,optimizerProps:this.optimizerProps,modelWeights:yield this.getModelWeightsArray(),featureSize:this.featureSize,outputSize:this.outputSize};return JSON.stringify(e)}))}}e.LogisticRegression=u},1759:function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,a){function s(t){try{l(r.next(t))}catch(t){a(t)}}function o(t){try{l(r.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,o)}l((r=r.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.MultinomialNB=void 0;const i=n(2480),a=n(1420);class s extends i.BaseClassifier{constructor(t={alpha:1}){super(),this.alpha=t.alpha&&t.alpha>0?t.alpha:1}updateClassLogPrior(){if(this.classCount){const t=(0,a.cast)((0,a.sum)(this.classCount),"float32");this.priorProb=(0,a.sub)((0,a.log)(this.classCount),(0,a.log)(t))}}updateFeatureLogProb(){if(this.featureCount){const t=1,e=(0,a.add)(this.featureCount,this.alpha),n=(0,a.reshape)((0,a.sum)(e,t),[-1,1]);this.conditionProb=(0,a.sub)((0,a.log)(e),(0,a.log)(n))}}updateFeautrCount(t){t=(0,a.cast)(t,"float32"),this.featureCount?this.featureCount=(0,a.add)(this.featureCount,t):this.featureCount=t}updateClassCount(t){t=(0,a.cast)(t,"float32"),this.classCount?this.classCount=(0,a.add)(this.classCount,t):this.classCount=t}getLogLikelihood(t){const e=(0,a.matMul)(t,(0,a.transpose)(this.conditionProb));return(0,a.add)(e,this.priorProb)}firstCall(){return!(this.featureCount&&this.priorProb&&this.conditionProb&&this.classCount)}train(t,e){return r(this,void 0,void 0,(function*(){const{x:n,y:r}=this.validateData(t,e);let i;if(this.firstCall())yield this.initClasses(r),i=yield this.getLabelOneHot(r);else{if(n.shape[1]!=this.featureCount.shape[1])throw new Error("feature size does not match to previous training dataset");i=yield this.getLabelOneHot(r)}const s=this.classes().shape[0],o=(0,a.sum)(i,0);this.updateClassCount(o);const l=[];for(let t=0;t<s;t++){const e=1,r=0,s=(0,a.squeeze)((0,a.cast)((0,a.gather)(i,[t],e),"bool")),o=yield(0,a.booleanMaskAsync)(n,s),u=(0,a.sum)(o,r);l.push(u)}const u=(0,a.stack)(l);return this.updateFeautrCount(u),this.updateClassLogPrior(),this.updateFeatureLogProb(),this}))}predict(t){return r(this,void 0,void 0,(function*(){const e=this.getLogLikelihood(t);return yield this.classOneHotEncoder.decode(e)}))}predictProba(t){return r(this,void 0,void 0,(function*(){const e=this.getLogLikelihood(t),n=(0,a.exp)(e),r=(0,a.reshape)((0,a.sum)(n,1),[-1,1]);return(0,a.divNoNan)(n,r)}))}load(t){return r(this,void 0,void 0,(function*(){const e=JSON.parse(t);if("MultinomialNB"!==e.name)throw new TypeError(`${e.name} is not a Multinomial Naive Bayes`);this.priorProb=e.priorProb?(0,a.tensor)(e.priorProb):this.priorProb,e.classes&&(yield this.initClasses((0,a.tensor)(e.classes))),this.conditionProb=e.conditionProb?(0,a.tensor)(e.conditionProb):this.conditionProb,this.alpha=e.alpha?e.alpha:this.alpha,this.classCount=e.classCount?e.classCount:this.classCount,this.featureCount=e.featureCount?e.featureCount:this.featureCount}))}toJson(){var t,e,n,r,i;const a={name:"MultinomialNB",priorProb:null===(t=this.priorProb)||void 0===t?void 0:t.arraySync(),conditionProb:null===(e=this.conditionProb)||void 0===e?void 0:e.arraySync(),classes:null===(n=this.classes())||void 0===n?void 0:n.arraySync(),alpha:this.alpha,classCount:null===(r=this.classCount)||void 0===r?void 0:r.arraySync(),featureCount:null===(i=this.featureCount)||void 0===i?void 0:i.arraySync()};return JSON.stringify(a)}}e.MultinomialNB=s},4883:function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,a){function s(t){try{l(r.next(t))}catch(t){a(t)}}function o(t){try{l(r.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,o)}l((r=r.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.PCA=void 0;const i=n(1420),a=n(4130),s=n(4034),o=n(813),l=n(2480),u=n(8368),h="covariance";class c extends l.BaseEstimater{constructor(t={method:h}){super(),this.nComponents=t.nComponents,this.method=t.method?t.method:h}fit(t){return r(this,void 0,void 0,(function*(){const e=(0,o.checkArray)(t,"float32",2);this.nComponents||(this.nComponents=Math.min(...e.shape)-1),yield this.fitFull(e,this.nComponents,this.method),t instanceof i.Tensor||(0,i.dispose)(e)}))}getCorcovMatrix(t,e){return(0,i.tidy)((()=>"correlation"===e?(0,s.getCorrelationMatrix)(t):(0,s.getCovarianceMatrix)(t)))}fitFull(t,e,n="covariance"){return r(this,void 0,void 0,(function*(){const r=this.getCorcovMatrix(t,n),[s,o]=yield(0,a.eigenSolve)(r,1e-4,200,!0),l=s.shape[0];this.mean&&(0,i.dispose)(this.mean),this.variance&&(0,i.dispose)(this.variance),this.eigenValues&&(0,i.dispose)(this.eigenValues),this.eigenVectors&&(0,i.dispose)(this.eigenVectors),this.explainedVariance&&(0,i.dispose)(this.explainedVariance),this.explainedVarianceRatio&&(0,i.dispose)(this.explainedVarianceRatio),this.mean=(0,i.mean)(t,0),this.variance=(0,i.tidy)((()=>(0,u.getVariance)(t))),this.eigenValues=(0,i.slice)(s,0,e),this.eigenVectors=(0,i.slice)(o,[0,0],[l,e]),this.explainedVariance=this.eigenValues,this.explainedVarianceRatio=(0,i.tidy)((()=>(0,i.div)(this.eigenValues,(0,i.sum)(s)))),(0,i.dispose)([r,o,s])}))}transform(t){return r(this,void 0,void 0,(function*(){return(0,i.tidy)((()=>{const e=(0,o.checkArray)(t,"float32",2),n=(0,i.sub)(e,this.mean);return"covariance"==this.method?(0,i.matMul)(n,this.eigenVectors):(0,i.matMul)((0,i.divNoNan)(n,(0,i.sqrt)(this.variance)),this.eigenVectors)}))}))}}e.PCA=c},6472:function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,a){function s(t){try{l(r.next(t))}catch(t){a(t)}}function o(t){try{l(r.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,o)}l((r=r.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.OneHotEncoder=void 0;const i=n(1420),a=n(813),s=n(1354);e.OneHotEncoder=class{constructor(t={drop:"none"}){const{drop:e}=t;this.drop=e}init(t){return r(this,void 0,void 0,(function*(){const{values:e}=(0,i.unique)(t);"int32"===e.dtype||"float32"===e.dtype?this.categories=(0,i.topk)(e,e.shape[0],!1).values:"bool"===e.dtype?this.categories=(0,i.tensor)([!1,!0]):this.categories=e;const n=yield this.categories.data(),r={};for(let t=0;t<n.length;t++)r[n[t]]=t;this.cateMap=r}))}encode(t){return r(this,void 0,void 0,(function*(){if(!this.categories)throw TypeError("Please init encoder using init()");const e=(0,a.checkArray)(t,"any",1),n=yield e.dataSync(),r=this.categories.shape[0],s=n.map((t=>this.cateMap[t]));return"binary-only"===this.drop&&2===r?(0,i.tensor)(s):"first"===this.drop?(0,i.oneHot)((0,i.cast)((0,i.sub)((0,i.tensor)(s),1),"int32"),r-1):(0,i.oneHot)((0,i.cast)((0,i.tensor)(s),"int32"),r)}))}decode(t){return r(this,void 0,void 0,(function*(){if(!this.categories)throw TypeError("Please init encoder using init()");const e=this.categories.shape[0],n="first"===this.drop?e-1:"binary-only"===this.drop&&2===e?1:e;if(!(n>1?(0,s.checkShape)(t,[-1,n]):(0,s.checkShape)(t,[-1])||(0,s.checkShape)(t,[-1,1])))throw new TypeError("Input shape does not match");const r="binary-only"===this.drop&&2===e?yield(0,i.greaterEqual)((0,i.squeeze)(t),.5).data():yield(0,i.argMax)(t,1).data(),a=[];return"binary-only"===this.drop&&2===e?r.forEach((t=>{if(0!=t&&1!=t)throw RangeError("Index out of range");a.push((0,i.slice)(this.categories,t,1))})):"first"===this.drop?r.forEach(((e,n)=>{0===Number((0,i.slice)(t,[n,e],[1,1]).dataSync())?a.push((0,i.slice)(this.categories,0,1)):a.push((0,i.slice)(this.categories,e+1,1))})):r.forEach((t=>{a.push((0,i.slice)(this.categories,t,1))})),(0,i.reshape)((0,i.stack)(a),[-1])}))}}},126:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.OneHotEncoder=void 0;var r=n(6472);Object.defineProperty(e,"OneHotEncoder",{enumerable:!0,get:function(){return r.OneHotEncoder}})},5e3:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=BetaModule},8898:function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),i=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),a=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&r(e,t,n);return i(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.loadBetaModule=void 0,e.loadBetaModule=function(){var t;if("object"==typeof(null===(t=globalThis)||void 0===t?void 0:t.window))throw new TypeError('"rand/beta" is unavailable at browser environment.');return Promise.resolve().then((()=>a(n(5e3))))}},4034:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getCorrelationMatrix=e.getCovarianceMatrix=void 0;const r=n(1420),i=n(2537),a=n(813);e.getCovarianceMatrix=t=>{const e=(0,a.checkArray)(t,"float32",2),n=e.shape[0],i=(0,r.sub)(e,(0,r.mean)(e,0));return(0,r.divNoNan)((0,r.matMul)((0,r.transpose)(i),i),n-1)},e.getCorrelationMatrix=t=>{const n=(0,i.normalize)(t);return(0,e.getCovarianceMatrix)(n)}},2537:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.normalize=e.getVariance=void 0;const r=n(1420),i=n(813);e.getVariance=t=>{const e=(0,i.checkArray)(t,"float32"),n=e.shape[0],a=(0,r.sub)(e,(0,r.mean)(e,0));return(0,r.divNoNan)((0,r.sum)((0,r.pow)(a,2),0),n-1)},e.normalize=t=>{const n=(0,i.checkArray)(t,"float32"),a=(0,r.sub)(n,(0,r.mean)(n,0)),s=(0,r.sqrt)((0,e.getVariance)(n));return(0,r.divNoNan)(a,s)}},8368:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getCorrelationMatrix=e.getCovarianceMatrix=e.normalize=e.getVariance=void 0;var r=n(2537);Object.defineProperty(e,"getVariance",{enumerable:!0,get:function(){return r.getVariance}}),Object.defineProperty(e,"normalize",{enumerable:!0,get:function(){return r.normalize}});var i=n(4034);Object.defineProperty(e,"getCovarianceMatrix",{enumerable:!0,get:function(){return i.getCovarianceMatrix}}),Object.defineProperty(e,"getCorrelationMatrix",{enumerable:!0,get:function(){return i.getCorrelationMatrix}})},1073:function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,a){function s(t){try{l(r.next(t))}catch(t){a(t)}}function o(t){try{l(r.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,o)}l((r=r.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.OneHotEncoder=e.LabelEncoder=void 0;const i=n(9423);e.LabelEncoder=class{fit(t){return r(this,void 0,void 0,(function*(){this.data=yield(0,i.getDataByType)(t);const e=new Set(this.data);this.labels=Array.from(e);const n=this.labels;return this.data.map((t=>n.indexOf(t)))}))}transform(t){return r(this,void 0,void 0,(function*(){const e=this.labels;return((yield(0,i.getDataByType)(t))||this.data).map((t=>e.indexOf(t)))}))}},e.OneHotEncoder=class{fit(t){return r(this,void 0,void 0,(function*(){this.data=yield(0,i.getDataByType)(t);const e=new Set(this.data);this.labels=Array.from(e);const n=this.data.length,r=(0,i.zeros)(n,this.labels.length);for(let t=0;t<n;t++){const e=this.data[t],n=this.labels.indexOf(e);r[t][n]=1}return r}))}transform(t){return r(this,void 0,void 0,(function*(){const e=(yield(0,i.getDataByType)(t))||this.data,n=this.labels,r=(0,i.zeros)(e.length,n.length);for(let t=0;t<e.length;t++){const i=e[t],a=n.indexOf(i);r[t][a]=1}return r}))}}},3431:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});class n{constructor(t){if(this.wordCount={},Array.isArray(t))this.wordCountFromArray(t);else if("string"==typeof t){const e=t.split("");this.wordCountFromArray(e)}else this.wordCount=t;this.createOrderedElement()}update(t){const e=new n(t);for(const t in e.wordCount)t in this.wordCount?this.wordCount[t]+=e.wordCount[t]:this.wordCount[t]=e.wordCount[t];this.createOrderedElement()}wordCountFromArray(t){for(let e=0;e<t.length;e++){const n=t[e];n in this.wordCount?this.wordCount[n]+=1:this.wordCount[n]=1}}createOrderedElement(){this.element=Object.keys(this.wordCount).sort(((t,e)=>this.wordCount[e]-this.wordCount[t])).map((t=>[t,this.wordCount[t]]))}mostCommon(t){return this.element.slice(0,t)}}e.default=n},4121:function(t,e,n){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const i=r(n(3431));e.default=class{constructor(t=[],e=[]){this.wordOrder={},this.stopWords=[],this.initDict(t,e)}initDict(t,e=[]){const n=[];t.forEach((t=>{let e;e=Array.isArray(t)?t:t.split(" "),e.forEach((t=>{""!==t&&n.push(t.toLocaleLowerCase().replace(/[.,/#!$%^&*;:{}=\-_`~()]/g,""))}))}));const r=Array.from(new Set(n)).filter((t=>-1==e.indexOf(t))),i=this.sort(r);return this.stopWords=e,i.forEach(((t,e)=>{""!==t&&(this.wordOrder[t]=e)})),this.uniqueLength=i.length,this}sort(t){return t.sort(((t,e)=>t.charCodeAt(0)-e.charCodeAt(0)))}transform(t){var e;if(null===(e=this.wordOrder)||void 0===e?void 0:e.length)throw new Error("Dictionary is empty, use init function to init dictionary first");return t.map((t=>{const e=Array.from(new Float64Array(this.uniqueLength)),n=[];let r;r=Array.isArray(t)?t:t.split(" "),r.forEach((t=>{if(""!==t){const e=t.toLocaleLowerCase().replace(/[.,/#!$%^&*;:{}=\-_`~()]/g,"");n.push(e)}}));const a=new i.default(n).wordCount;return n.forEach((t=>{if(t in this.wordOrder){const n=this.wordOrder[t],r=a[t];e[n]=r}})),e}))}toJson(){const t={name:"CountVecorizer",wordOrder:this.wordOrder,stopWords:this.stopWords,uniqueLength:this.uniqueLength};return JSON.stringify(t)}load(t){const e=JSON.parse(t);if("CountVecorizer"!==e.name)throw new RangeError(`${e.name} is not a CountVecorizer`);return this.wordOrder=e.wordOrder,this.stopWords=e.stopWords,this.uniqueLength=e.uniqueLength,this}}},5019:(t,e)=>{"use strict";function n(t,e){const n=t.split(" "),r=[];return n.forEach((t=>{""!=t&&(e&&e.includes(t)||r.push(t.replace(/[.,/#!$%^&*;:{}=\-_`~()]/g,"")))})),r}Object.defineProperty(e,"__esModule",{value:!0}),e.createData=e.objectLength=e.createUniqueWord=e.skipGram=e.clean=void 0,e.clean=n,e.skipGram=function(t=5,e,r){const i=[],a=[];for(const s in e){const o=n(e[s],r);a.push(...o);for(let e=0;e<o.length;e++){const n=o[e];for(let r=0;r<t;r++)e+1+r<o.length&&i.push([n,o[e+1+r]]),e-r-1>=0&&i.push([n,o[e-r-1]])}}return[i,a]},e.createUniqueWord=function(t){const e=new Set(t),n=Array.from(e),r={};for(let t=0;t<n.length;t++)r[n[t]]=t+1;return r},e.objectLength=function(t){return Object.keys(t).length},e.createData=function(t,e,n){const r=[],i=[];for(let a=0;a<t.length;a++){const[s,o]=t[a],l=e[s],u=e[o],h=new Float64Array(n);h[l]=1,r.push(Array.from(h)),i.push(u)}return[r,i]}},1730:function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),i=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),a=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&r(e,t,n);return i(e,t),e},s=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,a){function s(t){try{l(r.next(t))}catch(t){a(t)}}function o(t){try{l(r.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,o)}l((r=r.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0});const o=a(n(4402)),l=n(5019),u=n(1420);e.default=class{constructor(t,e,n,r=50){this.weight=void 0;const[i,a]=(0,l.skipGram)(e,t,n);this.uniqueWords=(0,l.createUniqueWord)(a),this.nwords=(0,l.objectLength)(this.uniqueWords);const[s,o]=(0,l.createData)(i,this.uniqueWords,this.nwords);this.data=s,this.label=o,this.size=r}train(t=100,e=0){return s(this,void 0,void 0,(function*(){const n=o.sequential();n.add(o.layers.dense({units:this.size,inputShape:[this.nwords]})),n.add(o.layers.dense({units:this.nwords,activation:"softmax"})),n.compile({optimizer:"sgd",loss:"sparseCategoricalCrossentropy",metrics:["accuracy"]});const r=(0,u.tensor)(this.data),i=(0,u.tensor)(this.label);yield n.fit(r,i,{epochs:t,callbacks:{onEpochEnd:(t,n)=>{e&&console.log(`Epoch ${t}: loss = ${n.loss}`)}}}),this.weight=n.getWeights()[0].arraySync()}))}similarity(t,e){this.ensureWordInTable(t),this.ensureWordInTable(e);const n=this.uniqueWords[t],r=this.uniqueWords[e],i=(0,u.tensor)(this.weight[n]),a=(0,u.tensor)(this.weight[r]);return(0,u.sqrt)((0,u.mean)((0,u.pow)((0,u.sub)(i,a),2))).arraySync()}getWeight(t){this.ensureWordInTable(t);const e=this.uniqueWords[t];return this.weight[e]}mostSimilar(t){this.ensureWordInTable(t);const e=this.weight.slice(),n=this.uniqueWords[t],r=(0,u.tensor)(this.weight[n]);e.splice(n-1,1);const i=(0,u.sqrt)((0,u.mean)((0,u.pow)((0,u.sub)((0,u.tensor)(e),r),2),1)).arraySync(),a=Object.keys(this.uniqueWords);a.splice(n-1,1);const s=a.map(((t,e)=>[t,i[e]])).sort(((t,e)=>e[1]-t[1]));return s}ensureWordInTable(t){if(!(t in this.uniqueWords))throw new Error(`${t} does not exist`)}}},9423:function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(i,a){function s(t){try{l(r.next(t))}catch(t){a(t)}}function o(t){try{l(r.throw(t))}catch(t){a(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,o)}l((r=r.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.sizeFromShape=e.getDataByType=e.zeros=void 0;const i=n(1420);e.zeros=function(t,e){const n=[];for(let r=0;r<t;r++){const t=Array.from(new Uint8Array(e));n.push(t)}return n},e.getDataByType=function(t){return r(this,void 0,void 0,(function*(){return Array.isArray(t)?t:t instanceof i.Tensor?yield t.array():void 0}))},e.sizeFromShape=function(t){if(0===t.length)return 1;let e=t[0];for(let n=1;n<t.length;n++)e*=t[n];return e}},4705:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getOptimizer=void 0;const r=n(1420),i={sgd:function(t){return(null==t?void 0:t.learningRate)>0},momentum:function(t){return(null==t?void 0:t.learningRate)>0&&(null==t?void 0:t.momentum)>0},adagrad:function(t){return(null==t?void 0:t.learningRate)>0&&(null==t?void 0:t.initialAccumulatorValue)>0},adadelta:function(t){return!0},adam:function(t){return!0},adamax:function(t){return!0},rmsprop:function(t){return(null==t?void 0:t.learningRate)>0}};e.getOptimizer=(t,e)=>{const n=i[t];if(n&&!n(e))throw new TypeError("Illegal properties to init optimizer");switch(t){case"sgd":return r.train.sgd(e.learningRate);case"momentum":{const{learningRate:t,momentum:n,useNesterov:i}=e;return r.train.momentum(t,n,i)}case"adagrad":{const{learningRate:t,initialAccumulatorValue:n}=e;return r.train.adagrad(t,n)}case"adadelta":{const{learningRate:t,rho:n,epsilon:i}=e;return r.train.adadelta(t,n,i)}case"adam":{const{learningRate:t,beta1:n,beta2:i,epsilon:a}=e;return r.train.adam(t,n,i,a)}case"adamax":{const{learningRate:t,beta1:n,beta2:i,epsilon:a,decay:s}=e;return r.train.adamax(t,n,i,a,s)}case"rmsprop":{const{learningRate:t,decay:n,momentum:i,epsilon:a,centered:s}=e;return r.train.rmsprop(t,n,i,a,s)}default:throw new TypeError("Illegal optimizer type: "+t)}}},813:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.checkArray=void 0;const r=n(1420);e.checkArray=function(t,e="any",n=-1){return(0,r.tidy)((()=>{if(t instanceof Array&&(t=(0,r.tensor)(t)),t instanceof r.Tensor){const i=t.rank,a=t.dtype;if(-1!=n&&i!=n)throw new TypeError(`Dimension of input require to be ${n} but receive ${i}`);return"string"!==e&&"float32"!==e&&"bool"!==e&&"int32"!==e&&"complex64"!==e||a!=e&&(t=(0,r.cast)(t,e)),t}throw new TypeError("invalid input")}))}},1892:(t,e,n)=>{"use strict";var r=n(4489),i=n(2054);function a(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}e.parse=v,e.resolve=function(t,e){return v(t,!1,!0).resolve(e)},e.resolveObject=function(t,e){return t?v(t,!1,!0).resolveObject(e):e},e.format=function(t){return i.isString(t)&&(t=v(t)),t instanceof a?t.format():a.prototype.format.call(t)},e.Url=a;var s=/^([a-z0-9.+-]+:)/i,o=/:[0-9]*$/,l=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,u=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),h=["'"].concat(u),c=["%","/","?",";","#"].concat(h),d=["/","?","#"],f=/^[+a-z0-9A-Z_-]{0,63}$/,p=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,m={javascript:!0,"javascript:":!0},g={javascript:!0,"javascript:":!0},b={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},y=n(7459);function v(t,e,n){if(t&&i.isObject(t)&&t instanceof a)return t;var r=new a;return r.parse(t,e,n),r}a.prototype.parse=function(t,e,n){if(!i.isString(t))throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var a=t.indexOf("?"),o=-1!==a&&a<t.indexOf("#")?"?":"#",u=t.split(o);u[0]=u[0].replace(/\\/g,"/");var v=t=u.join(o);if(v=v.trim(),!n&&1===t.split("#").length){var w=l.exec(v);if(w)return this.path=v,this.href=v,this.pathname=w[1],w[2]?(this.search=w[2],this.query=e?y.parse(this.search.substr(1)):this.search.substr(1)):e&&(this.search="",this.query={}),this}var _=s.exec(v);if(_){var k=(_=_[0]).toLowerCase();this.protocol=k,v=v.substr(_.length)}if(n||_||v.match(/^\/\/[^@\/]+@[^@\/]+/)){var x="//"===v.substr(0,2);!x||_&&g[_]||(v=v.substr(2),this.slashes=!0)}if(!g[_]&&(x||_&&!b[_])){for(var S,E,I=-1,A=0;A<d.length;A++)-1!==(M=v.indexOf(d[A]))&&(-1===I||M<I)&&(I=M);for(-1!==(E=-1===I?v.lastIndexOf("@"):v.lastIndexOf("@",I))&&(S=v.slice(0,E),v=v.slice(E+1),this.auth=decodeURIComponent(S)),I=-1,A=0;A<c.length;A++){var M;-1!==(M=v.indexOf(c[A]))&&(-1===I||M<I)&&(I=M)}-1===I&&(I=v.length),this.host=v.slice(0,I),v=v.slice(I),this.parseHost(),this.hostname=this.hostname||"";var T="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!T)for(var N=this.hostname.split(/\./),C=(A=0,N.length);A<C;A++){var R=N[A];if(R&&!R.match(f)){for(var O="",D=0,z=R.length;D<z;D++)R.charCodeAt(D)>127?O+="x":O+=R[D];if(!O.match(f)){var B=N.slice(0,A),F=N.slice(A+1),P=R.match(p);P&&(B.push(P[1]),F.unshift(P[2])),F.length&&(v="/"+F.join(".")+v),this.hostname=B.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),T||(this.hostname=r.toASCII(this.hostname));var L=this.port?":"+this.port:"",$=this.hostname||"";this.host=$+L,this.href+=this.host,T&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==v[0]&&(v="/"+v))}if(!m[k])for(A=0,C=h.length;A<C;A++){var U=h[A];if(-1!==v.indexOf(U)){var j=encodeURIComponent(U);j===U&&(j=escape(U)),v=v.split(U).join(j)}}var W=v.indexOf("#");-1!==W&&(this.hash=v.substr(W),v=v.slice(0,W));var G=v.indexOf("?");if(-1!==G?(this.search=v.substr(G),this.query=v.substr(G+1),e&&(this.query=y.parse(this.query)),v=v.slice(0,G)):e&&(this.search="",this.query={}),v&&(this.pathname=v),b[k]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){L=this.pathname||"";var H=this.search||"";this.path=L+H}return this.href=this.format(),this},a.prototype.format=function(){var t=this.auth||"";t&&(t=(t=encodeURIComponent(t)).replace(/%3A/i,":"),t+="@");var e=this.protocol||"",n=this.pathname||"",r=this.hash||"",a=!1,s="";this.host?a=t+this.host:this.hostname&&(a=t+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(a+=":"+this.port)),this.query&&i.isObject(this.query)&&Object.keys(this.query).length&&(s=y.stringify(this.query));var o=this.search||s&&"?"+s||"";return e&&":"!==e.substr(-1)&&(e+=":"),this.slashes||(!e||b[e])&&!1!==a?(a="//"+(a||""),n&&"/"!==n.charAt(0)&&(n="/"+n)):a||(a=""),r&&"#"!==r.charAt(0)&&(r="#"+r),o&&"?"!==o.charAt(0)&&(o="?"+o),e+a+(n=n.replace(/[?#]/g,(function(t){return encodeURIComponent(t)})))+(o=o.replace("#","%23"))+r},a.prototype.resolve=function(t){return this.resolveObject(v(t,!1,!0)).format()},a.prototype.resolveObject=function(t){if(i.isString(t)){var e=new a;e.parse(t,!1,!0),t=e}for(var n=new a,r=Object.keys(this),s=0;s<r.length;s++){var o=r[s];n[o]=this[o]}if(n.hash=t.hash,""===t.href)return n.href=n.format(),n;if(t.slashes&&!t.protocol){for(var l=Object.keys(t),u=0;u<l.length;u++){var h=l[u];"protocol"!==h&&(n[h]=t[h])}return b[n.protocol]&&n.hostname&&!n.pathname&&(n.path=n.pathname="/"),n.href=n.format(),n}if(t.protocol&&t.protocol!==n.protocol){if(!b[t.protocol]){for(var c=Object.keys(t),d=0;d<c.length;d++){var f=c[d];n[f]=t[f]}return n.href=n.format(),n}if(n.protocol=t.protocol,t.host||g[t.protocol])n.pathname=t.pathname;else{for(var p=(t.pathname||"").split("/");p.length&&!(t.host=p.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),""!==p[0]&&p.unshift(""),p.length<2&&p.unshift(""),n.pathname=p.join("/")}if(n.search=t.search,n.query=t.query,n.host=t.host||"",n.auth=t.auth,n.hostname=t.hostname||t.host,n.port=t.port,n.pathname||n.search){var m=n.pathname||"",y=n.search||"";n.path=m+y}return n.slashes=n.slashes||t.slashes,n.href=n.format(),n}var v=n.pathname&&"/"===n.pathname.charAt(0),w=t.host||t.pathname&&"/"===t.pathname.charAt(0),_=w||v||n.host&&t.pathname,k=_,x=n.pathname&&n.pathname.split("/")||[],S=(p=t.pathname&&t.pathname.split("/")||[],n.protocol&&!b[n.protocol]);if(S&&(n.hostname="",n.port=null,n.host&&(""===x[0]?x[0]=n.host:x.unshift(n.host)),n.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(""===p[0]?p[0]=t.host:p.unshift(t.host)),t.host=null),_=_&&(""===p[0]||""===x[0])),w)n.host=t.host||""===t.host?t.host:n.host,n.hostname=t.hostname||""===t.hostname?t.hostname:n.hostname,n.search=t.search,n.query=t.query,x=p;else if(p.length)x||(x=[]),x.pop(),x=x.concat(p),n.search=t.search,n.query=t.query;else if(!i.isNullOrUndefined(t.search))return S&&(n.hostname=n.host=x.shift(),(T=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=T.shift(),n.host=n.hostname=T.shift())),n.search=t.search,n.query=t.query,i.isNull(n.pathname)&&i.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.href=n.format(),n;if(!x.length)return n.pathname=null,n.search?n.path="/"+n.search:n.path=null,n.href=n.format(),n;for(var E=x.slice(-1)[0],I=(n.host||t.host||x.length>1)&&("."===E||".."===E)||""===E,A=0,M=x.length;M>=0;M--)"."===(E=x[M])?x.splice(M,1):".."===E?(x.splice(M,1),A++):A&&(x.splice(M,1),A--);if(!_&&!k)for(;A--;A)x.unshift("..");!_||""===x[0]||x[0]&&"/"===x[0].charAt(0)||x.unshift(""),I&&"/"!==x.join("/").substr(-1)&&x.push("");var T,N=""===x[0]||x[0]&&"/"===x[0].charAt(0);return S&&(n.hostname=n.host=N?"":x.length?x.shift():"",(T=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=T.shift(),n.host=n.hostname=T.shift())),(_=_||n.host&&x.length)&&!N&&x.unshift(""),x.length?n.pathname=x.join("/"):(n.pathname=null,n.path=null),i.isNull(n.pathname)&&i.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.auth=t.auth||n.auth,n.slashes=n.slashes||t.slashes,n.href=n.format(),n},a.prototype.parseHost=function(){var t=this.host,e=o.exec(t);e&&(":"!==(e=e[0])&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)}},2054:t=>{"use strict";t.exports={isString:function(t){return"string"==typeof t},isObject:function(t){return"object"==typeof t&&null!==t},isNull:function(t){return null===t},isNullOrUndefined:function(t){return null==t}}},2574:(t,e,n)=>{var r=n(7671);!function(){var e={};function i(){void 0===r&&console.log.apply(console,arguments)}t.exports=e,function(t,e){var n,r,a;n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r=function(){function t(t){this.message="JPEG error: "+t}return t.prototype=Error(),t.prototype.name="JpegError",t.constructor=t}(),a=function(){function t(t,e){this.message=t,this.g=e}return t.prototype=Error(),t.prototype.name="DNLMarkerError",t.constructor=t}(),function(){function e(){this.M=null,this.B=-1}function i(t,e){for(var n,r,i=0,a=[],s=16;0<s&&!t[s-1];)s--;a.push({children:[],index:0});var o,l=a[0];for(n=0;n<s;n++){for(r=0;r<t[n];r++){for((l=a.pop()).children[l.index]=e[i];0<l.index;)l=a.pop();for(l.index++,a.push(l);a.length<=n;)a.push(o={children:[],index:0}),l.children[l.index]=o.children,l=o;i++}n+1<s&&(a.push(o={children:[],index:0}),l.children[l.index]=o.children,l=o)}return a[0].children}function s(t,e,i,s,o,h,c,d,f){function p(){if(0<D)return D--,O>>D&1;if(255===(O=t[e++])){var n=t[e++];if(n){if(220===n&&N){e+=2;var s=t[e++]<<8|t[e++];if(0<s&&s!==i.g)throw new a("Found DNL marker (0xFFDC) while parsing scan data",s)}throw new r("unexpected marker "+(O<<8|n).toString(16))}}return D=7,O>>>7}function m(t){for(;;){if("number"==typeof(t=t[p()]))return t;if("object"!==(void 0===t?"undefined":n(t)))throw new r("invalid huffman sequence")}}function g(t){for(var e=0;0<t;)e=e<<1|p(),t--;return e}function b(t){if(1===t)return 1===p()?1:-1;var e=g(t);return e>=1<<t-1?e:e+(-1<<t)+1}function y(t,e){var n=m(t.D);for(n=0===n?0:b(n),t.a[e]=t.m+=n,n=1;64>n;){var r=m(t.o),i=15&r;if(r>>=4,0===i){if(15>r)break;n+=16}else n+=r,t.a[e+u[n]]=b(i),n++}}function v(t,e){var n=m(t.D);n=0===n?0:b(n)<<f,t.a[e]=t.m+=n}function w(t,e){t.a[e]|=p()<<f}function _(t,e){if(0<z)z--;else for(var n=h;n<=c;){var r=m(t.o),i=15&r;if(r>>=4,0===i){if(15>r){z=g(r)+(1<<r)-1;break}n+=16}else n+=r,t.a[e+u[n]]=b(i)*(1<<f),n++}}function k(t,e){for(var n,i=h,a=0;i<=c;){n=e+u[i];var s=0>t.a[n]?-1:1;switch(B){case 0:if(n=15&(a=m(t.o)),a>>=4,0===n)15>a?(z=g(a)+(1<<a),B=4):(a=16,B=1);else{if(1!==n)throw new r("invalid ACn encoding");x=b(n),B=a?2:3}continue;case 1:case 2:t.a[n]?t.a[n]+=s*(p()<<f):0==--a&&(B=2===B?3:0);break;case 3:t.a[n]?t.a[n]+=s*(p()<<f):(t.a[n]=x<<f,B=0);break;case 4:t.a[n]&&(t.a[n]+=s*(p()<<f))}i++}4===B&&0==--z&&(B=0)}for(var x,S,E,I,A,M,T,N=9<arguments.length&&void 0!==arguments[9]&&arguments[9],C=i.P,R=e,O=0,D=0,z=0,B=0,F=s.length,P=i.S?0===h?0===d?v:w:0===d?_:k:y,L=0,$=1===F?s[0].c*s[0].l:C*i.O;L<$;){var U=o?Math.min($-L,o):$;for(S=0;S<F;S++)s[S].m=0;if(z=0,1===F){var j=s[0];for(A=0;A<U;A++)P(j,64*((j.c+1)*(L/j.c|0)+L%j.c)),L++}else for(A=0;A<U;A++){for(S=0;S<F;S++)for(M=(j=s[S]).h,T=j.j,E=0;E<T;E++)for(I=0;I<M;I++)P(j,64*((j.c+1)*((L/C|0)*j.j+E)+(L%C*j.h+I)));L++}if(D=0,(j=l(t,e))&&j.f&&((0,_util.warn)("decodeScan - unexpected MCU data, current marker is: "+j.f),e=j.offset),!(j=j&&j.F)||65280>=j)throw new r("marker was not found");if(!(65488<=j&&65495>=j))break;e+=2}return(j=l(t,e))&&j.f&&((0,_util.warn)("decodeScan - unexpected Scan data, current marker is: "+j.f),e=j.offset),e-R}function o(t,e){for(var n=e.c,i=e.l,a=new Int16Array(64),s=0;s<i;s++)for(var o=0;o<n;o++){var l=64*((e.c+1)*s+o),u=a,h=e.G,c=e.a;if(!h)throw new r("missing required Quantization Table.");for(var d=0;64>d;d+=8){var f=c[l+d],p=c[l+d+1],m=c[l+d+2],g=c[l+d+3],b=c[l+d+4],y=c[l+d+5],v=c[l+d+6],w=c[l+d+7];if(f*=h[d],0==(p|m|g|b|y|v|w))f=5793*f+512>>10,u[d]=f,u[d+1]=f,u[d+2]=f,u[d+3]=f,u[d+4]=f,u[d+5]=f,u[d+6]=f,u[d+7]=f;else{p*=h[d+1],m*=h[d+2],g*=h[d+3],b*=h[d+4],y*=h[d+5];var _=5793*f+128>>8,k=5793*b+128>>8,x=m,S=v*=h[d+6];k=(_=_+k+1>>1)-k,f=3784*x+1567*S+128>>8,x=1567*x-3784*S+128>>8,y=(b=(b=2896*(p-(w*=h[d+7]))+128>>8)+(y<<=4)+1>>1)-y,g=(w=(w=2896*(p+w)+128>>8)+(g<<=4)+1>>1)-g,S=(_=_+(S=f)+1>>1)-S,x=(k=k+x+1>>1)-x,f=2276*b+3406*w+2048>>12,b=3406*b-2276*w+2048>>12,w=f,f=799*g+4017*y+2048>>12,g=4017*g-799*y+2048>>12,y=f,u[d]=_+w,u[d+7]=_-w,u[d+1]=k+y,u[d+6]=k-y,u[d+2]=x+g,u[d+5]=x-g,u[d+3]=S+b,u[d+4]=S-b}}for(h=0;8>h;++h)f=u[h],0==((p=u[h+8])|(m=u[h+16])|(g=u[h+24])|(b=u[h+32])|(y=u[h+40])|(v=u[h+48])|(w=u[h+56]))?(f=-2040>(f=5793*f+8192>>14)?0:2024<=f?255:f+2056>>4,c[l+h]=f,c[l+h+8]=f,c[l+h+16]=f,c[l+h+24]=f,c[l+h+32]=f,c[l+h+40]=f,c[l+h+48]=f,c[l+h+56]=f):(_=5793*f+2048>>12,k=5793*b+2048>>12,f=3784*(x=m)+1567*(S=v)+2048>>12,x=1567*x-3784*S+2048>>12,S=f,y=(b=(b=2896*(p-w)+2048>>12)+y+1>>1)-y,g=(w=(w=2896*(p+w)+2048>>12)+g+1>>1)-g,f=2276*b+3406*w+2048>>12,b=3406*b-2276*w+2048>>12,w=f,f=799*g+4017*y+2048>>12,g=4017*g-799*y+2048>>12,p=(k=(k=(_=4112+(_+k+1>>1))-k)+x+1>>1)+(y=f),v=k-y,y=(x=k-x)-g,f=16>(f=(_=_+S+1>>1)+w)?0:4080<=f?255:f>>4,p=16>p?0:4080<=p?255:p>>4,m=16>(m=x+g)?0:4080<=m?255:m>>4,g=16>(g=(S=_-S)+b)?0:4080<=g?255:g>>4,b=16>(b=S-b)?0:4080<=b?255:b>>4,y=16>y?0:4080<=y?255:y>>4,v=16>v?0:4080<=v?255:v>>4,w=16>(w=_-w)?0:4080<=w?255:w>>4,c[l+h]=f,c[l+h+8]=p,c[l+h+16]=m,c[l+h+24]=g,c[l+h+32]=b,c[l+h+40]=y,c[l+h+48]=v,c[l+h+56]=w)}return e.a}function l(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:e,r=t.length-1;if(n=n<e?n:e,e>=r)return null;var i=t[e]<<8|t[e+1];if(65472<=i&&65534>=i)return{f:null,F:i,offset:e};for(var a=t[n]<<8|t[n+1];!(65472<=a&&65534>=a);){if(++n>=r)return null;a=t[n]<<8|t[n+1]}return{f:i.toString(16),F:a,offset:n}}var u=new Uint8Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]);e.prototype={parse:function(t){function e(){var e=t[f]<<8|t[f+1];return f+=2,e}function n(){var n=e(),r=l(t,n=f+n-2,f);return r&&r.f&&((0,_util.warn)("readDataBlock - incorrect length, current marker is: "+r.f),n=r.offset),n=t.subarray(f,n),f+=n.length,n}function h(t){for(var e=Math.ceil(t.v/8/t.s),n=Math.ceil(t.g/8/t.u),r=0;r<t.b.length;r++){A=t.b[r];var i=Math.ceil(Math.ceil(t.v/8)*A.h/t.s),a=Math.ceil(Math.ceil(t.g/8)*A.j/t.u);A.a=new Int16Array(64*n*A.j*(e*A.h+1)),A.c=i,A.l=a}t.P=e,t.O=n}var c=(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}).N,d=void 0===c?null:c,f=0,p=null,m=0;c=[];var g=[],b=[],y=e();if(65496!==y)throw new r("SOI not found");for(y=e();65497!==y;){switch(y){case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:var v=n();65518===y&&65===v[0]&&100===v[1]&&111===v[2]&&98===v[3]&&101===v[4]&&(p={version:v[5]<<8|v[6],Y:v[7]<<8|v[8],Z:v[9]<<8|v[10],W:v[11]});break;case 65499:y=e()+f-2;for(var w;f<y;){var _=t[f++],k=new Uint16Array(64);if(0==_>>4)for(v=0;64>v;v++)k[w=u[v]]=t[f++];else{if(1!=_>>4)throw new r("DQT - invalid table spec");for(v=0;64>v;v++)k[w=u[v]]=e()}c[15&_]=k}break;case 65472:case 65473:case 65474:if(x)throw new r("Only single frame JPEGs supported");e();var x={};for(x.X=65473===y,x.S=65474===y,x.precision=t[f++],y=e(),x.g=d||y,x.v=e(),x.b=[],x.C={},v=t[f++],y=k=_=0;y<v;y++){w=t[f];var S=t[f+1]>>4,E=15&t[f+1];_<S&&(_=S),k<E&&(k=E),S=x.b.push({h:S,j:E,T:t[f+2],G:null}),x.C[w]=S-1,f+=3}x.s=_,x.u=k,h(x);break;case 65476:for(w=e(),y=2;y<w;){for(_=t[f++],k=new Uint8Array(16),v=S=0;16>v;v++,f++)S+=k[v]=t[f];for(E=new Uint8Array(S),v=0;v<S;v++,f++)E[v]=t[f];y+=17+S,(0==_>>4?b:g)[15&_]=i(k,E)}break;case 65501:e();var I=e();break;case 65498:for(v=1==++m&&!d,e(),_=t[f++],w=[],y=0;y<_;y++){k=x.C[t[f++]];var A=x.b[k];k=t[f++],A.D=b[k>>4],A.o=g[15&k],w.push(A)}y=t[f++],_=t[f++],k=t[f++];try{var M=s(t,f,x,w,I,y,_,k>>4,15&k,v);f+=M}catch(e){if(e instanceof a)return(0,_util.warn)('Attempting to re-parse JPEG image using "scanLines" parameter found in DNL marker (0xFFDC) segment.'),this.parse(t,{N:e.g});throw e}break;case 65500:f+=4;break;case 65535:255!==t[f]&&f--;break;default:if(255===t[f-3]&&192<=t[f-2]&&254>=t[f-2])f-=3;else{if(!(v=l(t,f-2))||!v.f)throw new r("unknown marker "+y.toString(16));(0,_util.warn)("JpegImage.parse - unexpected data, current marker is: "+v.f),f=v.offset}}y=e()}for(this.width=x.v,this.height=x.g,this.A=p,this.b=[],y=0;y<x.b.length;y++)(I=c[(A=x.b[y]).T])&&(A.G=I),this.b.push({R:o(0,A),U:A.h/x.s,V:A.j/x.u,c:A.c,l:A.l});this.i=this.b.length},L:function(t,e){var n,r,i=this.width/t,a=this.height/e,s=this.b.length,o=t*e*s,l=new Uint8ClampedArray(o),u=new Uint32Array(t);for(r=0;r<s;r++){var h=this.b[r],c=h.U*i,d=h.V*a,f=r,p=h.R,m=h.c+1<<3;for(n=0;n<t;n++)h=0|n*c,u[n]=(4294967288&h)<<3|7&h;for(c=0;c<e;c++)for(h=m*(4294967288&(h=0|c*d))|(7&h)<<3,n=0;n<t;n++)l[f]=p[h+u[n]],f+=s}if(a=this.M)for(r=0;r<o;)for(i=h=0;h<s;h++,r++,i+=2)l[r]=(l[r]*a[i]>>8)+a[i+1];return l},w:function(){return this.A?!!this.A.W:3===this.i?0!==this.B:1===this.B},I:function(t){for(var e,n,r,i=0,a=t.length;i<a;i+=3)e=t[i],n=t[i+1],r=t[i+2],t[i]=e-179.456+1.402*r,t[i+1]=e+135.459-.344*n-.714*r,t[i+2]=e-226.816+1.772*n;return t},K:function(t){for(var e,n,r,i,a=0,s=0,o=t.length;s<o;s+=4)e=t[s],n=t[s+1],r=t[s+2],i=t[s+3],t[a++]=n*(-660635669420364e-19*n+.000437130475926232*r-54080610064599e-18*e+.00048449797120281*i-.154362151871126)-122.67195406894+r*(-.000957964378445773*r+.000817076911346625*e-.00477271405408747*i+1.53380253221734)+e*(.000961250184130688*e-.00266257332283933*i+.48357088451265)+i*(-.000336197177618394*i+.484791561490776),t[a++]=107.268039397724+n*(219927104525741e-19*n-.000640992018297945*r+.000659397001245577*e+.000426105652938837*i-.176491792462875)+r*(-.000778269941513683*r+.00130872261408275*e+.000770482631801132*i-.151051492775562)+e*(.00126935368114843*e-.00265090189010898*i+.25802910206845)+i*(-.000318913117588328*i-.213742400323665),t[a++]=n*(-.000570115196973677*n-263409051004589e-19*r+.0020741088115012*e-.00288260236853442*i+.814272968359295)-20.810012546947+r*(-153496057440975e-19*r-.000132689043961446*e+.000560833691242812*i-.195152027534049)+e*(.00174418132927582*e-.00255243321439347*i+.116935020465145)+i*(-.000343531996510555*i+.24165260232407);return t.subarray(0,a)},J:function(t){for(var e,n,r,i=0,a=t.length;i<a;i+=4)e=t[i],n=t[i+1],r=t[i+2],t[i]=434.456-e-1.402*r,t[i+1]=119.541-e+.344*n+.714*r,t[i+2]=481.816-e-1.772*n;return t},H:function(t){for(var e,n,r,i,a=0,s=1/255,o=0,l=t.length;o<l;o+=4)e=t[o]*s,n=t[o+1]*s,r=t[o+2]*s,i=t[o+3]*s,t[a++]=255+e*(-4.387332384609988*e+54.48615194189176*n+18.82290502165302*r+212.25662451639585*i-285.2331026137004)+n*(1.7149763477362134*n-5.6096736904047315*r-17.873870861415444*i-5.497006427196366)+r*(-2.5217340131683033*r-21.248923337353073*i+17.5119270841813)-i*(21.86122147463605*i+189.48180835922747),t[a++]=255+e*(8.841041422036149*e+60.118027045597366*n+6.871425592049007*r+31.159100130055922*i-79.2970844816548)+n*(-15.310361306967817*n+17.575251261109482*r+131.35250912493976*i-190.9453302588951)+r*(4.444339102852739*r+9.8632861493405*i-24.86741582555878)-i*(20.737325471181034*i+187.80453709719578),t[a++]=255+e*(.8842522430003296*e+8.078677503112928*n+30.89978309703729*r-.23883238689178934*i-14.183576799673286)+n*(10.49593273432072*n+63.02378494754052*r+50.606957656360734*i-112.23884253719248)+r*(.03296041114873217*r+115.60384449646641*i-193.58209356861505)-i*(22.33816807309886*i+180.12613974708367);return t.subarray(0,a)},getData:function(t,e,n){if(4<this.i)throw new r("Unsupported color mode");if(t=this.L(t,e),1===this.i&&n){n=t.length,e=new Uint8ClampedArray(3*n);for(var i=0,a=0;a<n;a++){var s=t[a];e[i++]=s,e[i++]=s,e[i++]=s}return e}if(3===this.i&&this.w())return this.I(t);if(4===this.i){if(this.w())return n?this.K(t):this.J(t);if(n)return this.H(t)}return t}},t.JpegDecoder=e}(),t.encodeImage=function(e,n,r,i){var a={t256:[n],t257:[r],t258:[8,8,8,8],t259:[1],t262:[2],t273:[1e3],t277:[4],t278:[r],t279:[n*r*4],t282:[1],t283:[1],t284:[1],t286:[0],t287:[0],t296:[1],t305:["Photopea (UTIF.js)"],t338:[1]};if(i)for(var s in i)a[s]=i[s];var o=new Uint8Array(t.encode([a])),l=new Uint8Array(e),u=new Uint8Array(1e3+n*r*4);for(s=0;s<o.length;s++)u[s]=o[s];for(s=0;s<l.length;s++)u[1e3+s]=l[s];return u.buffer},t.encode=function(e){var n=new Uint8Array(2e4),r=4,i=t._binBE;n[0]=77,n[1]=77,n[3]=42;var a=8;i.writeUint(n,r,a),r+=4;for(var s=0;s<e.length;s++){var o=t._writeIFD(i,n,a,e[s]);a=o[1],s<e.length-1&&i.writeUint(n,o[0],a)}return n.slice(0,a).buffer},t.decode=function(e){t.decode._decodeG3.allow2D=null;var n=new Uint8Array(e),r=0,i=t._binBE.readASCII(n,r,2);r+=2;var a="II"==i?t._binLE:t._binBE;a.readUshort(n,r),r+=2;var s=a.readUint(n,r);r+=4;for(var o=[];;){var l=t._readIFD(a,n,s,o);if(0==(s=a.readUint(n,l)))break}return o},t.decodeImages=function(e,n){for(var r=new Uint8Array(e),a=t._binBE.readASCII(r,0,2),s=0;s<n.length;s++){var o=n[s];if(null!=o.t256){o.isLE="II"==a,o.width=o.t256[0],o.height=o.t257[0];var l=o.t259?o.t259[0]:1,u=o.t266?o.t266[0]:1;o.t284&&2==o.t284[0]&&i("PlanarConfiguration 2 should not be used!");var h=(o.t258?Math.min(32,o.t258[0]):1)*(o.t277?o.t277[0]:1),c=8*Math.ceil(o.width*h/8),d=o.t273;null==d&&(d=o.t324);var f=o.t279;1==l&&1==d.length&&(f=[o.height*(c>>>3)]),null==f&&(f=o.t325);var p=new Uint8Array(o.height*(c>>>3)),m=0;if(null!=o.t322){for(var g=o.t322[0],b=o.t323[0],y=Math.floor((o.width+g-1)/g),v=Math.floor((o.height+b-1)/b),w=new Uint8Array(0|Math.ceil(g*b*h/8)),_=0;_<v;_++)for(var k=0;k<y;k++){for(var x=_*y+k,S=0;S<w.length;S++)w[S]=0;t.decode._decompress(o,r,d[x],f[x],l,w,0,u),6==l?p=w:t._copyTile(w,0|Math.ceil(g*h/8),b,p,0|Math.ceil(o.width*h/8),o.height,0|Math.ceil(k*g*h/8),_*b)}m=8*p.length}else{var E=o.t278?o.t278[0]:o.height;for(E=Math.min(E,o.height),x=0;x<d.length;x++)t.decode._decompress(o,r,d[x],f[x],l,p,0|Math.ceil(m/8),u),m+=c*E;m=Math.min(m,8*p.length)}o.data=new Uint8Array(p.buffer,0,0|Math.ceil(m/8))}}},t.decode._decompress=function(n,r,a,s,o,l,u,h){if(1==o)for(var c=0;c<s;c++)l[u+c]=r[a+c];else if(3==o)t.decode._decodeG3(r,a,s,l,u,n.width,h);else if(4==o)t.decode._decodeG4(r,a,s,l,u,n.width,h);else if(5==o)t.decode._decodeLZW(r,a,l,u);else if(6==o)t.decode._decodeOldJPEG(n,r,a,s,l,u);else if(7==o)t.decode._decodeNewJPEG(n,r,a,s,l,u);else if(8==o)for(var d=new Uint8Array(r.buffer,a,s),f=e.inflate(d),p=0;p<f.length;p++)l[u+p]=f[p];else 32773==o?t.decode._decodePackBits(r,a,s,l,u):32809==o?t.decode._decodeThunder(r,a,s,l,u):i("Unknown compression",o);if(n.t317&&2==n.t317[0])for(var m=n.t277?n.t277[0]:1,g=n.t278?n.t278[0]:n.height,b=n.width*m,y=0;y<g;y++){var v=u+y*b;if(3==m)for(c=3;c<b;c+=3)l[v+c]=l[v+c]+l[v+c-3]&255,l[v+c+1]=l[v+c+1]+l[v+c-2]&255,l[v+c+2]=l[v+c+2]+l[v+c-1]&255;else for(c=m;c<b;c++)l[v+c]=l[v+c]+l[v+c-m]&255}},t.decode._decodeNikon=function(t,e,n,r,a){var s,o;i(t.slice(e,e+100)),s=t[e],o=t[++e],e++,i(s.toString(16),o.toString(16),n)},t.decode._decodeNewJPEG=function(e,n,r,i,a,s){var o=e.t347,l=o?o.length:0,u=new Uint8Array(l+i);if(o){for(var h=0,c=0;c<l-1&&(255!=o[c]||217!=o[c+1]);c++)u[h++]=o[c];var d=n[r],f=n[r+1];for(255==d&&216==f||(u[h++]=d,u[h++]=f),c=2;c<i;c++)u[h++]=n[r+c]}else for(c=0;c<i;c++)u[c]=n[r+c];if(32803==e.t262){var p=e.t258[0],m=(new LosslessJpegDecoder).decode(u),g=m.length;if(16==p)for(c=0;c<g;c++)a[s++]=255&m[c],a[s++]=m[c]>>>8;else{if(12!=p)throw new Error("unsupported bit depth "+p);for(c=0;c<g;c+=2)a[s++]=m[c]>>>4,a[s++]=255&(m[c]<<4|m[c+1]>>>8),a[s++]=255&m[c+1]}}else{var b=new t.JpegDecoder;b.parse(u);var y=b.getData(b.width,b.height);for(c=0;c<y.length;c++)a[s+c]=y[c]}6==e.t262[0]&&(e.t262[0]=2)},t.decode._decodeOldJPEGInit=function(t,e,n,r){var a,s,o,l,u,h=216,c=0,d=0,f=!1,p=t.t513,m=p?p[0]:0,g=t.t514,b=g?g[0]:0,y=t.t324||t.t273||p,v=t.t530,w=0,_=0,k=t.t277?t.t277[0]:1,x=t.t515;if(y&&(d=y[0],f=y.length>1),!f){if(255==e[n]&&e[n+1]==h)return{jpegOffset:n};if(null!=p&&(255==e[n+m]&&e[n+m+1]==h?c=n+m:i("JPEGInterchangeFormat does not point to SOI"),null==g?i("JPEGInterchangeFormatLength field is missing"):(m>=d||m+b<=d)&&i("JPEGInterchangeFormatLength field value is invalid"),null!=c))return{jpegOffset:c}}if(null!=v&&(w=v[0],_=v[1]),null!=p&&null!=g)if(b>=2&&m+b<=d){for(a=255==e[n+m+b-2]&&e[n+m+b-1]==h?new Uint8Array(b-2):new Uint8Array(b),o=0;o<a.length;o++)a[o]=e[n+m+o];i("Incorrect JPEG interchange format: using JPEGInterchangeFormat offset to derive tables")}else i("JPEGInterchangeFormat+JPEGInterchangeFormatLength > offset to first strip or tile");if(null==a){var S=0,E=[];E[S++]=255,E[S++]=h;var I=t.t519;if(null==I)throw new Error("JPEGQTables tag is missing");for(o=0;o<I.length;o++)for(E[S++]=255,E[S++]=219,E[S++]=0,E[S++]=67,E[S++]=o,l=0;l<64;l++)E[S++]=e[n+I[o]+l];for(u=0;u<2;u++){var A=t[0==u?"t520":"t521"];if(null==A)throw new Error((0==u?"JPEGDCTables":"JPEGACTables")+" tag is missing");for(o=0;o<A.length;o++){E[S++]=255,E[S++]=196;var M=19;for(l=0;l<16;l++)M+=e[n+A[o]+l];for(E[S++]=M>>>8,E[S++]=255&M,E[S++]=o|u<<4,l=0;l<16;l++)E[S++]=e[n+A[o]+l];for(l=0;l<M;l++)E[S++]=e[n+A[o]+16+l]}}if(E[S++]=255,E[S++]=192,E[S++]=0,E[S++]=8+3*k,E[S++]=8,E[S++]=t.height>>>8&255,E[S++]=255&t.height,E[S++]=t.width>>>8&255,E[S++]=255&t.width,E[S++]=k,1==k)E[S++]=1,E[S++]=17,E[S++]=0;else for(o=0;o<3;o++)E[S++]=o+1,E[S++]=0!=o?17:(15&w)<<4|15&_,E[S++]=o;null!=x&&0!=x[0]&&(E[S++]=255,E[S++]=221,E[S++]=0,E[S++]=4,E[S++]=x[0]>>>8&255,E[S++]=255&x[0]),a=new Uint8Array(E)}var T=-1;for(o=0;o<a.length-1;){if(255==a[o]&&192==a[o+1]){T=o;break}o++}if(-1==T){var N=new Uint8Array(a.length+10+3*k);N.set(a);var C=a.length;if(T=a.length,(a=N)[C++]=255,a[C++]=192,a[C++]=0,a[C++]=8+3*k,a[C++]=8,a[C++]=t.height>>>8&255,a[C++]=255&t.height,a[C++]=t.width>>>8&255,a[C++]=255&t.width,a[C++]=k,1==k)a[C++]=1,a[C++]=17,a[C++]=0;else for(o=0;o<3;o++)a[C++]=o+1,a[C++]=0!=o?17:(15&w)<<4|15&_,a[C++]=o}if(255==e[d]&&218==e[d+1]){var R=e[d+2]<<8|e[d+3];for((s=new Uint8Array(R+2))[0]=e[d],s[1]=e[d+1],s[2]=e[d+2],s[3]=e[d+3],o=0;o<R-2;o++)s[o+4]=e[d+o+4]}else{var O=0;if((s=new Uint8Array(8+2*k))[O++]=255,s[O++]=218,s[O++]=0,s[O++]=6+2*k,s[O++]=k,1==k)s[O++]=1,s[O++]=0;else for(o=0;o<3;o++)s[O++]=o+1,s[O++]=o<<4|o;s[O++]=0,s[O++]=63,s[O++]=0}return{jpegOffset:n,tables:a,sosMarker:s,sofPosition:T}},t.decode._decodeOldJPEG=function(e,n,r,i,a,s){var o,l,u,h=t.decode._decodeOldJPEGInit(e,n,r,i);if(null!=h.jpegOffset)for(o=r+i-h.jpegOffset,u=new Uint8Array(o),f=0;f<o;f++)u[f]=n[h.jpegOffset+f];else{for(l=h.tables.length,(u=new Uint8Array(l+h.sosMarker.length+i+2)).set(h.tables),u[h.sofPosition+5]=e.height>>>8&255,u[h.sofPosition+6]=255&e.height,u[h.sofPosition+7]=e.width>>>8&255,u[h.sofPosition+8]=255&e.width,255==n[r]&&n[r+1]==SOS||(u.set(h.sosMarker,bufoff),bufoff+=sosMarker.length),f=0;f<i;f++)u[bufoff++]=n[r+f];u[bufoff++]=255,u[bufoff++]=EOI}var c=new t.JpegDecoder;c.parse(u);for(var d=c.getData(c.width,c.height),f=0;f<d.length;f++)a[s+f]=d[f];6==e.t262[0]&&(e.t262[0]=2)},t.decode._decodePackBits=function(t,e,n,r,i){for(var a=new Int8Array(t.buffer),s=new Int8Array(r.buffer),o=e+n;e<o;){var l=a[e];if(e++,l>=0&&l<128)for(var u=0;u<l+1;u++)s[i]=a[e],i++,e++;if(l>=-127&&l<0){for(u=0;u<1-l;u++)s[i]=a[e],i++;e++}}},t.decode._decodeThunder=function(t,e,n,r,i){for(var a=[0,1,0,-1],s=[0,1,2,3,0,-3,-2,-1],o=e+n,l=2*i,u=0;e<o;){var h=t[e],c=h>>>6,d=63&h;if(e++,3==c&&(u=15&d,r[l>>>1]|=u<<4*(1-l&1),l++),0==c)for(var f=0;f<d;f++)r[l>>>1]|=u<<4*(1-l&1),l++;if(2==c)for(f=0;f<2;f++)4!=(p=d>>>3*(1-f)&7)&&(u+=s[p],r[l>>>1]|=u<<4*(1-l&1),l++);if(1==c)for(f=0;f<3;f++){var p;2!=(p=d>>>2*(2-f)&3)&&(u+=a[p],r[l>>>1]|=u<<4*(1-l&1),l++)}}},t.decode._dmap={1:0,"011":1,"000011":2,"0000011":3,"010":-1,"000010":-2,"0000010":-3},t.decode._lens=function(){var t=function(t,e,n,r){for(var i=0;i<e.length;i++)t[e[i]]=n+i*r},e="00110101,000111,0111,1000,1011,1100,1110,1111,10011,10100,00111,01000,001000,000011,110100,110101,101010,101011,0100111,0001100,0001000,0010111,0000011,0000100,0101000,0101011,0010011,0100100,0011000,00000010,00000011,00011010,00011011,00010010,00010011,00010100,00010101,00010110,00010111,00101000,00101001,00101010,00101011,00101100,00101101,00000100,00000101,00001010,00001011,01010010,01010011,01010100,01010101,00100100,00100101,01011000,01011001,01011010,01011011,01001010,01001011,00110010,00110011,00110100",n="0000110111,010,11,10,011,0011,0010,00011,000101,000100,0000100,0000101,0000111,00000100,00000111,000011000,0000010111,0000011000,0000001000,00001100111,00001101000,00001101100,00000110111,00000101000,00000010111,00000011000,000011001010,000011001011,000011001100,000011001101,000001101000,000001101001,000001101010,000001101011,000011010010,000011010011,000011010100,000011010101,000011010110,000011010111,000001101100,000001101101,000011011010,000011011011,000001010100,000001010101,000001010110,000001010111,000001100100,000001100101,000001010010,000001010011,000000100100,000000110111,000000111000,000000100111,000000101000,000001011000,000001011001,000000101011,000000101100,000001011010,000001100110,000001100111",r="11011,10010,010111,0110111,00110110,00110111,01100100,01100101,01101000,01100111,011001100,011001101,011010010,011010011,011010100,011010101,011010110,011010111,011011000,011011001,011011010,011011011,010011000,010011001,010011010,011000,010011011",i="0000001111,000011001000,000011001001,000001011011,000000110011,000000110100,000000110101,0000001101100,0000001101101,0000001001010,0000001001011,0000001001100,0000001001101,0000001110010,0000001110011,0000001110100,0000001110101,0000001110110,0000001110111,0000001010010,0000001010011,0000001010100,0000001010101,0000001011010,0000001011011,0000001100100,0000001100101",a="00000001000,00000001100,00000001101,000000010010,000000010011,000000010100,000000010101,000000010110,000000010111,000000011100,000000011101,000000011110,000000011111";e=e.split(","),n=n.split(","),r=r.split(","),i=i.split(","),a=a.split(",");var s={},o={};return t(s,e,0,1),t(s,r,64,64),t(s,a,1792,64),t(o,n,0,1),t(o,i,64,64),t(o,a,1792,64),[s,o]}(),t.decode._decodeG4=function(e,n,r,i,a,s,o){for(var l=t.decode,u=n<<3,h=0,c="",d=[],f=[],p=0;p<s;p++)f.push(0);f=l._makeDiff(f);for(var m=0,g=0,b=0,y=0,v=0,w=0,_="",k=0,x=8*Math.ceil(s/8);u>>>3<n+r;){b=l._findDiff(f,m+(0==m?0:1),1-v),y=l._findDiff(f,b,v);var S=0;if(1==o&&(S=e[u>>>3]>>>7-(7&u)&1),2==o&&(S=e[u>>>3]>>>(7&u)&1),u++,c+=S,"H"==_){if(null!=l._lens[v][c]){var E=l._lens[v][c];c="",h+=E,E<64&&(l._addNtimes(d,h,v),m+=h,v=1-v,h=0,0==--k&&(_=""))}}else"0001"==c&&(c="",l._addNtimes(d,y-m,v),m=y),"001"==c&&(c="",_="H",k=2),null!=l._dmap[c]&&(g=b+l._dmap[c],l._addNtimes(d,g-m,v),m=g,c="",v=1-v);d.length==s&&""==_&&(l._writeBits(d,i,8*a+w*x),v=0,w++,m=0,f=l._makeDiff(d),d=[])}},t.decode._findDiff=function(t,e,n){for(var r=0;r<t.length;r+=2)if(t[r]>=e&&t[r+1]==n)return t[r]},t.decode._makeDiff=function(t){var e=[];1==t[0]&&e.push(0,1);for(var n=1;n<t.length;n++)t[n-1]!=t[n]&&e.push(n,t[n]);return e.push(t.length,0,t.length,1),e},t.decode._decodeG3=function(e,n,r,i,a,s,o){for(var l=t.decode,u=n<<3,h=0,c="",d=[],f=[],p=0;p<s;p++)d.push(0);for(var m=0,g=0,b=0,y=0,v=0,w=-1,_="",k=0,x=!1,S=8*Math.ceil(s/8);u>>>3<n+r;){b=l._findDiff(f,m+(0==m?0:1),1-v),y=l._findDiff(f,b,v);var E=0;if(1==o&&(E=e[u>>>3]>>>7-(7&u)&1),2==o&&(E=e[u>>>3]>>>(7&u)&1),u++,c+=E,x){if(null!=l._lens[v][c]){var I=l._lens[v][c];c="",h+=I,I<64&&(l._addNtimes(d,h,v),v=1-v,h=0)}}else"H"==_?null!=l._lens[v][c]&&(I=l._lens[v][c],c="",h+=I,I<64&&(l._addNtimes(d,h,v),m+=h,v=1-v,h=0,0==--k&&(_=""))):("0001"==c&&(c="",l._addNtimes(d,y-m,v),m=y),"001"==c&&(c="",_="H",k=2),null!=l._dmap[c]&&(g=b+l._dmap[c],l._addNtimes(d,g-m,v),m=g,c="",v=1-v));c.endsWith("000000000001")&&(w>=0&&l._writeBits(d,i,8*a+w*S),1==o&&(x=1==(e[u>>>3]>>>7-(7&u)&1)),2==o&&(x=1==(e[u>>>3]>>>(7&u)&1)),u++,null==l._decodeG3.allow2D&&(l._decodeG3.allow2D=x),l._decodeG3.allow2D||(x=!0,u--),c="",v=0,w++,m=0,f=l._makeDiff(d),d=[])}d.length==s&&l._writeBits(d,i,8*a+w*S)},t.decode._addNtimes=function(t,e,n){for(var r=0;r<e;r++)t.push(n)},t.decode._writeBits=function(t,e,n){for(var r=0;r<t.length;r++)e[n+r>>>3]|=t[r]<<7-(n+r&7)},t.decode._decodeLZW=function(e,n,r,i){if(null==t.decode._lzwTab){for(var a=new Uint32Array(65535),s=new Uint16Array(65535),o=new Uint8Array(2e6),l=0;l<256;l++)o[l<<2]=l,a[l]=l<<2,s[l]=1;t.decode._lzwTab=[a,s,o]}for(var u=t.decode._copyData,h=t.decode._lzwTab[0],c=t.decode._lzwTab[1],d=(o=t.decode._lzwTab[2],258),f=1032,p=9,m=n<<3,g=0,b=0;g=(e[m>>>3]<<16|e[m+8>>>3]<<8|e[m+16>>>3])>>24-(7&m)-p&(1<<p)-1,m+=p,257!=g;){if(256==g){if(p=9,d=258,f=1032,g=(e[m>>>3]<<16|e[m+8>>>3]<<8|e[m+16>>>3])>>24-(7&m)-p&(1<<p)-1,m+=p,257==g)break;r[i]=g,i++}else if(g<d){var y=h[g],v=c[g];u(o,y,r,i,v),i+=v,b>=d?(h[d]=f,o[h[d]]=y[0],c[d]=1,f=f+1+3&-4,d++):(h[d]=f,u(o,h[b],o,f,w=c[b]),o[f+w]=o[y],w++,c[d]=w,d++,f=f+w+3&-4),d+1==1<<p&&p++}else{var w;b>=d?(h[d]=f,c[d]=0,d++):(h[d]=f,u(o,h[b],o,f,w=c[b]),o[f+w]=o[f],w++,c[d]=w,d++,u(o,f,r,i,w),i+=w,f=f+w+3&-4),d+1==1<<p&&p++}b=g}},t.decode._copyData=function(t,e,n,r,i){for(var a=0;a<i;a+=4)n[r+a]=t[e+a],n[r+a+1]=t[e+a+1],n[r+a+2]=t[e+a+2],n[r+a+3]=t[e+a+3]},t.tags={254:"NewSubfileType",255:"SubfileType",256:"ImageWidth",257:"ImageLength",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",266:"FillOrder",269:"DocumentName",270:"ImageDescription",271:"Make",272:"Model",273:"StripOffset",274:"Orientation",277:"SamplesPerPixel",278:"RowsPerStrip",279:"StripByteCounts",280:"MinSampleValue",281:"MaxSampleValue",282:"XResolution",283:"YResolution",284:"PlanarConfiguration",285:"PageName",286:"XPosition",287:"YPosition",292:"T4Options",296:"ResolutionUnit",297:"PageNumber",305:"Software",306:"DateTime",315:"Artist",316:"HostComputer",317:"Predictor",318:"WhitePoint",319:"PrimaryChromaticities",320:"ColorMap",321:"HalftoneHints",322:"TileWidth",323:"TileLength",324:"TileOffset",325:"TileByteCounts",330:"SubIFDs",336:"DotRange",338:"ExtraSample",339:"SampleFormat",347:"JPEGTables",512:"JPEGProc",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",519:"JPEGQTables",520:"JPEGDCTables",521:"JPEGACTables",529:"YCbCrCoefficients",530:"YCbCrSubSampling",531:"YCbCrPositioning",532:"ReferenceBlackWhite",700:"XMP",33421:"CFARepeatPatternDim",33422:"CFAPattern",33432:"Copyright",33434:"ExposureTime",33437:"FNumber",33723:"IPTC/NAA",34377:"Photoshop",34665:"ExifIFD",34675:"ICC Profile",34850:"ExposureProgram",34853:"GPSInfo",34855:"ISOSpeedRatings",34858:"TimeZoneOffset",34859:"SelfTimeMode",36867:"DateTimeOriginal",36868:"DateTimeDigitized",37377:"ShutterSpeedValue",37378:"ApertureValue",37380:"ExposureBiasValue",37383:"MeteringMode",37385:"Flash",37386:"FocalLength",37390:"FocalPlaneXResolution",37391:"FocalPlaneYResolution",37392:"FocalPlaneResolutionUnit",37393:"ImageNumber",37398:"TIFF/EPStandardID",37399:"SensingMethod",37500:"MakerNote",37510:"UserComment",37724:"ImageSourceData",40092:"XPComment",40094:"XPKeywords",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelXDimension",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41990:"SceneCaptureType",50706:"DNGVersion",50707:"DNGBackwardVersion",50708:"UniqueCameraModel",50709:"LocalizedCameraModel",50710:"CFAPlaneColor",50711:"CFALayout",50712:"LinearizationTable",50713:"BlackLevelRepeatDim",50714:"BlackLevel",50716:"BlackLevelDeltaV",50717:"WhiteLevel",50718:"DefaultScale",50719:"DefaultCropOrigin",50720:"DefaultCropSize",50733:"BayerGreenSplit",50738:"AntiAliasStrength",50721:"ColorMatrix1",50722:"ColorMatrix2",50723:"CameraCalibration1",50724:"CameraCalibration2",50727:"AnalogBalance",50728:"AsShotNeutral",50730:"BaselineExposure",50731:"BaselineNoise",50732:"BaselineSharpness",50734:"LinearResponseLimit",50735:"CameraSerialNumber",50736:"LensInfo",50739:"ShadowScale",50740:"DNGPrivateData",50741:"MakerNoteSafety",50778:"CalibrationIlluminant1",50779:"CalibrationIlluminant2",50780:"BestQualityScale",50781:"RawDataUniqueID",50827:"OriginalRawFileName",50829:"ActiveArea",50830:"MaskedAreas",50931:"CameraCalibrationSignature",50932:"ProfileCalibrationSignature",50935:"NoiseReductionApplied",50936:"ProfileName",50937:"ProfileHueSatMapDims",50938:"ProfileHueSatMapData1",50939:"ProfileHueSatMapData2",50940:"ProfileToneCurve",50941:"ProfileEmbedPolicy",50942:"ProfileCopyright",50964:"ForwardMatrix1",50965:"ForwardMatrix2",50966:"PreviewApplicationName",50967:"PreviewApplicationVersion",50969:"PreviewSettingsDigest",50970:"PreviewColorSpace",50971:"PreviewDateTime",50972:"RawImageDigest",51008:"OpcodeList1",51009:"OpcodeList2",51022:"OpcodeList3",51041:"NoiseProfile",51089:"OriginalDefaultFinalSize",51090:"OriginalBestQualityFinalSize",51091:"OriginalDefaultCropSize",51125:"DefaultUserCrop"},t.ttypes={256:3,257:3,258:3,259:3,262:3,273:4,274:3,277:3,278:4,279:4,282:5,283:5,284:3,286:5,287:5,296:3,305:2,306:2,338:3,513:4,514:4,34665:4},t._readIFD=function(e,n,r,a){var s=e.readUshort(n,r);r+=2;var o={};a.push(o);for(var l=0;l<s;l++){var u=e.readUshort(n,r);r+=2;var h=e.readUshort(n,r);r+=2;var c=e.readUint(n,r);r+=4;var d=e.readUint(n,r);r+=4;var f=[];if(o["t"+u]=f,1==h||7==h)for(var p=0;p<c;p++)f.push(n[(c<5?r-4:d)+p]);if(2==h&&f.push(e.readASCII(n,c<5?r-4:d,c-1)),3==h)for(p=0;p<c;p++)f.push(e.readUshort(n,(c<3?r-4:d)+2*p));if(4==h)for(p=0;p<c;p++)f.push(e.readUint(n,(c<2?r-4:d)+4*p));if(5==h)for(p=0;p<c;p++)f.push(e.readUint(n,d+8*p)/e.readUint(n,d+8*p+4));if(8==h)for(p=0;p<c;p++)f.push(e.readShort(n,(c<3?r-4:d)+2*p));if(9==h)for(p=0;p<c;p++)f.push(e.readInt(n,(c<2?r-4:d)+4*p));if(10==h)for(p=0;p<c;p++)f.push(e.readInt(n,d+8*p)/e.readInt(n,d+8*p+4));if(11==h)for(p=0;p<c;p++)f.push(e.readFloat(n,d+4*p));if(12==h)for(p=0;p<c;p++)f.push(e.readDouble(n,d+8*p));if(0!=c&&0==f.length&&i("unknown TIFF tag type: ",h,"num:",c),330==u)for(p=0;p<c;p++)t._readIFD(e,n,f[p],a)}return r},t._writeIFD=function(e,n,r,i){var a=Object.keys(i);e.writeUshort(n,r,a.length);for(var s=(r+=2)+12*a.length+4,o=0;o<a.length;o++){var l=a[o],u=parseInt(l.slice(1)),h=t.ttypes[u];if(null==h)throw new Error("unknown type of tag: "+u);var c=i[l];2==h&&(c=c[0]+"\0");var d=c.length;e.writeUshort(n,r,u),r+=2,e.writeUshort(n,r,h),r+=2,e.writeUint(n,r,d);var f=[-1,1,1,2,4,8,0,0,0,0,0,0,8][h]*d,p=r+=4;if(f>4&&(e.writeUint(n,r,s),p=s),2==h&&e.writeASCII(n,p,c),3==h)for(var m=0;m<d;m++)e.writeUshort(n,p+2*m,c[m]);if(4==h)for(m=0;m<d;m++)e.writeUint(n,p+4*m,c[m]);if(5==h)for(m=0;m<d;m++)e.writeUint(n,p+8*m,Math.round(1e4*c[m])),e.writeUint(n,p+8*m+4,1e4);if(12==h)for(m=0;m<d;m++)e.writeDouble(n,p+8*m,c[m]);f>4&&(s+=f+=1&f),r+=4}return[r,s]},t.toRGBA8=function(t){var e=t.width,n=t.height,r=e*n,a=4*r,s=t.data,o=new Uint8Array(4*r),l=t.t262[0],u=t.t258?Math.min(32,t.t258[0]):1,h=t.isLE?1:0;if(0==l)for(var c=Math.ceil(u*e/8),d=0;d<n;d++){var f=d*c,p=d*e;if(1==u)for(var m=0;m<e;m++){var g=p+m<<2,b=s[f+(m>>3)]>>7-(7&m)&1;o[g]=o[g+1]=o[g+2]=255*(1-b),o[g+3]=255}if(4==u)for(m=0;m<e;m++)g=p+m<<2,b=s[f+(m>>1)]>>4-4*(1&m)&15,o[g]=o[g+1]=o[g+2]=17*(15-b),o[g+3]=255;if(8==u)for(m=0;m<e;m++)g=p+m<<2,b=s[f+m],o[g]=o[g+1]=o[g+2]=255-b,o[g+3]=255}else if(1==l)for(c=Math.ceil(u*e/8),d=0;d<n;d++){if(f=d*c,p=d*e,1==u)for(m=0;m<e;m++)g=p+m<<2,b=s[f+(m>>3)]>>7-(7&m)&1,o[g]=o[g+1]=o[g+2]=255*b,o[g+3]=255;if(2==u)for(m=0;m<e;m++)g=p+m<<2,b=s[f+(m>>2)]>>6-2*(3&m)&3,o[g]=o[g+1]=o[g+2]=85*b,o[g+3]=255;if(8==u)for(m=0;m<e;m++)g=p+m<<2,b=s[f+m],o[g]=o[g+1]=o[g+2]=b,o[g+3]=255;if(16==u)for(m=0;m<e;m++)g=p+m<<2,b=s[f+(2*m+h)],o[g]=o[g+1]=o[g+2]=Math.min(255,b),o[g+3]=255}else if(2==l)if(8==u)if(t.t338)if(t.t338[0]>0)for(m=0;m<a;m++)o[m]=s[m];else for(m=0;m<a;m+=4)o[m]=s[m],o[m+1]=s[m+1],o[m+2]=s[m+2],o[m+3]=255;else{if(4==(_=t.t258?t.t258.length:3))for(m=0;m<a;m++)o[m]=s[m];if(3==_)for(m=0;m<r;m++){var y=3*m;o[g=m<<2]=s[y],o[g+1]=s[y+1],o[g+2]=s[y+2],o[g+3]=255}}else for(m=0;m<r;m++)y=6*m,o[g=m<<2]=s[y],o[g+1]=s[y+2],o[g+2]=s[y+4],o[g+3]=255;else if(3==l){var v=t.t320;for(m=0;m<r;m++){g=m<<2;var w=s[m];o[g]=v[w]>>8,o[g+1]=v[256+w]>>8,o[g+2]=v[512+w]>>8,o[g+3]=255}}else if(5==l){var _,k=(_=t.t258?t.t258.length:4)>4?1:0;for(m=0;m<r;m++){g=m<<2;var x=m*_,S=255-s[x],E=255-s[x+1],I=255-s[x+2],A=(255-s[x+3])*(1/255);o[g]=~~(S*A+.5),o[g+1]=~~(E*A+.5),o[g+2]=~~(I*A+.5),o[g+3]=255*(1-k)+s[x+4]*k}}else i("Unknown Photometric interpretation: "+l);return o},t.replaceIMG=function(){for(var e=document.getElementsByTagName("img"),n=0;n<e.length;n++){var r=e[n],i=r.getAttribute("src");if(null!=i){var a=i.split(".").pop().toLowerCase();if("tif"==a||"tiff"==a){var s=new XMLHttpRequest;t._xhrs.push(s),t._imgs.push(r),s.open("GET",i),s.responseType="arraybuffer",s.onload=t._imgLoaded,s.send()}}}},t._xhrs=[],t._imgs=[],t._imgLoaded=function(e){var n=e.target.response,r=t.decode(n),i=r[0];t.decodeImages(n,r);var a=t.toRGBA8(i),s=i.width,o=i.height,l=t._xhrs.indexOf(e.target),u=t._imgs[l];t._xhrs.splice(l,1),t._imgs.splice(l,1);var h=document.createElement("canvas");h.width=s,h.height=o;for(var c=h.getContext("2d"),d=c.createImageData(s,o),f=0;f<a.length;f++)d.data[f]=a[f];c.putImageData(d,0,0);var p=["style","class","id"];for(f=0;f<p.length;f++)h.setAttribute(p[f],u.getAttribute(p[f]));u.parentNode.replaceChild(h,u)},t._binBE={nextZero:function(t,e){for(;0!=t[e];)e++;return e},readUshort:function(t,e){return t[e]<<8|t[e+1]},readShort:function(e,n){var r=t._binBE.ui8;return r[0]=e[n+1],r[1]=e[n+0],t._binBE.i16[0]},readInt:function(e,n){var r=t._binBE.ui8;return r[0]=e[n+3],r[1]=e[n+2],r[2]=e[n+1],r[3]=e[n+0],t._binBE.i32[0]},readUint:function(e,n){var r=t._binBE.ui8;return r[0]=e[n+3],r[1]=e[n+2],r[2]=e[n+1],r[3]=e[n+0],t._binBE.ui32[0]},readASCII:function(t,e,n){for(var r="",i=0;i<n;i++)r+=String.fromCharCode(t[e+i]);return r},readFloat:function(e,n){for(var r=t._binBE.ui8,i=0;i<4;i++)r[i]=e[n+3-i];return t._binBE.fl32[0]},readDouble:function(e,n){for(var r=t._binBE.ui8,i=0;i<8;i++)r[i]=e[n+7-i];return t._binBE.fl64[0]},writeUshort:function(t,e,n){t[e]=n>>8&255,t[e+1]=255&n},writeUint:function(t,e,n){t[e]=n>>24&255,t[e+1]=n>>16&255,t[e+2]=n>>8&255,t[e+3]=n>>0&255},writeASCII:function(t,e,n){for(var r=0;r<n.length;r++)t[e+r]=n.charCodeAt(r)},writeDouble:function(e,n,r){t._binBE.fl64[0]=r;for(var i=0;i<8;i++)e[n+i]=t._binBE.ui8[7-i]}},t._binBE.ui8=new Uint8Array(8),t._binBE.i16=new Int16Array(t._binBE.ui8.buffer),t._binBE.i32=new Int32Array(t._binBE.ui8.buffer),t._binBE.ui32=new Uint32Array(t._binBE.ui8.buffer),t._binBE.fl32=new Float32Array(t._binBE.ui8.buffer),t._binBE.fl64=new Float64Array(t._binBE.ui8.buffer),t._binLE={nextZero:t._binBE.nextZero,readUshort:function(t,e){return t[e+1]<<8|t[e]},readShort:function(e,n){var r=t._binBE.ui8;return r[0]=e[n+0],r[1]=e[n+1],t._binBE.i16[0]},readInt:function(e,n){var r=t._binBE.ui8;return r[0]=e[n+0],r[1]=e[n+1],r[2]=e[n+2],r[3]=e[n+3],t._binBE.i32[0]},readUint:function(e,n){var r=t._binBE.ui8;return r[0]=e[n+0],r[1]=e[n+1],r[2]=e[n+2],r[3]=e[n+3],t._binBE.ui32[0]},readASCII:t._binBE.readASCII,readFloat:function(e,n){for(var r=t._binBE.ui8,i=0;i<4;i++)r[i]=e[n+i];return t._binBE.fl32[0]},readDouble:function(e,n){for(var r=t._binBE.ui8,i=0;i<8;i++)r[i]=e[n+i];return t._binBE.fl64[0]}},t._copyTile=function(t,e,n,r,i,a,s,o){for(var l=Math.min(e,i-s),u=Math.min(n,a-o),h=0;h<u;h++)for(var c=(o+h)*i+s,d=h*e,f=0;f<l;f++)r[c+f]=t[d+f]}}(e,n(2911))}()},5091:(t,e,n)=>{function r(t){try{if(!n.g.localStorage)return!1}catch(t){return!1}var e=n.g.localStorage[t];return null!=e&&"true"===String(e).toLowerCase()}t.exports=function(t,e){if(r("noDeprecation"))return t;var n=!1;return function(){if(!n){if(r("throwDeprecation"))throw new Error(e);r("traceDeprecation")?console.trace(e):console.warn(e),n=!0}return t.apply(this,arguments)}}},1746:t=>{t.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},7072:(t,e,n)=>{var r=n(7671),i=/%[sdj%]/g;e.format=function(t){if(!b(t)){for(var e=[],n=0;n<arguments.length;n++)e.push(o(arguments[n]));return e.join(" ")}n=1;for(var r=arguments,a=r.length,s=String(t).replace(i,(function(t){if("%%"===t)return"%";if(n>=a)return t;switch(t){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(t){return"[Circular]"}default:return t}})),l=r[n];n<a;l=r[++n])m(l)||!w(l)?s+=" "+l:s+=" "+o(l);return s},e.deprecate=function(t,i){if(y(n.g.process))return function(){return e.deprecate(t,i).apply(this,arguments)};if(!0===r.noDeprecation)return t;var a=!1;return function(){if(!a){if(r.throwDeprecation)throw new Error(i);r.traceDeprecation?console.trace(i):console.error(i),a=!0}return t.apply(this,arguments)}};var a,s={};function o(t,n){var r={seen:[],stylize:u};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),p(n)?r.showHidden=n:n&&e._extend(r,n),y(r.showHidden)&&(r.showHidden=!1),y(r.depth)&&(r.depth=2),y(r.colors)&&(r.colors=!1),y(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=l),h(r,t,r.depth)}function l(t,e){var n=o.styles[e];return n?"["+o.colors[n][0]+"m"+t+"["+o.colors[n][1]+"m":t}function u(t,e){return t}function h(t,n,r){if(t.customInspect&&n&&x(n.inspect)&&n.inspect!==e.inspect&&(!n.constructor||n.constructor.prototype!==n)){var i=n.inspect(r,t);return b(i)||(i=h(t,i,r)),i}var a=function(t,e){if(y(e))return t.stylize("undefined","undefined");if(b(e)){var n="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(n,"string")}return g(e)?t.stylize(""+e,"number"):p(e)?t.stylize(""+e,"boolean"):m(e)?t.stylize("null","null"):void 0}(t,n);if(a)return a;var s=Object.keys(n),o=function(t){var e={};return t.forEach((function(t,n){e[t]=!0})),e}(s);if(t.showHidden&&(s=Object.getOwnPropertyNames(n)),k(n)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return c(n);if(0===s.length){if(x(n)){var l=n.name?": "+n.name:"";return t.stylize("[Function"+l+"]","special")}if(v(n))return t.stylize(RegExp.prototype.toString.call(n),"regexp");if(_(n))return t.stylize(Date.prototype.toString.call(n),"date");if(k(n))return c(n)}var u,w="",S=!1,E=["{","}"];return f(n)&&(S=!0,E=["[","]"]),x(n)&&(w=" [Function"+(n.name?": "+n.name:"")+"]"),v(n)&&(w=" "+RegExp.prototype.toString.call(n)),_(n)&&(w=" "+Date.prototype.toUTCString.call(n)),k(n)&&(w=" "+c(n)),0!==s.length||S&&0!=n.length?r<0?v(n)?t.stylize(RegExp.prototype.toString.call(n),"regexp"):t.stylize("[Object]","special"):(t.seen.push(n),u=S?function(t,e,n,r,i){for(var a=[],s=0,o=e.length;s<o;++s)M(e,String(s))?a.push(d(t,e,n,r,String(s),!0)):a.push("");return i.forEach((function(i){i.match(/^\d+$/)||a.push(d(t,e,n,r,i,!0))})),a}(t,n,r,o,s):s.map((function(e){return d(t,n,r,o,e,S)})),t.seen.pop(),function(t,e,n){return t.reduce((function(t,e){return e.indexOf("\n"),t+e.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60?n[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+n[1]:n[0]+e+" "+t.join(", ")+" "+n[1]}(u,w,E)):E[0]+w+E[1]}function c(t){return"["+Error.prototype.toString.call(t)+"]"}function d(t,e,n,r,i,a){var s,o,l;if((l=Object.getOwnPropertyDescriptor(e,i)||{value:e[i]}).get?o=l.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):l.set&&(o=t.stylize("[Setter]","special")),M(r,i)||(s="["+i+"]"),o||(t.seen.indexOf(l.value)<0?(o=m(n)?h(t,l.value,null):h(t,l.value,n-1)).indexOf("\n")>-1&&(o=a?o.split("\n").map((function(t){return"  "+t})).join("\n").substr(2):"\n"+o.split("\n").map((function(t){return"   "+t})).join("\n")):o=t.stylize("[Circular]","special")),y(s)){if(a&&i.match(/^\d+$/))return o;(s=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=t.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=t.stylize(s,"string"))}return s+": "+o}function f(t){return Array.isArray(t)}function p(t){return"boolean"==typeof t}function m(t){return null===t}function g(t){return"number"==typeof t}function b(t){return"string"==typeof t}function y(t){return void 0===t}function v(t){return w(t)&&"[object RegExp]"===S(t)}function w(t){return"object"==typeof t&&null!==t}function _(t){return w(t)&&"[object Date]"===S(t)}function k(t){return w(t)&&("[object Error]"===S(t)||t instanceof Error)}function x(t){return"function"==typeof t}function S(t){return Object.prototype.toString.call(t)}function E(t){return t<10?"0"+t.toString(10):t.toString(10)}e.debuglog=function(t){if(y(a)&&(a=r.env.NODE_DEBUG||""),t=t.toUpperCase(),!s[t])if(new RegExp("\\b"+t+"\\b","i").test(a)){var n=r.pid;s[t]=function(){var r=e.format.apply(e,arguments);console.error("%s %d: %s",t,n,r)}}else s[t]=function(){};return s[t]},e.inspect=o,o.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},o.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},e.isArray=f,e.isBoolean=p,e.isNull=m,e.isNullOrUndefined=function(t){return null==t},e.isNumber=g,e.isString=b,e.isSymbol=function(t){return"symbol"==typeof t},e.isUndefined=y,e.isRegExp=v,e.isObject=w,e.isDate=_,e.isError=k,e.isFunction=x,e.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t},e.isBuffer=n(1746);var I=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function A(){var t=new Date,e=[E(t.getHours()),E(t.getMinutes()),E(t.getSeconds())].join(":");return[t.getDate(),I[t.getMonth()],e].join(" ")}function M(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.log=function(){console.log("%s - %s",A(),e.format.apply(e,arguments))},e.inherits=n(1193),e._extend=function(t,e){if(!e||!w(e))return t;for(var n=Object.keys(e),r=n.length;r--;)t[n[r]]=e[n[r]];return t}},2771:t=>{t.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},9953:(t,e,n)=>{var r=n(7671),i=/%[sdj%]/g;e.format=function(t){if(!b(t)){for(var e=[],n=0;n<arguments.length;n++)e.push(o(arguments[n]));return e.join(" ")}n=1;for(var r=arguments,a=r.length,s=String(t).replace(i,(function(t){if("%%"===t)return"%";if(n>=a)return t;switch(t){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(t){return"[Circular]"}default:return t}})),l=r[n];n<a;l=r[++n])m(l)||!w(l)?s+=" "+l:s+=" "+o(l);return s},e.deprecate=function(t,i){if(y(n.g.process))return function(){return e.deprecate(t,i).apply(this,arguments)};if(!0===r.noDeprecation)return t;var a=!1;return function(){if(!a){if(r.throwDeprecation)throw new Error(i);r.traceDeprecation?console.trace(i):console.error(i),a=!0}return t.apply(this,arguments)}};var a,s={};function o(t,n){var r={seen:[],stylize:u};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),p(n)?r.showHidden=n:n&&e._extend(r,n),y(r.showHidden)&&(r.showHidden=!1),y(r.depth)&&(r.depth=2),y(r.colors)&&(r.colors=!1),y(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=l),h(r,t,r.depth)}function l(t,e){var n=o.styles[e];return n?"["+o.colors[n][0]+"m"+t+"["+o.colors[n][1]+"m":t}function u(t,e){return t}function h(t,n,r){if(t.customInspect&&n&&x(n.inspect)&&n.inspect!==e.inspect&&(!n.constructor||n.constructor.prototype!==n)){var i=n.inspect(r,t);return b(i)||(i=h(t,i,r)),i}var a=function(t,e){if(y(e))return t.stylize("undefined","undefined");if(b(e)){var n="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(n,"string")}return g(e)?t.stylize(""+e,"number"):p(e)?t.stylize(""+e,"boolean"):m(e)?t.stylize("null","null"):void 0}(t,n);if(a)return a;var s=Object.keys(n),o=function(t){var e={};return t.forEach((function(t,n){e[t]=!0})),e}(s);if(t.showHidden&&(s=Object.getOwnPropertyNames(n)),k(n)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return c(n);if(0===s.length){if(x(n)){var l=n.name?": "+n.name:"";return t.stylize("[Function"+l+"]","special")}if(v(n))return t.stylize(RegExp.prototype.toString.call(n),"regexp");if(_(n))return t.stylize(Date.prototype.toString.call(n),"date");if(k(n))return c(n)}var u,w="",S=!1,E=["{","}"];return f(n)&&(S=!0,E=["[","]"]),x(n)&&(w=" [Function"+(n.name?": "+n.name:"")+"]"),v(n)&&(w=" "+RegExp.prototype.toString.call(n)),_(n)&&(w=" "+Date.prototype.toUTCString.call(n)),k(n)&&(w=" "+c(n)),0!==s.length||S&&0!=n.length?r<0?v(n)?t.stylize(RegExp.prototype.toString.call(n),"regexp"):t.stylize("[Object]","special"):(t.seen.push(n),u=S?function(t,e,n,r,i){for(var a=[],s=0,o=e.length;s<o;++s)M(e,String(s))?a.push(d(t,e,n,r,String(s),!0)):a.push("");return i.forEach((function(i){i.match(/^\d+$/)||a.push(d(t,e,n,r,i,!0))})),a}(t,n,r,o,s):s.map((function(e){return d(t,n,r,o,e,S)})),t.seen.pop(),function(t,e,n){return t.reduce((function(t,e){return e.indexOf("\n"),t+e.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60?n[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+n[1]:n[0]+e+" "+t.join(", ")+" "+n[1]}(u,w,E)):E[0]+w+E[1]}function c(t){return"["+Error.prototype.toString.call(t)+"]"}function d(t,e,n,r,i,a){var s,o,l;if((l=Object.getOwnPropertyDescriptor(e,i)||{value:e[i]}).get?o=l.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):l.set&&(o=t.stylize("[Setter]","special")),M(r,i)||(s="["+i+"]"),o||(t.seen.indexOf(l.value)<0?(o=m(n)?h(t,l.value,null):h(t,l.value,n-1)).indexOf("\n")>-1&&(o=a?o.split("\n").map((function(t){return"  "+t})).join("\n").substr(2):"\n"+o.split("\n").map((function(t){return"   "+t})).join("\n")):o=t.stylize("[Circular]","special")),y(s)){if(a&&i.match(/^\d+$/))return o;(s=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=t.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=t.stylize(s,"string"))}return s+": "+o}function f(t){return Array.isArray(t)}function p(t){return"boolean"==typeof t}function m(t){return null===t}function g(t){return"number"==typeof t}function b(t){return"string"==typeof t}function y(t){return void 0===t}function v(t){return w(t)&&"[object RegExp]"===S(t)}function w(t){return"object"==typeof t&&null!==t}function _(t){return w(t)&&"[object Date]"===S(t)}function k(t){return w(t)&&("[object Error]"===S(t)||t instanceof Error)}function x(t){return"function"==typeof t}function S(t){return Object.prototype.toString.call(t)}function E(t){return t<10?"0"+t.toString(10):t.toString(10)}e.debuglog=function(t){if(y(a)&&(a=r.env.NODE_DEBUG||""),t=t.toUpperCase(),!s[t])if(new RegExp("\\b"+t+"\\b","i").test(a)){var n=r.pid;s[t]=function(){var r=e.format.apply(e,arguments);console.error("%s %d: %s",t,n,r)}}else s[t]=function(){};return s[t]},e.inspect=o,o.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},o.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},e.isArray=f,e.isBoolean=p,e.isNull=m,e.isNullOrUndefined=function(t){return null==t},e.isNumber=g,e.isString=b,e.isSymbol=function(t){return"symbol"==typeof t},e.isUndefined=y,e.isRegExp=v,e.isObject=w,e.isDate=_,e.isError=k,e.isFunction=x,e.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t},e.isBuffer=n(2771);var I=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function A(){var t=new Date,e=[E(t.getHours()),E(t.getMinutes()),E(t.getSeconds())].join(":");return[t.getDate(),I[t.getMonth()],e].join(" ")}function M(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.log=function(){console.log("%s - %s",A(),e.format.apply(e,arguments))},e.inherits=n(1104),e._extend=function(t,e){if(!e||!w(e))return t;for(var n=Object.keys(e),r=n.length;r--;)t[n[r]]=e[n[r]];return t}},568:(t,e,n)=>{"use strict";var r=n(288),i=n(189),a=n(2459),s=n(7270);function o(t,e,n){var r=t;return i(e)?(n=e,"string"==typeof t&&(r={uri:t})):r=s(e,{uri:t}),r.callback=n,r}function l(t,e,n){return u(e=o(t,e,n))}function u(t){if(void 0===t.callback)throw new Error("callback argument missing");var e=!1,n=function(n,r,i){e||(e=!0,t.callback(n,r,i))};function r(){var t=void 0;if(t=h.response?h.response:h.responseText||function(t){try{if("document"===t.responseType)return t.responseXML;var e=t.responseXML&&"parsererror"===t.responseXML.documentElement.nodeName;if(""===t.responseType&&!e)return t.responseXML}catch(t){}return null}(h),b)try{t=JSON.parse(t)}catch(t){}return t}function i(t){return clearTimeout(c),t instanceof Error||(t=new Error(""+(t||"Unknown XMLHttpRequest Error"))),t.statusCode=0,n(t,y)}function s(){if(!u){var e;clearTimeout(c),e=t.useXDR&&void 0===h.status?200:1223===h.status?204:h.status;var i=y,s=null;return 0!==e?(i={body:r(),statusCode:e,method:f,headers:{},url:d,rawRequest:h},h.getAllResponseHeaders&&(i.headers=a(h.getAllResponseHeaders()))):s=new Error("Internal XMLHttpRequest Error"),n(s,i,i.body)}}var o,u,h=t.xhr||null;h||(h=t.cors||t.useXDR?new l.XDomainRequest:new l.XMLHttpRequest);var c,d=h.url=t.uri||t.url,f=h.method=t.method||"GET",p=t.body||t.data,m=h.headers=t.headers||{},g=!!t.sync,b=!1,y={body:void 0,headers:{},statusCode:0,method:f,url:d,rawRequest:h};if("json"in t&&!1!==t.json&&(b=!0,m.accept||m.Accept||(m.Accept="application/json"),"GET"!==f&&"HEAD"!==f&&(m["content-type"]||m["Content-Type"]||(m["Content-Type"]="application/json"),p=JSON.stringify(!0===t.json?p:t.json))),h.onreadystatechange=function(){4===h.readyState&&setTimeout(s,0)},h.onload=s,h.onerror=i,h.onprogress=function(){},h.onabort=function(){u=!0},h.ontimeout=i,h.open(f,d,!g,t.username,t.password),g||(h.withCredentials=!!t.withCredentials),!g&&t.timeout>0&&(c=setTimeout((function(){if(!u){u=!0,h.abort("timeout");var t=new Error("XMLHttpRequest timeout");t.code="ETIMEDOUT",i(t)}}),t.timeout)),h.setRequestHeader)for(o in m)m.hasOwnProperty(o)&&h.setRequestHeader(o,m[o]);else if(t.headers&&!function(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0}(t.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in t&&(h.responseType=t.responseType),"beforeSend"in t&&"function"==typeof t.beforeSend&&t.beforeSend(h),h.send(p||null),h}t.exports=l,t.exports.default=l,l.XMLHttpRequest=r.XMLHttpRequest||function(){},l.XDomainRequest="withCredentials"in new l.XMLHttpRequest?l.XMLHttpRequest:r.XDomainRequest,function(t,e){for(var n=0;n<t.length;n++)e(t[n])}(["get","put","post","patch","head","delete"],(function(t){l["delete"===t?"del":t]=function(e,n,r){return(n=o(e,n,r)).method=t.toUpperCase(),u(n)}}))},6483:t=>{t.exports=void 0!==self.DOMParser?function(t){return(new self.DOMParser).parseFromString(t,"application/xml")}:void 0!==self.ActiveXObject&&new self.ActiveXObject("Microsoft.XMLDOM")?function(t){var e=new self.ActiveXObject("Microsoft.XMLDOM");return e.async="false",e.loadXML(t),e}:function(t){var e=document.createElement("div");return e.innerHTML=t,e}},7270:t=>{t.exports=function(){for(var t={},n=0;n<arguments.length;n++){var r=arguments[n];for(var i in r)e.call(r,i)&&(t[i]=r[i])}return t};var e=Object.prototype.hasOwnProperty},5174:()=>{},7887:()=>{},8331:()=>{},9361:()=>{},2611:()=>{},4696:()=>{},779:()=>{},8901:()=>{},8364:()=>{},3039:()=>{},6789:()=>{}},e={};function n(r){var i=e[r];if(void 0!==i)return i.exports;var a=e[r]={id:r,loaded:!1,exports:{}};return t[r].call(a.exports,a,a.exports,n),a.loaded=!0,a.exports}n.amdD=function(){throw new Error("define cannot be used indirect")},n.amdO={},n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.nmd=t=>(t.paths=[],t.children||(t.children=[]),t);var r=n(6852),i=datacook="undefined"==typeof datacook?{}:datacook;for(var a in r)i[a]=r[a];r.__esModule&&Object.defineProperty(i,"__esModule",{value:!0})})();
//# sourceMappingURL=index.js.map